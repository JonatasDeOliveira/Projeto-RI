<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>Size Balanced Tree - PEGWiki</title>
<meta name="generator" content="MediaWiki 1.25.2" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit" />
<link rel="edit" title="Edit" href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/opensearch_desc.php" title="PEGWiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wcipeg.com/wiki/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="/wiki/Size_Balanced_Tree" />
<link rel="copyright" href="http://creativecommons.org/licenses/by/3.0/" />
<link rel="alternate" type="application/atom+xml" title="PEGWiki Atom feed" href="/wiki/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=ext.math.styles%7Cext.rtlcite%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:b36fd1c042133c9c9b60260f7c29b237 */</style>
<script src="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Size_Balanced_Tree","wgTitle":"Size Balanced Tree","wgCurRevisionId":1819,"wgRevisionId":1819,"wgArticleId":502,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Size_Balanced_Tree","wgRelevantArticleId":502,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wikidb:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Size_Balanced_Tree skin-vector action-view">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<div class="mw-indicators">
</div>
			<h1 id="firstHeading" class="firstHeading" lang="en">Size Balanced Tree</h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From PEGWiki</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>A <b>size balanced tree</b> (<b>SBT</b>) is a <a href="/wiki/index.php?title=Self-balancing_binary_search_tree&amp;action=edit&amp;redlink=1" class="new" title="Self-balancing binary search tree (page does not exist)">self-balancing binary search tree</a> (BBST) first published by Chinese student Qifeng Chen in 2007. The tree is rebalanced by examining the sizes of each node's subtrees. Its abbreviation resulted in many nicknames given by Chinese informatics competitors, including "sha bi" tree (Chinese: 傻屄树; pinyin: <i>shǎ bī shù</i>; literally meaning "dumb cunt tree") and "super BT", which is a homophone to the Chinese term for snot (Chinese: 鼻涕; pinyin: <i>bítì</i>) suggesting that it is messy to implement. Contrary to what its nicknames suggest, this data structure can be very useful, and is also known to be easy to implement. Since the only extra piece of information that needs to be stored is sizes of the nodes (instead of other "useless" fields such as randomized weights in treaps or colours in red–black tress), this makes it very convenient to implement the <i>select-by-rank</i> and <i>get-rank</i> operations (easily transforming it into an <a href="/wiki/index.php?title=Order_statistic_tree&amp;action=edit&amp;redlink=1" class="new" title="Order statistic tree (page does not exist)">order statistic tree</a>). It supports standard binary search tree operations such as insertion, deletion, and searching in O(log <i>n</i>) time. According to Chen's paper, "it works much faster than many other famous BSTs due to the tendency of a perfect BST in practice."<sup id="cite_ref-1" class="reference"><a href="#cite_note-1">[1]</a></sup>
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Properties"><span class="tocnumber">1</span> <span class="toctext">Properties</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Rotations"><span class="tocnumber">2</span> <span class="toctext">Rotations</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Left_Rotation"><span class="tocnumber">2.1</span> <span class="toctext">Left Rotation</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Right_Rotation"><span class="tocnumber">2.2</span> <span class="toctext">Right Rotation</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Maintenance"><span class="tocnumber">3</span> <span class="toctext">Maintenance</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Fundamental_Operations"><span class="tocnumber">4</span> <span class="toctext">Fundamental Operations</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Searching"><span class="tocnumber">4.1</span> <span class="toctext">Searching</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Get_Max.2FMin"><span class="tocnumber">4.2</span> <span class="toctext">Get Max/Min</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Iteration"><span class="tocnumber">4.3</span> <span class="toctext">Iteration</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Insertion"><span class="tocnumber">4.4</span> <span class="toctext">Insertion</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Deletion"><span class="tocnumber">4.5</span> <span class="toctext">Deletion</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Order_Statistics"><span class="tocnumber">5</span> <span class="toctext">Order Statistics</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Select"><span class="tocnumber">5.1</span> <span class="toctext">Select</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Rank"><span class="tocnumber">5.2</span> <span class="toctext">Rank</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#References"><span class="tocnumber">6</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Properties">Properties</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=1" title="Edit section: Properties">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The size balanced tree examines each node's size (i.e. the number of nodes below it in the subtree) to determine when rotations should be performed. Each node <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png" /> in the tree satisfies the following two properties:
</p>
<ol><li><img class="mwe-math-fallback-image-inline tex" alt="size(T.left) \ge size(T.right.left), size(T.right.right)" src="/wiki/images/math/8/d/0/8d09d8f2297437737f1d2d2c7dc60b07.png" /></li>
<li><img class="mwe-math-fallback-image-inline tex" alt="size(T.right) \ge size(T.left.left), size(T.left.right)" src="/wiki/images/math/6/0/2/60218489325f4f5b36a1b0f08433d986.png" /></li></ol>
<p>In other words, each child node of <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png" /> is not smaller in size than the child nodes of its sibling. Clearly, we should consider the sizes of nonexistent children and siblings to be 0.
</p><p>Consider the following example where <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png" /> is the node in question, <img class="mwe-math-fallback-image-inline tex" alt="L, R" src="/wiki/images/math/1/7/1/171e9230cfcb0655edeab052f911655e.png" /> are its child nodes, and <img class="mwe-math-fallback-image-inline tex" alt="A, B, C, D" src="/wiki/images/math/9/3/f/93f9dc4db1b82845990c5124e8b1c45a.png" /> are subtrees which also satisfy the above SBT properties on their own.
</p>
<pre>       T
      / \
     /   \
    L     R
   / \   / \
  A   B C   D
</pre>
<p>Then, the node <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png" /> must satisfy:
</p>
<ul><li><img class="mwe-math-fallback-image-inline tex" alt="size(L) \ge size(C), size(D)" src="/wiki/images/math/8/e/5/8e5d09f1e80df74b04b9a9ee89bdeea1.png" /></li>
<li><img class="mwe-math-fallback-image-inline tex" alt="size(R) \ge size(A), size(B)" src="/wiki/images/math/4/0/a/40a742e3f1a3f7b5ffb09d71218e04b9.png" /></li></ul>
<h2><span class="mw-headline" id="Rotations">Rotations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=2" title="Edit section: Rotations">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The rotations of SBTs are analogous to those in other self-balancing binary search trees.
</p>
<pre>  -------------    Right Rotation     ------------
  |    Q      |   ---------------&gt;    |     P    |
  |   / \     |                       |    / \   |
  -- P   C    |                       |   A   Q --
    / \    &lt;---     Left Rotation     ---&gt;   / \  
   A   B          &lt;---------------          B   C 
</pre>
<h3><span class="mw-headline" id="Left_Rotation">Left Rotation</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=3" title="Edit section: Left Rotation">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>def left-rotate(t):
    k &#8592; t.right
    t.right &#8592; k.left
    k.left &#8592; t
    k.size &#8592; t.size
    t.size &#8592; t.left.size + t.right.size + 1
    t &#8592; k
</pre>
<h3><span class="mw-headline" id="Right_Rotation">Right Rotation</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=4" title="Edit section: Right Rotation">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<pre>def right-rotate(t):
    k &#8592; t.left
    t.left &#8592; k.right
    k.right &#8592; t
    k.size &#8592; t.size
    t.size &#8592; t.left.size + t.right.size + 1
    t &#8592; k
</pre>
<h2><span class="mw-headline" id="Maintenance">Maintenance</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=5" title="Edit section: Maintenance">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>After insertions and deletions, the new sizes of subtrees may violate the two properties above. Thus, we define a procedure <code>maintain(T)</code> to rebalance the SBT rooted at the node <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png" />. This should be called with the precondition that <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png" />'s children are already SBTs themselves. Since property 1 and 2 are symmetrical, we will only discuss property 1.
</p><p>There are 4 cases to consider when rebalancing.
</p>
<ul><li><b>Case 1</b>: <img class="mwe-math-fallback-image-inline tex" alt="size(T.left) &lt; size\left(T.right.left\right)" src="/wiki/images/math/a/6/e/a6e26594f88052248d2e3b4feca03d01.png" /></li></ul>
<dl><dd>Perhaps after inserting a value to <img class="mwe-math-fallback-image-inline tex" alt="T.right" src="/wiki/images/math/3/d/3/3d32a5dcb9954f4aef6e9e6e935d1f08.png" />, the scenario below (figure 1) may occur, leading to <img class="mwe-math-fallback-image-inline tex" alt="size(L) &lt; size\left(C\right)" src="/wiki/images/math/c/5/d/c5d5a780b691869976a5759540a8a607.png" />.</dd>
<dd>To fix this, we first perform a <code>right-rotate</code> on <img class="mwe-math-fallback-image-inline tex" alt="T.right" src="/wiki/images/math/3/d/3/3d32a5dcb9954f4aef6e9e6e935d1f08.png" /> (figure 2) and then a <code>left-rotate</code> on <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png" /> (figure 3).</dd></dl>
<pre>    Fig. 1:                Fig. 2:                   Fig. 3:    
  insert(R,v)          right-rotate(R)            left-rotate(T)

       T                      T                         C       
      / \                    / \                       / \      
     /   \                  /   \                     /   \     
    L     R                L     C                   T     R    
   / \   / \              / \   / \                 / \   / \   
  A   B C   D            A   B E   R               L   E F   D  
       / \                        / \             / \           
      E   F                      F   D           A   B          
</pre>
<dl><dd>After these operations, the properties of the entire tree in figure 3 becomes unpredictable. Luckily, the subtrees <img class="mwe-math-fallback-image-inline tex" alt="A, B, D, E, F, L" src="/wiki/images/math/8/a/6/8a66b73479c808c5414590b05ea839cc.png" /> are still SBTs. Thus, we can recursively call <code>maintain</code> on subtrees <img class="mwe-math-fallback-image-inline tex" alt="R" src="/wiki/images/math/e/1/e/e1e1d3d40573127e9ee0480caf1283d6.png" /> and <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png" /> to take care of them.</dd>
<dd>Now that all of the subtrees are SBTs, we still have to make sure that the root node <img class="mwe-math-fallback-image-inline tex" alt="C" src="/wiki/images/math/0/d/6/0d61f8370cad1d412f80b84d143e1257.png" /> satisfies the SBT properties. So, we call <code>maintain</code> one last time on root node <img class="mwe-math-fallback-image-inline tex" alt="C" src="/wiki/images/math/0/d/6/0d61f8370cad1d412f80b84d143e1257.png" />.</dd></dl>
<ul><li><b>Case 2</b>: <img class="mwe-math-fallback-image-inline tex" alt="size(T.left) &lt; size\left(T.right.right\right)" src="/wiki/images/math/a/2/8/a286fb1559e0fdee391c520f0ae5516c.png" /></li></ul>
<dl><dd>Perhaps after inserting a value to <img class="mwe-math-fallback-image-inline tex" alt="T.right" src="/wiki/images/math/3/d/3/3d32a5dcb9954f4aef6e9e6e935d1f08.png" />, the scenario below (figure 4) may occur, leading to <img class="mwe-math-fallback-image-inline tex" alt="size(L) &lt; size\left(D\right)" src="/wiki/images/math/8/1/b/81b9ca0a4fa2b5db655b55d55d1d68da.png" />. This is similar to case 1, except that instead of going below <img class="mwe-math-fallback-image-inline tex" alt="C" src="/wiki/images/math/0/d/6/0d61f8370cad1d412f80b84d143e1257.png" />, <img class="mwe-math-fallback-image-inline tex" alt="E" src="/wiki/images/math/3/a/3/3a3ea00cfc35332cedf6e5e9a32e94da.png" /> and <img class="mwe-math-fallback-image-inline tex" alt="F" src="/wiki/images/math/8/0/0/800618943025315f869e4e1f09471012.png" /> instead goes below <img class="mwe-math-fallback-image-inline tex" alt="D" src="/wiki/images/math/f/6/2/f623e75af30e62bbd73d6df5b50bb7b5.png" />. We can omit them from the diagram.</dd>
<dd>Fixing this, we will perform a <code>left-rotate</code> on the root node <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png" />, obtaining the structure in figure 5.</dd></dl>
<pre>    Fig. 4:                Fig. 5:   
  insert(R,v)           left-rotate(T)
       T                       R           
      / \                     / \          
     /   \                   /   \         
    L     R                 T     D        
   / \   / \               / \             
  A   B C   D             L   C            
                         / \               
                        A   B              
</pre>
<dl><dd>After this, the tree rooted at R is still not yet a SBT because <img class="mwe-math-fallback-image-inline tex" alt="size(C) &lt; size\left(A\right)" src="/wiki/images/math/4/0/9/409f3024b62ff1add229181a38346d4b.png" /> or <img class="mwe-math-fallback-image-inline tex" alt="size(C) &lt; size\left(B\right)" src="/wiki/images/math/3/4/6/346b188fbd61e4f070f97a382d1cb907.png" /> may be true. So, we continue to call <code>maintain</code> on <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png" />.</dd>
<dd>Now that we have satisfied the precondition of making <img class="mwe-math-fallback-image-inline tex" alt="R" src="/wiki/images/math/e/1/e/e1e1d3d40573127e9ee0480caf1283d6.png" />'s subtrees SBTs, we may call <code>maintain</code> on <img class="mwe-math-fallback-image-inline tex" alt="R" src="/wiki/images/math/e/1/e/e1e1d3d40573127e9ee0480caf1283d6.png" /> itself.</dd></dl>
<ul><li><b>Case 3</b>: <img class="mwe-math-fallback-image-inline tex" alt="size(T.right) &lt; size\left(T.left.right\right)" src="/wiki/images/math/5/6/e/56e1b3e7b2503cec2e24f3e961653061.png" /></li></ul>
<dl><dd>Symmetrical to case 1.</dd></dl>
<ul><li><b>Case 4</b>: <img class="mwe-math-fallback-image-inline tex" alt="size(T.right) &lt; size\left(T.left.left\right)" src="/wiki/images/math/e/1/f/e1ffbc28bcb9f669f0a560fff1c15590.png" /></li></ul>
<dl><dd>Symmetrical to case 2.</dd></dl>
<p><br />
With this casework being taken care of, it becomes straightforward to actually implement <code>maintain</code>.
</p>
<pre>def maintain(t):

    if t.left.size &lt; t.right.left.size:         //case 1
        right-rotate(t.right)
        left-rotate(t)
        maintain(t.left)
        maintain(t.right)
        maintain(t)

    else if t.left.size &lt; t.right.right.size:   //case 2
        left-rotate(t)
        maintain(t.left)
        maintain(t)

    else if t.right.size &lt; t.left.right.size:   //case 1'
        left-rotate(t.left)
        right-rotate(t)
        maintain(t.left)
        maintain(t.right)
        maintain(t)

    else if t.right.size &lt; t.left.left.size:    //case 2'
        right-rotate(t)
        maintain(t.right)
        maintain(t)
</pre>
<p><br />
This pseudocode is slightly slow and redundant. Since we know that the two SBT properties will <i>usually</i> be satisfied, the following is an optimization.
Simply add an extra boolean flag to the <code>maintain</code> parameters, indicating whether cases 1/2 or their symmetrical cases are being examined.
If the flag is TRUE, then we examine cases 1 and 2, otherwise we examine cases 3 and 4. Doing so will eliminate many unnecessary comparisons.
</p>
<pre>def maintain(t, flag):
    
    if flag:
        if t.left.size &lt; t.right.left.size:        //case 1
            right-rotate(t.right)
            left-rotate(t)
        else if t.left.size &lt; t.right.right.size:  //case 2
            left-rotate(t)
        else:
            done
    else:
        if t.right.size &lt; t.left.right.size:       //case 1'
            left-rotate(t.left)
            right-rotate(t)
        else if t.right.size &lt; t.left.left.size:   //case 2'
            right-rotate(t)
        else:
            done

    maintain(t.left, FALSE)   //maintain the left subtree
    maintain(t.right, TRUE)   //maintain the right subtree
    maintain(t, TRUE)         //maintain the whole tree
    maintain(t, FALSE)        //maintain the whole tree
</pre>
<p>The proof for why <code>maintain(t.left, TRUE)</code> and <code>maintain(t.right, FALSE)</code> are unnecessary can be found in section 6 of Chen's paper. Furthermore, the running time of <code>maintain</code> is O(1) amortized (which means that you do not have to worry about it not terminating).
</p>
<h2><span class="mw-headline" id="Fundamental_Operations">Fundamental Operations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=6" title="Edit section: Fundamental Operations">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<h3><span class="mw-headline" id="Searching">Searching</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=7" title="Edit section: Searching">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Searching in SBTs is exactly the same as searching in other binary search trees. The following iterative implementation will return a pointer to the node in the SBT rooted at <img class="mwe-math-fallback-image-inline tex" alt="t" src="/wiki/images/math/e/3/5/e358efa489f58062f10dd7316b65649e.png" /> which has key <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png" />.
</p>
<pre>def search(t, k):
   x &#8592; t
   while x is not NIL:
       if k &lt; x.key then x &#8592; x.left
       else if x.key &lt; k then x &#8592; x.right
       else return x
   return NIL   //key not found!
</pre>
<h3><span class="mw-headline" id="Get_Max.2FMin">Get Max/Min</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=8" title="Edit section: Get Max/Min">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The size of the SBT is already stored. These operations can thus be handled trivially by the <code>select</code> operation implemented in the section below.
</p>
<h3><span class="mw-headline" id="Iteration">Iteration</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=9" title="Edit section: Iteration">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Iterating a SBT is exactly the same as iterating a normal binary search tree (by repeatedly finding nodes' predecessors/successors).
</p>
<h3><span class="mw-headline" id="Insertion">Insertion</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=10" title="Edit section: Insertion">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Inserting into a SBT is very simple. The only difference from normal binary search trees is that it has an extra call to <code>maintain</code> at the end. The following recursive version will insert the node <img class="mwe-math-fallback-image-inline tex" alt="x" src="/wiki/images/math/9/d/d/9dd4e461268c8034f5c8564e155c67a6.png" /> into the SBT rooted at <img class="mwe-math-fallback-image-inline tex" alt="t" src="/wiki/images/math/e/3/5/e358efa489f58062f10dd7316b65649e.png" />.
</p>
<pre>def insert(t, x):
    if x is NIL:
        t &#8592; x
    else
        t.size &#8592; t.size + 1
        if x.key &lt; t.key:
            insert(t.left, x)
        else
            insert(t.right, x)
    maintain(t, x.key &#8805; t.key)
</pre>
<h3><span class="mw-headline" id="Deletion">Deletion</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=11" title="Edit section: Deletion">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Deletion is exactly the same as in normal binary search trees. It is not even necessary to call <code>maintain</code> afterwards. The proof for this is as follows: A SBT will have all of its properties before deletion. Even though we cannot guarantee that the SBT will retain its balanced properties after the insertion, we know for sure that its height (and thus, its running time) will not increase. Given this, it is clear that calling <code>maintain</code> after deleting is extraneous.
</p>
<h2><span class="mw-headline" id="Order_Statistics">Order Statistics</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=12" title="Edit section: Order Statistics">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Since SBTs already conveniently store the <img class="mwe-math-fallback-image-inline tex" alt="size" src="/wiki/images/math/f/7/b/f7bd60b75b29d79b660a2859395c1a24.png" /> field to maintain balance, nothing else is needed to transform it into a fully-fledged order statistics tree.
</p>
<h3><span class="mw-headline" id="Select">Select</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=13" title="Edit section: Select">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The following function returns a pointer to the <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png" />th smallest element in the SBT rooted at <img class="mwe-math-fallback-image-inline tex" alt="t" src="/wiki/images/math/e/3/5/e358efa489f58062f10dd7316b65649e.png" />, where <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png" /> is zero-indexed. To make this one-indexed, simply change "<code>r &#8592; t.left.size</code>" to "<code>r &#8592; t.left.size + 1</code>" and "<code>i - (r + 1)</code>" to "<code>i - r</code>". 
</p>
<pre>def select(t, i):
    r &#8592; t.left.size
    if i = r:
        return t
    else if i &lt; r:
        return select(t.left, i)
    else 
        return select(t.right, i - (r + 1))
</pre>
<h3><span class="mw-headline" id="Rank">Rank</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=14" title="Edit section: Rank">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Determining the rank of an element in a SBT is exactly the same as doing so for a regular binary search tree.
</p>
<h2><span class="mw-headline" id="References">References</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit&amp;section=15" title="Edit section: References">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ol class="references">
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="#cite_ref-1">↑</a></span> <span class="reference-text">Chen, Qifeng. <a rel="nofollow" class="external text" href="http://www.scribd.com/doc/3072015/">"Size Balanced Tree"</a>, Guandong, China, 29 December 2006.</span>
</li>
</ol>

<!-- 
NewPP limit report
CPU time usage: 0.077 seconds
Real time usage: 0.084 seconds
Preprocessor visited node count: 587/1000000
Preprocessor generated node count: 1274/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:502-0!*!0!!en!*!*!math=0 and timestamp 20180417074751 and revision id 1819
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wcipeg.com/wiki/index.php?title=Size_Balanced_Tree&amp;oldid=1819">https://wcipeg.com/wiki/index.php?title=Size_Balanced_Tree&amp;oldid=1819</a>"					</div>
													<div id='catlinks' class='catlinks catlinks-allhidden'></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-createaccount"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Size+Balanced+Tree&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Size+Balanced+Tree" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="/wiki/Size_Balanced_Tree"  title="View the content page [c]" accesskey="c">Page</a></span></li>
															<li  id="ca-talk" class="new"><span><a href="/wiki/index.php?title=Talk:Size_Balanced_Tree&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="/wiki/Size_Balanced_Tree" >Read</a></span></li>
															<li id="ca-edit"><span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=edit"  title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span><a href="#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="/wiki/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search PEGWiki [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="/wiki/Main_Page"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
			<h3 id='p-navigation-label'>Navigation</h3>

			<div class="body">
									<ul>
													<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
													<li id="n-Index"><a href="/wiki/Special:AllPages">Index</a></li>
													<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
													<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
													<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Size_Balanced_Tree" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Size_Balanced_Tree" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;oldid=1819" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="/wiki/index.php?title=Size_Balanced_Tree&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 8 September 2014, at 20:33.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by/3.0/">Attribution 3.0 Unported</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="/wiki/PEGWiki:Privacy_policy" title="PEGWiki:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="/wiki/PEGWiki:About" title="PEGWiki:About">About PEGWiki</a></li>
											<li id="footer-places-disclaimer"><a href="/wiki/PEGWiki:General_disclaimer" title="PEGWiki:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by/3.0/"><img src="http://i.creativecommons.org/l/by/3.0/88x31.png" alt="Attribution 3.0 Unported" width="88" height="31" /></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="//www.mediawiki.org/"><img src="/wiki/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["ext.cite","mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wcipeg.com/wiki/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":73});
}</script>
	</body>
</html>
