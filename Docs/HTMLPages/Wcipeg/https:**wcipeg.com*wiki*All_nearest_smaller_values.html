<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8" />
<title>All nearest smaller values - PEGWiki</title>
<meta name="generator" content="MediaWiki 1.25.2" />
<link rel="alternate" type="application/x-wiki" title="Edit" href="/wiki/index.php?title=All_nearest_smaller_values&amp;action=edit" />
<link rel="edit" title="Edit" href="/wiki/index.php?title=All_nearest_smaller_values&amp;action=edit" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/opensearch_desc.php" title="PEGWiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="https://wcipeg.com/wiki/api.php?action=rsd" />
<link rel="alternate" hreflang="x-default" href="/wiki/All_nearest_smaller_values" />
<link rel="copyright" href="http://creativecommons.org/licenses/by/3.0/" />
<link rel="alternate" type="application/atom+xml" title="PEGWiki Atom feed" href="/wiki/index.php?title=Special:RecentChanges&amp;feed=atom" />
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=ext.math.styles%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:b36fd1c042133c9c9b60260f7c29b237 */</style>
<script src="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"All_nearest_smaller_values","wgTitle":"All nearest smaller values","wgCurRevisionId":2160,"wgRevisionId":2160,"wgArticleId":385,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages needing code"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"All_nearest_smaller_values","wgRelevantArticleId":385,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wikidb:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-All_nearest_smaller_values skin-vector action-view">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<div class="mw-indicators">
</div>
			<h1 id="firstHeading" class="firstHeading" lang="en">All nearest smaller values</h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From PEGWiki</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>In a list of numbers <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png" />, the <i>nearest smaller value</i> (NSV) to an entry <img class="mwe-math-fallback-image-inline tex" alt="A_i" src="/wiki/images/math/e/8/a/e8aaf87d9a5c35b14cfbc370d3fd7b21.png" /> is the last entry preceding it with a smaller value, if any; that is, the entry <img class="mwe-math-fallback-image-inline tex" alt="A_j" src="/wiki/images/math/8/7/a/87a72a8622edcb5195a0e10778f77f97.png" /> with greatest <img class="mwe-math-fallback-image-inline tex" alt="j &lt; i" src="/wiki/images/math/e/0/0/e00a1cf3e30f9cdfe98fa86474f38b9f.png" /> such that <img class="mwe-math-fallback-image-inline tex" alt="A_j &lt; A_i" src="/wiki/images/math/f/1/4/f14f288416971f84edb659ee490cb99a.png" />. The <b>all nearest smaller values</b> (ANSV) problem is that of computing the NSV for each number in the list.
</p>
<h2><span class="mw-headline" id="Algorithm">Algorithm</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=All_nearest_smaller_values&amp;action=edit&amp;section=1" title="Edit section: Algorithm">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>It is obvious that, upon seeing the list for the first time, we cannot guarantee being able to find the NSV to a given entry in less than linear time, because it could be any of the preceding entries in the list, and thus, in the worst case, we must examine all of them. If we do a linear scan on each element, we get a trivial <img class="mwe-math-fallback-image-inline tex" alt="O(n^2)" src="/wiki/images/math/1/8/9/189317b4b935a745fcfaf95940d2b4f0.png" /> time solution to ANSV.
</p><p>However, it turns out that there is a simple linear time (<img class="mwe-math-fallback-image-inline tex" alt="O(n)" src="/wiki/images/math/7/b/a/7ba55e7c64a9405a0b39a1107e90ca94.png" />) solution to ANSV, which is clearly asymptotically optimal, since the size of the output is <img class="mwe-math-fallback-image-inline tex" alt="\Theta(n)" src="/wiki/images/math/5/c/1/5c151486ce3904339687c2bac3cccd8d.png" /> anyway. To understand this algorithm, we make a series of observations and refinements:
</p>
<ol><li> If <img class="mwe-math-fallback-image-inline tex" alt="k &lt; j &lt; i" src="/wiki/images/math/e/2/7/e2788251fbaa190c7c66b3094c9f507a.png" />, then it is only possible for <img class="mwe-math-fallback-image-inline tex" alt="A_k" src="/wiki/images/math/d/9/3/d93f57d24bbe3378bf1116d752877d4f.png" /> to be a NSV for <img class="mwe-math-fallback-image-inline tex" alt="A_i" src="/wiki/images/math/e/8/a/e8aaf87d9a5c35b14cfbc370d3fd7b21.png" /> if <img class="mwe-math-fallback-image-inline tex" alt="A_k &lt; A_j" src="/wiki/images/math/6/a/3/6a3c2049cfe5df32a102bab5b3edad3b.png" />; otherwise <img class="mwe-math-fallback-image-inline tex" alt="A_j" src="/wiki/images/math/8/7/a/87a72a8622edcb5195a0e10778f77f97.png" /> will always be both smaller and "nearer".</li>
<li> Thus, if we scan the list from left to right, and compute the NSV for each element as we visit it, and we encounter <img class="mwe-math-fallback-image-inline tex" alt="A_j" src="/wiki/images/math/8/7/a/87a72a8622edcb5195a0e10778f77f97.png" /> such that <img class="mwe-math-fallback-image-inline tex" alt="A_j \leq A_k" src="/wiki/images/math/5/3/8/538705a5499590109c5631619984190e.png" /> for some <img class="mwe-math-fallback-image-inline tex" alt="A_k" src="/wiki/images/math/d/9/3/d93f57d24bbe3378bf1116d752877d4f.png" /> already seen, then we can pretend that <img class="mwe-math-fallback-image-inline tex" alt="A_k" src="/wiki/images/math/d/9/3/d93f57d24bbe3378bf1116d752877d4f.png" /> doesn't exist anymore.</li>
<li> Given this fact, the only entries we've seen so far that we need to keep track of are the ones that are less than all following entries seen so far.</li>
<li> This means that the list of "retained" entries is monotonically increasing.</li>
<li> Once we get to <img class="mwe-math-fallback-image-inline tex" alt="A_i" src="/wiki/images/math/e/8/a/e8aaf87d9a5c35b14cfbc370d3fd7b21.png" />, we can compute its NSV by looking backward though the list of retained previous entries, selecting the first one we find that is less than <img class="mwe-math-fallback-image-inline tex" alt="A_i" src="/wiki/images/math/e/8/a/e8aaf87d9a5c35b14cfbc370d3fd7b21.png" />. Also, all the retained entries skipped along the way&#8212;the ones that are greater than or equal to <img class="mwe-math-fallback-image-inline tex" alt="A_i" src="/wiki/images/math/e/8/a/e8aaf87d9a5c35b14cfbc370d3fd7b21.png" />&#8212;can now be discarded.</li></ol>
<p>In these five points the essence of the algorithm is contained. We can use a <a href="/wiki/Stack" title="Stack">stack</a> to store the list of previously seen values that are being retained, because we only add to and remove from it at the end. As an implementation detail, in step 5, it is useful to have a sentinel, so that we don't try to pop off an empty stack (when <img class="mwe-math-fallback-image-inline tex" alt="A_i" src="/wiki/images/math/e/8/a/e8aaf87d9a5c35b14cfbc370d3fd7b21.png" /> has no preceding smaller value).
</p><p><b>Pseudocode:</b>
</p>
<pre>input array A[1..n]
let A[0] &#8592; -&#8734;
let S be an empty stack
push(S,0)
for i &#8712; [1..n]
    while A[top(S)] &#8805; A[i]
        pop(S)
    let NSV[i] &#8592; top(S)
    push(S,i)
</pre>
<p>After this code has completed, <code>NSV[i]</code> will contain the <i>index</i> of the NSV of <img class="mwe-math-fallback-image-inline tex" alt="A_i" src="/wiki/images/math/e/8/a/e8aaf87d9a5c35b14cfbc370d3fd7b21.png" /> (not the NSV itself).
</p>
<h2><span class="mw-headline" id="Applications">Applications</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=All_nearest_smaller_values&amp;action=edit&amp;section=2" title="Edit section: Applications">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>A theoretically important application of ANSV is the construction of the <a href="/wiki/Cartesian_tree" title="Cartesian tree">Cartesian tree</a> for a given list of numbers; a node's parent in a Cartesian tree is either its NSV or its NSV in the reversed array (that is, the nearest smaller value on the right rather than on the left), whichever one is larger. (Proof is given in the other article.)
</p><p>Running ANSV twice, once on an array and once on its reverse, can be used to find, for each element <img class="mwe-math-fallback-image-inline tex" alt="A_i" src="/wiki/images/math/e/8/a/e8aaf87d9a5c35b14cfbc370d3fd7b21.png" />, the range <img class="mwe-math-fallback-image-inline tex" alt="[j,k]" src="/wiki/images/math/0/4/a/04a572c655742d66ec17d0c4c21d43bb.png" /> such that <img class="mwe-math-fallback-image-inline tex" alt="A_m \geq A_i" src="/wiki/images/math/c/c/f/ccfb7a1e068d5e644324326eb92d5ea8.png" /> for each <img class="mwe-math-fallback-image-inline tex" alt="m \in [j,k]" src="/wiki/images/math/6/1/0/610b840cf6b25213f83e6b7e2655456a.png" />. Geometrically, if the array is taken to represent a histogram in which <img class="mwe-math-fallback-image-inline tex" alt="A_i" src="/wiki/images/math/e/8/a/e8aaf87d9a5c35b14cfbc370d3fd7b21.png" /> is the height of the <i>i</i><sup>th</sup> bar, then this range gives how large a rectangle can be that just touches the top of the <i>i</i><sup>th</sup> bar while staying contained within the histogram. This can then trivially be used to find the largest rectangle contained entirely within the histogram.
</p><p>This gives an easy linear-time solution to the problem of finding the largest empty axis-aligned rectangle in a rectangular grid (in which each square is either completely full or completely empty): sweep from top to bottom; keep track of how far up one can go along each column  until encountering an obstacle, starting from the current row; and find the largest rectangle contained within the corresponding histogram constructed at each row.
</p>
<h2><span class="mw-headline" id="Problems">Problems</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=All_nearest_smaller_values&amp;action=edit&amp;section=3" title="Edit section: Problems">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a rel="nofollow" class="external text" href="http://wcipeg.com/problem/ccc11s2p6">CCC '11 Stage 2: Biggest (Zero Carbon) Footprint</a></li>
<li> <a rel="nofollow" class="external text" href="http://www.spoj.pl/problems/HISTOGRA">Largest rectangle in a histogram</a></li>
<li> <a rel="nofollow" class="external text" href="http://www.spoj.pl/problems/CTGAME">City Game</a></li>
<li> USACO: Rectangular Barn</li></ul>

<!-- 
NewPP limit report
CPU time usage: 0.043 seconds
Real time usage: 0.049 seconds
Preprocessor visited node count: 286/1000000
Preprocessor generated node count: 704/1000000
Postâ€expand include size: 256/2097152 bytes
Template argument size: 112/2097152 bytes
Highest expansion depth: 4/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    8.543      1 - -total
 71.82%    6.136      1 - Template:Problem
 40.65%    3.473      1 - Template:JudgeRoot
 23.21%    1.983      2 - Template:SPOJ
 19.83%    1.694      1 - Template:Root
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:385-0!*!0!!*!*!*!math=0 and timestamp 20180417131705 and revision id 2160
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wcipeg.com/wiki/index.php?title=All_nearest_smaller_values&amp;oldid=2160">https://wcipeg.com/wiki/index.php?title=All_nearest_smaller_values&amp;oldid=2160</a>"					</div>
													<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/wiki/Category:Pages_needing_code" title="Category:Pages needing code">Pages needing code</a></li></ul></div></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-createaccount"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=All+nearest+smaller+values&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=All+nearest+smaller+values" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li  id="ca-nstab-main" class="selected"><span><a href="/wiki/All_nearest_smaller_values"  title="View the content page [c]" accesskey="c">Page</a></span></li>
															<li  id="ca-talk" class="new"><span><a href="/wiki/index.php?title=Talk:All_nearest_smaller_values&amp;action=edit&amp;redlink=1"  title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label"><span>Variants</span><a href="#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="/wiki/All_nearest_smaller_values" >Read</a></span></li>
															<li id="ca-edit"><span><a href="/wiki/index.php?title=All_nearest_smaller_values&amp;action=edit"  title="You can edit this page. Please use the preview button before saving [e]" accesskey="e">Edit</a></span></li>
															<li id="ca-history" class="collapsible"><span><a href="/wiki/index.php?title=All_nearest_smaller_values&amp;action=history"  title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<h3 id="p-cactions-label"><span>More</span><a href="#"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="/wiki/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search PEGWiki [f]" accesskey="f" id="searchInput" /><input type="hidden" value="Special:Search" name="title" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton" /><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton" />								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="/wiki/Main_Page"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id='p-navigation' aria-labelledby='p-navigation-label'>
			<h3 id='p-navigation-label'>Navigation</h3>

			<div class="body">
									<ul>
													<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z">Main page</a></li>
													<li id="n-Index"><a href="/wiki/Special:AllPages">Index</a></li>
													<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
													<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
													<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id='p-tb' aria-labelledby='p-tb-label'>
			<h3 id='p-tb-label'>Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/All_nearest_smaller_values" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/All_nearest_smaller_values" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="/wiki/index.php?title=All_nearest_smaller_values&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="/wiki/index.php?title=All_nearest_smaller_values&amp;oldid=2160" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="/wiki/index.php?title=All_nearest_smaller_values&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 2 January 2018, at 14:12.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by/3.0/">Attribution 3.0 Unported</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="/wiki/PEGWiki:Privacy_policy" title="PEGWiki:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="/wiki/PEGWiki:About" title="PEGWiki:About">About PEGWiki</a></li>
											<li id="footer-places-disclaimer"><a href="/wiki/PEGWiki:General_disclaimer" title="PEGWiki:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by/3.0/"><img src="http://i.creativecommons.org/l/by/3.0/88x31.png" alt="Attribution 3.0 Unported" width="88" height="31" /></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="//www.mediawiki.org/"><img src="/wiki/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31" /></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wcipeg.com/wiki/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":83});
}</script>
	</body>
</html>
