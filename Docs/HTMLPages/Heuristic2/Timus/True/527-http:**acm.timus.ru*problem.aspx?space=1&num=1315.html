<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1315. MDPAR and MIIAR @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1315"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1315&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1315&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1315&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1315&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1315. MDPAR and MIIAR</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Speleology is a very interesting occupation. But it is also quite risky. According to the statistics, accidents are most often in spring, and many of them are caused by unexpected cave floods. In the last few years, there were several rescue operations, and each of them required quite a lot of financial resources and manpower. For the sake of economy, the Ministry for Extreme Situations issued the following order.</div></div><div class="problem_par"><div class="problem_par_normal">-----------------------<br>
<b>Order № 321/1.</b><br>

For the sake of economy of resources at spring rescue operations, it is ordered to:
<ol>
<li>Create a database of all caves and all speleologists of the Russian Federation.</li>
<li>Put into geostationary orbits 12 satellites S-349857 to make possible the exact determination of the location of speleologists in caves.</li>
<li>Employ programmers to develop systems of satellite control.</li>
<li>Create a device interacting with the satellites for automatically issuing rescue instructions to a speleologist. The device specification is given in Appendices A and B.</li>
<li>Oblige speleologists to have special equipment for urgent communication with a rescue center, including the device described in Article 4. </li>
</ol>
Minister.</div></div><div class="problem_par"><div class="problem_par_normal"><b>Appendix A. The device specification.</b><br>
The device has two modules.
<ol>
<li>The module for detecting the possibility of automated rescue (MDPAR):
<ul>
<li>determines which part of a cave is filled with water for the known configuration of the cave;</li>
<li>determines whether automated rescue is possible if the location of a speleologist and the maximal duration of his underwater stay are known.</li>
</ul>
</li><li>The module for issuing instructions for automated rescue (MIIAR): 
<ul>
<li>given the location of a speleologist, determines the direction of movement guaranteeing reaching the surface.</li>
</ul></li></ol></div></div><div class="problem_par"><div class="problem_par_normal"><b>Appendix B. The principles of filling caves with water.</b><br>
This document is a result of investigations of the Institute for Cave Studies. 
A cave is filled with water according to the following rules:
<ol>
<li>The cave is regarded as a collection of cubicles.</li>
<li>A cubicle is filled with water if there is a path from this cubicle to the surface.</li>
<li>A path is a sequence of cubicles that have common side.</li>
</ol>
Here only the paths having no downward segments are considered.<br>
-----------------------</div></div><div class="problem_par"><div class="problem_par_normal">You are to implement the MDPAR.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains 5 integers <i>W</i>, <i>H</i>, <i>X</i>, <i>Y</i>, <i>D</i>, which are respectively the width and depth of a cave (in cubicles), the <i>X</i> and <i>Y</i> coordinates of a speleologist, and the number of cubicles through which he can swim without air. The following <i>H</i> lines describe the configuration of the cave. Each of these lines contains <i>W</i> characters: "#" denotes a wall, i.e., a cubicle inaccessible both for the speleologist and for water, and a dot "." denotes air, i.e., a cubicle that is possibly accessible for the speleologist and can be filled with water. The module should be able to operate in the following ranges of the parameters: 1 ≤ <i>W</i>, <i>H</i> ≤ 500; 1 ≤ <i>X</i> ≤ <i>W</i>; 1 ≤ <i>Y</i> ≤ <i>H</i>. 1 ≤ <i>D</i> ≤ 1000. Cubicles are numbered from left to right, from bottom to top.
It is known that a speleologist can reach the surface while cave is not filled with water.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">You should output "Can be rescued by himself" if the speleologist can reach the surface following the instructions issued by the MIIAR. Otherwise, you should output "Rescue operation required".</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>9 4 8 2 5
##..##..#
##.#.####
##......#
#########
</pre></td><td><pre>Rescue operation required
</pre></td></tr><tr><td><pre>9 4 8 2 6
##..##..#
##.#.####
##......#
#########
</pre></td><td><pre>Can be rescued by himself
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Idea - Alexander Klepinin, prepared by Alexander Klepinin, Ivan Dashkevich<br><b>Problem Source: </b>VIII Collegiate Students Urals Programming Contest. Yekaterinburg, March 11-16, 2004<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=graphs">graph theory</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1315" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1315" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 2021</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1315" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1315">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1315">Discussion (21)</a><br><a href="status.aspx?space=1&amp;num=1315">All submissions (3869)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1315&amp;status=accepted">All accepted submissions (459)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1315">Solutions rating (206)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>