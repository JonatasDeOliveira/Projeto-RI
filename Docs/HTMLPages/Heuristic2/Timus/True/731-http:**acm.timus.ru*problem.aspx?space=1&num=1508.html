<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1508. Japanese Puzzle @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1508"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1508&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1508&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1508&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1508&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1508. Japanese Puzzle</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Solving Japanese puzzles (or Paint by numbers, as they are often called) is a very popular pastime among New Russians. In this kind of puzzle, cells in a grid have to be painted black or left blank according to numbers given at the sides of the grid. If this is done correctly, a hidden picture is revealed. The numbers are the lengths of continuous segments of painted cells in any given row or column. For example, a clue of "4 8 3" would mean there are segments of four, eight, and three filled cells, in that order, with at least one blank cell between successive groups. Of course, programmers are not as clever as New Russians, so we don't ask you to solve the whole puzzle. Your task will be to write a program that yields as much information about each cell of one row of a puzzle as possible, given some data about this row.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains the length of the row <i>L</i> (1&nbsp;≤&nbsp;<i>L</i>&nbsp;≤&nbsp;400) and the number of groups of consecutive cells that must be painted <i>K</i> (0&nbsp;≤&nbsp;<i>K</i>&nbsp;≤&nbsp;<i>L</i>). The second line contains <i>K</i> integers, which are the lengths of these groups. The third line contains <i>L</i> symbols describing the current information about the cells of the row (this information could be obtained by means of analyzing the data for columns and other rows):<br>
'.' denotes a cell that is definitely blank,<br>
'X' denotes a cell that must definitely be painted,<br>
'?' means that there is no information about this cell.
</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output a line containing <i>L</i> symbols describing the most complete information about the cells of the row in the same format as in the input, or the word Impossible if the input information is inconsistent and there is no row satisfying the input data.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>10 2
4 2
?????.?X??
</pre></td><td><pre>?XXX?.?X?.
</pre></td></tr><tr><td><pre>9 0

??????.X?
</pre></td><td><pre>Impossible
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Stanislav Vasilyev<br><b>Problem Source: </b>Quarter-Final of XXXI ACM ICPC - Yekaterinburg - 2006<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1508" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1508" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 1667</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1508" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1508">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1508">Discussion (10)</a><br><a href="status.aspx?space=1&amp;num=1508">All submissions (1988)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1508&amp;status=accepted">All accepted submissions (354)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1508">Solutions rating (230)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>