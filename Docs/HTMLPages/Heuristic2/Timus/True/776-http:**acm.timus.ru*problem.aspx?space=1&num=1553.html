<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1553. Caves and Tunnels @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1553"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1553&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1553&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1553&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1553&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1553. Caves and Tunnels</h2><div class="problem_limits">Time limit: 3.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">After landing on Mars surface, scientists found a strange system of caves connected by
tunnels. So they began to research it using remote controlled robots. It was found out that 
there exists exactly one route between every pair of caves. But then scientists faced a
particular problem. Sometimes in the caves faint explosions happen. They cause emission
of radioactive isotopes and increase radiation level in the cave. Unfortunately robots
don't stand radiation well. But for the research purposes they must travel from one cave
to another. So scientists placed sensors in every cave to monitor radiation level in the
caves. And now every time they move robots they want to know the maximal radiation level
the robot will have to face during its relocation. So they asked you to write a program that
will solve their problem. 
</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line of the input contains one integer <i>N</i> (1&nbsp;≤&nbsp;<i>N</i>&nbsp;≤&nbsp;100000)&nbsp;— the 
number of caves. Next <i>N</i>&nbsp;−&nbsp;1 lines describe tunnels. Each of these lines contains a pair of integers 
<i>a<sub>i</sub></i>, <i>b<sub>i</sub></i> (1&nbsp;≤&nbsp;<i>a<sub>i</sub></i>,&nbsp;<i>b<sub>i</sub></i>&nbsp;≤&nbsp;<i>N</i>)
specifying the numbers of the caves connected by corresponding tunnel. The next line has an integer <i>Q</i>
(<i>Q</i>&nbsp;≤&nbsp;100000) representing the number of queries. The <i>Q</i> queries follow on a single line each. Every query has
a form of "<i>C&nbsp;U&nbsp;V</i>", where <i>C</i> is a single character and can be either 'I' or 'G' representing the type of the query (quotes
for clarity only). In the case of an 'I' query radiation level in <i>U</i>-th cave (1&nbsp;≤&nbsp;<i>U</i>&nbsp;≤&nbsp;<i>N</i>) is incremented by <i>V</i> (0&nbsp;≤&nbsp;<i>V</i>&nbsp;≤&nbsp;10000).
In the case of a 'G' query your program must output the maximal level of radiation on the way between caves with
numbers <i>U</i> and <i>V</i> (1&nbsp;≤&nbsp;<i>U</i>,&nbsp;<i>V</i>&nbsp;≤&nbsp;<i>N</i>) after all increases of radiation ('I' queries) specified before current query.
It is assumed that initially radiation level is 0 in all caves, and it never decreases with time (because isotopes'
half-life time is much larger than the time of observations).
</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">For every 'G' query output one line containing the maximal radiation level by itself.
</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>4
1 2
2 3
2 4
6
I 1 1
G 1 1
G 3 4
I 2 3
G 1 1
G 3 4 
</pre></td><td><pre>1
0
1
3
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Source: </b>Novosibirsk SU Contest. Petrozavodsk training camp, September 2007<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=structure">data structures</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1553" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1553" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 406</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1553" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1553">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1553">Discussion (9)</a><br><a href="status.aspx?space=1&amp;num=1553">All submissions (9907)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1553&amp;status=accepted">All accepted submissions (2394)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1553">Solutions rating (891)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>