<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1580. Dean's Debts @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1580"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1580&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1580&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1580&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1580&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1580. Dean's Debts</h2><div class="problem_limits">Time limit: 2.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal"><i>N</i> students of one university took part 
in the Yekaterinozavodsk training camp.
When they returned home, it turned out that they had spent much of their own money for the
tickets to Yekaterinozavosk and back, for their lodgings, food and registration fees.
The students came to the dean of their department and asked him to compensate the costs of the trip.
The dean listened to them carefully and gave some amounts of money (possibly different) to all of them.
The next day two of these students came to the dean and told that 
the two of them had been given <i>A</i><sub>1</sub> rubles
less than they had spent jointly. On the next day, the situation repeated itself:
a pair of students claimed that the dean owed them <i>A</i><sub>2</sub> rubles. 
The situation repeated itself for a few days more. Finally, on the 
<i>M</i>-th day a pair of students told the dean that 
they two had spent together <i>A<sub>M</sub></i> rubles more than
the dean had paid them. After that, the students lost any hope and stopped visiting the dean.
Then the dean took the notes with the students' demands and decided to calculate 
how much he owed each of them.
But it turned out to be not so easy!</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains integers <i>N</i> and <i>M</i> separated by a space <nobr>(2 ≤ <i>N</i> ≤ 1000; 1 ≤ <i>M</i> ≤ 100000)</nobr>.
The following <i>M</i> lines contain the demands of pairs of students who visited the dean. The (<i>i</i>&nbsp;+&nbsp;1)-st line 
contains three integers separated by spaces: the numbers of two students who visited the dean on the <i>i</i>-th day and 
the amount of money <i>A</i><sub>i</sub> they asked for. The students are numbered from 1 to <i>N</i>.
The number <i>A<sub>i</sub></i> is an integer in range from −10000 to 10000. A negative number neans that the students got from 
the dean more that they spent. It is known that no pair of students visited the dean more than once.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">If the dean can determine uniquely how much money he owes each of the students, write these sums with two digits
after the decimal point: in the <i>i</i>-th line output the amount he owes the <i>i</i>-th student. The numbers can 
be negative; this means that the student owes the dean (sometimes it happens!). If it is impossible to 
find these amounts, output “IMPOSSIBLE”.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3 3
1 2 2
2 3 4
3 1 6
</pre></td><td><pre>2.00
0.00
4.00
</pre></td></tr><tr><td><pre>4 3
1 2 2
1 3 4
1 4 6
</pre></td><td><pre>IMPOSSIBLE
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Alexey Efremov<br><b>Problem Source: </b>USU Junior Contest, October 2007<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=graphs">graph theory</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1580" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1580" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 885</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1580" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1580">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1580">Discussion (18)</a><br><a href="status.aspx?space=1&amp;num=1580">All submissions (3992)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1580&amp;status=accepted">All accepted submissions (600)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1580">Solutions rating (401)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>