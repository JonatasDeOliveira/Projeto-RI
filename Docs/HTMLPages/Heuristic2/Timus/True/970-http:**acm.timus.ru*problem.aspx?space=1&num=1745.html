<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1745. Yet Another Answer @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1745"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1745&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1745&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1745&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1745&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1745. Yet Another Answer</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Eventually, after running Yet Another Stupendous Supercomputer for π million of years, hedgehogs happen to know Yet Another Answer. This time the Answer they got was quite surprising. Even for hedgehogs who didn't actually know what the Question was.</div></div><div class="problem_par"><div class="problem_par_normal">In fact, the Answer consists of <i>n</i> words. Each word is a nonempty sequence of left and right brackets.
Whilst most of the hedgehogs were rather frustrated with the Answer, Fluffy was happy, because Fluffy likes brackets so much. But most of all he likes regular bracket sequences.</div></div><div class="problem_par"><div class="problem_par_normal">A <i>regular bracket sequence</i> is a sequence of brackets which satisfies the following conditions:
<el>
<li> The sequence contains an equal number of left and right brackets; </li>
<li> The number of right brackets in any prefix of the sequence doesn't exceed the number of left ones. </li>
</el></div></div><div class="problem_par"><div class="problem_par_normal">Fluffy is sure that it's vitally important for the hedgehogs to know what is the longest regular bracket sequence one can make by concatenating the words of the Answer under the following rules:
<el>
<li> Each word can be used at most once; </li>
<li> Words can be used in the arbitrary order. </li>
</el></div></div><div class="problem_par"><div class="problem_par_normal">Because the Supercomputer is so busy designing its yet more powerful successor, Fluffy hopes you can help him to solve the problem.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains the number of words in the Answer <i>n</i> (1 ≤ <i>n</i> ≤ 1000). Each of the next <i>n</i> lines contains one of these words. The total length of all words doesn't exceed 10000.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">The first line of the output should contain two space-separated integers <i>l</i> and <i>k</i>, where <i>l</i> is the length of the longest possible regular bracket sequence and <i>k</i> is the number of
words it consists of. The second line should contain <i>k</i> space-separated numbers of used words in the order they should be concatenated. Words are numbered from 1 to <i>n</i> in the order they are given in the input.
If there are several possible answers output any of them.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>4
(
(((
(
))
</pre></td><td><pre>4 3
1 3 4
</pre></td></tr><tr><td><pre>3
()
(()
)
</pre></td><td><pre>6 3
2 3 1
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Damir Akhmetzyanov<br><b>Problem Source: </b>Ufa SATU Contest. Petrozavodsk Summer Session, August 2009<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=dynprog">dynamic programming</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1745" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1745" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 885</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1745" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1745">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1745">Discussion (8)</a><br><a href="status.aspx?space=1&amp;num=1745">All submissions (3807)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1745&amp;status=accepted">All accepted submissions (523)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1745">Solutions rating (306)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>