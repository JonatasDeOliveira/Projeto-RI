<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1992. CVS @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1992"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1992&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1992&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1992&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1992&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1992. CVS</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_epigraph">Yoda: Visit I will the cloners on Kamino... And see this army they have created for the Republic.</div></div><div class="problem_par"><div class="problem_par_normal">Cloners from the Kamino planet breed some of the finest clones.
Such good results are due to the careful management over the clones’ evolution.
The Kaminuans are now busy working out a new study technology that lets increase the clones’ effectiveness.
The cloners have come up with a new control system CVS (Clone Version System)  that makes managing the progress of experiments easier.
The system is quite simple to use. </div></div><div class="problem_par"><div class="problem_par_normal">The Kaminuans have some set of educational programs at their disposal.
A clone’s effectiveness depends on which programs and in which order he has learned.
The Kaminuans can teach any clone a program as long as this clone hasn’t learned it already.</div></div><div class="problem_par"><div class="problem_par_normal">To make the experiments even easier to conduct, the Kaminuans enabled canceling the changes made by the last program the clone has learned. 
In this case, the clone’s knowledge returns to the level when the program hasn’t yet been studied.
Then this clone can study this program in the future.
You can cancel programs at any time unless the clone is at the basic knowledge level.</div></div><div class="problem_par"><div class="problem_par_normal">Besides the ‘roll back’ function, a clone can ‘re-learn’ a program.
If one cancels some program by mistake, he can cancel the cancellation.
The CVS keeps record of each clone’s canceled programs.
After a program is canceled, the CVS adds another record.
After a clone re-learn a program, the record is deleted.
If a clone learn (not relearn) a program, all cancellation record history of this clone is deleted. 
You can use the re-learn function as long as the record history for this clone contains any records.</div></div><div class="problem_par"><div class="problem_par_normal">Finally, the system has a ‘clone’ option.
If a Kaminuan likes the current variant of a clone, he can clone the clone, 
that is, create a new clone with the same sequence of taught programs and cancellation history.</div></div><div class="problem_par"><div class="problem_par_normal">Initially the Kaminuans have a single clone with basic knowledge.
Help them analyze the progress of the experiments.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line of the input contains numbers <i>n</i>&nbsp;— the number of queries&nbsp;— and <i>m</i>&nbsp;— the number of educational programs (1&nbsp;≤ <i>n</i>, <i>m</i> ≤ 5·10<sup>5</sup>).
Each of the following <i>n</i> lines has one of the formats given below.
<ul>
<li> <i>learn</i>&nbsp;<i>c</i><sub><i>i</i></sub>&nbsp;<i>p</i><sub><i>i</i></sub>. Teach clone <i>c</i><sub><i>i</i></sub> program <i>p</i><sub><i>i</i></sub> (1 ≤ <i>p</i><sub><i>i</i></sub> ≤ <i>m</i>).
</li><li> <i>rollback</i>&nbsp;<i>c</i><sub><i>i</i></sub>. Cancel the last learned program for clone <i>c</i><sub><i>i</i></sub>.
</li><li> <i>relearn</i>&nbsp;<i>c</i><sub><i>i</i></sub>. Apply ‘re-learn’ function to clone <i>c</i><sub><i>i</i></sub>.
</li><li> <i>clone</i>&nbsp;<i>c</i><sub><i>i</i></sub>. Clone the clone <i>c</i><sub><i>i</i></sub>.
</li><li> <i>check</i>&nbsp;<i>c</i><sub><i>i</i></sub>. Display the last program clone <i>c</i><sub><i>i</i></sub> has learned and knows at the moment.
</li></ul>
It is guaranteed that <i>rollback</i> won’t be applied to the clone that is at the basic knowledge level.
<i>learn</i> is always applied with the program a clone doesn’t already know.
<i>relearn</i> is only applied if the cancellation history of a clone is not empty.
It is also guaranteed that only the clones that already exist can occur in the queries.
The numbers are assigned to the clones in the order the clones appear.
The Kaminuans started their experiments from clone number one.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">For each <i>check</i>&nbsp;<i>c</i><sub><i>i</i></sub> query display the result on a single line.
If some clone has only basic knowledge, print <i>basic</i>, otherwise print the number of the last learned program.</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>9 10
learn 1 5
learn 1 7
rollback 1
check 1
clone 1
relearn 2
check 2
rollback 1
check 1
</pre></td><td><pre>5
7
basic
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Egor Shchelkonogov<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1992" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1992" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 326</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1992" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1992">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1992">Discussion (15)</a><br><a href="status.aspx?space=1&amp;num=1992">All submissions (8528)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1992&amp;status=accepted">All accepted submissions (1681)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1992">Solutions rating (491)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>