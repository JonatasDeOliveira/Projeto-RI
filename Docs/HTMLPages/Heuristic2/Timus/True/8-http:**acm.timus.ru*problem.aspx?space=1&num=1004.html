<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1004. Sightseeing Trip @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1004"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1004&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1004&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1004&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1004&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1004. Sightseeing Trip</h2><div class="problem_limits">Time limit: 0.5 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">There is a travel agency in Adelton town on Zanzibar island. It has decided to
offer its clients, besides many other attractions, sightseeing the town. To
earn as much as possible from this attraction, the agency has accepted a
shrewd decision: it is necessary to find the shortest route which begins and
ends at the same place.  
</div></div><div class="problem_par"><div class="problem_par_normal">Your task is to write a program which finds such a route.
In the town there are <i>N</i> crossing points numbered from 1 to <i>N</i> and <i>M</i> two-way
roads numbered from 1 to <i>M</i>.  Two crossing points can be connected by multiple
roads, but no road connects a crossing point with itself.  Each sightseeing
route is a sequence of road numbers <i>y</i><sub>1</sub>, …, <i>y<sub>k</sub></i>, <i>k</i> &gt; 2. The road <i>y<sub>i</sub></i>
<nobr>(1 ≤ <i>i</i> ≤ <i>k</i> − 1)</nobr> connects crossing points <i>x<sub>i</sub></i> and <i>x</i><sub><i>i</i>+1</sub>, the road <i>y<sub>k</sub></i> connects
crossing points <i>x<sub>k</sub></i> and <i>x</i><sub>1</sub>. All the numbers <i>x</i><sub>1</sub>, …, <i>x<sub>k</sub></i> should be different.
The length of the sightseeing route is the sum of the lengths of all roads on
the sightseeing route, i.e. L(<i>y</i><sub>1</sub>) + L(<i>y</i><sub>2</sub>) + … + L(<i>y<sub>k</sub></i>) where L(<i>y<sub>i</sub></i>) is the
length of the road <i>y<sub>i</sub></i> (1 ≤ <i>i</i> ≤ <i>k</i>).  Your program has to find such a sightseeing
route, the length of which is minimal, or to specify that it is not possible,
because there is no sightseeing route in the town.
</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">Input contains <i>T</i> tests (1 ≤ <i>T</i> ≤ 5).
The first line of each test contains two integers: the
number of crossing points <i>N</i> and the number of roads <i>M</i> (3 ≤ <i>N</i> ≤ 100; 3 ≤ <i>M</i> ≤ <i>N</i> · (<i>N</i> − 1)).
Each of the next <i>M</i> lines describes one road. It contains 3 integers: the number
of its first crossing point <i>a</i>, the number of the second one <i>b</i>, and the length of the road <i>l</i> (1 ≤ <i>a</i>, <i>b</i> ≤ <i>N</i>; <i>a</i> ≠ <i>b</i>; <nobr>1 ≤ <i>l</i> ≤ 300</nobr>). Input is ended with a “−1” line.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Each line of output is an answer. It contains either a string
“No&nbsp;solution.” in case there isn't any sightseeing route, or it contains the
numbers of all crossing points on the shortest sightseeing route in the order
how to pass them (i.e. the numbers <i>x</i><sub>1</sub> to <i>x<sub>k</sub></i> from our definition of a
sightseeing route), separated by single spaces. If there are multiple
sightseeing routes of the minimal length, you can output any one of them.
</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>5 7
1 4 1
1 3 300
3 1 10
1 2 16
2 3 100
2 5 15
5 3 20
4 3
1 2 10
1 3 20
1 4 30
-1
</pre></td><td><pre>1 3 5 2
No solution.
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Source: </b>Central European Olympiad in Informatics 1999<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=graphs">graph theory</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1004" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1004" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 558</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1004" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1004">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1004">Discussion (84)</a><br><a href="status.aspx?space=1&amp;num=1004">All submissions (25131)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1004&amp;status=accepted">All accepted submissions (3631)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1004">Solutions rating (2317)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>