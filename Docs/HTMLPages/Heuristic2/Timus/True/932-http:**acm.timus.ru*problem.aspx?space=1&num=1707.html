<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1707. Hypnotoad's Secret @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1707"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1707&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1707&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1707&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1707&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1707. Hypnotoad's Secret</h2><div class="problem_limits">Time limit: 5.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><img src="/image/get.aspx/f48a08c5-e069-414d-a2a5-de882b6e0ff0" border="0" alt="Problem illustration" align="RIGHT" class="problem_raimage"><div class="problem_par"><div class="problem_par_normal">Everybody loves Hypnotoad! Its show is one of the most popular on TV!
It is true that after the show nobody remembers what it was about and even what
they have been doing during all that time. However, this does not prevent
the numerous fans of Hypnotoad from enjoying their favorite show.</div></div><div class="problem_par"><div class="problem_par_normal">In order to study the amazing properties of Hypnotoad, Professor Farnsworth
constructed a special device, which trapped and scanned its waves. He found out
that at each time moment Hypnotoad's eyes could be in one of <i>n</i> states.
Professor denoted those states by the numbers 0, 1, …, <i>n</i>−1
for simplicity. The states of the eyes changed according to one of several
linear laws. There were <i>m</i> such laws and each of them could be specified by
five integers:
<i>s</i><sub>0</sub>, <i>t</i><sub>0</sub>, Δ<i>s</i>, Δ<i>t</i>, <i>k</i>.
When Hypnotoad “worked” according to such a law, its left eye switched to
the state&nbsp;<i>s</i><sub><i>i</i></sub> and its right eye switched to
the state&nbsp;<i>t</i><sub><i>i</i></sub> successively
for all integers&nbsp;<i>i</i> from 0 to <i>k</i>−1, where</div></div><div class="problem_par"><div class="problem_par_center"><i>s</i><sub><i>i</i></sub> = (<i>s</i><sub>0</sub> + <i>i</i> Δ<i>s</i>) mod <i>n</i>,<br>
<i>t</i><sub><i>i</i></sub> = (<i>t</i><sub>0</sub> + <i>i</i> Δ<i>t</i>) mod <i>n</i>.
</div></div><div class="problem_par"><div class="problem_par_normal">After several weeks of research, Farnsworth understood that Hypnotoad's waves
could be used to learn many secrets of the Universe. For example, Hypnotoad could
see the dark matter and extract information from black holes. In order to see
the same way Hypnotoad saw, Professor constructed another device that emulated
“hypnosight”: each of its four oculars could stay in one of the <i>n</i>
states changing according to linear laws. Farnsworth carried out a series of
experiments and decided to draw a diagram in which he would mark for every possible state
of the device whether Hypnotoad's eyes could be in states similar to the states of
the oculars. Help Professor automate this process.
</div></div><div class="problem_par"><div class="problem_par_normal">One experiment is described by nine integers:
<i>a</i><sub>0</sub>, <i>b</i><sub>0</sub>, <i>c</i><sub>0</sub>, <i>d</i><sub>0</sub>,
Δ<i>a</i>, Δ<i>b</i>, Δ<i>c</i>, Δ<i>d</i>, <i>q</i>.
For all integer values of <i>j</i> from 0 to <i>q</i>−1, the oculars successively switch to
the following states:
</div></div><div class="problem_par"><div class="problem_par_center"><i>a</i><sub><i>j</i></sub> = (<i>a</i><sub>0</sub> + <i>j</i> Δ<i>a</i>) mod <i>n</i>,<br>
<i>b</i><sub><i>j</i></sub> = (<i>b</i><sub>0</sub> + <i>j</i> Δ<i>b</i>) mod <i>n</i>,<br>
<i>c</i><sub><i>j</i></sub> = (<i>c</i><sub>0</sub> + <i>j</i> Δ<i>c</i>) mod <i>n</i>,<br>
<i>d</i><sub><i>j</i></sub> = (<i>d</i><sub>0</sub> + <i>j</i> Δ<i>d</i>) mod <i>n</i>.
</div></div><div class="problem_par"><div class="problem_par_normal">For every state of the device (<i>a</i><sub><i>j</i></sub>, <i>b</i><sub><i>j</i></sub>,
<i>c</i><sub><i>j</i></sub>, <i>d</i><sub><i>j</i></sub>), it is required to determine
whether Hypnotoad's eyes can be in a state
(<i>s</i><sub><i>i</i></sub>, <i>t</i><sub><i>i</i></sub>) such that
</div></div><div class="problem_par"><div class="problem_par_center">min(<i>a</i><sub><i>j</i></sub>, <i>b</i><sub><i>j</i></sub>) ≤
<i>s</i><sub><i>i</i></sub> ≤
max(<i>a</i><sub><i>j</i></sub>, <i>b</i><sub><i>j</i></sub>),<br>
min(<i>c</i><sub><i>j</i></sub>, <i>d</i><sub><i>j</i></sub>) ≤
<i>t</i><sub><i>i</i></sub> ≤
max(<i>c</i><sub><i>j</i></sub>, <i>d</i><sub><i>j</i></sub>).
</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">In the first line you are given the number <i>n</i> of states of Hypnotoad's eyes
and the number <i>m</i> of laws of their behavior
(1 ≤ <i>n</i> ≤ 5000, 1 ≤ <i>m</i> ≤ 1000).
Each of the following <i>m</i> lines contains the integers
<i>s</i><sub>0</sub>, <i>t</i><sub>0</sub>, Δ<i>s</i>, Δ<i>t</i>, <i>k</i>,
which specify the law according to which the states of the eyes are switched
(0 ≤ <i>s</i><sub>0</sub>, <i>t</i><sub>0</sub>, |Δ<i>s</i>|,
|Δ<i>t</i>| ≤ <i>n</i>−1; 1 ≤ <i>k</i> ≤ 567).
</div></div><div class="problem_par"><div class="problem_par_normal">In the next line you are given the number <i>p</i> of experiments
(1 ≤ <i>p</i> ≤ 345). Each of the following <i>p</i> lines contains the integers
a<sub>0</sub>, <i>b</i><sub>0</sub>, <i>c</i><sub>0</sub>, <i>d</i><sub>0</sub>,
Δ<i>a</i>, Δ<i>b</i>, Δ<i>c</i>, Δ<i>d</i>, <i>q</i>,
which describe the experiment
(0 ≤ <i>a</i><sub>0</sub>, <i>b</i><sub>0</sub>, <i>c</i><sub>0</sub>,
<i>d</i><sub>0</sub>, |Δ<i>a</i>|, |Δ<i>b</i>|, |Δ<i>c</i>|,
|Δ<i>d</i>| ≤ <i>n</i>−1; 1 ≤ <i>q</i> ≤ 345).
</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output <i>p</i> lines, one line per experiment. For each experiment, determine
its result: the set of numbers <i>x</i><sub><i>j</i></sub> for <i>j</i> = 0, 1, …, <i>q</i>−1.
In this set, <i>x</i><sub><i>j</i></sub> = 1 if Hypnotoad's eyes can be in a state complying
with the corresponding state of the device and <i>x</i><sub><i>j</i></sub> = 0 otherwise.
If <i>q</i> ≤ 20, output all <i>x</i><sub><i>j</i></sub> in a row without spaces.
If <i>q</i> &gt; 20, output one number equal to
</div></div><div class="problem_centered_picture"><img src="/image/get.aspx/9ba9ffa4-3de7-4bb8-b92f-af786a8fe7ca" border="0" alt="Problem illustration"></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3 3
0 1 0 0 1
1 2 0 0 1
2 0 0 0 1
5
0 0 1 1 0 0 0 0 5
1 1 0 0 0 0 0 0 3
0 1 0 0 0 0 0 0 345
1 2 1 1 0 0 0 1 4
1 2 1 1 0 0 0 1 3 </pre></td><td><pre>11111
000
0
0110
011
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Dmitry Ivankov<br><b>Problem Source: </b>The 13th Urals Collegiate Programing Championship, April 04, 2009<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=structure">data structures</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1707" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1707" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 1789</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1707" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1707">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1707">Discussion (2)</a><br><a href="status.aspx?space=1&amp;num=1707">All submissions (1579)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1707&amp;status=accepted">All accepted submissions (303)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1707">Solutions rating (162)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>