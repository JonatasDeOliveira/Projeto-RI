<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1730. ManBearPig @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1730"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1730&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1730&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1730&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1730&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1730. ManBearPig</h2><div class="problem_limits">Time limit: 0.5 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">It was an early winter morning at South Park. As usual, adults were hurrying to work and children were hurrying to school. Stan, Kyle, Kenny, and Eric stood at a bus stop
waiting for the school bus. The day promised to be dull and boring.
</div></div><div class="problem_par"><div class="problem_par_normal">The boys didn't know that they would meet an interesting person that day. It all started when the school counselor gathered the children in the gymnasium and announced: “Attention, students, we have a very special guest speaker today. Who can tell me the name of our country's last vice-president?”</div></div><div class="problem_par"><div class="problem_par_normal">Of course, none of the children knew that his name was Al Gore. It turned out a bit later that, possibly, it was for the better.</div></div><div class="problem_par"><div class="problem_par_normal">The man mounted the platform and said: “Thanks, Mr. Mackey, and good morning to South Park Elementary! I am here to tell you about the single biggest threat to our planet. You see, there is something out there which threatens our very existence and may be the end to the human race as we know it. I'm talking, of course, about ‘ManBearPig.’ It is a creature which roams the Earth alone. It is half man, half bear, and half pig. Some people say that ManBearPig isn't real. Well, I'm here to tell you now, ManBearPig is very real. ManBearPig doesn't care who you are and what you've done. ManBearPig just wants to get you. But have no fear, because I am here to save you. And someday, when the world is rid of ManBearPig, everyone will say, ‘Thank you, Al Gore!’”</div></div><div class="problem_par"><div class="problem_par_normal">Of course, nobody paid attention to Gore's words. Everybody just shrugged their
shoulders and went to their classes. But in the evening Eric Cartman suddenly understood that Al Gore had said complete nonsense.</div></div><div class="problem_par"><div class="problem_par_normal">Judge for yourself, how could one creature consist of three halves of other creatures? Eric told that to Kenny, but Kenny dismissed it by saying that Gore, evidently, had meant one third of each creature. However, Eric was right. Indeed, there is no lineage that could lead to ManBearPig containing equal parts of pig, bear, and man.</div></div><div class="problem_par"><div class="problem_par_normal">A <i>lineage</i> of a creature is a sequence of interbreedings of creatures that leads to the birth of this creature. When creature <i>A</i> is interbreeded with creature <i>B</i>, a new creature is born, which consists of <i>A</i> and <i>B</i>. If creature <i>A</i> contained <i>a</i> percent of some animal and creature <i>B</i> contained <i>b</i> percent of the same animal, then the new creature contains <nobr>(<i>a</i> + <i>b</i>) / 2 </nobr> percent of that animal.</div></div><div class="problem_par"><div class="problem_par_normal">Now Eric wants to construct a possible lineage of a creature by the information on which animals and in which proportions are contained in this creature.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains the name of a creature. It consists of lowercase English letters and hyphens and has length in the range from 1 to 200. The hyphens in this name separate the names of animals. Each animal has a nonempty name and appears in the name of the creature at most once. The creature consists of at least one and at most ten different animals. The second line contains a space-separated list of fractions of the form <i>a</i>/<i>b</i> <nobr>(1 ≤ <i>a</i> ≤ <i>b</i> ≤ 1500)</nobr>. The <i>i</i>-th fraction in this list is the part of the creature that the <i>i</i>-th animal makes up. The sum of the fractions is equal to one.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output a lineage of the creature in the form of a consecutive description of how its ancestors and the creature itself were born. In the first line output the number <i>n</i> of lines in the lineage (1 ≤ <i>n</i> ≤ 10000). After that output <nobr><i>n</i> − 1</nobr> lines. The <i>k</i>-th of these lines must describe the <i>k</i>-th ancestor of the creature. If the <i>k</i>-th ancestor is an animal, then the line must contain its name only. If this ancestor was born as a result of interbreeding of two of the earlier-described ancestors, then the line must contain a pair of integers in the range from 1 to <nobr><i>k</i> − 1</nobr>. The integers are the numbers of lines in the lineage where these ancestors are described. In the last line output, in the same format, how the creature given in the input was born.
All the described ancestors of the creature must appear in at least one interbreeding.
If there are several possible lineages, output any of them. If it is impossible to construct the required lineage, output the line “No solution”.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>man-bear-pig
1/2 1/4 1/4
</pre></td><td><pre>7
man
pig
1 2
bear
man
4 5
3 6</pre></td></tr><tr><td><pre>man
1/1</pre></td><td><pre>1
man</pre></td></tr><tr><td><pre>man-bear-pig
1/3 1/3 1/3</pre></td><td><pre>No solution</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Fedor Fominykh (prepared by Ivan Burmistrov)<br><b>Problem Source: </b>Ural Regional School Programming Contest 2009<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1730" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1730" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 1006</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1730" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1730">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1730">Discussion (8)</a><br><a href="status.aspx?space=1&amp;num=1730">All submissions (1712)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1730&amp;status=accepted">All accepted submissions (327)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1730">Solutions rating (279)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>