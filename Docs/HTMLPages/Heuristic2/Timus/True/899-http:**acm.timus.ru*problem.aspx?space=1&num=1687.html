<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1687. Numismatics for Fun @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1687"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1687&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1687&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1687&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1687&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1687. Numismatics for Fun</h2><div class="problem_limits">Time limit: 0.5 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">San Sanych was a famous numismatist. Every time he came to another country
he would find a shop for collectors at once and buy there all local coins missing
in his collection.
</div></div><div class="problem_par"><div class="problem_par_normal">When he came to Japan and found such a shop, he
figured which Japanese coins were interesting to him. He was going to buy them
when he noticed that all the coins in that shop were packed in transparent
boxes, several coins in one box, and one could buy whole boxes only. The price
for all boxes was the same—200 yen. San Sanych was ready to buy some
extra coins if eventually every coin that he needed would cost him no more than
100 yen. He started to examine the boxes. The required coins were present in
many boxes in different combinations. It was not easy to make the choice.
</div></div><div class="problem_par"><div class="problem_par_normal">Seeing the customer's confusion, the shopkeeper offered her help and asked
which coins he wanted. San Sanych named the coins and added that he would buy
several boxes if their total cost didn't exceed the value of the purchase. In
order to determine the value of a purchase, San Sanych counts the number of
different new coins in the purchase and multiplies the number by 100 yen.
The shopkeeper said that she would select a suitable set of
boxes and let San Sanych have it at half-price if he bought the whole set. Of
course, in this case he might have to buy some redundant boxes—those that
could be excluded without decreasing the value of the set. San Sanych couldn't
miss the chance to get a discount and agreed to buy a set with the total cost,
the discount taken into account, not exceeding its value. The shopkeeper was
very kind and promised not to include into the set boxes that contained none
of the required coins. Naturally, San Sanych left the shop with the largest set
satisfying the above conditions.
</div></div><div class="problem_par"><div class="problem_par_normal">Your task is to determine which boxes the shopkeeper included in the set.
</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">In the first line there are two integers: the number <i>n</i> of kinds of Japanese
coins in the shop (1 ≤ <i>n</i> ≤ 100) and the number <i>k</i> of boxes
in the shop (1 ≤ <i>k</i> ≤ 50). The boxes are described in the following
<i>k</i> lines. Each of these lines starts with the number <i>k<sub>i</sub></i>
of coins in a box (1 ≤ <i>k<sub>i</sub></i> ≤ 100). Then there are
exactly <i>k<sub>i</sub></i> numbers denoting coins. The numbers are separated
with a space. The coins are numbered from 1 to <i>n</i>. All coins in each box
are different.
</div></div><div class="problem_par"><div class="problem_par_normal">In the last line you are given the list of coins that San Sanych wants to buy.
The first number in this line is the number <i>m</i> of coins in the list
(1 ≤ <i>m</i> ≤ 100). Then there are <i>m</i> numbers from 1 to <i>n</i>
separated with a space. All numbers in the list are different.
</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">In the first line output the number of boxes San Sanych bought. In the next
line, give the numbers of these boxes separated with a space. The boxes are
numbered from 1 to <i>k</i> as they are given in the input. If there are
several possible answers, output any of them.
</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>10 4
5 2 7 6 1 3
6 6 7 10 2 9 4
5 1 8 3 9 2
5 4 3 7 6 1
4 8 5 4 9
</pre></td><td><pre>3
2 3 4
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>prepared by Vladimir Yakovlev, special thanks to Vladislav Isenbaev<br><b>Problem Source: </b>USU Open Personal Contest 2009 (February 28, 2009)<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1687" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1687" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 1087</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1687" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1687">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1687">Discussion (3)</a><br><a href="status.aspx?space=1&amp;num=1687">All submissions (930)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1687&amp;status=accepted">All accepted submissions (337)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1687">Solutions rating (276)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>