<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>2096. All Inclusive @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=2096"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=2096&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=2096&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=2096&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=2096&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">2096. All Inclusive</h2><div class="problem_limits">Time limit: 2.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Winter in Yekaterinburg is the longest time of the year. And everyone 
spends long winter evenings in his own way. Nastya does not like winter. 
She loves the bright sun and warm sea. Therefore, every year in the middle 
of winter she flies with her friends for a couple of weeks to some tropical 
country to lie on a beach and go sightseeing. Every year she faces the 
problem of trip planning. She knows exactly what she will do each day. 
However, with her friends it is much more complicated. Each friend is 
unable to make the plan of his trip, therefore, at first he asks Nastya 
about who what planning to do in any of days, then chooses one of the 
plans, and sometimes changes a few days in it for himself. Moreover, 
Nastya has to keep track of who in which day is planning for himself. It 
is fine, if each friend just changes a day or two for himself, but many 
say, “I&nbsp;want to hang out on a beach from the fifth to the eleventh day 
after day. And I want to go on a tour three times starting from the 
seventh day once a week.” Nastya understands that her friend wants to  
spend the fifth, ninth and eleventh day on a&nbsp;beach and the seventh, 
fourteenth and twenty-first — on a tour. If a friend wants to do 
several things at the same day, in fact he will do what he says Nastya 
after all.</div></div><div class="problem_par"><div class="problem_par_normal">Nastya is so tired of that whims of her friends that she decided this year 
to automate the process.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains integers <i>n</i> and <i>m</i> that are the number of days 
in the trip and the number of Nastya’s friends <nobr>(1 ≤ <i>n</i>, <i>m</i> 
≤ 10<sup>5</sup>)</nobr>. The second line contains integers <i>a</i><sub>1</sub>, …, <i>a</i><sub><i>n</i></sub> 
that are planned activities in each of the days of Nastya’s plan (1 
≤ <i>a</i><sub><i>i</i></sub> ≤ 10<sup>9</sup>). Then there are <i>m</i> blocks, which describe 
Nastya’s friends. The first line of the <i>i</i>-th block contains an integer 
<i>q</i><sub><i>i</i></sub> that is the number of questions asked by the <i>i</i>-th friend before 
choosing his own plan (0 ≤ <i>q</i><sub><i>i</i></sub> ≤ 10<sup>5</sup>). The <i>j</i>-th of 
the following <i>q</i><sub><i>i</i></sub> lines contains integers <i>f</i><sub><i>ij</i></sub> and <i>x</i><sub><i>ij</i></sub>, meaning 
the question of what activity is scheduled for <i>x</i><sub><i>ij</i></sub> day of <i>f</i><sub><i>ij</i></sub> 
plan (0 ≤ <i>f</i><sub><i>ij</i></sub> &lt; <i>i</i>; <nobr>1 ≤ <i>x</i><sub><i>ij</i></sub> ≤ <i>n</i></nobr>).
The next line contains integers <i>p</i><sub><i>i</i></sub> and <i>c</i><sub><i>i</i></sub> that are the number of
the plan taken as a basis, and the amount of changes in it (0 ≤ 
<i>p</i><sub><i>i</i></sub> &lt; <i>i</i>; 0 ≤ <i>c</i><sub><i>i</i></sub> ≤ <i>n</i>). The following <i>c</i><sub><i>i</i></sub> lines 
contain four integers <i>d</i><sub><i>ij</i></sub>, <i>k</i><sub><i>ij</i></sub>, <i>p</i><sub><i>ij</i></sub> and <i>t</i><sub><i>ij</i></sub> that are 
the number of the&nbsp;first day in which it is needed to change the activity, 
the total number of days in which it is needed to change the activity, the 
period between these days and a new kind of activity (1 ≤ <i>d</i><sub><i>ij</i></sub>, 
<i>k</i><sub><i>ij</i></sub>, <i>p</i><sub><i>ij</i></sub> ≤ <i>n</i>; <i>d</i><sub><i>ij</i></sub> + (<i>k</i><sub><i>ij</i></sub> − 1) · <i>p</i><sub><i>ij</i></sub> ≤ 
<i>n</i>; 1 ≤ <i>t</i><sub><i>ij</i></sub> ≤ 10<sup>9</sup>).
Nastya’s plan has the number 0, plans of her friends are numbered by 
integers from 1 to <i>m</i> in the order in which the friends are described in  
the input. The sum of all <i>q</i><sub><i>i</i></sub> does not exceed 10<sup>5</sup>, the sum of all 
<i>k</i><sub><i>ij</i></sub> does not exceed 5 · 10<sup>6</sup>, the sum of all <i>c</i><sub><i>i</i></sub> does not  
exceed 10<sup>5</sup>. </div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output <i>m</i> lines, the <i>i</i>-th of them should contain <i>q</i><sub><i>i</i></sub> 
integers — the answers to the questions of the <i>i</i>-th friend.</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3 2
1 2 3
1
0 3
0 2
1 2 2 4
2 2 1 5
3
1 1
1 2
1 3
0 0
</pre></td><td><pre>3
4 5 5
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Egor Shchelkonogov<br><b>Problem Source: </b>Open Ural FU Personal Contest 2014<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=structure">data structures</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=2096" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=2096" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 2374</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=2096" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=2096">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=2096">Discussion (0)</a><br><a href="status.aspx?space=1&amp;num=2096">All submissions (254)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=2096&amp;status=accepted">All accepted submissions (47)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=2096">Solutions rating (27)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>