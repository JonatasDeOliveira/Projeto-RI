<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1616. Square Country 4 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1616"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1616&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1616&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1616&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1616&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1616. Square Country 4</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">There had never been trams in Square Country. No doubt, this worried
citizens a lot. At a referendum, people decided that a tram network should be
built all over the country. They also wanted this network to be connected with
the tram network of adjacent Rectangular Country. However, when projecting
works started, it turned out  that there was a problem: Square Country and
Rectangular Country had different coordinate systems; moreover, their
coordinate axes were not parallel.

</div></div><div class="problem_par"><div class="problem_par_normal">President of Square Country held a meeting with Square Parliament and took a
historic decision to turn the coordinate system of the country by an angle
α about the point (0, 0). The decision turned out to be rather unpopular
because in Square Country all privately-owned plots of land were sets of
squares with sides parallel to the coordinate axes and with integer-coordinate
vertices. That meant that after the historic turn it would be necessary to
alter the boundaries of private estates. The rules of establishing new
boundaries was approved by President's decree. For each cell of unit size, a
new owner was to be established as follows. If there was a citizen who owned
more than a half of that cell, then this person was to become the new owner of
the whole cell. Otherwise, the whole cell was to become state property.
</div></div><div class="problem_par"><div class="problem_par_normal">Square Government asked you to automatize the redistribution of private
property. You are given a map where all plots are shown. You must compile a new
map in which plots after the turn will be shown.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">Plots located far from the center are not in demand
in Square country; that is why all private estates are situated inside the
square <nobr>[−<i>n</i>, <i>n</i>] × [−<i>n</i>,
<i>n</i>]</nobr>. The map is a square table in each cell of which there is a
lowercase English letter, which is a unique code of the owner of the
corresponding plot. If there is a dot in a cell, then the corresponding plot
belongs to the state. In the map, the <i>x</i> axis is directed to the right,
and the <i>y</i> axis is directed upward.</div></div><div class="problem_par"><div class="problem_par_normal">The first line contains the numbers <i>n</i> and α separated by a
space; <nobr>1 ≤ <i>n</i> ≤ 30;</nobr> <nobr>0 ≤ α ≤
90;</nobr> the angle α is given in degrees. The following 2<i>n</i> lines
contain 2<i>n</i> symbols each; they form the map of private estates inside the
square <nobr>[−<i>n</i>, <i>n</i>] × [−<i>n</i>,
<i>n</i>]</nobr>.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">After the turn, some estates may fall out of the square
<nobr>[−<i>n</i>, <i>n</i>] × [−<i>n</i>, <i>n</i>]</nobr>.
Therefore, output the map of estates in the square <nobr>[−2<i>n</i>,
2<i>n</i>] × [−2<i>n</i>, 2<i>n</i>]</nobr> after the turn of
coordinates and property redistribution, in the same format.
</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>2 45.0
aaaa
aaaa
bb.x
bbx.
</pre></td><td><pre>........
........
...aa...
..aa.x..
..a..x..
...bb...
........
........
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Vladimir Yakovlev (idea — Stanislav Vasilyev)<br><b>Problem Source: </b>The 12th Urals Collegiate Programing Championship, March 29, 2008<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=geometry">geometry</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1616" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1616" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 3589</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1616" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1616">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1616">Discussion (4)</a><br><a href="status.aspx?space=1&amp;num=1616">All submissions (816)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1616&amp;status=accepted">All accepted submissions (157)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1616">Solutions rating (86)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>