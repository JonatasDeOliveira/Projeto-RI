<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1952. To Kill the Dragon @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1952"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1952&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1952&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1952&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1952&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1952. To Kill the Dragon</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">A small group of brave magicians gathered together to kill the bad dragon.
Since they do it every week (sometimes in several attempts),
they know the dragon’s behaviour by heart and can predict all his moves
with one second precision.</div></div><div class="problem_par"><div class="problem_par_normal">There are two kinds of magicians: attackers and healers.
The purpose of attackers is to damage the dragon, and
the purpose of healers is to heal injured magicians.
Each attacker can surround the dragon with an anti-magic aura that
continuously damages the dragon.
Similarly, each healer can surround all magicians on the battlefield
with an aura that continuously restores their health.</div></div><div class="problem_par"><div class="problem_par_normal">While a magician maintains his spell, the power of his aura 
(the damage or healing in a unit of time) increases linearly.
But the power of the aura of each magician can not exceed some fixed value
associated with the magician.
While a magician does not maintain the spell, the power of his aura
decreases linearly until it falls to zero.
So the power of an aura can never become negative.</div></div><div class="problem_par"><div class="problem_par_normal">Auras of different magicians are independent and don’t influence each other.
The total damage the dragon gets equals to the sum of damages
from every attacker’s aura.
Similarly, the total healing each magician gets equals to the sum of
amounts of healing from every healer’s aura.
Hit points of a magician can not exceed their initial value that is
the same for each magician.</div></div><div class="problem_par"><div class="problem_par_normal">During the battle, the dragon uses different spells in some fixed order.
The same type of spell can be used multiple times in a row.</div></div><div class="problem_par"><div class="problem_par_normal">The first spell is Fire Storm.
It creates a wall of fire all over the field
except for a small plot of land in the center of the storm.
While a magician is located in the fire, he gets constant damage equal to the power
of this spell and is not able to cast a spell.
There is enough space in the center of the storm to locate all magicians
without getting damage, and there they can cast spells.
The center of the storm can appear in different places each time
this spell is used.</div></div><div class="problem_par"><div class="problem_par_normal">The second spell is Dragon’s Breath.
While the dragon uses it, all magicians in the field
get constant damage equal to the power of this spell.
Fortunately, there are some <i> relatively safe</i> locations, where
magicians can cast their spells (in the other points magicians can not do this).
However, such locations are too small, and at each of them,
there is room for only one magician.
The number of such locations always equals to the number of magicians.
Similar to the Fire Storm, relatively safe locations can appear
in different places each time.
Since Dragon’s Breath takes much magic power,
the dragon never uses it more than two times in a row.</div></div><div class="problem_par"><div class="problem_par_normal">After a while, the dragon gets tired of the battle and strikes
all magicians with his tail, instantly killing them.</div></div><div class="problem_par"><div class="problem_par_normal">An <i> attack</i> of the dragon is either using one of his two spells or
his tail strike. The first attack starts at time 0.
Each subsequent attack starts at the time the previous attack is finished.
At the very moment when the dragon switches two attacks, the first of them
is considered to have effect.</div></div><div class="problem_par"><div class="problem_par_normal">Magicians don’t like to be fried, so each of them runs to the center
of the fire storm along a straight line right after it starts.
In case of Dragon’s Breath, each magician chooses one of the relatively safe
locations for himself and runs straight to that location.
Several magicians can run through the same point 
at the same time.
However, it doesn’t deny the fact that each relatively safe location
can be considered only for exactly one magician.</div></div><div class="problem_par"><div class="problem_par_normal">The dragon does not like to hurry, so the duration of his spells
is long enough for all magicians to reach every safe location
of the current spell from every safe location of the previous spell
regardless of which magicians go to which safe locations.
(Note however that there is <i>no</i> guarantee that they can get
to their destinations alive.)
Moreover, if the current spell is Fire Storm, then its duration is long enough
not only to reach its center but also to increase the power of all attacking
and healing auras to maximum value and to totally restore all magicians’
health regardless of how much health they had.
Dragon’s spells can have different power but it is always
strictly greater than the maximal total power of all healing auras.</div></div><div class="problem_par"><div class="problem_par_normal">If at some moment hit points of any magician fall to zero,
all magicians die. Killing the dragon is slightly more complicated
than killing a magician. It is necessary not only to make his hit
points equal to zero but also to cast a final spell.
Casting the final spell requires all magicians to gather at the center
of the fire storm. Obviously, magicians must be alive to cast the final spell.
The final spell can be cast instantly.</div></div><div class="problem_par"><div class="problem_par_normal">At time 0, all magicians are located at the origin, the power of every
healer’s aura is equal to its maximal level, and the power of 
every attacker’s aura is equal to zero.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">In the first line of input, you are given three nonnegative integers
<i>n</i>, <i>m</i> and <i>k</i>: the number of attackers, the number of healers
and the total number of dragon’s attacks
(1 ≤ <i>n</i>, <i>m</i> ≤ 9; <i>n</i> + <i>m</i> ≤ 10; 1 ≤ <i>k</i> ≤ 10).
In the second line, there are three integers <i>hp</i><sub><i>m</i></sub>, <i>v</i> and <i>hp</i><sub><i>d</i></sub>:
initial hit points and velocity of each magician and initial hit points of the dragon
(1 ≤ <i>hp</i><sub><i>m</i></sub>, <i>hp</i><sub><i>d</i></sub> ≤ 10<sup>9</sup>; 1 ≤ <i>v</i> ≤ 10<sup>6</sup>).</div></div><div class="problem_par"><div class="problem_par_normal">The next <i>n</i> lines describe attackers.
On <i>i</i>-th of them, there are three integers <i>dps</i><sub><i>i</i></sub>, <i>id</i><sub><i>i</i></sub> and <i>dd</i><sub><i>i</i></sub>:
the maximal power of <i>i</i>-th attacker’s aura,
the increment of the power of his aura per unit of time while he
maintains the spell, and decrement of the power of his aura per unit of time while
he runs to the next safe location
(1 ≤ <i>dps</i><sub><i>i</i></sub>, <i>id</i><sub><i>i</i></sub>, <i>dd</i><sub><i>i</i></sub> ≤ 10<sup>6</sup>).</div></div><div class="problem_par"><div class="problem_par_normal">The next <i>m</i> lines describe healers.
On <i>i</i>-th of them, there are three integers <i>hps</i><sub><i>i</i></sub>, <i>ih</i><sub><i>i</i></sub> and <i>dh</i><sub><i>i</i></sub>
describing the same values that were described by numbers <i>dps</i><sub><i>i</i></sub>, <i>id</i><sub><i>i</i></sub>
and <i>dd</i><sub><i>i</i></sub> for attackers.
(1 ≤ <i>hps</i><sub><i>i</i></sub>, <i>ih</i><sub><i>i</i></sub>, <i>dh</i><sub><i>i</i></sub> ≤ 10<sup>6</sup>).</div></div><div class="problem_par"><div class="problem_par_normal">After that, there are <i>k</i> blocks which describe dragon’s attacks in
chronological order.</div></div><div class="problem_par"><div class="problem_par_normal">If the attack is a Fire Storm, the first line of the block
contains a single word “Storm”.
On the second line of the block, you are given space-separated integers <i>d</i> and <i>t</i>:
the power and duration of the spell (1 ≤ <i>d</i>, <i>t</i> ≤ 10<sup>6</sup>).
On the third line of the block, there are two integers <i>x</i> and <i>y</i>:
coordinates of the center of this storm
(−1000 ≤ <i>x</i>, <i>y</i> ≤ 1000).</div></div><div class="problem_par"><div class="problem_par_normal">If the attack is a Dragon’s Breath, the first line of the block contains
a single word “Breath”.
On the second line of the block, you are given space-separated integers <i>d</i> and <i>t</i>:
the power and duration of the spell (1 ≤ <i>d</i>, <i>t</i> ≤ 10<sup>6</sup>).
The next <i>n</i> + <i>m</i> lines of the block contains two integers each <i>x</i><sub><i>i</i></sub> and <i>y</i><sub><i>i</i></sub>:
coordinates of relatively safe locations.
All relatively safe locations are different.</div></div><div class="problem_par"><div class="problem_par_normal">If the attack is a Tail Strike, its description is 
a single word “Tail”.</div></div><div class="problem_par"><div class="problem_par_normal">It is guaranteed that among all attacks, there is exactly one Tail Strike
and this attack is the last one.
It is also guaranteed that there can not be more than two
Dragon’s Breaths in a row.</div></div><div class="problem_par"><div class="problem_par_normal">Durations of spells are given in seconds, coordinates are in meters,
velocities are in meters per second. Powers of magicians’ auras and 
powers of the dragon spells are given in hit points per second,
the increment and the decrement of powers of auras are 
in hit points per square second.</div></div><div class="problem_par"><div class="problem_par_normal">Note that, although the given values are all integers,
all movement, damage, healing and changes in aura powers happen continuously.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">If the magicians are not able to kill the dragon, output a single line
“You are not prepared”.</div></div><div class="problem_par"><div class="problem_par_normal">Otherwise, on the first line, output “No useful loot again”.
On the second line, output one integer: the minimal number of attack
during which the dragon can die.
Attacks are numbered from 1.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>1 1 2
1 5 10
1 3 2
1 1 1
Storm
7 11
0 0
Tail
</pre></td><td><pre>No useful loot again
1
</pre></td></tr><tr><td><pre>1 1 2
1 5 10
1 3 2
1 1 1
Storm
7 10
0 0
Tail
</pre></td><td><pre>You are not prepared
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Denis Dublennykh<br><b>Problem Source: </b>Ural FU contest. Kontur Cup. Petrozavodsk training camp. Winter 2013<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=hardest">hardest problem</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1952" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1952" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 9161</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1952" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1952">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1952">Discussion (3)</a><br><a href="status.aspx?space=1&amp;num=1952">All submissions (373)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1952&amp;status=accepted">All accepted submissions (10)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1952">Solutions rating (9)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>