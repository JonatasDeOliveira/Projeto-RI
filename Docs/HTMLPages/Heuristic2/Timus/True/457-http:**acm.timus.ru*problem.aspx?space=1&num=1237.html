<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1237. Evacuation Plan @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1237"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1237&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1237&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1237&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1237&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1237. Evacuation Plan</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><img src="/image/get.aspx/3c14f5e5-5aca-4774-a139-52c835673b8e" border="0" alt="Problem illustration" align="RIGHT" class="problem_raimage"><div class="problem_par"><div class="problem_par_normal">The City has a number of municipal buildings and a number of fallout 
shelters that were build specially to hide municipal workers in case of
a nuclear war. Each fallout shelter has a limited capacity in terms of 
a number of people it can accommodate, and there's almost no excess 
capacity in The City's fallout shelters. Ideally, all workers from a 
given municipal building shall run to the nearest fallout shelter. 
However, this will lead to overcrowding of some fallout shelters, while 
others will be half-empty at the same time.</div></div><div class="problem_par"><div class="problem_par_normal">To address this problem, The City Council has developed a special evacuation plan. Instead of assigning every worker to a fallout shelter individually (which will be a huge amount of information to keep), they allocated fallout shelters to municipal buildings, listing the number of workers from every building that shall use a given fallout shelter, and left the task of individual assignments to the buildings' management. The plan takes into account a number of workers in every building - all of them are assigned to fallout shelters, and a limited capacity of each fallout shelter - every fallout shelter is assigned to no more workers then it can accommodate, though some fallout shelters may be not used completely.</div></div><div class="problem_par"><div class="problem_par_normal">The City Council claims that their evacuation plan is optimal, in the sense that it minimizes <i>the total time to reach fallout shelters</i>
for all workers in The City, which is the sum for all workers of the time to go from the worker's municipal building to the fallout shelter assigned
to this worker.</div></div><div class="problem_par"><div class="problem_par_normal">The City Mayor, well known for his constant confrontation with The City
Council, does not buy their claim and hires you as an independent consultant to verify the evacuation plan. Your task is to either ensure that the evacuation plan is indeed optimal, or to prove otherwise by presenting another evacuation plan with the smaller total time to reach fallout shelters, thus clearly exposing The City Council's incompetence.</div></div><div class="problem_par"><div class="problem_par_normal">During initial requirements gathering phase of your project, you have found that The City is represented by a rectangular grid. The location of municipal buildings and fallout shelters is specified by two integer numbers and the time to go between municipal building at the location 
(X<sub>i</sub>,&nbsp;Y<sub>i</sub>) and the fallout shelter at the location (P<sub>j</sub>,&nbsp;Q<sub>j</sub>) is D<sub>i,j</sub> = |X<sub>i</sub> - P<sub>j</sub>| + |Y<sub>i</sub> - Q<sub>j</sub>| + 1 
minutes.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The input consists of The City description and the evacuation plan description. The first line consists of two numbers N and M separated by a space. N (1&nbsp;≤&nbsp;N&nbsp;≤&nbsp;100) is a number of municipal buildings in The City (all municipal buildings are numbered from 1 to N). M (1&nbsp;≤&nbsp;M&nbsp;≤&nbsp;100) is a number of fallout shelters in The City (all fallout shelters are numbered from 1 to M).</div></div><div class="problem_par"><div class="problem_par_normal">The following N lines describe municipal buildings. Each line contains there integer numbers X<sub>i</sub>, Y<sub>i</sub>, and B<sub>i</sub> separated by spaces, where X<sub>i</sub>, Y<sub>i</sub> (-1000&nbsp;≤&nbsp;X<sub>i</sub>,&nbsp;Y<sub>i</sub>&nbsp;≤&nbsp;1000) are the coordinates of the building, and B<sub>i</sub> 
(1&nbsp;≤&nbsp;B<sub>i</sub>&nbsp;≤&nbsp;1000) is the number of workers in this building.</div></div><div class="problem_par"><div class="problem_par_normal">The description of municipal buildings is followed by M lines that describe fallout shelters. Each line contains three integer numbers P<sub>j</sub>, Q<sub>j</sub>, and C<sub>j</sub> separated by spaces, where P<sub>i</sub>, Q<sub>i</sub> (-1000&nbsp;≤&nbsp;P<sub>j</sub>,&nbsp;Q<sub>j</sub>&nbsp;≤&nbsp;1000) are the coordinates of the fallout shelter, and C<sub>j</sub> 
(1&nbsp;≤&nbsp;C<sub>j</sub>&nbsp;≤&nbsp;1000) is the capacity
of this shelter.</div></div><div class="problem_par"><div class="problem_par_normal">The description of The City Council's evacuation plan follows on the next N lines. Each line represents an evacuation plan for a single building (in the order they are given in The City description). The evacuation plan of i<sup>th</sup> municipal building consists of M integer numbers E<sub>i,j</sub> separated by spaces. E<sub>i,j</sub> (0&nbsp;≤&nbsp;E<sub>i,j</sub>&nbsp;≤&nbsp;1000) is a number 
of workers that shall evacuate from the i<sup>th</sup> municipal building to the j<sup>th</sup> fallout shelter.</div></div><div class="problem_par"><div class="problem_par_normal">The plan is guaranteed to be <i>valid</i>. Namely, it calls for an evacuation of the exact number of workers that are actually working in any given municipal building according to The City description and does not exceed the capacity of any given fallout shelter.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">If The City Council's plan is optimal, then write the
single word <tt>OPTIMAL</tt>. Otherwise, write the word <tt>SUBOPTIMAL</tt> on the first line, followed by N lines that describe your plan in the same format as in the input. Your plan need not be optimal itself, but must be valid and better than The City Council's one.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3 4
-3 3 5
-2 -2 6
2 2 5
-1 1 3
1 1 4
-2 -2 7
0 -1 3
3 1 1 0
0 0 6 0
0 3 0 2
</pre></td><td><pre>SUBOPTIMAL
3 0 1 1
0 0 6 0
0 4 0 1
</pre></td></tr><tr><td><pre>3 4
-3 3 5
-2 -2 6
2 2 5
-1 1 3
1 1 4
-2 -2 7
0 -1 3
3 0 1 1
0 0 6 0
0 4 0 1
</pre></td><td><pre>OPTIMAL
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Vladimir Kotov<br><b>Problem Source: </b>2002-2003 ACM Northeastern European Regional Programming Contest<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=graphs">graph theory</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1237" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1237" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 925</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1237" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1237">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1237">Discussion (10)</a><br><a href="status.aspx?space=1&amp;num=1237">All submissions (3481)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1237&amp;status=accepted">All accepted submissions (733)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1237">Solutions rating (454)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>