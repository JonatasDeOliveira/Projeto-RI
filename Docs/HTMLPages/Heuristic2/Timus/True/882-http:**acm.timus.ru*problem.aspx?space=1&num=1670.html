<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1670. Asterisk @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1670"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1670&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1670&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1670&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1670&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1670. Asterisk</h2><div class="problem_limits">Time limit: 0.5 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Recently Cuckooland mathematicians have invented a new binary operation “asterisk”, which uses sequences as its arguments. Operation just appends the first sequence to the second. For example <nobr>(2, 4) * (1, 3) = (1, 3, 2, 4)</nobr>. “Asterisk” operations in one expression are performed in order from the leftmost to the rightmost, but this order can be changed with brackets (operations in brackets are performed earlier). E. g. <nobr>(3) * ((1, 5) * (2, 7)) = (2, 7, 1, 5, 3)</nobr>. Notice that if a sequence element is represented by an expression, then this expression is calculated first and then all nested brackets in this sequence are removed. For example, <nobr>(1, ((2) * (3)), 4) = (1, (3, 2), 4) = (1, 3, 2, 4)</nobr>.</div></div><div class="problem_par"><div class="problem_par_normal">Now cuckoolanders want to use this operation for generating permutations. More precisely, they want to obtain a given permutation from permutation <nobr>(1, 2, …, <i>N</i>)</nobr> by adding brackets, commas and asterisks and evaluating the resulting expression.</div></div><div class="problem_par"><div class="problem_par_normal">The formal definition of <i>expression</i> follows.<br>
&lt;<i>expression</i>&gt; ::= &lt;<i>sequence</i>&gt;[*&lt;<i>sequence</i>&gt;…]<br>
&lt;<i>sequence</i>&gt; ::= (&lt;<i>sequence element</i>&gt;[,&lt;<i>sequence element</i>&gt;…])<br>
&lt;<i>sequence element</i>&gt; ::= &lt;<i>number</i>&gt; | &lt;<i>expression</i>&gt;<br>
&lt;<i>number</i>&gt; ::= 1|2|…|<i>N</i></div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains an integer <i>N</i> <nobr>(1 ≤ <i>N</i> ≤ 10000)</nobr>. The second line contains a permutation of numbers from 1 to <i>N</i>. These numbers are separated by spaces.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output a single line&nbsp;— correct expression, the result of which is the given permutation. Numbers from 1 to <i>N</i> should appear in ascending order. The length of the expression should not exceed 100000 symbols. In case there is no such expression output “IMPOSSIBLE”. Note that expression must not contain spaces and all sequences must be enclosed in brackets.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>4
3 4 2 1
</pre></td><td><pre>(1)*(2)*(3,4)
</pre></td></tr><tr><td><pre>6
5 1 2 6 4 3
</pre></td><td><pre>IMPOSSIBLE
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Daniil Ayzenshteyn<br><b>Problem Source: </b>Ural SU Contest. Petrozavodsk Summer Session, August 2008<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1670" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1670" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 1636</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1670" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1670">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1670">Discussion (6)</a><br><a href="status.aspx?space=1&amp;num=1670">All submissions (1717)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1670&amp;status=accepted">All accepted submissions (241)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1670">Solutions rating (183)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>