<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1623. Fractal Labyrinth @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1623"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1623&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1623&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1623&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1623&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1623. Fractal Labyrinth</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Roman adores all kinds of labyrinths. He solves them since his early childhood.
Yesterday he found a new, extremely amazing sort of labyrinth. He called it a "fractal labyrinth".
</div></div><div class="problem_par"><div class="problem_par_normal">Imagine a house with <i>N</i> doors. Inside it, there are <i>K</i> houses, each of them an entire copy of the "outer" one. Some doors are connected by roads. If you draw these roads, you get something like this:</div></div><div class="problem_centered_picture"><img src="/image/get.aspx/13b0532c-3f4c-47a1-9f31-3f6aa7c96e82" border="0" alt="Problem illustration"></div><div class="problem_par"><div class="problem_par_normal">Remembering that each "inner" house is a copy of the "outer house", you get the following picture 
as a result:</div></div><div class="problem_centered_picture"><img src="/image/get.aspx/1f19911e-02a5-4257-87ea-8962621aa6d2" border="0" alt="Problem illustration"></div><div class="problem_par"><div class="problem_par_normal">The following picture is an example of a house with 2 inner houses:</div></div><div class="problem_centered_picture"><img src="/image/get.aspx/a8414983-9621-4d74-a4cc-5882858387ff" border="0" alt="Problem illustration"></div><div class="problem_par"><div class="problem_par_normal">For outer house, some door is defined as "input" and some door as "output", so we finally come up to a labyrinth. Assuming that length of each road is 1, find the length of the shortest path in such labyrinth.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">In the first line there are numbers <i>N</i> <nobr>(2 ≤ <i>N</i> ≤ 20)</nobr> and <i>K</i> <nobr>(0 ≤ <i>K</i> ≤ 5)</nobr>. The next line contains <i>M</i>, the number of the roads. In the following <i>M</i> lines there are descriptions of the roads, one per line.</div></div><div class="problem_par"><div class="problem_par_normal">Each road description is formatted in the following way: </div></div><div class="problem_par_pre"><pre>&lt;house-number&gt;.&lt;door-number&gt; - &lt;house-number&gt;.&lt;door-number&gt;</pre></div><div class="problem_par"><div class="problem_par_normal">where left and right part of description specify the connected doors (a door is described by its number and
number of house it belongs to). Each road is bidirectional. The "outer" house has number 0, "inner" houses have numbers from 1 to <i>K</i>. Door numbers start with 0. No two roads connect the same pair of doors. No road connects a door to itself.</div></div><div class="problem_par"><div class="problem_par_normal">In the last line there are numbers of input and output door <i>D<sub>i</sub></i> and <i>D<sub>o</sub></i>. These numbers may coincide.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">If there exists a path from input to output, print the minimal length of such path. Otherwise, print "no&nbsp;solution".</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>12 1
11
0.0 - 1.1
0.1 - 0.2
1.2 - 1.3
0.3 - 0.4
1.4 - 1.5
0.5 - 0.6
1.6 - 1.7
0.7 - 0.8
1.8 - 1.9
0.9 - 0.10
1.10 - 0.11
0 11</pre></td><td><pre>11</pre></td></tr><tr><td><pre>8 0
8
0.0 - 0.2
0.1 - 0.3
0.2 - 0.4
0.3 - 0.5
0.4 - 0.6
0.5 - 0.7
0.6 - 0.0
0.7 - 0.1
2 5</pre></td><td><pre>no solution</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Source: </b>SPbSU ITMO contest. Petrozavodsk training camp. Winter 2008.<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=graphs">graph theory</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1623" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1623" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 3238</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1623" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1623">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1623">Discussion (4)</a><br><a href="status.aspx?space=1&amp;num=1623">All submissions (700)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1623&amp;status=accepted">All accepted submissions (164)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1623">Solutions rating (92)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>