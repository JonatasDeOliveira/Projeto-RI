<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1652. Banking Crisis @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1652"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1652&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1652&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1652&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1652&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1652. Banking Crisis</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">The interbank lending market has a great influence on the functioning of all
banks. This is where banks can obtain cheap short-term credits from other
banks. When this market was paralyzed, many banks became unable to discharge
their current liabilities. Central banks of all countries agreed upon
supporting the world's financial system by granting unlimited credits to
banks. However, all central banks pursued protectionist policies and undertook
to credit only those banks that were registered in their own countries.
Moreover, to avoid speculations, it was decided to credit “responsible”
banks only, i.e., those that credited other banks in the same country.
Wildcat banks found a way to obtain the required status: they bought some of
the debts of local banks incurred before the day of the announcement of the
plan.
</div></div><div class="problem_par"><div class="problem_par_normal">Given the situation in the interbank market on that day, determine the maximal
number of banks that can obtain additional liquidity from central banks. 
You may assume that the
essential quality of every banker is greed; that is why a banker always
agrees to get money today even if he may lose greater money tomorrow because of
that. Every debt can only be bought as a whole.
</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">In the first line you are given the total number <i>n</i> of banks in the
interbank market <nobr>(2 ≤ <i>n</i> ≤ 1000)</nobr>. In the following
<i>n</i> lines the banks are described by pairs of numbers
<i>c<sub>i</sub></i>, <i>v<sub>i</sub></i>, where <i>c<sub>i</sub></i>
is the code of the country <nobr>(1 ≤ <i>c<sub>i</sub></i> ≤ 100)</nobr>
and <i>v<sub>i</sub></i> is the amount of the available funds of the 
<i>i</i>-th bank <nobr>(0 ≤ <i>v<sub>i</sub></i> ≤ 10<sup>9</sup>)</nobr>.
The next line contains the number <i>m</i> of active contracts in the interbank
market <nobr>(0 ≤ <i>m</i> ≤ 10000)</nobr>. The contracts are described
in the next <i>m</i> lines in the following format: the number of the
lending bank in the above list, the number of the debtor bank, and the amount
of the contract (the amounts satisfy the restriction for the available funds).
Banks may buy the debts using the available funds they have initially only,
banks may not use the funds they receive after selling their debts.
</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output the maximal number of banks satisfying the requirements of the economy
rescue plan.
</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>5
1 100000
1 200000
1 300000
2 400000
2 500000
4
1 2 200000
1 3 200000
2 4 500000
3 5 500000
</pre></td><td><pre>3
</pre></td></tr></tbody></table><h3 class="problem_subtitle">Notes</h3><div class="problem_par"><div class="problem_par_normal">In the sample, initially only Bank&nbsp;1 is responsible.
Bank&nbsp;2 can buy the debt of Bank&nbsp;3 to Bank&nbsp;1; it has enough
money for that. As a result, Bank&nbsp;3 will owe 200000 to Bank&nbsp;2,
and Bank&nbsp;2 will owe 200000 to Bank&nbsp;1. 
Bank&nbsp;1 will remain responsible because it will remain a
creditor of Bank&nbsp;2. In addition, Bank&nbsp;5 can become
responsible; it has to buy the debt of Bank&nbsp;4 to Bank&nbsp;2.
</div></div><div class="problem_source"><b>Problem Author: </b>Pavel Atnashev<br><b>Problem Source: </b>NEERC 2008, Eastern subregion quarterfinals<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=graphs">graph theory</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1652" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1652" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 2515</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1652" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1652">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1652">Discussion (10)</a><br><a href="status.aspx?space=1&amp;num=1652">All submissions (1655)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1652&amp;status=accepted">All accepted submissions (243)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1652">Solutions rating (119)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>