<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>2009. Canteen Line @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=2009"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=2009&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=2009&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=2009&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=2009&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">2009. Canteen Line</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">In your opinion, what is a student’s favorite activity? Studying? OK, that 
is the number one priority. And the number two priority is tasty lunch, of 
course. Unfortunately, the university authorities don’t understand 
students at all and the lunch break lasts for forty minutes only.
The forty minutes should include standing in a line, choosing favorite 
dishes and eating them. The students come up with lots of tricks to spend 
less time in a line and knowing the right people becomes very important... </div></div><div class="problem_par"><div class="problem_par_normal">Alexey’s lecture has just finished and he is rushing to the university 
canteen. The problem is, other students finished earlier and there are 
huge lines in front of canteen counters. To wait or not to wait? 
Some people might feel lost but Alexey arms himself with his good old 
laptop and starts writing a program that would say for each student the 
time when he would leave the line. Can you give it a try?</div></div><div class="problem_par"><div class="problem_par_normal">Ural FU canteen has two counters that work simultaneously, so there 
is a line in front of each counter. If a student joins a line, he can’t 
move to the other one. The cashiers are very professional, so it takes 
them one second to serve one customer. At some moments of time a new group 
of students enters the canteen. We can assume that all students in the 
group enter at the same time but in turn: the first student from the 
group, then the second one and so on. When each student enters the canteen 
he can stand either at the end of a line or, if he knows some student that 
is already in the line, right behind him. Moreover, each student tries to 
get the most optimal place, that is, such place that the number of people 
in front of him is minimum. If the position in the right line and the 
position in the left line are identically optimal, a student always 
chooses the right line. If at the same moment a student served by a 
cashier leaves a line and new group of students enters the canteen, you 
should consider that the first action occurs earlier.  </div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains integers <i>n</i> and <i>m</i> that are the number of 
students and the number of groups of students (5 ≤ <i>n</i> ≤ 1000;
1 ≤ <i>m</i> ≤ <i>n</i>). The students are enumerated with integers from 1 to <i>n</i>.</div></div><div class="problem_par"><div class="problem_par_normal">Next <i>n</i> lines contain the information about the students. The (<i>i</i> + 1)'th 
line of input data contains list of numbers of students which will let <i>i</i>’th 
student stand behind them in a line. It is guaranteed that for each 
student this list has at most 100 numbers and doesn’t contain this 
student’s own number. The list ends with number 0. If the <i>i</i>’th student 
will let the <i>j</i>’th student stand behind him in a line, this is not means 
that the <i>j</i>’th student will let the <i>i</i>’th student too.</div></div><div class="problem_par"><div class="problem_par_normal">Then an information about groups of students entering the canteen follows. 
The description of each group consists of two lines. The first line 
contains integers <i>t</i><sub><i>i</i></sub> and <i>k</i><sub><i>i</i></sub> that are the time when the group enters 
the canteen and the number of students in the group 
(1 ≤ <i>t</i><sub><i>i</i></sub> ≤ 10<sup>9</sup>; 1 ≤ <i>k</i><sub><i>i</i></sub> ≤ <i>n</i>). The second line of the 
description contains <i>k</i><sub><i>i</i></sub> integers: the numbers of students in the group 
listed in the order they enter the canteen. All groups are listed by 
increasing <i>t</i><sub><i>i</i></sub>. It is guaranteed that each student visits the canteen  
exactly once.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output <i>n</i> lines. The <i>i</i>’th one should contain the time when the <i>i</i>’th 
student leaves the line and the line he stands in (“left” for the left 
line and “right” for the right one). </div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>5 1
0
0
0
0
1 0
1 5
1 2 3 4 5
</pre></td><td><pre>2 right
2 left
4 right
3 left
3 right
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Alexey Kungurtsev<br><b>Problem Source: </b>Ural Regional School Programming Contest 2013<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=2009" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=2009" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 627</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=2009" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=2009">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=2009">Discussion (7)</a><br><a href="status.aspx?space=1&amp;num=2009">All submissions (1515)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=2009&amp;status=accepted">All accepted submissions (378)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=2009">Solutions rating (249)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>