<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1556. Multishot in the Secret Cow Level @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1556"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1556&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1556&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1556&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1556&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1556. Multishot in the Secret Cow Level</h2><div class="problem_limits">Time limit: 5.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">The well-known game development company "Clissard Entertainment" has released
new Action-RPG game named "Angel VII". Vasya has bought this game and played
a lot until he entered the "The Secret Cow Level". This secret was covered by
Clissard for a long time, but eventually fans has guessed the mysterious notes
like "Moo" strings appearing in the game chat.</div></div><div class="problem_par"><div class="problem_par_normal">The cow level is infinite in all directions plane with Vasya (a point) and
<i>N</i> cows (circles of equal radius <i>R</i>). Vasya is playing as a bowazon&nbsp;— amazon with a bow.
His character knows a useful skill called "Multiple shot". It is used in the
following way: Vasya chooses a direction which we will call the main direction.
The bow splits one arrow into <i>K</i> arrows and shoots them. The <i>i</i>-th arrow (counting from zero)
subtend the angle <i>A<sub>i</sub></i> with the main direction equal to:
</div></div><div class="problem_centered_picture"><img src="/image/get.aspx/848b4bad-696a-4bb9-a6f4-07ca949748c7" border="0" alt="Problem illustration"></div><div class="problem_par"><div class="problem_par_normal">Each arrow flies along a straight line (arrow is also a point). Crossing or touching
a cow is considered as a hit. Thanks to a passive skill "Pierce" an arrow after the hit
has a chance <i>P</i> to pierce target and continue its path and a chance 100%&nbsp;−&nbsp;<i>P</i> 
to get stuck in the cow or just break. However, there is a cap on this skill: each arrow can't hit
more than five targets. After hitting fifth target it disappears for sure. Vasya is
surrounded by cows now and he has to shoot immediately without moving. Help Vasya to
choose the main direction to maximize the expectation value of number of hits!
</div></div><div class="problem_centered_picture"><img src="/image/get.aspx/1c73519f-3cf1-49b3-a8a9-0b608309211b" border="0" alt="Problem illustration"></div><div class="problem_par"><div class="problem_par_normal">The cows don't move and are very tough so every hit to a single cow should be counted.
Cows and Vasya don't intersect or touch each other (cows also can't lie one in the other).
</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">In the first line four numbers are written:
<i>N</i> (integer number of cows), <i>K</i> (integer number of arrows),
<i>P</i> (integer pierce probability in percent), <i>R</i> (real radius of cows)
In the second line two coordinates of Vasya are written (both real).
Then <i>N</i> lines follow: each line consists of two real numbers&nbsp;— coordinates of the cow 
(1&nbsp;≤&nbsp;<i>N</i>&nbsp;≤&nbsp;50000; 2&nbsp;≤&nbsp;<i>K</i>&nbsp;≤&nbsp;16; 0&nbsp;≤&nbsp;<i>P</i>&nbsp;≤&nbsp;100; 0.4&nbsp;≤&nbsp;<i>R</i>&nbsp;≤&nbsp;2.0). Absolute values of all coordinates don't exceed 25000.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">The only line must be the normalized direction (two coordinates with at least 10 digits, sum of their squares must be equal to 1.0)
and the expectation value with four digit precision. See output format in the example below.
</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3 5 40 1.0
-2.0 1
0 2.0
3 2.0
4 -3
</pre></td><td><pre>The best shot at (0.8944271910;0.4472135955) gives Vasya 5.8000 average hits.
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Source: </b>Novosibirsk SU Contest. Petrozavodsk training camp, September 2007<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=geometry">geometry</a> &nbsp;<a href="problemset.aspx?space=1&amp;tag=hardest">hardest problem</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1556" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1556" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 8713</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1556" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1556">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1556">Discussion (1)</a><br><a href="status.aspx?space=1&amp;num=1556">All submissions (584)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1556&amp;status=accepted">All accepted submissions (69)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1556">Solutions rating (32)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>