<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1518. Jedi Riddle 3 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1518"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1518&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1518&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1518&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1518&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1518. Jedi Riddle 3</h2><div class="problem_limits">Time limit: 1.5 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><h3 class="problem_subtitle">Background</h3><div class="problem_par"><div class="problem_par_normal">The death is a funny thing. It is discussed only by the ones, who never died, while those, who are already dead, prefer keeping silence. That is why few people know, what exactly happens with a human after his death. A body is undoubtedly remains under ground forever... But the way of a soul was discovered only by Anton Hamster, who was a disciple of legendary Vasily Slipman (you may look through the problems <a href="/problem.aspx?space=1&amp;num=1428">"Jedi riddle"</a> and <a href="/problem.aspx?space=1&amp;num=1456">"Jedi riddle 2"</a> for more information about Mr. Slipman).</div></div><div class="problem_par"><div class="problem_par_normal">Mr. Hamster carried out a sequence of experiments and found out, that, however it sounds pity, a soul neither soars into the sky nor falls under ground. It just finds oneself at one of the countless levels of the Twilight, where it is condemned to stay till the end of time. In theory, a soul may be returned into the Real World and resurrected in a new body. The only question is how to do it...</div></div><h3 class="problem_subtitle">Problem</h3><div class="problem_par"><div class="problem_par_normal">Surely, Anton knew, that it was possible to get to any level of the Twilight straight from the Real World. You should only know a Key - and the Gates of the Twilight will open before you. Inter vivos, Mr. Slipman himself visited <b>N</b> first levels using <b>N</b> Keys <b>K<sub>i</sub></b> he found by brute force. But Vasily failed to find the Key to the (<b>N</b>+1)-th and the following levels. He just made a remark, that one had to use <b>N</b> Shift Numbers <b>C<sub>i</sub></b> and the Modular Number <b>Y</b>.</div></div><div class="problem_par"><div class="problem_par_normal">But Mr. Hamster could excel his Teacher and succeeded in finding a universal formula for the Key <b>K<sub>i</sub></b> to the Gates of any level of the Twilight. Here is the formula: <b>K<sub>i</sub></b> = (<b>K<sub>i-1</sub></b>*<b>C<sub>N</sub></b> + <b>K<sub>i-2</sub>*C<sub>N-1</sub></b> + <b>K<sub>i-3</sub>*C<sub>N-2</sub></b> + ... + <b>K<sub>i-N</sub>*C<sub>1</sub></b>) modulo <b>Y</b>.</div></div><div class="problem_par"><div class="problem_par_normal">And now Anton wants to organize the second coming of Mr. Slipman into our sinful world. The only thing he needs is to calculate the Key to the Gates of the Twilight's <b>X</b>-th level, where the Teacher's soul is concealed in expectation of freedom.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains the integer numbers <b>N</b> (1 ≤ <b>N</b> ≤ 100), <b>X</b> (<b>N</b> &lt; <b>X</b> &lt; 2<sup>28</sup>) and <b>Y</b> (2 ≤ <b>Y</b> &lt; 2<sup>28</sup>). The second line contains <b>N</b> integer Keys <b>K<sub>i</sub></b> (0 ≤ <b>K<sub>i</sub></b> ≤ 100). The third line contains <b>N</b> integer Shift Numbers <b>C<sub>i</sub></b> (0 ≤ <b>C<sub>i</sub></b> ≤ 1).</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">You should output the desired Key <b>K<sub>X</sub></b>.</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3 6 73
12 91 65
1 1 0
</pre></td><td><pre>22
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Ilya Grebnov, Nikita Rybak, Dmitry Kovalioff<br><b>Problem Source: </b>Timus Top Coders: Third Challenge<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1518" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1518" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 1055</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1518" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1518">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1518">Discussion (6)</a><br><a href="status.aspx?space=1&amp;num=1518">All submissions (2234)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1518&amp;status=accepted">All accepted submissions (764)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1518">Solutions rating (364)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>