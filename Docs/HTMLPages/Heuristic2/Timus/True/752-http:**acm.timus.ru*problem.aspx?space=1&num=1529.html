<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1529. Game of Squares @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1529"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1529&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1529&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1529&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1529&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1529. Game of Squares</h2><div class="problem_limits">Time limit: 5.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Alice and Bob are playing with <i>k</i>-dimensional rectangular parallelepiped
consisting of <i>n</i><sub>1</sub> × <i>n</i><sub>2</sub> × … × <i>n<sub>k</sub></i> unit hypercubes.
They make moves in turn. Alice chooses some unit hypercube, and cuts
the parallelepiped through the center of this hypercube with all possible
planes that are parallel to its sides. All unit hypercubes that were
cut by at least one plane are removed, and what remains is a series of smaller
rectangular parallelepipeds. It is required that at least one of those
small parts has edge lengths that are pairwise relatively prime with 
the corresponding edge lengths of the original parallelepiped. It is also allowed
to cut the parallelepiped in such way that no parts remain.
</div></div><div class="problem_par"><div class="problem_par_normal">Afterwards, each player chooses any of remaining parallelepipeds, and cuts
it as described above. After a cut every parallelepiped is left,
and making the turn the player can choose any of them.
The player who can't move loses. Assuming
both players play optimally, who will win?
</div></div><img src="/image/get.aspx/03432776-46bb-44eb-a832-99357d634a61" border="0" alt="Problem illustration" align="RIGHT" class="problem_raimage"><div class="problem_par"><div class="problem_par_normal">Let's consider an example. Assume that  <i>k</i> = 2, and we have a 6 × 5
rectangle. By cutting the hypercube at (1, 4) we get two parts:
5 × 1 and 5 × 3. As the second part's (as well as first part's,
but that's not important) edge lengths are relatively prime with
the edge lengths of the original rectangle (5 is relatively prime with 6 and
3 is relatively prime with 5), this is a possible move. However,
cutting the hypercube at (3, 2) is not a possible move, because each of the remaining
parts (2 × 1, 3 × 1, 2 × 3, 3 × 3) doesn't satisfy
the condition above.
</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line of the input contains an integer <i>k</i> (1&nbsp;≤&nbsp;<i>k</i>&nbsp;≤&nbsp;8), 
the second line contains <i>k</i> integers <i>n</i><sub>1</sub>, <i>n</i><sub>2</sub>, … <i>n<sub>k</sub></i>, 
1&nbsp;≤&nbsp;(<i>n</i><sub>1</sub>+1) × (<i>n</i><sub>2</sub>+1) × … × (<i>n<sub>k</sub></i>+1)&nbsp;≤&nbsp;10000.
</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output the number of the winning player to the first line of output 
(1 for Alice, 2 for Bob). In case Alice wins the game, output the
first move that leads her to the win to the second line of output.
The move is described by <i>k</i> numbers, 1-based coordinates of the
cut hypercube. In case there're several possible moves that lead her
to the win, output the lexicographically smallest one.
</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>2 
2 2
</pre></td><td><pre>2
</pre></td></tr><tr><td><pre>3
3 4 5
</pre></td><td><pre>1
1 1 3
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Dmitry Gozman<br><b>Problem Source: </b>Dmitry Gozman Contest 1, Petrozavodsk training camp, January 2007<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=game">game</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1529" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1529" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 3971</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1529" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1529">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1529">Discussion (4)</a><br><a href="status.aspx?space=1&amp;num=1529">All submissions (1083)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1529&amp;status=accepted">All accepted submissions (173)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1529">Solutions rating (88)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>