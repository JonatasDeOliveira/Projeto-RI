<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1463. Happiness to People! @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1463"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1463&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1463&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1463&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1463&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1463. Happiness to People!</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Every Santa Claus wants to surprise children with his presents. This year Santa Claus Petrovich wants to surprise children of remote Cuckooland. He is sure that in order to make a real impression he should choose a route without repeating towns. In order to bring as much happiness as possible, he plans to visit the most populated places. Petrovich took a map of 
Cuckooland and connected with lines some pairs of towns where, he's sure, people will wait for him. He decided not to fly between towns that are not connected. It turned out that if Petrovich 
can fly (using one or several flights) from town <i>i</i> to town <i>j</i>, then there is exactly one way to do this. Petrovich can start his 
trip in any of the towns.</div></div><div class="problem_par"><div class="problem_par_normal">Petrovich knows that when he arrives in town <i>i</i>, the population feels happiness <i>A<sub>i</sub></i>. And when Petrovich flies 
from town <i>i</i> to town <i>j</i>, he bestows happiness <i>C<sub>ij</sub></i>. The same amount of happiness is bestowed if he flies from <i>j</i> to <i>i</i>. Help Santa Claus Petrovich to maximize the amount of happiness that he can bring to people.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains the number <i>N</i> (1 ≤ <i>N</i> ≤ 50000) of towns in Cuckooland and the number <i>K</i> of pairs of towns that are connected. The second line contains numbers <i>A<sub>i</sub></i> (<i>i</i> = 1..<i>N</i>); <i>A<sub>i</sub></i> ≤ 10000. Each of the following <i>K</i> lines contains
three numbers <i>a</i>, <i>b</i>, <i>c</i>, which mean that when Petrovich flies from town <i>a</i> to town <i>b</i> he brings happiness <i>c</i> (<i>a</i> ≠ <i>b</i>; <i>c</i> ≤ 10000). All numbers in the input are whole and nonnegative.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">The first line of the output must contain the maximal amount of happiness felt by the people of Cuckooland. The second line must contain the length <i>L</i> of the optimal route of Santa Claus Petrovich. The third line must contain the optimal route (<i>L</i> numbers separated with a space). If there are several answers, you may output any of them.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>2 1
1 1
1 2 1
</pre></td><td><pre>3
2
1 2
</pre></td></tr><tr><td><pre>8 7
1 5 4 6 10 1 2 2
1 2 1
2 3 10
2 4 1
4 5 1
4 6 2
6 7 2
6 8 3
</pre></td><td><pre>37
4
5 4 2 3
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Alexander Toropov, special thanks to Alexander Ipatov<br><b>Problem Source: </b>Ural SU Contest. Petrozavodsk Winter Session, January 2006<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=dynprog">dynamic programming</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1463" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1463" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 672</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1463" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1463">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1463">Discussion (25)</a><br><a href="status.aspx?space=1&amp;num=1463">All submissions (3659)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1463&amp;status=accepted">All accepted submissions (845)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1463">Solutions rating (598)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>