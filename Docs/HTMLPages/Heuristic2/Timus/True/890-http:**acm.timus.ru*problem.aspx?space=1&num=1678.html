<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1678. Space Poker 3 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1678"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1678&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1678&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1678&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1678&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1678. Space Poker 3</h2><div class="problem_limits">Time limit: 3.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Space poker. A legendary game, first version of which was introduced as far as in year 1284 of Alien era. Even nowadays its rules are known only to small group of professional players. Fortunately, the developers of the first program in the world playing space poker asked for your help.
</div></div><div class="problem_par"><div class="problem_par_normal">There are <i>N</i> extraterrestial players in space poker. At the beginning of the round, each player gets <i>M</i> cards (we call them <i>hole cards</i>). Players don't know hole cards of their opponents. Then <i>K</i> <i>community</i> cards are consecutively dealt face-up. So, community cards are known to all players. Player's <i>hand</i> consists of his hole cards and all community cards&nbsp;— <i>M</i>&nbsp;+&nbsp;<i>K</i> cards in total. There are no suits, cards differ only in their values. There are 13 different values: "2", "3", "4", …,  "9", "T", "J", "Q", "K" and "A". The card deck is infinite, and the probability of the event that the next card will have a given value is equal to 1/13. The combinations in space poker are represented in the form: <nobr>(<i>v</i><sub>1</sub>, …, <i>v<sub>L</sub></i>)</nobr>, where <i>L</i> is the number of different values in the combination. The hand satisfies the combination <nobr>(<i>v</i><sub>1</sub>, …, <i>v<sub>L</sub></i>)</nobr> in case it contains <i>v</i><sub>1</sub> cards of one value, <i>v</i><sub>2</sub> cards of another value, …, <i>v<sub>L</sub></i> cards of <i>L</i>-th value. For example, combination (2,&nbsp;2) is satisfied by hands "2JA2A" and "22233". Combination (2,&nbsp;3) is satisfied by hand "KQKQKQ" but is not satisfied by hand "AAAAAA". All combinations have different strength. The winner of the round is a player whose hand satisfies the combination of the maximal strength among all combinations in hands of all players. If there is more than one such player, the round ends in a draw.</div></div><div class="problem_par"><div class="problem_par_normal">Suppose you know the hole cards of the first player and partly dealt community cards. Calculate the probability the first player will be the only winner of this round.
</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains integers <i>N</i>, <i>M</i> and <i>K</i> separated by spaces (<nobr>2 ≤ <i>N</i>, <i>M</i> ≤ 10;</nobr> <nobr>1 ≤ <i>K</i> ≤ 5</nobr>). The second line contains <i>M</i> symbols&nbsp;— hole cards of the first player. The third line contains at most <i>K</i> symbols&nbsp;— dealt community cards. The fourth line contains integer <i>C</i>&nbsp;— the number of combinations in space poker <nobr>(1 ≤ <i>C</i> ≤ 100)</nobr>. The following <i>C</i> lines contain combinations in order of increasing strength. Each description has the form <nobr><i>L</i> <i>v</i><sub>1</sub> <i>v</i><sub>2</sub> … <i>v<sub>L</sub></i></nobr>. <i>L</i> and <i>v<sub>i</sub></i> are positive integers, sum of all <i>v<sub>i</sub></i> doesn't exceed <i>M</i>&nbsp;+&nbsp;<i>K</i>.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output the probability of winning for the first player with absolute error not exceeding 10<sup>−5</sup>.
</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>2 5 2
23456

1
1 2</pre></td><td><pre>0.0883526857</pre></td></tr><tr><td><pre>2 5 2
23456
78
2
7 1 1 1 1 1 1 1
1 4</pre></td><td><pre>0.8407915043</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Alex Samsonov<br><b>Problem Source: </b>Ural SU Contest. Petrozavodsk Summer Session, August 2008<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=hardest">hardest problem</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1678" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1678" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 8311</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1678" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1678">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1678">Discussion (1)</a><br><a href="status.aspx?space=1&amp;num=1678">All submissions (213)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1678&amp;status=accepted">All accepted submissions (42)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1678">Solutions rating (28)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>