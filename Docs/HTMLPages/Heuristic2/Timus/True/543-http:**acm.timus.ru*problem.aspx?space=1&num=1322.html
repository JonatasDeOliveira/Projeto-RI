<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1322. Spy @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1322"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1322&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1322&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style55.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1322&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1322&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1322. Spy</h2><div class="problem_limits">Time limit: 0.25 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">The secret service detected an acting foreign agent. Frankly speaking — a spy. A surveillance showed that each week the spy sends strange unreadable texts to somebody via the Internet. In order to find out which information became available to the spy, it is necessary to decipher the texts. Secret service agents got into the spy's apartment, discovered a cipher machine, and found out the principle of its operation.</div></div><div class="problem_par"><div class="problem_par_normal">An input of the machine is a text line S<sub>1</sub> = s<sub>1</sub>s<sub>2</sub>...s<sub>N</sub>. The machine constructs all cyclic permutations of this line, i.e., S<sub>2</sub> = s<sub>2</sub>s<sub>3</sub>...s<sub>N</sub>s<sub>1</sub>, ..., S<sub>N</sub> = s<sub>N</sub>s<sub>1</sub>s<sub>2</sub>...s<sub>N-1</sub>. Then the set S<sub>1</sub>, S<sub>2</sub>, ..., S<sub>N</sub> is sorted lexicographically in the ascending order, and the lines are written out in this order in a column, one under another. Thus an array N × N is obtained. One of the rows of this array contains the initial word. The number of this row and the last column of the array are the output of the machine.</div></div><div class="problem_par"><div class="problem_par_normal">For example, if the initial word S<sub>1</sub> = abracadabra, then the following array is formed:
<ol>
<li>aabracadabr = S<sub>11</sub>
</li><li>abraabracad = S<sub>8</sub>
</li><li>abracadabra = S<sub>1</sub>
</li><li>acadabraabr = S<sub>4</sub>
</li><li>adabraabrac = S<sub>6</sub>
</li><li>braabracada = S<sub>9</sub>
</li><li>bracadabraa = S<sub>2</sub>
</li><li>cadabraabra = S<sub>5</sub>
</li><li>dabraabraca = S<sub>7</sub>
</li><li>raabracadab = S<sub>10</sub>
</li><li>racadabraab = S<sub>3</sub>
</li></ol>
In this case, the output of the machine is the number 3 and the line rdarcaaaabb.</div></div><div class="problem_par"><div class="problem_par_normal">So it is clear how the cipher machine operates. However, no deciphering machine was found. But as the information can certainly  be deciphered (otherwise there is no sense in sending it), you have to invent a deciphering algorithm.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first and the second lines contain an integer and a string respectively. This is the output of the cipher machine. Both the number and the length of the string do not exceed 100000. The string may contain only the letters a-z, A-Z and the underlining character. The lexicographic order on the set of words is determined by the following order of characters:</div></div><div class="problem_par"><div class="problem_par_normal">ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz</div></div><div class="problem_par"><div class="problem_par_normal">The characters here are given in the ascending order.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">The only line should contain the initial message.</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3
rdarcaaaabb</pre></td><td><pre>abracadabra</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Idea: Alexander Klepinin, prepared by Alexander Klepinin, Stanislav Vasilyev
<br><b>Problem Source: </b>VIII Collegiate Students Urals Programming Contest. Yekaterinburg, March 11-16, 2004<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1322" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1322" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 476</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1322" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1322">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1322">Discussion (14)</a><br><a href="status.aspx?space=1&amp;num=1322">All submissions (3518)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1322&amp;status=accepted">All accepted submissions (1286)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1322">Solutions rating (910)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>