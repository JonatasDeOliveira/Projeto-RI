<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>2027. URCAPL, Episode 1 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=2027"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=2027&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=2027&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=2027&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=2027&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">2027. URCAPL, Episode 1</h2><div class="problem_limits">Time limit: 2.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">We are glad to present to you a new programming language URCAPL (Universal Reusable Cool and Amazing Programming Language).</div></div><div class="problem_par"><div class="problem_par_normal"><b>Attention:</b>
if you know anything about the programming language Befunge and the syntax described below seems familiar to you, we still recommend you to read the description of the language URCAPL. It was invented especially for this contest and has little in common with Befunge.</div></div><div class="problem_par"><div class="problem_par_normal">URCAPL works only with integers not exceeding&nbsp;10<sup>5</sup> by absolute value. Numbers are stored in 27 registers: one current register and 26 memory registers encoded by uppercase English letters from A to&nbsp;Z. Initially all the registers contain the number&nbsp;0.</div></div><div class="problem_par"><div class="problem_par_normal">A program is a two-dimensional field of size <i>H</i> × <i>W</i>; each cell contains some operator. A program is executed by a pointer, which is located in some cell of the field and has one of the four possible motion directions: up, down, to the right and to the left. When the execution of a program starts, the pointer is in the upper left corner of the field, and the direction of its motion is to the right. During the execution, the motion direction may change depending on the operator written in the cell where the pointer is at the moment. The work of a program is divided into steps. At each step, the operator in the pointer cell is first executed, and then the pointer moves one cell in the current direction.</div></div><div class="problem_par"><div class="problem_par_normal">The list of operators:
<ul>
<li> “<tt>^</tt>”, “<tt>&gt;</tt>”, “<tt>v</tt>”, “<tt>&lt;</tt>”&nbsp;— change the motion direction to up, right, down, or left, respectively;
</li><li> “<tt>.</tt>”&nbsp;— do nothing;
</li><li> “<tt>A</tt>”…“<tt>Z</tt>”&nbsp;— swap the integers in the current register and the register denoted by the letter;
</li><li> “<tt>?</tt>”&nbsp;— read the integer from the input and write it to the current register (the old value of the current register is deleted);
</li><li> “<tt>!</tt>”&nbsp;— write the integer in the current register to the output and set the value of the current register to 0;
</li><li> “<tt>+</tt>”&nbsp;— increase the number in the current register by one;
</li><li> “<tt>-</tt>”&nbsp;— decrease the number in the current register by one;
</li><li> “<tt>@</tt>”&nbsp;— (the conditional operator) if the number in the current register is 0, change the motion direction counterclockwise; otherwise, change it clockwise;
</li><li> “<tt>#</tt>”&nbsp;— terminate the execution of the program <b>immediately</b>.
</li></ul></div></div><div class="problem_par"><div class="problem_par_normal">If the number in the current register exceeds 10<sup>5</sup> by absolute value, the program terminates with OVERFLOW ERROR.
If the pointer moves out of the field, the program terminates with RUNTIME ERROR.
If the termination operator is not executed during 10<sup>6</sup> steps and none of the above two errors occurs, then the program terminates with TIME LIMIT EXCEEDED.</div></div><div class="problem_par"><div class="problem_par_normal">You are required to write an URCAPL interpreter. For a given URCAPL program and input data, the interpreter should produce the output of the program.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains integers <i>H</i> and <i>W</i> (1 ≤ <i>H</i>, <i>W</i> ≤ 100), which are dimensions of the field.
Then you are given a table with <i>H</i> rows and <i>W</i> columns, which is a syntactically correct URCAPL program (i.e., it contains only the operators described above).</div></div><div class="problem_par"><div class="problem_par_normal">The next line contains the number <i>n</i> of integers in the input of the program (1 ≤ <i>n</i> ≤ 10<sup>5</sup>),
and the input of the program is given in the following <i>n</i> lines: each line contains one integer with absolute value not exceeding 10<sup>5</sup>.
If the program has read <i>n</i> numbers during its execution, then all the subsequent read requests will return the last integer from this list.
If the program reads not all integers from the list during its execution, this is not an error.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">For each output command in the URCAPL program, you should output a number in a separate line. If one of the errors OVERFLOW ERROR, RUNTIME ERROR, or TIME LIMIT EXCEEDED occurs, output the corresponding message in a separate line.</div></div><div class="problem_par"><div class="problem_par_normal">Note that the program terminates immediately after the first error. For example, if OVERFLOW ERROR and RUNTIME ERROR occur during the same step, you should output only the message “OVERFLOW ERROR” (without quotation marks), because the operator in the pointer cell is executed first and only after that the pointer moves.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>4 6
?A?v&gt;v
&gt;..&gt;@A
-...A!
^A.+&lt;#
2
2
3</pre></td><td><pre>5</pre></td></tr><tr><td><pre>2 4
?!&gt;v
##^&lt;
1
0</pre></td><td><pre>0
TIME LIMIT EXCEEDED</pre></td></tr><tr><td><pre>1 4
??!#
1
1</pre></td><td><pre>1</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Kirill Borozdin<br><b>Problem Source: </b>Ural Regional School Programming Contest 2014<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=2027" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=2027" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 362</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=2027" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=2027">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=2027">Discussion (7)</a><br><a href="status.aspx?space=1&amp;num=2027">All submissions (3043)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=2027&amp;status=accepted">All accepted submissions (652)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=2027">Solutions rating (356)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table></body></html>