<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - CCC14 Stage 2 - Gates</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "3d9c83c15e0f324305366b918ab3d51c";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fccc14s2p6"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>2014 Canadian Computing Competition, Stage 2</h3>
<h2>Day 2, Problem 3: Gates</h2>

<p>You're in an airport hallway with <var>G</var> (1 ≤ <var>G</var> ≤ 10<sup>9</sup>) gates, numbered from 1 to <var>G</var> in order. The entrance to gate <var>i</var> is 100·<var>i</var> metres from the start of the hallway.</p>

<p>There are also <var>N</var> (0 ≤ <var>N</var> ≤ 10<sup>5</sup>) moving walkways. The <var>i</var>-th walkway runs from the entrance to gate <var>A<sub>i</sub></var> (1 ≤ <var>A<sub>i</sub></var> ≤ <var>G</var>) to the entrance to a different gate <var>B<sub>i</sub></var> (1 ≤ <var>B<sub>i</sub></var> ≤ <var>G</var>) at a speed of <var>S<sub>i</sub></var> (1 ≤ <var>S<sub>i</sub></var> ≤ 10<sup>9</sup>) metres per minute, in one direction only. At every point along the hallway, there is at most one walkway moving in each direction (towards the start of the hallway, or away from it). However, it is possible that one walkway starts at the same gate as another walkway, moving in the same direction, ends.</p>

<p>You can walk in either direction along the hallway at a speed of <var>W</var> (1 ≤ <var>W</var> ≤ 10<sup>9</sup>) metres per minute. Additionally, when at the start of a walkway, you may choose to get on it, in which case it'll carry you directly to its end - you may not get on or off in between these points. While on walkway <var>i</var>, you will move at a speed of <var>W</var> + <var>S<sub>i</sub></var> metres per minute.</p>

<p>To amuse yourself while waiting for your flight (which, of course, has been delayed), you've posed <var>Q</var> (1 ≤ <var>Q</var> ≤ 10<sup>5</sup>) queries to yourself. The <var>i</var>-th query involves finding the minimal time in which you can get from gate <var>X<sub>i</sub></var> (1 ≤ <var>X<sub>i</sub></var> ≤ <var>G</var>) to gate <var>Y<sub>i</sub></var> (1 ≤ <var>Y<sub>i</sub></var> ≤ <var>G</var>). To make things more interesting, you've decided that you won't board your flight unless you can correctly answer all of these queries - so you'd better not screw up!</p>

<h3>Input</h3>
<p>The first line contains four integers: <var>G</var> (1 ≤ <var>G</var> ≤ 10<sup>9</sup>), the number of gates; <var>W</var> (1 ≤ <var>W</var> ≤ 10<sup>9</sup>), the walking speed; <var>N</var> (1 ≤ <var>N</var> ≤ 10<sup>5</sup>), the number of moving walkways, and <var>Q</var> (1 ≤ <var>Q</var> ≤ 10<sup>5</sup>), the number of queries.</p>

<p>The next <var>N</var> lines each contain three integers dealing with walkway <var>i</var> (<var>i</var> = 1..<var>N</var>): <var>A<sub>i</sub></var> (1 ≤ <var>A<sub>i</sub></var> ≤ <var>G</var>), the starting gate; <var>B<sub>i</sub></var> (1 ≤ <var>B<sub>i</sub></var> ≤ <var>G</var>), the ending gate; <var>S<sub>i</sub></var> (1 ≤ <var>S<sub>i</sub></var> ≤ 10<sup>9</sup>), the speed. Note that <var>A<sub>i</sub></var> ≠ <var>B<sub>i</sub></var> for any <var>i</var>.</p>

<p>The next <var>Q</var> lines each contain two integers dealing with query <var>i</var> = 1..<var>Q</var>: <var>X<sub>i</sub></var> (1 ≤ <var>X<sub>i</sub></var> ≤ <var>G</var>), the starting gate; and <var>Y<sub>i</sub></var> (1 ≤ <var>Y<sub>i</sub></var> ≤ <var>G</var>), the ending gate.</p>

<p>You can assume that for some test cases, at least some of <var>G</var>, <var>N</var>, <var>Q</var> are small. This information may be helpful, or not.</p>

<h3>Output</h3>
<p>The output is <var>Q</var> lines, each line containing one real number which is the minimal amount of time required to travel from gate <var>X<sub>i</sub></var> to <var>Y<sub>i</sub></var> (in minutes), for <var>i</var> = 1..<var>Q</var>. The output will be judged to be correct if the outputted answer is within a factor of 10<sup>−4</sup> of the correct solution: that is, if <var>D</var> is the correct answer, values in the range [<var>D</var>·(1 − 10<sup>−4</sup>), <var>D</var>·(1 + 10<sup>−4</sup>)] will be judged as correct.</p>

<h3>Sample Input</h3>
<pre>6 10 3 4
2 3 15
4 2 150
3 6 290
3 2
2 3
1 4
4 6
</pre>

<h3>Sample Output</h3>
<pre>10.0
4.0
24.0
6.25
</pre>

<h3>Explanation</h3>
<p>For the first query, you should simply walk from gate 3 to gate 2, covering 100 metres at a speed of 10 metres per minute.</p>

<p>For the second query, you should immediately get on the moving walkway going from gate 2 to gate 3, covering 100 metres at a speed of 10 + 15 = 25 metres per minute.</p>

<p>For the third query, you should walk to gate 2 (taking 10 minutes), then take the walkway as before (taking 4 minutes), and then walk to gate 4 (taking 10 minutes).</p>

<p>Finally, for the fourth query, you should take the walkway from gate 4 to gate 2 (taking 1.25 minutes), then the walkway from gate 2 to gate 3 (taking 4 minutes), and finally the walkway from gate 3 to gate 6 (taking 1 minute).</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,ccc14s2p6">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/ccc14s2p6">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 40 (partial)<br>
    <b>Time Limit:</b> 2.00s<br>
    <b>Memory Limit:</b> 64M<br>
    <b>Added:</b> May 17, 2014<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=ccc14s2p6">Search</a>)</h2><p style="text-align: center"></p>It's quiet in here...</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0106s.<br>
    Server time on page load:
    Jun 7, 2018 07:44:07 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fccc14s2p6">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>