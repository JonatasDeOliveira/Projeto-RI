<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - WC15 Finals - Server Hacking</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "a5a6da31e315e7ee609958a2aedecd0f";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fwc15fs4"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>2015-16 Woburn Challenge Finals - Senior Division</h3>
<h2>Problem 4: Server Hacking</h2>

<img src="images/wc15fs4/wc15fs4.jpg" alt="" style="float:right; height:200px; padding:25px; padding-top: 0;">

<p>The Center for Exploration of Monkey Cryptography (CEMC) is an organization dedicated to wartime cryptography research amongst the primate community. As the monkeys are once again at war with the cows, this institution has become indispensable to their success in combat. After all, taking over Scarberia in the 21st century will require some of the most sophisticated code-breaking techniques in existence to infiltrate the enemies' communications. As it turns out, the cows possess a slight technological edge over the monkeys, due to their experimentation with Cow-Bots in 2002. They were therefore able to reverse engineer the structure of the CEMC's servers!</p>

<p>The cows have learned that the server is a network consisting of <var>N</var> (1 ≤ <var>N</var> ≤ 100,000) computers arranged in a line topology. Specifically, the computers are numbered from 1 to <var>N</var>, and are connected in a line in ascending order. For example, computer 1 is connected only to computer 2, computer 2 is connected only to computers 1 and 3, and computer <var>N</var> is connected only to computer <var>N</var> − 1. The network is encrypted using a simple public key cryptosystem. Each computer <var>i</var> has a distinct public key, an integer <var>A<sub>i</sub></var> (1 ≤ <var>A<sub>i</sub></var> ≤ 10<sup>9</sup>). The private key to access computer <var>i</var> is a sequence of integers based on the prime factorization of <var>A<sub>i</sub></var>. Consider <var>A<sub>i</sub></var> = 1200 with the prime factorization of 2<sup>4</sup> × 3<sup>1</sup> × 5<sup>2</sup> when the prime factors are listed in ascending order. Its private key is then the sequence [2, 4, 3, 1, 5, 2].</p>

<p>Typical brute force attacks rely on trying every possibility to gain access. In this case, a private key is easier to guess if it comes "earlier" in an exhaustive list of possible guesses. So for two different computers <var>i</var> and <var>j</var>, we will call the public key of <var>i</var> <strong>weaker</strong> than the public key of <var>j</var> if and only if the private key sequence of <var>i</var> is lexicographically smaller than the private key sequence of <var>j</var>. A sequence <var>X</var> is considered to be lexicographically smaller than another sequence <var>Y</var> if <var>X<sub>i</sub></var> &lt; <var>Y<sub>i</sub></var> for the smallest index <var>i</var> such that <var>X<sub>i</sub></var> differs from <var>Y<sub>i</sub></var>. If every value in <var>X</var> is equal to the values at corresponding indices in <var>Y</var> and <var>X</var> is a shorter sequence (i.e. if <var>X</var> is a prefix of <var>Y</var>), then <var>X</var> is also considered lexicographically smaller than <var>Y</var>. For example, [2, 2, 7, 1] is lexicographically smaller than [2, 3] and [2, 3] is lexicographically smaller than [2, 3, 5, 7].</p>

<p>Having discovered the weak cryptographic scheme of the CEMC's servers, the cows now wish to assert their dominance and generate chaos amongst the monkeys by performing a distributed denial-of-service (DDOS) attack on the network to take it down.  However, they will need a <strong>weakpoint</strong> from which to initiate the attack. In particular, a weakpoint is a computer whose public key is weaker than that of every other computer that it is directly connected to. Please help the cows write a program to find a weakpoint and crash the CEMC's servers. If there are multiple such weakpoints, then any one of them will suffice.</p>

<p>In test cases worth 5/25 of the points: <var>N</var> ≤ 1000.</p>

<h3>Input Format</h3>
<p>
The first line of input consists of a single integer <var>N</var>.<br>
<var>N</var> lines follow, with the <var>i</var>-th of these lines containing <var>A<sub>i</sub></var> (for <var>i</var> = 1..<var>N</var>).
</p>

<h3>Output Format</h3>
<p>
Output a single integer between 1 and <var>N</var>, your chosen weakpoint.
</p>

<h3>Sample Input</h3>
<pre>4
840350
341796875
1584
735166567
</pre>

<h3>Sample Output</h3>
<pre>1
</pre>

<h3>Explanation</h3>
<p>
Computer 1's public key has the prime factorization 840350 = 2<sup>1</sup> × 5<sup>2</sup> × 7<sup>5</sup>, so its private key is [2, 1, 5, 2, 7, 5].<br>
Computer 2's public key has the prime factorization 341796875 = 5<sup>11</sup> × 7<sup>1</sup>, so its private key is [5, 11, 7, 1].<br>
Computer 3's public key has the prime factorization 1584 = 2<sup>4</sup> × 3<sup>2</sup> × 11<sup>1</sup>, so its private key is [2, 4, 3, 2, 11, 1].<br>
Computer 4's public key has the prime factorization 735166567 = 26783<sup>1</sup> × 27449<sup>1</sup>, so its private key is [26783, 1, 27449, 1].<br>
<span style="line-height: 1.5em;">Therefore, both computers 1 and 3 are valid weakpoints that will be accepted.</span>
</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,wc15fs4">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/wc15fs4">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 20 (partial)<br>
    <b>Time Limit:</b> 0.20s<br>
    <b>Memory Limit:</b> 32M<br>
    <b>Added:</b> May 07, 2016<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/Alex">Alex</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=wc15fs4">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment7585">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/Alex">Alex</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7585">May 07, 2016 - 3:54:03 am UTC</a>      </span>
      <a class="comment_title" id="title7585" onclick="toggle(&quot;body7585&quot;)">Time Limit</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7585">
    (<span class="upvotes"><span id="upvotes7585">0</span></span>/<span class="downvotes"><span id="downvotes7585">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7585" class="comment_body">
    <pre id="msg7585" style="display: none">In an attempt to filter out suboptimal algorithms, the time limit for this problem on the main judge has been lowered to 0.2s.</pre>
    <div style="opacity: 1">
      In an attempt to filter out suboptimal algorithms, the time limit for this problem on the main judge has been lowered to 0.2s.    </div>
    <br><div class="comment_block" id="comment7949">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/P234rer">P234rer</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7949">Feb 11, 2017 - 3:28:29 am UTC</a>      </span>
      <a class="comment_title" id="title7949" onclick="toggle(&quot;body7949&quot;)">Re: Time Limit</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7949">
    (<span class="upvotes"><span id="upvotes7949">0</span></span>/<span class="downvotes"><span id="downvotes7949">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7949" class="comment_body">
    <pre id="msg7949" style="display: none">Is it still possible to do the problem in Python?</pre>
    <div style="opacity: 1">
      Is it still possible to do the problem in Python?    </div>
      </div>
</div>
  </div>
</div>
<br>
<div class="comment_block" id="comment7588">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/ImaxBlue">ImaxBlue</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7588">May 08, 2016 - 11:24:58 pm UTC</a>      </span>
      <a class="comment_title" id="title7588" onclick="toggle(&quot;body7588&quot;)">Wall Clock</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7588">
    (<span class="upvotes"><span id="upvotes7588">0</span></span>/<span class="downvotes"><span id="downvotes7588">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7588" class="comment_body">
    <pre id="msg7588" style="display: none">Is tle(wall clock) used here to enforce the strict time limit, or is it an actual problem?</pre>
    <div style="opacity: 1">
      Is tle(wall clock) used here to enforce the strict time limit, or is it an actual problem?    </div>
    <br><div class="comment_block" id="comment7589">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/bbi5291">bbi5291</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7589">May 09, 2016 - 7:30:50 pm UTC</a>      </span>
      <a class="comment_title" id="title7589" onclick="toggle(&quot;body7589&quot;)">Re: Wall Clock</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7589">
    (<span class="upvotes"><span id="upvotes7589">0</span></span>/<span class="downvotes"><span id="downvotes7589">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7589" class="comment_body">
    <pre id="msg7589" style="display: none">Elapsed time limit is 5 times CPU time limit (which is currently 0.2 s for this problem). It can't be set separately. It's nothing more than a mechanism to prevent submissions from taking forever.</pre>
    <div style="opacity: 1">
      Elapsed time limit is 5 times CPU time limit (which is currently 0.2 s for this problem). It can't be set separately. It's nothing more than a mechanism to prevent submissions from taking forever.    </div>
      </div>
</div>
  </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0321s.<br>
    Server time on page load:
    Jun 24, 2018 07:01:22 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fwc15fs4">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>