<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - CCC10S4 - Animal Farm</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "a5a6da31e315e7ee609958a2aedecd0f";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fccc10s4"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>2010 Canadian Computing Competition, Stage 1</h3>
<h2>Problem S4: Animal Farm</h2>

<p>You are running a farm which has <var>N</var> (1 ≤ <var>N</var> ≤ 100)
animals. You went to the store and bought <var>M</var> = <var>N</var> pre-made
pens that will house your animals. Pens satisfy the following conditions:</p>
<ul>
<li>pens have between 3 and 8 edges;</li>
<li>an edge that is specified by two pens connects the two pens;</li>
<li>an edge that is specified only once connects that pen to the outside;</li>
<li>there is exactly one animal in each pen and no animals outside the pens,
initially.</li>
</ul>
<p>The animals, however, have a game they like to play called "Escape from the
pen." They assign a cost to each edge of the pen, and they determine the
minimum cost for all of the animals to meet in the same area by trampling over
the edge of various pens. The animals may meet inside a particular pen or
outside of all the pens. Also note that once an edge has been trampled, any
animal may pass over it without incurring any cost.</p>

<p>You will be given a description of the pens, along with the placement of
animals, and you are to figure out what the smallest cost is to move all the
animals into the same area.</p>

<h3>Input</h3>
<p>The first line of input will be the integer <var>M</var>, the number of pens.
On the next <var>M</var> lines, there will be a description of each pen, with
one description per line. The description is composed of three components, with
each component separated by one space, as follows:</p>
<ul>
<li>the first component is an integer <var>e<sub>p</sub></var> (3 ≤
<var>e<sub>p</sub></var>), which describes the number of edges for this
particular pen <var>p</var>;</li>
<li>the second component is a sequence of <var>e<sub>p</sub></var> integers
describing the corners of each pen, where each integer is less than or equal
to 1000;</li>
<li>the third component is a sequence of <var>e<sub>p</sub></var> integers
describing the cost of each edge, where each integer is less than or equal to
5000.</li>
</ul>
<p>For the corner and edge cost description, the descriptions are given in
cyclical order. For example, the pen description "3 1 2 3 7 4 6" means that
there are three corners, and thus, three edges, where the edge (1,2) has cost
7, the edge (2,3) has cost 4 and the edge (3,1) has cost 6. Note: at least 20%
of the marks for this question have <var>N</var> ≤ 10 and no pen will have
more than four edges in these cases.</p>

<h3>Output</h3>
<p>On one line, output the minimal cost that will allow all the animals to
gather in one pen or outside all of the pens.</p>

<h3>Sample Input</h3>
<pre>4
3 1 2 3 7 4 6
4 1 2 4 5 7 7 2 6
4 4 7 6 5 4 8 9 2
5 3 2 4 7 8 4 7 4 7 7</pre>

<h3>Sample Output</h3>
<pre>10</pre>

<h3>Explanation</h3>
<p>The diagram below explains the input data:</p>
<p style="text-align: center"><img src="images/ccc10s4/animal_farm.png" alt="">
</p><p>where the circled numbers are the corners, and the numbers in <i>italics</i>
are the edge costs. Notice that if the edges (2,3), (4,5), and (4,7) are
removed, all the animals can meet in the pen which has five sides.</p>

</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,ccc10s4">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/ccc10s4">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 15 (partial)<br>
    <b>Time Limit:</b> 2.00s<br>
    <b>Memory Limit:</b> 16M<br>
    <b>Added:</b> Feb 23, 2010<br>
      </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=ccc10s4">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment7239">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/spencereir">spencereir</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7239">Dec 24, 2015 - 7:52:40 pm UTC</a>      </span>
      <a class="comment_title" id="title7239" onclick="toggle(&quot;body7239&quot;)">What's the issue with my algorithm?</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7239">
    (<span class="upvotes"><span id="upvotes7239">0</span></span>/<span class="downvotes"><span id="downvotes7239">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7239" class="comment_body">
    <pre id="msg7239" style="display: none">Why is my code getting WA? I've been looking over it for the past hour and a bit, but can't see any reason why that might be. I'd really appreciate a hint of some sort. I'm sure it's probably some stupid indexing problem or something, but I'm just not seeing it -_-. Thanks!</pre>
    <div style="opacity: 1">
      Why is my code getting WA? I've been looking over it for the past hour and a bit, but can't see any reason why that might be. I'd really appreciate a hint of some sort. I'm sure it's probably some stupid indexing problem or something, but I'm just not seeing it -_-. Thanks!    </div>
    <br><div class="comment_block" id="comment7249">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/wgma00">wgma00</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7249">Dec 26, 2015 - 4:16:08 pm UTC</a>      </span>
      <a class="comment_title" id="title7249" onclick="toggle(&quot;body7249&quot;)">Re: What's the issue with my algorithm?</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7249">
    (<span class="upvotes"><span id="upvotes7249">1</span></span>/<span class="downvotes"><span id="downvotes7249">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7249" class="comment_body">
    <pre id="msg7249" style="display: none">You cannot use kruskals algorithm for this problem; kruskals makes a minimum spanning forest if the graph is not connected.</pre>
    <div style="opacity: 1">
      You cannot use kruskals algorithm for this problem; kruskals makes a minimum spanning forest if the graph is not connected.    </div>
    <br><div class="comment_block" id="comment7250">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/spencereir">spencereir</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7250">Dec 26, 2015 - 4:39:56 pm UTC</a>      </span>
      <a class="comment_title" id="title7250" onclick="toggle(&quot;body7250&quot;)">Re: What's the issue with my algorithm?</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7250">
    (<span class="upvotes"><span id="upvotes7250">0</span></span>/<span class="downvotes"><span id="downvotes7250">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7250" class="comment_body">
    <pre id="msg7250" style="display: none">Thanks for the reply!

One question: what's the issue with the graph being disconnected? In line 202 in my most recent submission, I check for the case of the graph being disconnected. Then for the second pass, the graph should always be connected, as every pen is either entirely surrounded by other pens, or connected by a single edge to the outside.

Again, thanks for the help.</pre>
    <div style="opacity: 1">
      Thanks for the reply! <br> <br>One question: what's the issue with the graph being disconnected? In line 202 in my most recent submission, I check for the case of the graph being disconnected. Then for the second pass, the graph should always be connected, as every pen is either entirely surrounded by other pens, or connected by a single edge to the outside. <br> <br>Again, thanks for the help.    </div>
    <br><div class="comment_block" id="comment7252">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/spencereir">spencereir</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7252">Dec 27, 2015 - 3:20:06 pm UTC</a>      </span>
      <a class="comment_title" id="title7252" onclick="toggle(&quot;body7252&quot;)">Re: What's the issue with my algorithm?</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7252">
    (<span class="upvotes"><span id="upvotes7252">1</span></span>/<span class="downvotes"><span id="downvotes7252">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7252" class="comment_body">
    <pre id="msg7252" style="display: none">I found the issue with it. It had to do with connecting pens that shared multiple faces.</pre>
    <div style="opacity: 1">
      I found the issue with it. It had to do with connecting pens that shared multiple faces.    </div>
      </div>
</div>
  </div>
</div>
<br><div class="comment_block" id="comment7263">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/Alex">Alex</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7263">Dec 27, 2015 - 9:02:36 pm UTC</a>      </span>
      <a class="comment_title" id="title7263" onclick="toggle(&quot;body7263&quot;)">Re: What's the issue with my algorithm?</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7263">
    (<span class="upvotes"><span id="upvotes7263">2</span></span>/<span class="downvotes"><span id="downvotes7263">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7263" class="comment_body">
    <pre id="msg7263" style="display: none">This is not entirely true. It's possible to use Kruskal's to solve the problem.</pre>
    <div style="opacity: 1">
      This is not entirely true. It's possible to use Kruskal's to solve the problem.    </div>
      </div>
</div>
  </div>
</div>
  </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0297s.<br>
    Server time on page load:
    Jun 24, 2018 07:08:39 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fccc10s4">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>