<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - WC16 Finals - Bug Infestation</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "a5a6da31e315e7ee609958a2aedecd0f";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fwc16fs4"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>2016-17 Woburn Challenge Finals Round - Senior Division</h3>
<h2>Problem 4: Bug Infestation</h2>

<img src="images/wc16fs4/wc16fs4.jpg" alt="" style="float:right; height:200px; padding:25px; padding-top: 0;">

<p>Having fortunately gotten wind of the Cow-Bot's construction before meeting it in battle, the monkeys are in the process of frantically creating a virus, with the hopes of installing it into the robot and shutting it down! They've finished writing their program, which consists of <var>N</var> (1 ≤ <var>N</var> ≤ 300,000) lines of code, but unfortunately its quality may be somewhat lacking...</p>

<p>At any point in time, each line of code either contains a bug, or doesn't. Initially, each line <var>i</var> contains a bug if <var>B<sub>i</sub></var> = 1, and otherwise doesn't if <var>B<sub>i</sub></var> = 0 (0 ≤ <var>B<sub>i</sub></var> ≤ 1).</p>

<p>Each minute, the monkeys can select one line of code which contains a bug, and fix that bug! Unfortunately, their code is so fragile that fixing some bugs may introduce others. If a bug is fixed on line <var>i</var>, then if <var>L<sub>i</sub></var> = 0, there are no consequences. Otherwise, one other line <var>L<sub>i</sub></var> (1 ≤ <var>L<sub>i</sub></var> ≤ <var>N</var>, <var>L<sub>i</sub></var> ≠ <var>i</var>) will begin to have a bug (regardless of whether it already had one or not).</p>

<p>In order to efficiently proceed with making their viral code as correct as possible, the monkeys are interested in the answers to two questions. Firstly, what's the minumum possible number of lines of code which can be left containing bugs after they fix as many bugs as they'd like to? And secondly, how quickly can that minimum number of outstanding bugs be achieved? If <var>Q</var> = 1, then you only need to answer the first of these questions, and if <var>Q</var> = 2, then you must answer both.</p>

<p>
In test cases worth 5/30 of the points, <var>Q</var> = 1 and <var>N</var> ≤ 2000.<br>
In test cases worth another 4/30 of the points, <var>Q</var> = 1.<br>
In test cases worth another 6/30 of the points, <var>N</var> ≤ 2000.
</p>

<h3>Input Format</h3>
<p>
The first line of input consists of two space-separated integers <var>N</var> and <var>Q</var>.<br>
<var>N</var> lines follow, the <var>i</var>-th of which consists of two integers <var>B<sub>i</sub></var> and <var>L<sub>i</sub></var> (for <var>i</var> = 1..<var>N</var>).
</p>

<h3>Output Format</h3>
<p>
If <var>Q</var> = 1, then output a single integer – the minimum possible number of bugs which can remain in the code.<br>
Otherwise if <var>Q</var> = 2, then output two space-separated integers – the minimum possible number of bugs which can remain in the code, and the minimum number of minutes required to achieve that number of bugs.
</p>

<h3>Sample Input</h3>
<pre>10 2
1 4
0 0
0 8
0 10
0 0
1 0
1 4
1 4
1 5
0 7
</pre>

<h3>Sample Output</h3>
<pre>1 6
</pre>

<h3>Sample Explanation</h3>
<p>
One optimal sequence of lines to debug is: 1, 6, 7, 8, 9, 5.<br>
After this sequence, the only line containing a bug will be line 4. It's impossible to eliminate all of the bugs from the monkeys' code (hopefully the same isn't true for yours…).
</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,wc16fs4">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/wc16fs4">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 20 (partial)<br>
    <b>Time Limit:</b> 3.00s<br>
    <b>Memory Limit:</b> 64M<br>
    <b>Added:</b> May 07, 2017<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=wc16fs4">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment8097">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/8097">May 07, 2017 - 8:38:38 pm UTC</a>      </span>
      <a class="comment_title" id="title8097" onclick="toggle(&quot;body8097&quot;)">Incorrect Test Data</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating8097">
    (<span class="upvotes"><span id="upvotes8097">2</span></span>/<span class="downvotes"><span id="downvotes8097">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body8097" class="comment_body">
    <pre id="msg8097" style="display: none">As pointed out by kobortor, there was unfortunately an error in the test data used during the competition. The data has since been corrected, and submissions have been rejudged accordingly. We apologize for this issue.

This does affect the results of the competition in some unknown fashion, as Thornhill1 actually solved this problem correctly while the remaining teams did not. We've decided to leave the official results unchanged, but award Thornhill1 the equivalent of the 1st place's prize money.</pre>
    <div style="opacity: 1">
      As pointed out by kobortor, there was unfortunately an error in the test data used during the competition. The data has since been corrected, and submissions have been rejudged accordingly. We apologize for this issue. <br> <br>This does affect the results of the competition in some unknown fashion, as Thornhill1 actually solved this problem correctly while the remaining teams did not. We've decided to leave the official results unchanged, but award Thornhill1 the equivalent of the 1st place's prize money.    </div>
      </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0177s.<br>
    Server time on page load:
    Jun 24, 2018 07:02:03 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fwc16fs4">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>