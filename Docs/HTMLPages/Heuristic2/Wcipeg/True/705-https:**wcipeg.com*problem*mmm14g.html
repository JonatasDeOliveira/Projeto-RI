<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - Campfire Cooking</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "221fe9b9644c0adc95c96655c1b1b5a1";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fmmm14g"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>Maniacal Midsummer Marathon 2014 by AL, TL, JJ</h3>
<h2>Problem G: Campfire Cooking</h2>

<p>Esdeath is currently enjoying a wonderful dinner with subordinates in her army. There is a giant pot on a campfire, and <var>N</var> (2 ≤ <var>N</var> ≤ 200000) soldiers surrounding the pot in a circle, numbered clockwise from 1 to <var>N</var>. Each soldier holds a very large supply of a specific type of food that tastes best when cooked at a specific range of temperatures. Soldier <var>i</var>'s food tastes best when it is cooked between <var>A<sub>i</sub></var> and <var>B<sub>i</sub></var> degrees Celsius, inclusive. We shall refer to this as the <i>optimal temperature range</i>.</p>

<p>The entire campfire cooking session will last <var>M</var> (1 ≤ <var>M</var> ≤ 200000) minutes. During each of these minutes, one of three possible events will occur:</p>

<ol>
<li>
<p>Esdeath would like to try a combination of foods, so all soldiers with a number between <var>i</var> and <var>j</var> (1 ≤ <var>i</var>, <var>j</var> ≤ <var>N</var>; note: it is <i>not</i> necessarily true that <var>i</var> ≤ <var>j</var>) will pitch in some food if the type of food they hold tastes best within a certain range of the pot's current temperature <var>T</var> degrees Celsius. That is, if a soldier is <i>between</i> soldiers <var>i</var> and <var>j</var> inclusive, they must contribute if their optimal temperature range overlaps with the range [<var>T</var> − <var>L</var>, <var>T</var> + <var>H</var>] (0 ≤ <var>L</var>, <var>H</var> ≤ 100000). Here, <i>between</i> means starting from the <var>i</var>-th soldier and going clockwise around the circle, considering every soldier you pass up to and including the <var>j</var>-th soldier.</p>

<p>After each time Esdeath performs this event, the temperature of the pot will change based on three constant values <var>X</var>, <var>Y</var>, and <var>Z</var> (0 ≤ <var>X</var>, <var>Y</var> ≤ 1000; 1 ≤ <var>Z</var> ≤ 100000). The new temperature after each instance of this event is determined by the formula: <var>T</var><sub>new</sub> = ((<var>T</var><sub>old</sub>*<var>X</var> + <var>F</var>*<var>Y</var>) mod <var>Z</var>) + 1, where <var>F</var> is the number of foods tossed into the pot. We'll assume that each soldier has a very large quantity of their own type of food, and will always be able to contribute if his or her temperature range is right. Every time this event is called, please determine <var>F</var>, the number of types of foods that have been tossed into the pot.</p>
</li>

<li><p>The <var>i</var>-th soldier gets a new type of food, getting rid of their old type of food. The new type of food will have an optimal temperature range between <var>L</var> and <var>H</var> (1 ≤ <var>i</var> ≤ <var>N</var>; 1 ≤ <var>L</var> ≤ <var>H</var> ≤ <var>Z</var>).</p></li>

<li>For this event, Esdeath would like to know, hypothetically, if all soldiers between <var>i</var> and <var>j</var> were to put some of their food into the pot in increasing order of the <var>A<sub>i</sub></var> temperatures of their food (the lower bounds of their foods' optimal temperature ranges), what would be the <var>A<sub>i</sub></var> temperature of the <var>k</var>-th soldier who places food into the pot? If no such value exists, output <code>-1</code>.</li>
</ol>

<h3>Input Format</h3>
<p>
Line 1: Six integers <var>N</var>, <var>M</var>, <var>T</var>, <var>X</var>, <var>Y</var>, and <var>Z</var>.
<br>
Next <var>N</var> lines: line <var>i</var>+1 will contain two integers <var>A</var><sub>i</sub> and <var>B</var><sub>i</sub>, the optimal temperature range for soldier <var>i</var>'s initial type of food.
<br>
Next <var>M</var> lines: line <var>i</var>+<var>N</var>+1 will describe the event that happens in the <var>i</var>-th minute of the cooking session. Each line will be in one of the following three formats to represent the three types of events:

</p><ul>
<li>Type 1 events will be in the format:<code> 1 <var>i</var> <var>j</var> <var>L</var> <var>H</var></code></li>
<li>Type 2 events will be in the format:<code> 2 <var>i</var> <var>L</var> <var>H</var></code></li>
<li>Type 3 events will be in the format:<code> 3 <var>i</var> <var>j</var> <var>k</var></code></li>
</ul>
<p></p>

<p>At any given time the pot's temperature <var>T</var> will satisfy 1 ≤ <var>T</var> ≤ <var>Z</var>. Furthermore, the total number of type 2 events will not exceed 25000.</p>

<style type="text/css">
#samples td {
  vertical-align: text-top;
}
</style>

<table id="samples" style="width: 100%;">
<tbody><tr><td>
<h3>Sample Input 1</h3>
<pre>5 4 4 1 1 10
1 3
4 6
7 9
3 5
2 4
1 1 5 1 0
1 2 4 0 0
1 3 3 0 0
1 3 2 0 0
</pre>
</td>
<td>
<h3>Sample Input 2</h3>
<pre>3 10 1 2 3 10
1 1
1 5
1 10
1 1 3 0 9
2 3 10 10
1 1 3 1 1
1 1 3 0 9
1 1 3 0 1
2 2 9 9
1 1 3 0 2
1 1 3 2 0
1 1 2 0 0
1 1 2 0 0
</pre></td><td>
<h3>Sample Input 3</h3>
<pre>5 12 1 0 0 5
3 3
1 1
3 3
4 4
2 2
3 1 5 1
3 2 1 2
3 3 2 3
3 4 3 4
3 5 4 5
3 1 3 1
3 1 3 2
3 1 3 3
3 4 2 4
3 1 2 3
3 4 1 5
3 4 1 2
</pre><br></td></tr>
<tr><td>
<h3>Sample Output 1</h3>
<pre>4
1
0
2
</pre></td><td>
<h3>Sample Output 2</h3>
<pre>3
2
3
1
2
1
0
1
</pre></td><td>
<h3>Sample Output 3</h3>
<pre>1
2
3
3
4
1
3
3
4
-1
-1
3
</pre></td>
</tr>
</tbody></table>

<h3>Explanation for Sample 1</h3>
<p>
The pot starts at a temperature of 4 degrees Celsius. The range of temperatures is [3, 4].<br>
All soldiers participate, and 4 types of food are thrown into the pot. The temperature becomes (4*1 + 4*1) mod 10 + 1 = 9 degrees Celsius.<br>
Soldiers 2, 3, and 4 participate, and 1 type of food is thrown into the pot. The temperature becomes (9*1 + 1*1) mod 10 + 1 = 1 degrees Celsius.<br>
The third soldier cannot throw any food into the pot. The temperature becomes (1*1 + 0*1) mod 10 + 1 = 2 degrees Celsius.<br>
All soldiers participate again, and 2 types of food are thrown into the pot. The temperature becomes (2*1 + 2*1) mod 10 + 1 = 5 degrees Celsius, and the cooking session ends.
</p>

<h3>Subtask 1 [8% of points]</h3>

<p><var>N</var>, <var>M</var> ≤ 1000.<br>
Additionally, there will be no events of type 3.</p>

<h3>Subtask 2 [17% of points]</h3>

<p><var>N</var>, <var>M</var> ≤ 100000.<br>
In all events of type 1, <var>L</var> = <var>H</var> = 0.<br>
Additionally, there will be no events of type 3.</p>

<h3>Subtask 3 [20% of points]</h3>

<p><var>N</var>, <var>M</var> ≤ 100000.<br>
<var>X</var> = 1 and <var>Y</var> = 0.<br>
Additionally, there will be no events of type 3.</p>

<h3>Subtask 4 [15% of points]</h3>

<p><var>N</var>, <var>M</var> ≤ 100000.<br>
There will only be events of type 1.</p>

<h3>Subtask 5 [17% of points]</h3>

<p><var>N</var>, <var>M</var> ≤ 100000.<br>
There will be no events of type 3.</p>

<h3>Subtask 6 [20% of points]</h3>

<p><var>N</var>, <var>M</var> ≤ 100000.</p>

<h3>Subtask 7 [3% of points]</h3>

<p>There are no additional constraints.</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,mmm14g">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/mmm14g">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 40 (partial)<br>
    <b>Time Limit:</b> 3.00s<br>
    <b>Memory Limit:</b> 1024M<br>
    <b>Added:</b> Jul 15, 2014<br>
        <b>Authors:</b> <a href="https://wcipeg.com/user/FatalEagle">FatalEagle</a>, <a href="https://wcipeg.com/user/Alex">Alex</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=mmm14g">Search</a>)</h2><p style="text-align: center"></p>It's quiet in here...</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0182s.<br>
    Server time on page load:
    May 10, 2018 21:59:56 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fmmm14g">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>