<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - CCC14 Stage 2 - King Gruff</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "8c45b434a3b7582378f7341582f131fd";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fccc14s2p2"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>2014 Canadian Computing Competition, Stage 2</h3>
<h2>Day 1, Problem 2: King Gruff</h2>

<p>King Gruff the Wolf rules over a happy, prosperous land inhabited by adorable Foxen. Unfortunately for them, he is not a nice king at all, and wants to make their lives miserable!</p>

<p>His country has <var>N</var> (1 ≤ <var>N</var> ≤ 10<sup>5</sup>) cities, with <var>M</var> (0 ≤ <var>M</var> ≤ 10<sup>5</sup>) roads running amongst them. The <var>i</var>-th road allows one to travel from city <var>X<sub>i</sub></var> to a different city <var>Y<sub>i</sub></var> (1 ≤ <var>X<sub>i</sub></var>, <var>Y<sub>i</sub></var> ≤ <var>N</var>), in that direction only, and has a length of <var>L<sub>i</sub></var> (1 ≤ <var>L<sub>i</sub></var> ≤ 10<sup>4</sup>) and a shutdown cost of <var>C<sub>i</sub></var> (1 ≤ <var>C<sub>i</sub></var> ≤ 10<sup>4</sup>). There may be multiple roads running between a pair of cities, even in the same direction.</p>

<p>King Gruff particularly dislikes the Foxen living in two different cities <var>A</var> and <var>B</var> (1 ≤ <var>A</var>, <var>B</var> ≤ <var>N</var>), and would like to make it more inconvenient (or even impossible) to travel from city <var>A</var> to city <var>B</var>. In particular, he'll select a distance value <var>D</var> (1 ≤ <var>D</var> ≤ 10<sup>9</sup>), and then simultaneously shut down every single road in his kingdom which is part of at least one path from city <var>A</var> to city <var>B</var> with total length no more than <var>D</var>. For each such road, however, he'll have to dig into his royal treasury and pay its shutdown cost. A path consists of a sequence of roads such that each road (except the first) starts at the city that the previous road ended at, and may visit a city or road multiple times.</p>

<p>Gruff is having trouble making up his mind about what value of <var>D</var> to choose, however - a larger value would make things more inconvenient for his Foxy subjects, but might cost him more money as well! As such, he'll consider <var>Q</var> (1 ≤ <var>Q</var> ≤ 10<sup>5</sup>) different values, <var>D</var><sub>1</sub>, <var>D</var><sub>2</sub>, …, <var>D<sub>Q</sub></var>. For each one, he'd like to know how many tax dollars would need to be spent to shut down all roads which lie on at least one sufficiently short path from city <var>A</var> to city <var>B</var>. Since you don't like Foxen either, you're agreed to help the Wolf write a program to calculate this!</p>

<h3>Input</h3>
<p>The first line contains 4 integers, each separated by a space:</p>
<ul>
  <li><var>N</var> (1 ≤ <var>N</var> ≤ 10<sup>5</sup>), the number of cities, followed by</li>
  <li><var>M</var> (1 ≤ <var>M</var> ≤ 10<sup>5</sup>), the number of roads, followed by</li>
  <li><var>A</var> (1 ≤ <var>A</var> ≤ <var>N</var>), the starting city, followed by</li>
  <li><var>B</var> (1 ≤ <var>B</var> ≤ <var>N</var>), the ending city</li>
</ul>

<p>Each of the next <var>M</var> lines contain four space-separated integers <var>X<sub>i</sub></var>, <var>Y<sub>i</sub></var>, <var>L<sub>i</sub></var>, and <var>C<sub>i</sub></var>, describing the road from <var>X<sub>i</sub></var> to <var>Y<sub>i</sub></var> with length <var>L<sub>i</sub></var>, and shutdown cost <var>C<sub>i</sub></var> (where 1 ≤ <var>X<sub>i</sub></var>, <var>Y<sub>i</sub></var> ≤ <var>N</var>, 1 ≤ <var>L<sub>i</sub></var>, <var>C<sub>i</sub></var> ≤ 10<sup>4</sup>).</p>

<p>The next line contains <var>Q</var> (1 ≤ <var>Q</var> ≤ 10<sup>5</sup>), the number of different distance values to consider.</p>

<p>The next <var>Q</var> lines each contain one integer <var>D<sub>i</sub></var> (1 ≤ <var>D<sub>i</sub></var> ≤ 10<sup>9</sup>), which is the distance value to consider in shutting down roads.</p>

<p>The following conditions hold for the input data:</p>
<ul>
  <li>For test cases worth up to 20% of the points, <var>N</var> ≤ 500;</li>
  <li>For test cases worth up to 20% of the points, <var>Q</var> = 1;</li>
  <li>For test cases worth up to 80% of the points, <var>Q</var> ≤ 20.</li>
</ul>

<h3>Output</h3>
<p>The output consists of <var>Q</var> lines, each with one integer, representing the total cost required to shut down all necessary roads given a distance value of <var>D<sub>i</sub></var>, for <var>i</var> = 1..<var>Q</var>.</p>

<h3>Sample Input 1</h3>
<pre>4 5 1 3
1 2 5 1
1 2 8 50
2 3 2 15
3 1 80 1000
3 4 1 1
4
8
6
90
94
</pre>

<h3>Sample Output 1</h3>
<pre>16
0
66
1066
</pre>

<h3>Explanation of Sample 1</h3>
<p>The map of the country is illustrated below, with each road labeled with its length only:</p>

<p style="text-align:center;"><img src="images/ccc14s2p2/ccc14s2p2.1.png"></p>
<p>If <var>D</var> = 8, the first and third roads need to be shut down, as they're both part of a path from city 1 to city 3 of length 7. This incurs a total cost of 1 + 15 = 16.<br>
If <var>D</var> = 6, no roads need to be shut down, as no paths from city 1 to city 3 with total length 6 or less exist.<br>
If <var>D</var> = 90, the first three roads all need to be shut down.<br>
If <var>D</var> = 94, the fourth road must additionally be shut down, as it lies on a path from city 1 to city 3 of length exactly 94, consisting of the first, third, fourth, first and then third roads.</p>


<h3>Sample Input 2</h3>
<pre>4 3 1 2
2 1 1 1
3 4 10000 10000
4 3 10000 10000
1
1000000000
</pre>

<h3>Sample Output 2</h3>
<pre>0
</pre>

<h3>Explanation 2</h3>
<p>The map of the country is illustrated below:</p>
<p style="text-align:center;"><img src="images/ccc14s2p2/ccc14s2p2.2.png"></p>
<p>As can be seen, the Foxen already have a problem, as no path from city 1 to city 2 exists! As such, for any value of <var>D</var>, King Gruff doesn't need to shut down any roads.</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,ccc14s2p2">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/ccc14s2p2">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 15 (partial)<br>
    <b>Time Limit:</b> 2.00s<br>
    <b>Memory Limit:</b> 64M<br>
    <b>Added:</b> May 17, 2014<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=ccc14s2p2">Search</a>)</h2><p style="text-align: center"></p>It's quiet in here...</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0123s.<br>
    Server time on page load:
    May 9, 2018 15:30:05 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fccc14s2p2">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>