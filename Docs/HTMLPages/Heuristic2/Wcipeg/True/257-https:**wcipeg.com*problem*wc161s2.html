<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - WC16 #1 - Alucard's Quest</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "8c45b434a3b7582378f7341582f131fd";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fwc161s2"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>Woburn Challenge 2016-17 Round 1 - Senior Division</h3>
<h2>Problem 2: Alucard's Quest</h2>

<img src="images/wc161s2/wc161s2.jpg" alt="" style="float:right; height:200px; padding:25px; padding-top: 0;">

<p>What a horrible night to have a curse! Alucard has returned to the ancient castle of his evil father, Dracula, determined to wake him from his slumber and then destroy him once and for all. However, something tells him that it won't be easy - though Dracula remains fast asleep in his coffin for now, his monstrous servants are scattered throughout the castle, armed to the teeth and hungry for blood.</p>

<p>The castle consists of <var>N</var> (1 ≤ <var>N</var> ≤ 200,000) chambers, with <var>N</var> − 1 passageways running between them. The <var>i</var>-th passageway connects distinct chambers <var>A<sub>i</sub></var> and <var>B<sub>i</sub></var> (1 ≤ <var>A<sub>i</sub></var>, <var>B<sub>i</sub></var> ≤ <var>N</var>), and has <var>M<sub>i</sub></var> (1 ≤ <var>M<sub>i</sub></var> ≤ 5000) monsters in it. It's possible to reach any chamber from any other chamber by following a sequence of one or more passageways – in other words, the system of chambers and passageways forms a tree structure when modelled as a graph.</p>

<p>Dracula's resting place is in the 1st chamber, and fortunately for Alucard, he's already infiltrated the castle and also finds himself in the 1st chamber! However, he's realized that he's not quite ready to battle Dracula yet. In order to stand a chance, Alucard will surely need some holy water, stronger weapons (a whip should come in handy), a wider range of magical spells to cast, and of course an oak stake to plunge into his father's heart and finish him off permanently. In particular, Alucard will first need to gather <var>K</var> (1 ≤ <var>K</var> &lt; <var>N</var>) items. Conveniently, all of these items can be found in distinct chambers of Dracula's castle, with the <var>i</var>-th item in chamber <var>C<sub>i</sub></var> (2 ≤ <var>C<sub>i</sub></var> ≤ <var>N</var>).</p>

<p>Alucard will need to travel around the castle through its passageways, starting from the 1st chamber, visiting all <var>K</var> chambers that contain his required items (in any order), and arriving back in the 1st chamber to finally wake and confront Dracula. If he chooses to travel through a passageway that contains <var>m</var> monsters, he'll first need to destroy them by casting a spell and using up <var>m</var> of his "magic points". That passageway will then be permanently cleared of monsters, so he'll be able to freely travel through it any number of times afterwards.</p>

<p>Conserving magic points for his battle with Dracula is vital, so Alucard will need to carefully plan out a route through the castle which will allow him to collect all <var>K</var> items while requiring him to use as few magic points as possible. Can you help him?</p>

<p>
In test cases worth 3/20 of the points, <var>N</var> ≤ 1000 and <var>K</var> = 1.<br>
In test cases worth another 7/20 of the points, <var>N</var> ≤ 1000.
</p>

<h3>Input Format</h3>
<p>
The first line of input consists of two space-separated integers <var>N</var> and <var>K</var>.<br>
<var>N</var> − 1 lines follow, with the <var>i</var>-th of these lines consisting of three space-separated integers <var>A<sub>i</sub></var>, <var>B<sub>i</sub></var>, and <var>M<sub>i</sub></var> (for <var>i</var> = 1..<var>N</var> − 1).<br>
<var>K</var> lines follow, with the <var>i</var>-th of these lines consisting of a single integer <var>C<sub>i</sub></var> (for <var>i</var> = 1..<var>K</var>).
</p>

<h3>Output Format</h3>
<p>
Output one line consisting of a single integer – the minimum number of magic points required for Alucard to collect all <var>K</var> items and return to Dracula's chamber.
</p>

<h3>Sample Input</h3>
<pre>7 4
1 2 5
1 7 2
2 4 3
2 5 8
5 6 1
7 3 10
4
5
3
7
</pre>

<h3>Sample Output</h3>
<pre>28
</pre>

<h3>Sample Explanation</h3>
<p>
One optimal route that Alucard can take, passing through all 4 chambers that contain items and then returning to the 1st chamber, is as follows:
</p>
<ul>
<li>1 → 7 (2 magic points)</li>
<li>7 → 3 (10 magic points)</li>
<li>3 → 7 (already cleared)</li>
<li>7 → 1 (already cleared)</li>
<li>1 → 2 (5 magic points)</li>
<li>2 → 4 (3 magic points)</li>
<li>4 → 2 (already cleared)</li>
<li>2 → 5 (8 magic points)</li>
<li>5 → 2 (already cleared)</li>
<li>2 → 1 (already cleared)</li>
</ul>
<p>
The total number of magic points required on this route is 2 + 10 + 5 + 3 + 8 = 28.
</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,wc161s2">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/wc161s2">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 10 (partial)<br>
    <b>Time Limit:</b> 4.00s<br>
    <b>Memory Limit:</b> 64M<br>
    <b>Added:</b> Oct 16, 2016<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=wc161s2">Search</a>)</h2><p style="text-align: center"></p>It's quiet in here...</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0199s.<br>
    Server time on page load:
    May 9, 2018 15:28:28 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fwc161s2">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>