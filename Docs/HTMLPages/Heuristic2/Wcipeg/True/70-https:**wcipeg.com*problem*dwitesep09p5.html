<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - Traffic Lights</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "58ee96f07f700762ecde5e3dc163a054";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fdwitesep09p5"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>2009 Mock DWITE by A.J.: Problem 5</h3>
<h2>Traffic Lights</h2>
<p>Every day, Brenda is faced with the monumental task of getting to work by car. Brenda
lives in a city containing <i>C</i> north-south roads and <i>R</i> east-west roads.
Every north-south road intersects every east-west road exactly once. All north-south
roads are parallel to each other and perpendicular to all east-west roads (which
are themselves all mutually parallel as well). Conveniently, the westernmost north-south
road is called 1<sup>st</sup> Avenue, the next westernmost 2<sup>nd</sup> Avenue, and
so on; the northernmost east-west road is called 1<sup>st</sup> Street, the next
northermost 2<sup>nd</sup> Street, and so on.</p>
<p>Two intersections are considered
adjacent if it is possible to move from one intersection to another along a road
without passing through any other intersection on the way. It takes Brenda exactly <i>X</i>
minutes to move between two adjacent intersections, where <i>X</i> is constant.</p>
<p>Each intersection has a traffic light. The traffic light at the intersection of
<i>i</i><sup>th</sup> Street and <i>j</i><sup>th</sup> Avenue spends
<i>g</i><sub><i>ij</i></sub> minutes green in the north-south direction, then immediately switches
to being red for <i>r</i><sub><i>ij</i></sub> in the north-south direction, then repeats this
cycle indefinitely. The color in the
east-west direction is always opposite to the color in the north-south direction at any
instant in time.
Brenda cannot leave an intersection unless the light is green in the
direction of travel <i>at the time of departure from that intersection</i>.</p>
<p>Brenda's
apartment is at one intersection, and her place of work is at another intersection.
Brenda departs from her home at time zero, cannot leave the city, and obviously must
travel along the roads. She knows that, at her time of departure, all lights in the
city have <i>just</i> switched to green in the north-south direction.
Help her determine the earliest time at which she can possibly arrive at work.</p>
<h3>Input</h3>
There will be five cases given one after another in the input.<br>
The first line of each case contains three space-separated integers: <i>R</i>, <i>C</i>
(1 ≤ <i>R</i>,<i>C</i> ≤ 40), and <i>X</i> (1 ≤ <i>X</i> ≤ 5), as described
above.<br>
The next line contains two space-separated integers: <i>R</i><sub>h</sub> and
<i>C</i><sub>h</sub> (1 ≤ <i>R</i><sub>h</sub> ≤ <i>R</i>,
1 ≤ <i>C</i><sub>h</sub> ≤ <i>C</i>), indicating that Brenda's home is located
at <i>R</i><sub>h</sub><sup>th</sup> Street and <i>C</i><sub>h</sub><sup>th</sup>
Avenue.<br>
The next line contains two space-separated integers: <i>R</i><sub>w</sub> and
<i>C</i><sub>w</sub> (1 ≤ <i>R</i><sub>w</sub> ≤ <i>R</i>,
1 ≤ <i>C</i><sub>w</sub> ≤ <i>C</i>), indicating that Brenda's place of work
 is located at <i>R</i><sub>w</sub><sup>th</sup> Street and <i>C</i><sub>w</sub><sup>th</sup>
Avenue.<br>
A block of <i>R</i> lines follows, each containing <i>C</i> space-separated integers.
The <i>j</i><sup>th</sup> integer in the <i>i</i><sup>th</sup> line in this block 
gives <i>g</i><sub><i>ij</i></sub> (1 ≤ <i>g</i><sub><i>ij</i></sub> ≤ 5).<br>
A block of <i>R</i> lines follows, each containing <i>C</i> space-separated integers.
The <i>j</i><sup>th</sup> integer in the <i>i</i><sup>th</sup> line in this block 
gives <i>r</i><sub><i>ij</i></sub> (1 ≤ <i>r</i><sub><i>ij</i></sub> ≤ 5).
<h3>Output</h3>
For each case given in input, in the order given, output one line containing one integer:
the minimum amount of time, in seconds, it takes for Brenda to get to work.
<h3>Sample Input (only two cases shown)</h3>
<pre>1 2 1
1 2
1 2
2 3 
4 2 
2 2 3
2 1
2 2
5 3 
5 4 
1 5 
2 5 
</pre>
<h3>Sample Output</h3>
<pre>0
8
</pre>
<h3>Explanation</h3>
In the first case, Brenda's home and place of work are on the same intersection, so we
assume that it takes no time at all for her to move from one to the other.<br>
In the second case, Brenda waits for five minutes for the light at her initial
intersection to turn green in the east-west direction, and three minutes for
her to travel east one block. That totals eight minutes.<br>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,dwitesep09p5">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/dwitesep09p5">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 15 (partial)<br>
    <b>Time Limit:</b> 2.00s<br>
    <b>Memory Limit:</b> 16M<br>
    <b>Added:</b> Sep 26, 2009<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/bbi5291">bbi5291</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=dwitesep09p5">Search</a>)</h2><p style="text-align: center"></p>It's quiet in here...</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0187s.<br>
    Server time on page load:
    Jun 11, 2018 06:04:19 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fdwitesep09p5">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>