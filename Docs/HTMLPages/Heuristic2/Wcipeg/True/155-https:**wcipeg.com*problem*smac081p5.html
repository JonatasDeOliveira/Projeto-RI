<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - SMAC 08/09 (Oct) #5 - Crossroads</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "58ee96f07f700762ecde5e3dc163a054";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fsmac081p5"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>Sane's Monthly Algorithms Challenge: October 2008</h3>
<h2>Cross Roads (Guru Level)</h2>

<p>A flat rectangular grid of land separates four cities. Each city is situated on a different edge of the rectange</p>
<p>The four cities now wish to be joined by exactly 2 roads so that citizens may travel freely to and from each city. 
One road will join the North and South cities. 
Another road will join the West and East cities. The two roads will, of course, intersect somewhere, premitting anyone to travel to and from all four cities. 
Each road is a solid rectange of any width, with sides parallel to x and y axis.</p>

<p style="text-align: center"><img src="images/smac081p5/smac081p5.1.png" alt=""></p>

<p>The land separating the cities is a w x h grid of non-negative integers. 
Each value represents the cost of paving a road over the cell. 
To pave an entire road, all covered cells are paved and paid for exactly once. 
When paving the second road, the intersection does not need to be paved a second time.</p>

<p>If the roads are larger, more cars can travel from city to city. 
Therefore, you wish to maximize the total number of paved cells. 
However, you can not exceed the budget allocated for this job.</p>

<p>Determine the maximum number of cells which can be paved to build exactly 2 roads within the provided budget.</p>

<h3>Input</h3>
<p>The first line contains integers w, h (1 ≤ w, h ≤ 500) and budget (0 ≤ budget ≤ 2 000 000 000).</p>
<p>The next h lines contains w non-negative integers each ≤ 8000, representing the cost of paving a road over that cell.</p>

<h3>Output</h3>
<p>A single integer representing the largest possible area which can be paved with the given budget. If it is impossible to build both roads, output 0.</p>

<h3>Sample Input 1</h3>
<pre>7 5 30</pre>
<pre>0 4 0 5 5 8 9</pre>

<pre>1 1 3 2 2 3 4</pre>
<pre>0 1 2 1 4 1 1</pre>

<pre>2 9 1 4 5 3 6</pre>

<pre>7 7 1 2 4 9 7</pre>



<h3>Sample Output 1</h3>
<pre>17</pre>

<img src="images/smac081p5/smac081p5.2.png" alt="">



<h3>Sample Input 2</h3>
<pre>8 8 145</pre>
<pre>1 5 2 3 3 8 0 1</pre>
<pre>0 6 6 7 2 5 4 9</pre>
<pre>6 5 1 1 1 2 3 4</pre>
<pre>4 3 1 2 1 5 6 0</pre>
<pre>9 8 1 4 2 1 8 3</pre>
<pre>3 2 7 1 8 9 3 5</pre>
<pre>5 5 6 0 1 3 0 7</pre>
<pre>1 0 8 3 3 2 5 1</pre>

<h3>Sample Output 2</h3>
<pre>44</pre>

<img src="images/smac081p5/smac081p5.3.png" alt="">

</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,smac081p5">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/smac081p5">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 25 (partial)<br>
    <b>Time Limit:</b> 2.00s<br>
    <b>Memory Limit:</b> 64M<br>
    <b>Added:</b> Oct 26, 2008<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/DrSane">DrSane</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=smac081p5">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment97">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/bbi5291">bbi5291</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/97">Oct 26, 2008 - 10:47:53 pm UTC</a>      </span>
      <a class="comment_title" id="title97" onclick="toggle(&quot;body97&quot;)">Guru level?</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating97">
    (<span class="upvotes"><span id="upvotes97">0</span></span>/<span class="downvotes"><span id="downvotes97">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body97" class="comment_body">
    <pre id="msg97" style="display: none">I wonder, does the name "Guru level" have anything to do with Guru, or your title of "Programming Guru"?</pre>
    <div style="opacity: 1">
      I wonder, does the name "Guru level" have anything to do with Guru, or your title of "Programming Guru"?    </div>
    <br><div class="comment_block" id="comment99">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/DrSane">DrSane</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/99">Oct 26, 2008 - 10:57:22 pm UTC</a>      </span>
      <a class="comment_title" id="title99" onclick="toggle(&quot;body99&quot;)"></a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating99">
    (<span class="upvotes"><span id="upvotes99">0</span></span>/<span class="downvotes"><span id="downvotes99">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body99" class="comment_body">
    <pre id="msg99" style="display: none">Kind of the second. I didn't title myself as "Programming Guru". The forum has a system that titles you as "Beginner" or "Hobbyist" or "Guru" etc... depending on your number of posts. Since I have been personally influenced by the forum, I decided the competition should be too. Guru is the highest rank, and so the hardest problem has that rank. </pre>
    <div style="opacity: 1">
      Kind of the second. I didn't title myself as "Programming Guru". The forum has a system that titles you as "Beginner" or "Hobbyist" or "Guru" etc... depending on your number of posts. Since I have been personally influenced by the forum, I decided the competition should be too. Guru is the highest rank, and so the hardest problem has that rank.    </div>
      </div>
</div>
  </div>
</div>
<br>
<div class="comment_block" id="comment96">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/DrSane">DrSane</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/96">Oct 26, 2008 - 10:43:33 pm UTC</a>      </span>
      <a class="comment_title" id="title96" onclick="toggle(&quot;body96&quot;)">Note from the Author</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating96">
    (<span class="upvotes"><span id="upvotes96">0</span></span>/<span class="downvotes"><span id="downvotes96">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body96" class="comment_body">
    <pre id="msg96" style="display: none">I'll sleep better at night if I get no stupid solutions please. Fair submissions can easily solve this problem in under 1 second. Hacks and/or exploitations of any test data characteristics are completely unnecessary.</pre>
    <div style="opacity: 1">
      I'll sleep better at night if I get no stupid solutions please. Fair submissions can easily solve this problem in under 1 second. Hacks and/or exploitations of any test data characteristics are completely unnecessary.    </div>
      </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0244s.<br>
    Server time on page load:
    Jun 11, 2018 06:06:06 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fsmac081p5">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>