<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - CCO15 - Eggscavation</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "221fe9b9644c0adc95c96655c1b1b5a1";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fccc15s2p6"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>2015 Canadian Computing Olympiad</h3>
<h2>Day 2, Problem 3 - Eggscavation</h2>

<p>It's time for a vacation! You are sick and tired of C shells, so you decide to become a seashell collector.</p>

<p>For your vacation, you have decided to visit the beautiful island nation of Cartesia. It is well-known for having a lovely square beach that is composed of an <var>N</var>×<var>N</var> grid of square cells. You have brought your trusty shovel, which is able to dig up a <var>K</var>×<var>K</var> square subgrid of the beach. Your shovel, being trusty, can only dig up a <var>K</var>×<var>K</var> subgrid that is entirely within the beach.</p>

<p>There are <var>M</var> undiscovered species of shells hidden under certain grid cells. Specifically for each <var>i</var>, there are <var>S<sub>i</sub></var> shells from the <var>i</var>-th species in <var>S<sub>i</sub></var> grid locations, with 1 ≤ <var>S<sub>i</sub></var> ≤ 4. For each distinct species that you dig up and bring back home, you can sell it to a scientist back home for one dollar. Multiple shells of the same species don't add extra value.</p>

<p>Complicating matters is a glorious dodo bird running around the beach. At a given moment, it may decide to bury an egg in a grid cell (including grid cells that have eggs or shells already). The bad news is that if the <var>K</var>×<var>K</var> subgrid dug up by your shovel includes a dodo egg, the scientists will become annoyed that you are harming endangered species, and nobody will pay you anything.</p>

<p>After all is said and done, you decide to sit back, go back to programming, and simulate the digging instead. You will be computing the probability that your scoop, when chosen uniformly from all valid possible scoops, will make at least a given minimum profit (to pay off your student loans) at different points in time. Who wants to get all sweaty from shoveling on a beach anyway?</p>

<h3>Input Format</h3>

<p>The first line of input containts two integers <var>N</var> and <var>K</var>, (1 ≤ <var>N</var> ≤ 2500; 1 ≤ <var>K</var> ≤ <var>N</var>), the size of the beach and the size of the shovel, respectively.</p>

<p>The second line of input contains the integer <var>M</var> (0 ≤ <var>M</var> ≤ 10<sup>5</sup>), the number of species of shells. The next <var>M</var> lines each represent species <var>i</var> and consist of the integer <var>S<sub>i</sub></var> (1 ≤ <var>S<sub>i</sub></var> ≤ 4) followed by 2*<var>S<sub>i</sub></var> more integers, which represent the grid positions (between (1, 1) and (<var>N</var>, <var>N</var>)) where the <var>S<sub>i</sub></var> shells of that species are buried.</p>

<p>The next line contains <var>T</var> (1 ≤ <var>T</var> ≤ 10,000). Each of the next <var>T</var> lines represent one specific point in time (from oldest to newest) and each line has one of the following two forms:</p>

<ul>
<li><code>1 <var>A<sub>i</sub></var> <var>B<sub>i</sub></var></code> (1 ≤ <var>A<sub>i</sub></var>, <var>B<sub>i</sub></var> ≤ <var>N</var>), meaning that the dodo just buried an egg in the grid shell (<var>A<sub>i</sub></var>, <var>B<sub>i</sub></var>); or</li>
<li><code>2 <var>V<sub>i</sub></var></code> (1 ≤ <var>V<sub>i</sub></var> ≤ 10<sup>9</sup>), meaning we would like to calculate the probability that a random dig at this point in time has profit in dollars ≥ <var>V<sub>i</sub></var>. Note that no shells or eggs are actually removed or added when this probability is calculated.</li>
</ul>

<p>For at least 15% of the marks for this question, <var>N</var> ≤ 40 and all update operations occur before all query operations.</p>
<p>For an additional 25% of the marks for this question, all update operations will occur before all query operations.</p>

<h3>Output Format</h3>

<p>For each query operation, output on one line the probability that a random scoop would contain at least the desired number of different types of shells.</p>

<p>Your answer must be within 10<sup>−4</sup> of the judge's answer.</p>

<h3>Sample Input</h3>
<pre>4 2
3
3 1 1 2 3 4 2
3 1 4 2 3 3 2
4 2 1 2 4 4 1 4 4
6
2 2
2 3
1 2 3
2 2
2 3
2 4
</pre>

<h3>Sample Output</h3>
<pre>0.88889
0.33333
0.44444
0.11111
0.00000
</pre>

<h3>Explanation</h3>

<p>Initially, we have the following arrangement of shells (with the first shells in the input being labelled as 1, and so on):</p>


<style type="text/css">
#shells-table {
  border: 1px solid black;
  border-collapse: collapse;
}

#shells-table td {
  border: 1px solid black;
  padding: 3px 10px 3px 10px;
  text-align: center;
}
</style>

<table align="center" id="shells-table">
<tbody><tr><td>1</td><td></td><td></td><td>2</td></tr>
<tr><td>3</td><td></td><td>1,2</td><td>3</td></tr>
<tr><td></td><td>2</td><td></td><td></td></tr>
<tr><td>3</td><td>1</td><td></td><td>3</td></tr>
</tbody></table>

<p>and our shovel will scoop up a 2×2 square of cells. Thus, there are 9 possible scoops.</p>

<p>With no eggs present, 8 of the 9 scoops contain at least two species of shells and 3 of the 9 scoops contain three species of shells.</p>

<p>An egg is then dropped into the cell that contains 1, 2.</p>

<p>Then, 4 of the 9 scoops contain at least two species of shells and no eggs and only 1 scoop (the bottom-leftmost scoop) would contain all three species of shells and no eggs. The final output indicates there are no scoops which contain 4 different species of shells.</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,ccc15s2p6">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/ccc15s2p6">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 30 (partial)<br>
    <b>Time Limit:</b> 5.00s<br>
    <b>Memory Limit:</b> 512M<br>
    <b>Added:</b> Jun 05, 2015<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=ccc15s2p6">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment8104">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/thomas0115">thomas0115</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/8104">May 15, 2017 - 11:07:08 pm UTC</a>      </span>
      <a class="comment_title" id="title8104" onclick="toggle(&quot;body8104&quot;)">Grader</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating8104">
    (<span class="upvotes"><span id="upvotes8104">0</span></span>/<span class="downvotes"><span id="downvotes8104">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body8104" class="comment_body">
    <pre id="msg8104" style="display: none">Apparently the output has to match exactly now... if you output more than 5 digits then you get WA. However, for one of the cases, I still get WA when outputting exactly 5 digits.</pre>
    <div style="opacity: 1">
      Apparently the output has to match exactly now... if you output more than 5 digits then you get WA. However, for one of the cases, I still get WA when outputting exactly 5 digits.    </div>
      </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0150s.<br>
    Server time on page load:
    May 10, 2018 22:00:50 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fccc15s2p6">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>