<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - Revenge of the Digger</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "221fe9b9644c0adc95c96655c1b1b5a1";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2FRevDig"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<style type="text/css">
    #descContent span.nobr {
        white-space: nowrap;
    }
    
    #input-table {
        text-align: justify;
    }

    #input-table > tbody > tr > td:first-child {
        vertical-align: top;
        width: 100px;
        text-align: left;
    }
</style>

<h2 align="center">Revenge of the Digger</h2>

<p>In his last escapade, Digger successfully picked up the underground treasure and continued to dig down with his souped-up pneumatic drill, hoping to come up in China. To his surprise, however, he instead stumbled upon the planet core. He quickly cooks up a new plan - to rocket up to the surface via a volcano.</p>

<p>He observes <var>N</var> (1 ≤ <var>N</var> ≤ 10000) rivers of lava, as well as <var>M</var> (1 ≤ <var>M</var> ≤ 1000) lakes, which Digger has numbered 1 to <var>M</var>. Each river flows in one direction only, from one lake to another, and no two rivers run between the same pair of lakes in the same direction. Each lake has a certain flow rate - this is how many gallons of lava in total can potentially flow out of it per second (geologists claim they know the factors that affect flow rate, but really they have no idea). Exactly one lake has a flow rate of 0 - this means that this lake is volcanic and erupts from time to time. There will be no rivers flowing out of this lake.</p>

<p>The lake that Digger counts as Lake 1 is fed by the core itself, which is where all lava in the river system comes from. No rivers flow into this lake, and there will be at least one system of rivers that lead from it to the volcanic lake.</p>

<p>All rivers and lakes are originally empty, but when an eruption occurs, lava starts to gush out of the core and along the rivers so that the rate of lava flowing into the volcanic lake is maximized. Digger plans to hop into the volcanic lake (using the inflatable heat-proof raft he keeps in his pocket) and wait for an eruption to occur, but he wants to know in advance the rate of lava that will be flowing into the lake.</p><p>

</p><h3>Input</h3>

<table id="input-table">
<tbody><tr>
    <td>Line 1:</td>
    <td><var>M</var> and <var>N</var> — respectively, the number of lakes and the number of rivers.</td>
</tr>
<tr>
    <td>Lines 2..<var>M</var>+1:</td>
    <td><var>F</var> (0 ≤ <var>F</var> ≤ 10000) — the <var>i</var>-th line describes the (<var>i</var>-1)-th lake, where <var>F</var> is the flow rate (if <var>F</var> = 0, this lake is volcanic).</td>
</tr>
<tr>
    <td>Lines <var>N</var>+2:</td>
    <td><var>A</var> and <var>B</var> (1 ≤ <var>A</var>, <var>B</var> ≤ <var>M</var>) — the <var>i</var>-th line describes the (<var>i</var>-<var>M</var>-1)-th river, which flows from lake <var>A</var> to lake <var>B</var>.</td>
</tr>
</tbody></table>

<h3>Output</h3>

<p>Output the maximum rate at which lava can flow into the volcanic lake (in gallons per second).</p>

<h3>Sample Input</h3>
<pre>6 8
10
3
4
6
2
0
1 2
1 3
2 3
2 4
3 4
3 5
4 6
5 6</pre>

<h3>Explanation</h3>
<p>Below is a graphical representation of the river system (the boxed-in numbers are lakes, the adjacent numbers are their flow rates, the V denotes the volcano, and the arrows are rivers):</p>
<p align="center"><img src="images/revdig/revdig.1.png"></p>

<h3>Sample Output</h3>
<pre>7</pre>

<h3>Explanation</h3>
<p>The amount of lava that flows through each river (this is just one possible solution) is shown below:</p>
<p align="center"><img src="images/revdig/revdig.2.png"></p>

</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,RevDig">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/RevDig">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 20 (partial)<br>
    <b>Time Limit:</b> 1.00s<br>
    <b>Memory Limit:</b> 64M<br>
    <b>Added:</b> Oct 05, 2008<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>  </p>

    <b>Problem Types:</b>
  <noscript>
    &lt;style type="text/css"&gt;
      #show_types, #hide_types { display: none !important; }
      #spoiler_id { display: inline !important; }
    &lt;/style&gt;
  </noscript>
  <a href="javascript:void(null);" id="show_types" onclick="document.getElementById('spoiler_id').style.display=''; document.getElementById('show_types').style.display='none';">[Show]</a>
  <span id="spoiler_id" style="display: none">
    <a href="javascript:void(null);" id="hide_types" onclick="document.getElementById('spoiler_id').style.display='none'; document.getElementById('show_types').style.display='';">[Hide]</a><br>
    <ul style="list-style-type: none; margin: 0; padding: 0;">
      <li>Graph Theory</li>    </ul>
  </span>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=RevDig">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment638">
  <div class="comment_header" style="opacity: 0.84996429117983">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/638">Dec 05, 2008 - 1:48:45 am UTC</a>      </span>
      <a class="comment_title" id="title638" onclick="toggle(&quot;body638&quot;)">Hint</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating638">
    (<span class="upvotes"><span id="upvotes638">2</span></span>/<span class="downvotes"><span id="downvotes638">2</span></span>)
  </li>
  </ul>  </div>
  <div id="body638" class="comment_body">
    <pre id="msg638" style="display: none">Unfortunately, the only "hint" I can give is that this problem is too hard for most people to get full marks on :(

However, I can say that it's a "max-flow" graph theory problem, so you could look up the "Ford-Fulkerson's Algorithm" and try coding it, as that's the way to do this problem.</pre>
    <div style="opacity: 0.84996429117983">
      Unfortunately, the only "hint" I can give is that this problem is too hard for most people to get full marks on :( <br> <br>However, I can say that it's a "max-flow" graph theory problem, so you could look up the "Ford-Fulkerson's Algorithm" and try coding it, as that's the way to do this problem.    </div>
      </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0152s.<br>
    Server time on page load:
    May 10, 2018 21:52:44 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2FRevDig">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>