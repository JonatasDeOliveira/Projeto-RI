<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - WC15 #1 - Contest Sites</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "3d9c83c15e0f324305366b918ab3d51c";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fwc151s3"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>Woburn Challenge 2015-16 Round 1 - Senior Division</h3>
<h2>Problem 3: Contest Sites</h2>

<div style="float: right; margin-left: 20px; margin-bottom: 10px;">
  <img src="images/wc151s3/wc151s3.png" width="350px" alt="">
</div>

<p>It's no surprise that the Programming Enrichment Group at Woburn participates in a wide number of programming contests. However, not all contests are held at the same place (worry not – the Woburn Challenge finals will be held at a single location). In fact if too many people register for a contest, the contest organizers may even demand that the same contest be held in two entirely different towns! This will make it a lot harder for our young Woburnites to compete in the contest, but certainly won't stop them from trying.</p>

<p>There are <var>N</var> (2 ≤ <var>N</var> ≤ 10<sup>5</sup>) towns uniquely numbered with integers from 1 to <var>N</var>, and <var>M</var> (1 ≤ <var>M</var> ≤ 10<sup>5</sup>) one-way roads running amongst them. Specifically, the <var>i</var>-th road (for <var>i</var> = 1..<var>M</var>) allows one to travel from a town <var>A<sub>i</sub></var> to a different town <var>B<sub>i</sub></var> (1 ≤ <var>A<sub>i</sub></var>, <var>B<sub>i</sub></var> ≤ <var>N</var>; <var>A</var> ≠ <var>B</var>) and has a distance of <var>D<sub>i</sub></var> (1 ≤ <var>D<sub>i</sub></var> ≤ 100) kilometres. No two roads run between the same pair of towns in the same direction. A very large programming contest is soon to be held across two locations, with the main contest site located in town 1 and the secondary contest site located in town 2. A non-zero number of Woburnites will be competing in this contest, with <var>C<sub>i</sub></var> (0 ≤ <var>C<sub>i</sub></var> ≤ 10<sup>6</sup>) of them living in town <var>i</var> (for each <var>i</var> = 1..<var>N</var>). Each competitor must select one of the two contest sites and travel to it using a sequence of roads. This sequence is possibly empty, if they're fortunate enough to live in the same town as their chosen contest site.</p>

<p>There is a catch! Resources are limited at the second contest site, so the contest organizers have insisted that no more than <var>K</var> (0 ≤ <var>K</var> ≤ 10<sup>9</sup>) of the competitors attend the secondary site (located in town 2). Given that the Woburnites collaborate to come up with the best travel strategy, you must help them determine the minimum total combined distance that they must travel in order to all attend the contest, such that no more than <var>K</var> of them travel to the secondary site.</p>

<p>
In test cases worth 60% of the marks, <var>N</var> ≤ 100.<br>
In a subset of those cases worth 30% of the marks, <var>C<sub>i</sub></var> ≤ 1 (for <var>i</var> = 1..<var>N</var>).
</p>

<h3>Input Format</h3>
<p>
Line 1 of input will contain three space-separated integers, the values of <var>N</var>, <var>M</var>, and <var>K</var>, respectively representing the number of towns, roads, and the maximum number of Woburnites that may attend the second site.<br>
There will be <var>N</var> lines to follow. The <var>i</var>-th of these lines (for <var>i</var> = 1..<var>N</var>) will contain a single integer <var>C<sub>i</sub></var>, representing the number of Woburnites living in town <var>i</var>.<br>
There will be <var>M</var> lines to follow. The <var>i</var>-th of these lines (for <var>i</var> = 1..<var>M</var>) will contain three space-separated integers,
the values of <var>A<sub>i</sub></var>, <var>B<sub>i</sub></var>, and <var>D<sub>i</sub></var> representing the <var>i</var>-th one-way road.
</p>

<h3>Output Format</h3>
<p>
The output should consist of a single integer. If it is possible for the Woburnites to travel to all contest sites with no more than <var>K</var> of them attending the secondary site, then output the minimum total combined distance that they must travel to do so. Output <code>-1</code> if it is impossible for all of them to reach a contest site while satisfying the condition. Please note that the answer may not necessarily fit in a 32-bit integer.
</p>

<h3>Sample Input</h3>
<pre>4 5 5
2
1
5
7
1 2 1
3 2 1
3 4 1
4 1 1
4 3 1
</pre>

<h3>Sample Output</h3>
<pre>13
</pre>

<h3>Explanation</h3>

<p>There are 4 towns and 5 roads between them. At most 5 people may attend the second contest site. Each road happens to have a distance of 1. An optimal travel strategy is as follows.</p>

<ul>
<li>We let competitors from towns 1 and 2 attend the contest sites at their respective towns (incurring an additional 0 kilometres to our total distance).</li>
<li>We let all 7 of our competitors from town 4 travel to the main contest site (incurring a total of 7 kilometres).</li>
<li>We let 4/5 of the competitors from town 3 travel to the secondary contest site (incurring a total of 4 kilometres).</li>
<li>We let the remaining competitor from town 3 must travel to the main site through town 4 (incurring an additional 2 kilometres to our total distance).</li>
</ul>

<p>The total distance traveled across all of the competitors is 0 + 7 + 4 + 2 = 13 kilometres.</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,wc151s3">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/wc151s3">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 17 (partial)<br>
    <b>Time Limit:</b> 2.00s<br>
    <b>Memory Limit:</b> 16M<br>
    <b>Added:</b> Oct 17, 2015<br>
        <b>Authors:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>, <a href="https://wcipeg.com/user/Alex">Alex</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=wc151s3">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment7006">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/fifiman">fifiman</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7006">Oct 21, 2015 - 7:34:04 pm UTC</a>      </span>
      <a class="comment_title" id="title7006" onclick="toggle(&quot;body7006&quot;)">What if a contestant cant reach either site?</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7006">
    (<span class="upvotes"><span id="upvotes7006">0</span></span>/<span class="downvotes"><span id="downvotes7006">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7006" class="comment_body">
    <pre id="msg7006" style="display: none"></pre>
    <div style="opacity: 1">
          </div>
    <br><div class="comment_block" id="comment7007">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/spencereir">spencereir</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/7007">Oct 21, 2015 - 8:14:21 pm UTC</a>      </span>
      <a class="comment_title" id="title7007" onclick="toggle(&quot;body7007&quot;)">Re: What if a contestant cant reach either site?</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating7007">
    (<span class="upvotes"><span id="upvotes7007">0</span></span>/<span class="downvotes"><span id="downvotes7007">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body7007" class="comment_body">
    <pre id="msg7007" style="display: none">If a contestant can't reach either site, then there is no way to distribute all contestants. The problem statement contains information as to what should be done in this case.</pre>
    <div style="opacity: 1">
      If a contestant can't reach either site, then there is no way to distribute all contestants. The problem statement contains information as to what should be done in this case.    </div>
      </div>
</div>
  </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0237s.<br>
    Server time on page load:
    Jun 7, 2018 07:33:38 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fwc151s3">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>