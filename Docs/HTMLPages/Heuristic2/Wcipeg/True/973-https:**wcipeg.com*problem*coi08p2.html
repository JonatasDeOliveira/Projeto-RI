<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - COI08 - Otoci</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "221fe9b9644c0adc95c96655c1b1b5a1";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fcoi08p2"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>Croatian Olympiad in Informatics 2009</h3>
<h2>Task OTOCI</h2>
<p>Some time ago Mirko founded a new tourist agency named "Dreams of Ice". The agency purchased N icy islands near the South Pole and now offers excursions.</p>
<p>Especially popular are the emperor penguins, which can be found in large numbers on the islands. Mirko's agency has become a huge hit; so big that it is no longer cost-effective to use boats for the excursions. The agency will build bridges between islands and transport tourists by buses. Mirko wants to introduce a computer program to manage the bridge building process so that fewer mistakes are made.</p>
<p>The islands are numbered 1 through N. No two islands are initially connected by bridges. The initial number of penguins on each island is known. That number may change, but will always be between 0 and 1000 (inclusive).</p>
<p>Your program must handle the following three types of commands:</p>
<ul>
  <li>  "bridge A B" - an offer was received to build a bridge between islands A and B (A and B will be different). To limit costs, your program must accept the offer <strong>only if there isn't already a way</strong> to get from one island to the other using previously built bridges. If the offer is accepted, the program should output "yes", after which the bridge is built. If the offer is rejected, the program should output "no".</li>
  <li> "penguins A X" - the penguins on island A have been recounted and there are now X of them.<br>
    This is an informative command and your program does not need to respond.</li>
  <li> "excursion A B" - a group of tourists wants an excursion from island A to island B. If the excursion is possible (it is possible to get from island A to B), the program should output the <strong>total number of penguins</strong> the tourists would see on the excursion (including islands A and B). Otherwise, your program should output "impossible".</li>
</ul>
<h3>Input</h3>
The first line contains the integer N (1 ≤ N ≤ 30 000), the number of islands.<br>
The second line contains N integers between 0 and 1000, the initial number of penguins on each of the islands.<br>
The third line contains an integer Q (1 ≤ Q ≤ 300 000), the number of commands.<br>
Q commands follow, each on its own line.<br>
<h3>Output</h3>
<p>Output the responses to commands "bridge" and "excursion", each on its own line.</p>
<h3>Scoring</h3>
<p>In test cases worth 50% of points, the command "penguins" will not appear. In these test cases N will be odd, while in all other cases N will be even.</p>
  
<h3>Examples</h3>
<table class="coci">
    <tbody><tr>
      <td><h3>Sample Input</h3>
<pre>5
4 2 4 5 6
10
excursion 1 1
excursion 1 2
bridge 1 2
excursion 1 2
bridge 3 4
bridge 3 5
excursion 4 5
bridge 1 3
excursion 2 4
excursion 2 5</pre>
<br>
<h3>Sample Output</h3>
<pre>4
impossible
yes
6
yes
yes
15
yes
15
16</pre></td>
      <td><h3>Sample Input</h3>
<pre>6
1 2 3 4 5 6
10
bridge 1 2
bridge 2 3
bridge 4 5
excursion 1 3
excursion 1 5
bridge 3 4
excursion 1 5
penguins 3 10
excursion 1 3
bridge 1 5</pre>
<br>
<h3>Sample Output</h3>
<pre>yes
yes
yes
6
impossible
yes
15
13
no</pre></td>
    </tr>
</tbody></table>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,coi08p2">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/coi08p2">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 40 (partial)<br>
    <b>Time Limit:</b> 5.00s<br>
    <b>Memory Limit:</b> 128M<br>
    <b>Added:</b> Apr 27, 2009<br>
      </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=coi08p2">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment2708">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/jsn1993">jsn1993</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/2708">Jul 21, 2010 - 1:01:40 pm UTC</a>      </span>
      <a class="comment_title" id="title2708" onclick="toggle(&quot;body2708&quot;)">time limit is strict</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating2708">
    (<span class="upvotes"><span id="upvotes2708">0</span></span>/<span class="downvotes"><span id="downvotes2708">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body2708" class="comment_body">
    <pre id="msg2708" style="display: none">in COI2009's pdf it's 5s/testcase...</pre>
    <div style="opacity: 1">
      in COI2009's pdf it's 5s/testcase...    </div>
    <br><div class="comment_block" id="comment2714">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/jsn1993">jsn1993</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/2714">Jul 24, 2010 - 12:33:21 am UTC</a>      </span>
      <a class="comment_title" id="title2714" onclick="toggle(&quot;body2714&quot;)">Re: time limit is strict</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating2714">
    (<span class="upvotes"><span id="upvotes2714">0</span></span>/<span class="downvotes"><span id="downvotes2714">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body2714" class="comment_body">
    <pre id="msg2714" style="display: none">..i use gets instead of scanf, then i got ac.....</pre>
    <div style="opacity: 1">
      ..i use gets instead of scanf, then i got ac.....    </div>
    <br><div class="comment_block" id="comment2715">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/2715">Jul 25, 2010 - 1:59:12 pm UTC</a>      </span>
      <a class="comment_title" id="title2715" onclick="toggle(&quot;body2715&quot;)">Re: Re: time limit is strict</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating2715">
    (<span class="upvotes"><span id="upvotes2715">0</span></span>/<span class="downvotes"><span id="downvotes2715">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body2715" class="comment_body">
    <pre id="msg2715" style="display: none">Alright, then sure - it's been increased to 5s here.
Thanks for pointing these things out.</pre>
    <div style="opacity: 1">
      Alright, then sure - it's been increased to 5s here. <br>Thanks for pointing these things out.    </div>
      </div>
</div>
  </div>
</div>
  </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0230s.<br>
    Server time on page load:
    May 10, 2018 22:05:26 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fcoi08p2">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>