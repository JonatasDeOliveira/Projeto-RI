<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - Traffic Lights</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "8c45b434a3b7582378f7341582f131fd";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Ftraffic"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h2 align="center">Traffic Lights</h2>

<p>Jim-Bob lives in a strange city where the streets don't necessarily run NS or EW. Instead the <var>N</var> (1 ≤ <var>N</var> ≤ 100,000) streets run seemingly at random, sometimes crossing over each other by bridges, and intersecting with one another at exactly <var>K</var> (1 ≤ <var>K</var> ≤ 1,000) intersections. Each intersection consists of some streets coming together, as well as a traffic light.</p>

<p>Street <var>i</var> starts at intersection <var>s<sub>i</sub></var> (1 ≤ <var>s<sub>i</sub></var> ≤ <var>K</var>), and ends at a different intersection <var>e<sub>i</sub></var> (1 ≤ <var>e<sub>i</sub></var> ≤ <var>K</var>), going through no other intersections in between. It takes <var>t<sub>i</sub></var> (1 ≤ <var>t<sub>i</sub></var> ≤ 1,000) minutes to travel down street <var>i</var> (this number is derived from the length, the average pothole size, and the amount of roadkill). Each road can be travelled in either direction in the same amount of time.</p>

<p>The traffic lights in this city are also strange. First of all, each one only alternates between green and red. Each light also cycles through these colours at a different rate - the traffic light located at intersection <var>i</var> stays green for <var>g<sub>i</sub></var> (1 ≤ <var>g<sub>i</sub></var> ≤ 1,000) minutes, then stays red for <var>r<sub>i</sub></var> (1 ≤ <var>r<sub>i</sub></var> ≤ 1,000) minutes, then goes back to green, and so on.</p>

<p>Jim-Bob always obeys the law, and will never run a red light. If he arrives at an intersection while the light is green, he can pass right through it. Otherwise, he must wait there until the light turns green. If he gets to an intersection just as the traffic light is turning red, he must wait. It takes no time to drive through an intersection, so the light will never turn red on him as he drives through.</p>

<p>Jim-Bob starts at his house, also known as intersection <var>1</var>. As soon as he leaves his house, all the traffic lights turn green, starting their green-red-green cycle. He wishes to drive to Billy-Bob's house (which is right at intersection <var>K</var>) as fast as possible. Neither the starting nor the finishing intersection have traffic lights, so their <var>g</var> and <var>r</var> will be given as 0. Find the minimum number of minutes Jim-Bob can take to drive from his house to Billy-Bob's.</p>

<h3>Input</h3>
<p>2 integers - <var>N</var> and <var>K</var>.<br>
The next <var>N</var> lines contain 3 integers each - <var>s<sub>i</sub></var>, <var>e<sub>i</sub></var>, and <var>t<sub>i</sub></var>.<br>
The next <var>K</var> lines contain 2 integers each - <var>g<sub>i</sub></var>, and <var>r<sub>i</sub></var>.</p>

<h3>Output</h3>
<p>A single integer - the minimum number of minutes it takes to drive from Jim-Bob's house to Billy-Bob's. It will always be possible to do this.</p>

<h3>Sample Input</h3>
<pre>7 6
1 2 4
1 3 1
3 5 2
2 4 2
2 5 6
5 4 2
5 6 10
0 0
5 5
1 20
2 5
10 2
0 0</pre>

<h3>Sample Output</h3>
<pre>19</pre>

<h3>Explanation</h3>
<p>The city looks something like this (Jim-Bob's best route is shown in red):</p>
<p align="center"><img src="images/traffic/traffic.png"></p>
<p>Jim-Bob can drive to intersection 2 (4 min), drive on to intersection 4 (2 min), wait for the green light (1 min), drive down to intersection 5 (2 min), and finally drive to Billy-Bob's house (10 min). This is a total of 19 minutes.</p>
<p>Note: The traffic light at intersection 3 only stays green for 1 minute, which means that Jim-Bob would just miss it if he drove directly there. On the other hand, he makes the green lights as intersections 2 and 5 just in time, as they turn red 1 minute after he passes.</p></div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,traffic">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/traffic">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 15 (partial)<br>
    <b>Time Limit:</b> 2.00s<br>
    <b>Memory Limit:</b> 16M<br>
    <b>Added:</b> Nov 17, 2008<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=traffic">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment6010">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/xiaowuc1">xiaowuc1</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/6010">Aug 01, 2014 - 6:08:47 am UTC</a>      </span>
      <a class="comment_title" id="title6010" onclick="toggle(&quot;body6010&quot;)">Test cases 7-10 are invalid</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating6010">
    (<span class="upvotes"><span id="upvotes6010">1</span></span>/<span class="downvotes"><span id="downvotes6010">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body6010" class="comment_body">
    <pre id="msg6010" style="display: none">g_1, g_n, r_1, r_n are nonzero.</pre>
    <div style="opacity: 1">
      g_1, g_n, r_1, r_n are nonzero.    </div>
    <br><div class="comment_block" id="comment6025">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/Alex">Alex</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/6025">Aug 04, 2014 - 2:31:56 pm UTC</a>      </span>
      <a class="comment_title" id="title6025" onclick="toggle(&quot;body6025&quot;)">Re: Test cases 7-10 are invalid</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating6025">
    (<span class="upvotes"><span id="upvotes6025">0</span></span>/<span class="downvotes"><span id="downvotes6025">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body6025" class="comment_body">
    <pre id="msg6025" style="display: none">Fixed</pre>
    <div style="opacity: 1">
      Fixed    </div>
      </div>
</div>
  </div>
</div>
<br>
<div class="comment_block" id="comment639">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/639">Dec 05, 2008 - 1:50:07 am UTC</a>      </span>
      <a class="comment_title" id="title639" onclick="toggle(&quot;body639&quot;)">Hint</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating639">
    (<span class="upvotes"><span id="upvotes639">0</span></span>/<span class="downvotes"><span id="downvotes639">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body639" class="comment_body">
    <pre id="msg639" style="display: none">This is a graph theory problem that's just asking for the shortest path between 2 nodes, made trickier by the presence of traffic lights.

The algorithm to use here is called "Dijkstra's", so you can try looking that up and coding it. We'll teach this eventually in class though.</pre>
    <div style="opacity: 1">
      This is a graph theory problem that's just asking for the shortest path between 2 nodes, made trickier by the presence of traffic lights. <br> <br>The algorithm to use here is called "Dijkstra's", so you can try looking that up and coding it. We'll teach this eventually in class though.    </div>
      </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0198s.<br>
    Server time on page load:
    May 9, 2018 15:28:59 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Ftraffic">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>