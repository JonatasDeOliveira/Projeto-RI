<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - WC15 Finals - Supply Chain</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "3d9c83c15e0f324305366b918ab3d51c";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fwc15fs5"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>2015-16 Woburn Challenge Finals - Senior Division</h3>
<h2>Problem 5: Supply Chain</h2>

<img src="images/wc15fs5/wc15fs5.jpg" alt="" style="float:right; height:200px; padding:25px; padding-top: 0;">

<p>At last, the final battle for Scarberia is upon us! The cows and monkeys have agreed that the fighting will take place on a circle of <var>N</var> (3 ≤ <var>N</var> ≤ 300,000) pastures, connected to one another in a cycle by <var>N</var> two-way bridges. The <var>i</var>-th bridge can support a weight of at most <var>S<sub>i</sub></var> (1 ≤ <var>S<sub>i</sub></var> ≤ 10<sup>6</sup>) pounds, and connects pastures <var>i</var> and <var>i</var> + 1 (if 1 ≤ <var>i</var> &lt; <var>N</var>), or pastures <var>N</var> and 1 (if <var>i</var> = <var>N</var>).</p>

<p>The monkeys' base of operations is located in pasture 1, and they have troops stationed in all of the other pastures. The monkeys, being masterful makers of war, are keenly aware that the most effective soldiers are well-fed soldiers. As such, they have a convoy of <var>M</var> (1 ≤ <var>M</var> ≤ 300,000) trucks which will deliver bananas from their base daily. The <var>i</var>-th truck has a weight of <var>W<sub>i</sub></var> (1 ≤ <var>W<sub>i</sub></var> ≤ 10<sup>6</sup>) pounds, and every day, it will depart from pasture 1, driving around amongst the pastures and delivering <var>B<sub>i</sub></var> (1 ≤ <var>B<sub>i</sub></var> ≤ 10<sup>6</sup>) bananas to each other pasture that it can reach. Each truck can only cross bridges which can at least support its weight, and it can drive back and forth as much as necessary (even revisiting pastures multiple times), but it will only deliver a load of bananas to each pasture at most once. Therefore, each day, the <var>i</var>-th truck will deliver between 0 and <var>B<sub>i</sub></var>×(<var>N</var> − 1) bananas in total.</p>

<p>The battle is scheduled to last for <var>D</var> (1 ≤ <var>D</var> ≤ 300,000) days, and in order to manage their banana hoard successfully, the monkeys would like to determine how many bananas their trucks will deliver on each day. However, this aspect of the war promises to be particularly dynamic, as those dastardly cows are also well aware of the military importance of the supply chain and will attempt to sabotage it, while the monkeys will hopefully enact the necessary countermeasures. One event will occur at the start of each day (before the trucks roll out to make their deliveries, with the type of the event on the <var>i</var>-th day indicated by <var>T<sub>i</sub></var> (1 ≤ <var>T<sub>i</sub></var> ≤ 2):</p>
<ul>
<li>If <var>T<sub>i</sub></var> = 1, the cows will undermine the structural integrity of the <var>X<sub>i</sub></var>-th (1 ≤ <var>X<sub>i</sub></var> ≤ <var>N</var>) bridge, permanently reducing its maximum supported weight by <var>Y<sub>i</sub></var> (1 ≤ <var>Y<sub>i</sub></var> &lt; 10<sup>6</sup>) pounds. It's guaranteed that it will still be able to support a weight of at least 1 pound.</li>
<li>If <var>T<sub>i</sub></var> = 2, the monkeys will remodel their <var>X<sub>i</sub></var>-th (1 ≤ <var>X<sub>i</sub></var> ≤ <var>M</var>) truck such that it henceforth weighs <var>Y<sub>i</sub></var> (1 ≤ <var>Y<sub>i</sub></var> ≤ 10<sup>6</sup>) pounds. Note that this could cause its weight to increase (thanks to cows cleverly disguised as monkey mechanics).</li>
</ul>

<p>The outcome of the entire war, and the monkeys' opportunity to reclaim Scarberia once and for all, depends on this supply chain! Can you help the monkeys determine how many bananas their trucks will deliver in total on each of the <var>D</var> days of the battle?</p>

<p>
In test cases worth 6/33 of the points, <var>N</var> ≤ 200, <var>M</var> ≤ 200, and <var>D</var> ≤ 200.<br>
In test cases worth another 8/33 of the points, <var>N</var> ≤ 2000, <var>M</var> ≤ 2000, and <var>D</var> ≤ 2000.<br>
In test cases worth another 8/33 of the points, <var>T<sub>i</sub></var> = 1.<br>
In test cases worth another 8/33 of the points, <var>T<sub>i</sub></var> = 2.
</p>

<h3>Input Format</h3>
<p>
The first line of input consists of three space-separated integers, <var>N</var>, <var>M</var>, and <var>D</var>.<br>
<var>N</var> lines follow. The <var>i</var>-th of these lines consists of a single integer, <var>S<sub>i</sub></var> (for <var>i</var> = 1..<var>N</var>).<br>
<var>M</var> lines follow. The <var>i</var>-th of these lines consists of two space-separated integers, <var>W<sub>i</sub></var> and <var>B<sub>i</sub></var> (for <var>i</var> = 1..<var>M</var>).<br>
<var>D</var> lines follow. The <var>i</var>-th of these lines consists of three space-separated integers, <var>T<sub>i</sub></var>, <var>X<sub>i</sub></var>, and <var>Y<sub>i</sub></var> (for <var>i</var> = 1..<var>D</var>).
</p>

<h3>Output Format</h3>
<p>
Output <var>D</var> lines. The <var>i</var>-th line of output should consist of a single integer representing the total number of bananas delivered on the <var>i</var>-th day (for <var>i</var> = 1..<var>D</var>).<br>
Note that each of these values may not fit within a 32-bit integer.
</p>

<h3>Sample Input</h3>
<pre>4 5 4
5
4
2
8
3 5
1 100
2 1
5 20
6 4
2 2 100
1 4 3
1 4 4
2 2 1
</pre>

<h3>Sample Output</h3>
<pre>62
58
33
333
</pre>

<h3>Explanation</h3>
<p>
On the first day, the first truck will deliver 5 bananas each to pastures 2, 3, and 4. The second truck, now weighing 100 pounds, won't deliver any bananas. The third truck will deliver 1 banana to each of those 3 pastures, the fourth will deliver 20 bananas to pastures 2 and 4, and the fifth will deliver 4 bananas to just pasture 4. The total number of bananas delivered on this day will then be 5×3 + 1×3 + 20×2 + 4×1 = 62.
</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,wc15fs5">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/wc15fs5">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 30 (partial)<br>
    <b>Time Limit:</b> 5.00s<br>
    <b>Memory Limit:</b> 64M<br>
    <b>Added:</b> May 07, 2016<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=wc15fs5">Search</a>)</h2><p style="text-align: center"></p>It's quiet in here...</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0124s.<br>
    Server time on page load:
    Jun 7, 2018 07:34:21 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fwc15fs5">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>