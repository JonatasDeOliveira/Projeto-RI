<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - CCC14 Stage 2 - Early Exam Evacuation</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "8c45b434a3b7582378f7341582f131fd";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fccc14s2p5"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>2014 Canadian Computing Competition, Stage 2</h3>
<h2>Day 2, Problem 2: Early Exam Evacuation</h2>

<p>You find yourself writing an exam in a long, narrow auditorium - it has <var>N</var> (1 ≤ <var>N</var> ≤ 10<sup>5</sup>) rows, numbered 1..<var>N</var> from the front to the back, each of which has 6 seats, 3 on each side of the aisle running down the middle of the auditorium. Each seat is identified by its row number immediately followed by a letter from "A" to "F", which indicates its position in that row (with seat "A" at the far left, and "F" at the far right). The aisle lies between seats "C" and "D" in each row. The auditorium also has two secure rooms - one at the front (in front of row 1), and one at the back (behind row <var>N</var>).</p>

<p>Every seat in the auditorium is initially occupied by exactly one exam-writer per seat. However, over the course of the exam,M different exam writers decide that they have written all they can on the exam, and then would like to leave the auditorium, one after another. The <var>i</var>-th exam writer is in seat <var>R<sub>i</sub>C<sub>i</sub></var> (1 ≤ <var>R<sub>i</sub></var> ≤ <var>N</var>, <var>C<sub>i</sub></var> is one of "A".."F"). When the exam writer leaves the auditorium, they must stay in one of the secure rooms until the end of the exam. Fortunately, both secure rooms can hold as many people as necessary.</p>

<p>Exam writers not only worry about writing exams, but they would like their lives to be as convenient as possible - as such, they're interesting in working together to minimize the total inconvenience experienced by all of them. The inconvenience a single exam-writer experiences is <var>Ax</var> + <var>By</var>, where <var>A</var> and <var>B</var> are given constants (0 ≤ <var>A</var>, <var>B</var> ≤ 10<sup>9</sup>), <var>x</var> is the number of different people passed on the way to the chosen secure room (explained below), and <var>y</var> is the number of people already in that secure room before that exam-writer enters. Note that if an exam-writer does not leave their seat, their inconvenience is 0.</p>

<p>When walking from a seat to a secure room, one must first pass any other exam writers in the same row on the way to the aisle, and then any exam writers in seats adjacent to the aisle from that row to either row 1 or <var>N</var> (depending on which secure room is chosen), inclusive. Note that any vacant seats passed along the way don't count towards this value.</p>

<p>Can you help the poor exam writers make their lives as convenient as possible?</p>

<h3>Input</h3>
<p>The first line contains four space-separated integers: <var>N</var> (1 ≤ <var>N</var> ≤ 10<sup>5</sup>), the number of rows in the auditorium; <var>M</var> (1 ≤ <var>M</var> ≤ 6<var>N</var>), the number of exam writers that leave early; <var>A</var>, followed by <var>B</var> (1 ≤ <var>A</var>, <var>B</var> ≤ 10<sup>9</sup>), the constants used in determining the inconvenience caused by an exam writer leaving early.</p>

<p>The next <var>M</var> lines each contain one integer followed by one character, <var>R<sub>i</sub></var> and <var>C<sub>i</sub></var>, for <var>i</var> = 1..<var>N</var> in order, where 1 ≤ <var>R<sub>i</sub></var> ≤ <var>N</var> and <var>C<sub>i</sub></var> ∈ "A".."F".</p>

<p>You can assume that for test cases worth 60% of the marks, <var>M</var> ≤ 5000</p>

<h3>Output</h3>

<p>Output the integer which is the minimum total inconvenience experienced by all M exam writers who leave early.</p>

<h3>Sample Input</h3>
<pre>5 5 3 4
3E
1D
5C
1E
4A
</pre>

<h3>Sample Output</h3>
<pre>55
</pre>

<h3>Explanation</h3>
<p>One optimal strategy is as follows. The first person to leave can go to the front secure room, passing six people along the way (in seats 3D, 3C, 2D, 2C, 1D, and 1C) for an inconvenience of 3·6 + 4·0 = 18. The second person to leave can also go to the front secure room, passing only one person (in seat 1C) and finding one person already in the secure room, for an inconvenience of 3·1 + 4·1 = 7. The third person can go to the back secure room, passing one person for an inconvenience of 3. The fourth person can join the first two in the front secure room, passing only one person (as seat 1D is vacant at that point) for an inconvenience of 11. Finally, the fifth person to leave can go to the back secure room, passing four people and meeting one person in the back secure room for an inconvenience of 16. The total inconvenience experienced by the exam writers with this strategy is 18 + 7 + 3 + 11 + 16 = 55.</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,ccc14s2p5">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/ccc14s2p5">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 25 (partial)<br>
    <b>Time Limit:</b> 2.00s<br>
    <b>Memory Limit:</b> 64M<br>
    <b>Added:</b> May 17, 2014<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=ccc14s2p5">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment5855">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/frenzybenzy">frenzybenzy</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/5855">May 18, 2014 - 5:13:54 am UTC</a>      </span>
      <a class="comment_title" id="title5855" onclick="toggle(&quot;body5855&quot;)">Warning</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating5855">
    (<span class="upvotes"><span id="upvotes5855">1</span></span>/<span class="downvotes"><span id="downvotes5855">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body5855" class="comment_body">
    <pre id="msg5855" style="display: none">Answers may overflow 32-bit integers</pre>
    <div style="opacity: 1">
      Answers may overflow 32-bit integers    </div>
    <br><div class="comment_block" id="comment5856">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/ImbaCalvin">ImbaCalvin</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/5856">May 18, 2014 - 1:31:13 pm UTC</a>      </span>
      <a class="comment_title" id="title5856" onclick="toggle(&quot;body5856&quot;)">Re: Warning</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating5856">
    (<span class="upvotes"><span id="upvotes5856">3</span></span>/<span class="downvotes"><span id="downvotes5856">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body5856" class="comment_body">
    <pre id="msg5856" style="display: none">it may actually overflow 64-bit integers... but the test datas aren't that mean...</pre>
    <div style="opacity: 1">
      it may actually overflow 64-bit integers... but the test datas aren't that mean...    </div>
      </div>
</div>
  </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0219s.<br>
    Server time on page load:
    May 9, 2018 15:30:06 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fccc14s2p5">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>