<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - WC15 #3 - Detective Work</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "3d9c83c15e0f324305366b918ab3d51c";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fwc153s2"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<h3>Woburn Challenge 2015-16 Round 3 - Senior Division</h3>
<h2>Problem 2: Detective Work</h2>

<img src="images/wc153s2/wc153s2.png" alt="" style="float:right; height:200px; padding:25px; padding-top: 0;">

<p>While Superman was preparing in secrecy for the fight to come, feelings of fever, rage and powerlessness were festering within the dark knight of Gotham. He can do nothing but watch as the planet praise an alien capable of annihilating it. The peace of Gotham he fought so long to protect is now compromised by a godly figure that has unworthily gained the world's reverence.</p>

<p>To take care of this threat for good, the masked billionaire will have to elaborate a plan like no other he's ever concocted. In preparation, Batman plans on doing some heavy-duty detective work to figure out Superman's weaknesses. The logical place to start is by determining his secret identity. After compiling an abundance of data on Superman's movements and past battles, as well as newspaper articles written about him, he will need a program that can efficiently cross-reference them to fill in the missing pieces and hopefully uncover the man behind Superman. As the new intern of the batcave, your first task is to write a cryptanalysis program that can process the compiled data to help Batman figure out who Superman really is.</p>

<p>The data that Batman has compiled consists of <var>N</var> (1 ≤ <var>N</var> ≤ 1000) uppercase, alphabetical strings <var>S</var><sub>1</sub>, …, <var>S<sub>N</sub></var>, each of length <var>M</var> (1 ≤ <var>M</var> ≤ 500). A good detective knows that no data from the real world is ever fully complete or accurate, so Batman has decided to represent unknown information in the strings with wildcard letters denoted by question marks. Specifically, each of these <var>N</var> strings will only consist of uppercase letters from "<code>A</code>" to "<code>Z</code>", as well as special wildcard characters ("<code>?</code>"). The instincts of the world's greatest detective tell him that it will be possible to transform all of these strings into the same string (any string <var>X</var> of Batman's choice, made up of <var>M</var> letters), and hopefully this will be the real name of Superman. To accomplish this, some of the letters in the strings may be replaced with other letters at a cost of 1 each. But for this method to be effective in actually extracting useful data, the number of letters changed must be as small as possible! The lower the total cost, the more likely it is for the result to be accurate. Each wildcard character can also be changed into any letter of Batman's choice, at no cost.</p>

<p>But measuring this cost is not definitive, so Batman would also like to know the "error" of the process. In particular, this error is defined as the number of different strings <var>X</var> that Batman can choose, such that all <var>N</var> strings can be transformed into <var>X</var> with this minimal cost. Knowing this error is important, because the larger the total number of possibilities, the less likely that <var>X</var> is the actual name of Superman. Since this error value can actually get very large, Batman doesn't care any more than the last 3 digits (if the error is in the thousands or more, the data is unreliable anyway). So you are only required to compute the error modulo 1000. For example, if the error is 2016, simply output 16. Fortunately, Batman is also a genius-level number theorist so he has made you aware of the following two identities, which may prove useful:</p>

<ul>
<li>(<var>A</var> + <var>B</var>) mod <var>M</var> = ((<var>A</var> mod <var>M</var>) + (<var>B</var> mod <var>M</var>)) mod <var>M</var></li>
<li>(<var>A</var> × <var>B</var>) mod <var>M</var> = ((<var>A</var> mod <var>M</var>) × (<var>B</var> mod <var>M</var>)) mod <var>M</var></li>
</ul>

<p>Will Batman be able to solve one of the greatest-kept secrets in the world to help him defeat the most dangerous being in the world? His fate rests in your hands.</p>

<h3>Input Format</h3>
<p>
The first line of input will contain two space-separated integers <var>N</var> and <var>M</var>.<br>
The next <var>N</var> lines will each contain a single string, where line <var>i</var> contains <var>S<sub>i</sub></var>, for <var>i</var> = 1..<var>N</var>.
</p>

<h3>Output Format</h3>
<p>
The output should be a single line consisting of two space-separated integers.
The first integer should be the cost, i.e. the minimum possible number of letters which must be changed to allow all <var>N</var> words to be turned into the same word.
The second integer should be the error, i.e. the number of ways in which this can be accomplished (modulo 1000).
</p>

<h3>Sample Input 1</h3>
<pre>4 9
??ARKKANT
CL?RK?ENT
SUPERGIRL
???RK?UNT
</pre>

<h3>Sample Output 1</h3>
<pre>11 64
</pre>

<h3>Explanation 1</h3>
<p>All four strings can be turned into the word "<code>CLARKKENT</code>" with minimal cost. The second string can be transformed to that with no extra cost, since the wildcard characters line up. The last "<code>A</code>" is wrong in the first string, so it will take a cost of 1 to make it an "<code>E</code>". The third string shares no matching letters whatsoever with "<code>CLARKKENT</code>", and therefore all 9 letters of it should be swapped. Finally, the "<code>U</code>" in the last string is incorrect, and should be switched for an "<code>E</code>" at a cost of 1. Similarly, there are 64 other words that may be reached by making exactly 11 replacements.</p>

<h3>Sample Input 2</h3>
<pre>1 3
???
</pre>

<h3>Sample Output 2</h3>
<pre>0 576
</pre>

<h3>Explanation 2</h3>
<p>
With only one string, any assignment of the wildcard characters to letters will suffice. Each one can independently be turned into any of the 26 letters, so there are 26<sup>3</sup> = 17576 possibilities. This set of data is clearly not that helpful for Batman.
</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,wc153s2">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/wc153s2">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 10<br>
    <b>Time Limit:</b> 2.00s<br>
    <b>Memory Limit:</b> 16M<br>
    <b>Added:</b> Feb 13, 2016<br>
        <b>Authors:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>, <a href="https://wcipeg.com/user/Alex">Alex</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=wc153s2">Search</a>)</h2><p style="text-align: center"></p>It's quiet in here...</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0179s.<br>
    Server time on page load:
    Jun 7, 2018 07:33:59 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fwc153s2">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>