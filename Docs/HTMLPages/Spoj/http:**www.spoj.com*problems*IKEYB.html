<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html class="not-ie" lang="en"> <!--<![endif]-->
<head>
	<!-- main header -->
	<meta charset="utf-8">
	
				<title>SPOJ.com - Problem IKEYB</title>
		  
	<meta name="keywords" content="language, algorithm, spoj, contest, contester, Java, C#, Pascal, C, C++, python, ruby, caml, ocaml, perl, haskell, lisp, prolog, fortran, assembler, asembler, functional, online, judge, problem, problemset, ACM">
  	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  
  		<meta property="og:title" content="SPOJ.com - Problem IKEYB"/>
    <meta property="fb:app_id"      content="321676846207" />
	<meta property="og:type" content="spoj-pl:problem"/>
	<meta property="og:url" content="http://www.spoj.com/problems/IKEYB/"/>
	<meta property="og:image" content="//stx1.spoj.com/gfx/logo-cr.png"/>
	<meta property="og:description" content="..."/>
	<meta name="description" content="..."/>
		<meta property="og:site_name" content="spoj.com"/>

  <!--[if (gte IE 9)|!(IE)]>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" id="metatag">
  <![endif]--> 

	  <!-- Favicon -->
	  <link href="//stx1.spoj.com/gfx/favicon_new.png" rel="shortcut icon" type="image/x-icon" />
	  
	  <!-- RSS -->
	  <link href="/rss/" rel="alternate" type="application/rss+xml" title="RSS Feed">
	
	  <!-- Web Fonts -->
	  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet" type="text/css">  

	<!-- Internet Explorer condition - HTML5 shim, for IE6-8 support of HTML5 elements -->
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]--> 
	
	
	
	<!-- CSS: Bootstrap, Font-awesome, Bootstrap libs,  -->
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet" />
  	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
  	<link href="//stx1.spoj.com/gfx/bootstrap-tour/build/css/bootstrap-tour.min.css" rel="stylesheet" />
  	<link href="//stx1.spoj.com/themes/bootstrap-social.css" rel="stylesheet" type="text/css" />
  	
	<link href="//stx1.spoj.com/themes/common.css?4" rel="stylesheet" type="text/css" id="theme0" />
	<link href="//stx1.spoj.com/themes/en_new.css?4" rel="stylesheet" type="text/css" id="theme" />
	
	<!-- JS -->
	<script type="text/javascript" src='//code.jquery.com/jquery-1.11.1.min.js'></script>
	<script type="text/javascript" src="//code.jquery.com/ui/1.11.2/jquery-ui.min.js"></script>
	
		
		
	<script type="text/javascript" language="javascript">
	$(function () { 
		$("#profile-menu").popover();
	});
	function UnCryptMailto(s) {
		var n=0;
		var r="";
		for(var i=0;i<s.length;i++) {		
			n=s.charCodeAt(i); 
			if (n>=8364) {n = 128;}
			r += String.fromCharCode(n+(2));	
		}
		return r;
	}
	function linkTo_UnCryptMailto(s)	{
		location.href=UnCryptMailto(s);
	}
	</script>
	
	<script type="text/javascript">
	function recordOutboundLink(link, category, action) {
	  try {
	    var pageTracker=_gat._getTracker("UA-XXXXX-X");
	    pageTracker._trackEvent(category, action);
	    setTimeout('document.location = "' + link.href + '"', 100)
	  }catch(err){}
	}
	</script>
	
</head>

<body>

	
	<!-- <div class="space30"></div> -->
	
	<!-- Content -->
	<div class="content">
		<div class="container" id="header">
			<div class="row">
				<div class="col-md-12 text-right">
										<form method="post" style="display: none;" action="/login/" id="login-form">
						<div class="row">
							<div class="col-md-10 col-md-offset-2">
								<input type="hidden" name="next_raw" value="/"/>
								<input type="hidden" name="autologin" value="1"/>
								<input type="text" name="login_user" placeholder="Username" class="form-control input-sm" style="display: inline-block; width: 25%;"/>
								<input type="password" name="password" placeholder="Password" class="form-control input-sm" style="display: inline-block; width: 25%;"/>
																<button type="submit" class="btn btn-default btn-sm" style="display: inline-block; margin-right: 10px;"><span class="fa fa-sign-in fa-lg"></span> <strong>sign in</strong></button>
																<a href="/register"><i class="fa fa-user-plus"></i> sign up</a> 
								<a href="/forgot"><i class="fa fa-question-circle"></i> forgot</a>
				        									</div>
						</div>
					</form>
										
					
				</div>
			</div>
		
			<div class="row">
				<div class="col-md-4">
					<a href="/" class="navbar-brand">
						<img src="//stx1.spoj.com/gfx/2015e.png" style="height: 40px;"/>
					</a>
					<div class="navbar-header">
				      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
				        <span class="sr-only">Toggle navigation</span>
				        <i class="fa fa-bars"></i>
				      </button>
				    </div>
				</div>
				<div class="col-md-8" id="menu">
				
					
					<div class="row">
					<nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation"  style="border: 0px;">
				      <ul class="nav navbar-nav" style="  float: right; margin-top: 10px;">
				      						        <li class="active">
					          <a href="/problems"><i class="fa fa-puzzle-piece"></i> PROBLEMS</a>
					        </li>
					        					        <li >
					          <a href="/status"><i class="fa fa-circle"></i> STATUS</a>
					        </li>
					        <li >
					          <a href="/ranks"><i class="fa fa-trophy"></i> RANKS</a>
					        </li>
					        <li >
					          <a href="http://spoj.com/forum"><i class="fa fa-comments-o"></i> DISCUSS</a>
					        </li>
					        <li >
					          <a href="/contests">CONTESTS</a>
					        </li>
											        					        <li >
					        	<a href="/login" class="text-success" onclick="$('#login-form').show(); $('input[name=login_user]').focus(); return false;"><i class="fa fa-sign-in"></i> sign in</a>
					        </li>
					        						
				        
				      </ul>
				    </nav>
				    </div>
				    
				    
				</div>
			</div>
			
		</div>
		
		<div class="container" id="menu">
			
		</div>
		
		<div class="container" id="content">
		<script type='text/javascript' src='/gfx/jquery.cxhelp2.js'></script>



 <!-- wykorzystywane w pcontent.html (by wiele) -->

<div class="submenu">
	
		<ol class="breadcrumb">
	  <li><a href="/problems">Problems</a></li>
	  <li><a href="/problems/classical">classical</a></li>
	  <li class="active">I-Keyboard</li>
	</ol>
		
	<ol class="navbar-right">
						
				<li><a href="/status/IKEYB/" class="">Status</li></a>
		<li><a href="/ranks/IKEYB/" class="">Ranking</li></a>
	</ol>
</div>


	<script type="text/javascript">
		var number_of_voteboxes = "";
	</script>


<div class="row first-row">
	<div class="col-lg-8 col-md-8">
		<div class="prob" style="position: relative">

			<!-- google_ad_section_start -->
			<!-- plik z pomoca kontekstowa (cxhelp_*) dziedziczony po pindex.html -->



<script type="text/javascript" src="/gfx/jscripts/tiny_mce/plugins/asciimath/js/ASCIIMathMLwFallback.js"></script>
<!--script type="text/javascript" src="/gfx/jscripts/tiny_mce/plugins/asciisvg/js/ASCIIsvgPI.js"></script-->
<script type="text/javascript">
<!--
var AScgiloc = 'http://www.imathas.com/imathas/filter/graph/svgimg.php';
var AMTcgiloc = "/files/gif/";
-->
</script>


<div class="text-center"><center>
	<div class="aProblemTop c728x90"><div class="no_a_info"></div><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:inline-block;width:728px;height:90px"
     data-ad-client="ca-pub-4453360425583535"
     data-ad-slot="1073332635"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
	</center>
</div>
<br/>

<h2 id="problem-name" class="text-center">IKEYB - I-Keyboard</h2>


<div class="row">
	<div id="problem-tags" class="col-lg-12 text-center">
				<i>no tags</i>&nbsp;
				</div>
</div>
<br/>

<div id="problem-body">
	<P>
Most of you have probably tried to type an&nbsp;SMS message on the keypad of
a&nbsp;cellular phone. It is sometimes very annoying to write longer messages,
because one key must be usually pressed several times to produce a&nbsp;single
letter. It is due to a&nbsp;low number of keys on the keypad. Typical phone has
twelve keys only (and maybe some other control keys that are not used for
typing). Moreover, only eight keys are used for typing 26&nbsp;letters of
an&nbsp;English alphabet. The standard assignment of letters on the keypad is
shown in the left picture:

<P>

<TABLE ALIGN=CENTER><TR><TD>

<TABLE BORDERCOLOR=BLACK CELLPADDING=3 CELLSPACING=0 BORDER="1">
<TR><TD ALIGN="CENTER">1<BR>&nbsp;</td>
<TD ALIGN="CENTER">2<BR>abc</td>
<TD ALIGN="CENTER">3<BR>def</td>
</tr>
<TR><TD ALIGN="CENTER">4<BR>ghi</td>
<TD ALIGN="CENTER">5<BR>jkl</td>
<TD ALIGN="CENTER">6<BR>mno</td>
</tr>
<TR><TD ALIGN="CENTER">7<BR>pqrs</td>
<TD ALIGN="CENTER">8<BR>tuv</td>
<TD ALIGN="CENTER">9<BR>wxyz</td>
</tr>
<TR><TD ALIGN="CENTER">*<BR>&nbsp;</td>
<TD ALIGN="CENTER">0<BR><EM>space</em></td>
<TD ALIGN="CENTER">#<BR>&nbsp;</td>
</tr>
</table>

</td><TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><TD>

<TABLE BORDERCOLOR=BLACK CELLPADDING=3 CELLSPACING=0 BORDER="1">
<TR><TD ALIGN="CENTER">1<BR>&nbsp;</td>
<TD ALIGN="CENTER">2<BR>abcd</td>
<TD ALIGN="CENTER">3<BR>efg</td>
</tr>
<TR><TD ALIGN="CENTER">4<BR>hijk</td>
<TD ALIGN="CENTER">5<BR>lm</td>
<TD ALIGN="CENTER">6<BR>nopq</td>
</tr>
<TR><TD ALIGN="CENTER">7<BR>rs</td>
<TD ALIGN="CENTER">8<BR>tuv</td>
<TD ALIGN="CENTER">9<BR>wxyz</td>
</tr>
<TR><TD ALIGN="CENTER">*<BR>&nbsp;</td>
<TD ALIGN="CENTER">0<BR><EM>space</em></td>
<TD ALIGN="CENTER">#<BR>&nbsp;</td>
</tr>
</table>

</td></tr>
</table>

<P>
There are 3 or 4 letters assigned to each key. If you want the first letter
of any group, you press that key once. If you want the second letter, you
have to press the key twice. For other letters, the key must be pressed three
or four times. The authors of the keyboard did not try to optimise the layout
for minimal number of keystrokes. Instead, they preferred the even
distribution of letters among the keys. Unfortunately, some letters are more
frequent than others. Some of these frequent letters are placed on the third
or even fourth place on the standard keyboard. For
example, <TT>S</tt> is a&nbsp;very common letter in an&nbsp;English alphabet, and we need
four keystrokes to type it. If the assignment of characters was like in the
right picture, the keyboard would be much more comfortable for typing average
English texts.

<P>
ACM have decided to put an&nbsp;optimised version of the keyboard on its new
cellular phone. Now they need a&nbsp;computer program that will find an&nbsp;optimal
layout for the given letter frequency. We need to preserve alphabetical
order of letters, because the user would be confused if the letters were
mixed. But we can assign any number of letters to a&nbsp;single key.

<P>
<H3>Input</h3>

<P>
There is a&nbsp;single positive integer <VAR>T</var> on the first line of input (equal to about 2000). It stands
for the number of test cases to follow. Each test case begins with a&nbsp;line
containing two integers <VAR>K</var>, <VAR>L</var> (1  &lt;= <VAR>K</var>  &lt;= <VAR>L</var>  &lt;= 90) separated by
a&nbsp;single space. <VAR>K</var> is the number of keys, <VAR>L</var> is the number of letters to be
mapped onto those keys. Then there are two lines. The first
one contains exactly <VAR>K</var> characters each representing a&nbsp;name of one
key. The second line contains exactly <VAR>L</var> characters representing names
of letters of an&nbsp;alphabet. Keys and letters are represented by digits,
letters (which are case-sensitive), or any punctuation characters (ASCII code
between 33 and 126 inclusively). No two keys have the same character, no two
letters are the same. However, the name of a&nbsp;letter can be used also as
a&nbsp;name for a&nbsp;key.

<P>
After those two lines, there are exactly <VAR>L</var> lines each containing exactly
one positive integer <VAR>F</var><SUB>1</sub>, <VAR>F</var><SUB>2</sub>, ... <VAR>F</var><SUB><VAR>L</var></sub>. These numbers determine the
frequency of every letter, starting with the first one and continuing with
the others sequentially. The higher number means the more common letter. No
frequency will be higher than 100000.

<P>
<H3>Output</h3>

<P>
Find an&nbsp;optimal keyboard for each test case. Optimal keyboard is such that
has the lowest "price" for typing average text. The <EM>price</em> is determined
as the sum of the prices of each letter. The price of a&nbsp;letter is a&nbsp;product
of the&nbsp;letter frequency (<VAR>F</var><SUB><VAR>i</var></sub>) and its position on the key. The order of
letters cannot be changed, they must be grouped in the given order.

<P>
If there are more solutions with the same price, we will try to maximise the
number of letters assigned to the last key, then to the one before the last
one etc.

<P>
More formally, you are to find a&nbsp;sequence <VAR>P</var><SUB>1</sub>, <VAR>P</var><SUB>2</sub>, ... <VAR>P</var><SUB><VAR>L</var></sub> 
representing the position of every letter on a&nbsp;particular key. The sequence
must meet following conditions:
<div align=left>
<UL>
<LI><VAR>P</var><SUB>1</sub> = 1
<LI>for each <VAR>i</var>&gt;1, either 
<VAR>P</var><SUB><VAR>i</var></sub> = <VAR>P</var><SUB><VAR>i</var>-1</sub>+1 or <VAR>P</var><SUB><VAR>i</var></sub> = 1
<LI>there are at most <VAR>K</var> numbers <VAR>P</var><SUB><VAR>i</var></sub> such that <VAR>P</var><SUB><VAR>i</var></sub> = 1
<LI>the sum of products <VAR>S</var><SUB><VAR>P</var></sub> = 
Sum[i=1..l]
<VAR>F</var><SUB><VAR>i</var></sub>.<VAR>P</var><SUB><VAR>i</var></sub> is minimal
<LI>for any other sequence <VAR>Q</var> meeting these criteria and with the same
  sum <VAR>S</var><SUB><VAR>Q</var></sub> = <VAR>S</var><SUB><VAR>P</var></sub>, there exists such <VAR>M</var>, 
1 &lt;= <VAR>M</var> &lt;= <VAR>L</var> that for any <VAR>J</var>,
  <VAR>M</var>&lt;<VAR>J</var> &lt;= <VAR>L</var>, <VAR>P</var><SUB><VAR>J</var></sub> = <VAR>Q</var><SUB><VAR>J</var></sub>, and <VAR>P</var><SUB><VAR>M</var></sub>&gt;<VAR>Q</var><SUB><VAR>M</var></sub>.
</ul>
</div>
<P>
The output for every test case must start with a&nbsp;single line saying
<TT>Keypad #</tt><VAR>I</var><TT>:</tt>, where <VAR>I</var> is a&nbsp;sequential order of the test case,
starting with 1. Then there must be exactly <VAR>K</var> lines, each representing one
letter, in the same order that was used in input. Each line must contain the
character representing the key, a&nbsp;colon, one space and a&nbsp;list of letters
assigned to that particular key. Letters are not separated from each other.

<P>
Print one blank line after each test case, including the last one.


<h3>Example</h3>
<p>Sample Input:</p>

<PRE>
<tt>1
8 26
23456789
ABCDEFGHIJKLMNOPQRSTUVWXYZ
3371
589
1575
1614
6212
971
773
1904
2989
123
209
1588
1513
2996
3269
1080
121
2726
3083
4368
1334
518
752
427
733
871
</tt>
</pre>

<p>Sample Output:</p>

<PRE>
<tt>Keypad #1:
2: ABCD
3: EFG
4: HIJK
5: LM
6: NOPQ
7: RS
8: TUV
9: WXYZ
</tt></pre>
<b>Warning: large Input/Output data, be careful with certain languages</b>
</div>

<div class="text-center">
	<a href="/submit/IKEYB/" class="btn btn-primary btn-lg"><i class="fa fa-send"></i> Submit solution!</a>
</div>
			<!-- google_ad_section_end -->
			
			<div id="ccontent">
			<!-- google_ad_section_start -->
			
<hr style="clear:both;"/>
<a href="#" onclick="toggleComments(); return false;"><span id="comments_sh">hide</span> comments</a><br/>

<a id="comments"></a>
<table id="comments_table" width="100%">
		<tr>
		<td colspan="2">
		<ul class="pagination" style="">
			<li class="disabled"><span>&lt;</span></li>
		<li class="disabled"><span>Previous</span></li>
						<li class="active"><span>1</span></li> 
							<li><a href="/problems/IKEYB/cstart=10" class="pager_link">2</a></li> 
						<li><a href="/problems/IKEYB/cstart=10" class="pager_link">Next</a></li>
		<li><a href="/problems/IKEYB/cstart=10" class="pager_link">&gt;</a></li>
	</ul>
		</td>
	</tr>
	<tr>
		<td colspan="2">
				</td>
	</tr>
	
	<script language="JavaScript">
	<!--
	$(document).ready(function(){
        $('.pager_link').bind('click', function(me){
                var href=$(me.currentTarget).attr('href');
		$('#ccontent').animate({opacity: 0.5},1);
                $.ajax({
                        type: "GET",
                        url: href+",ajax=1",
                        contentType: "application/x-www-form-urlencoded;charset=ISO-8859-2",
                        success: function(data){
                                $('#ccontent').html(data);
				$('#ccontent').animate({opacity: 1.0},1);
                        },
                        error: function(err){
                                alert('error');
                        }
                });
                return false;
        });
	});
	-->
	</script>
	



			
	<tr>
		<td width="50" style="vertical-align:top;">
			<img src="http://www.gravatar.com/avatar/fbe3dc490ab0134d2d060696c6b47576?s=40&20150116"/>
		</td>
		<td class="comm comm_odd">
			<a href="/users/neils_mah">neils_mah</a>: 
								<span style="font-size: 10px; color: #666;">2017-08-21 12:46:06</span>
		<br/>
				<p>Problem with h and I.<br/>In example given above.</p>
						</td>
	</tr>
				
	<tr>
		<td width="50" style="vertical-align:top;">
			<img src="http://www.gravatar.com/avatar/e9253f3496ced024665fe9bf20da08d4?s=40&20150116"/>
		</td>
		<td class="comm comm_even">
			<a href="/users/tni_mdixit">tni_mdixit</a>: 
								<span style="font-size: 10px; color: #666;">2016-12-17 15:23:21</span>
		<br/>
				<p>@Alex can u please explain the logic by greedy?</p>
						</td>
	</tr>
				
	<tr>
		<td width="50" style="vertical-align:top;">
			<img src="http://www.gravatar.com/avatar/6a71c31f294de81b8c73d339bef47327?s=40&20150116"/>
		</td>
		<td class="comm comm_odd">
			<a href="/users/sarvesh_19">sarvesh_19</a>: 
								<span style="font-size: 10px; color: #666;">2016-06-23 10:46:14</span>
		<br/>
				<p>Nice dp to complete century.Concept is easy only problem i face during implementation is how to store alphabets corr to key.<br/>Word Wrap knowledge is not required quite intutive.<br/>Happy Coding.</p>
				<b>Last edit: 2016-06-23 10:51:03</b>
						</td>
	</tr>
				
	<tr>
		<td width="50" style="vertical-align:top;">
			<img src="http://www.gravatar.com/avatar/47e5211471286251db9c6ac19be06919?s=40&20150116"/>
		</td>
		<td class="comm comm_even">
			<a href="/users/shivang_bansal">shivang_bansal</a>: 
								<span style="font-size: 10px; color: #666;">2016-05-20 08:15:56</span>
		<br/>
				<p>Misinterpretation of the line "there are at most K numbers Pi such that Pi = 1" costed me 2 WE. :P :D<br/>Rest is an just extension of Word Wrap problem. ^_^<br/><br/>Hint : Read ALL the conditions very carefully.</p>
						</td>
	</tr>
				
	<tr>
		<td width="50" style="vertical-align:top;">
			<img src="http://www.gravatar.com/avatar/d2e72575e76284082d883ecd865dff22?s=40&20150116"/>
		</td>
		<td class="comm comm_odd">
			<a href="/users/vastolorde95">Aditya Paliwal</a>: 
								<span style="font-size: 10px; color: #666;">2014-11-14 22:17:44</span>
		<br/>
				<p>AC but had to fix a really weird error. Occasionally the first alphabet was never printed. :/ Added an if condition to check and manually added the first alphabet wherever required. O(K*L^2)</p>
						</td>
	</tr>
				
	<tr>
		<td width="50" style="vertical-align:top;">
			<img src="http://www.gravatar.com/avatar/de57de92de53e1b5cdfa915bd9c53efa?s=40&20150116"/>
		</td>
		<td class="comm comm_even">
			<a href="/users/ashjai689">ashish jaiswal</a>: 
								<span style="font-size: 10px; color: #666;">2014-06-13 22:47:06</span>
		<br/>
				<p>Got AC in 1 attempt. piece of cake :)</p>
						</td>
	</tr>
				
	<tr>
		<td width="50" style="vertical-align:top;">
			<img src="http://www.gravatar.com/avatar/c3097016e89e044acb020bece922075c?s=40&20150116"/>
		</td>
		<td class="comm comm_odd">
			<a href="/users/donraj">Mayank Raj</a>: 
								<span style="font-size: 10px; color: #666;">2013-08-25 12:24:14</span>
		<br/>
				<p>any tuff/corner cases please?</p>
						</td>
	</tr>
				
	<tr>
		<td width="50" style="vertical-align:top;">
			<img src="http://www.gravatar.com/avatar/c3097016e89e044acb020bece922075c?s=40&20150116"/>
		</td>
		<td class="comm comm_even">
			<a href="/users/donraj">Mayank Raj</a>: 
								<span style="font-size: 10px; color: #666;">2013-08-25 12:23:55</span>
		<br/>
				<p>any tuff/corner cases please?</p>
						</td>
	</tr>
				
	<tr>
		<td width="50" style="vertical-align:top;">
			<img src="http://www.gravatar.com/avatar/7aab364c91ae3dbaa2011e7ad6cecabb?s=40&20150116"/>
		</td>
		<td class="comm comm_odd">
			<a href="/users/wiser">samuel</a>: 
								<span style="font-size: 10px; color: #666;">2013-06-27 03:51:53</span>
		<br/>
				<p>use dynamic programming!<br/>and be careful with details</p>
						</td>
	</tr>
				
	<tr>
		<td width="50" style="vertical-align:top;">
			<img src="http://www.gravatar.com/avatar/cdb7741174a2d6701cd5b61cd6b87ef2?s=40&20150116"/>
		</td>
		<td class="comm comm_even">
			<a href="/users/aradhya71">Aradhya</a>: 
								<span style="font-size: 10px; color: #666;">2013-05-29 21:07:54</span>
		<br/>
				<p>hmm.. good one ;)</p>
						</td>
	</tr>
			
</table>


<script language="javascript" type="text/javascript">
<!--
function getCookieVal (offset) {
        var endstr = document.cookie.indexOf (";", offset);
        if (endstr == -1) { 
                endstr = document.cookie.length; 
        }
        return unescape(document.cookie.substring(offset, endstr));
}

function GetCookie (name) {
  var arg = name + "=";
  var alen = arg.length;
  var clen = document.cookie.length;
  var i = 0;
  while (i < clen) {
    var j = i + alen;
    if (document.cookie.substring(i, j) == arg) {
      return getCookieVal (j);
      }
    i = document.cookie.indexOf(" ", i) + 1;
    if (i == 0) break; 
    }
  return null;
}

function toggleComments() {
        var a = document.getElementById('comments_table');
        var d = a.style.display;
        if( d == "" || d == "block" ){
                d = "none";
                document.getElementById('comments_sh').innerHTML = 'show';
        } else {
                d = "block";
                document.getElementById('comments_sh').innerHTML = 'hide';
        }
        a.style.display = d;
        document.cookie="comments_table="+d+"; path=/;";
}

if( GetCookie('comments_table') == 'none' ){
        document.getElementById('comments_sh').innerHTML = 'show';
        document.getElementById('comments_table').style.display = 'hide';
}

-->
</script>


			<!-- google_ad_section_end -->
			</div>
			<table width="100%">
        </table>
<br/>
		</div>
	</div><!-- endof col-lg-8 col-md-8 -->
	
	<div class="col-lg-4 col-md-4">
	
				<div id="problem-btn-submit-box">
			<a href="/submit/IKEYB/" id="problem-btn-submit" class="btn btn-primary" style="width: 100%; margin-bottom: 20px;"><i class="fa fa-send"></i> Submit solution!</a>
		</div>
				
		<table border=0 cellspacing=0 cellpadding=0 style="margin-bottom:10px" class="probleminfo" id="problem-meta">
			<colgroup>
				<col width="120"/>
				<col/>
			</colgroup>
			<tbody>
			<tr><td>Added by:</td><td><a href="/users/adrian">adrian</a></td></tr>
			<tr><td>Date:</td><td>2004-05-09</td></tr>
			<tr><td>Time limit:</td><td>5s
			</td></tr>
			<tr><td>Source limit:</td><td>50000B</td></tr>
						<tr><td>Memory limit:</td><td>1536MB</td></tr>
										<tr>
					<td>Cluster:</td>
					<td>
													<a href="/clusters/" target="_blank">Cube (Intel G860)</a>
								
					</td>
				</tr>
						<tr><td>Languages:</td><td>All </td></tr>
			<tr><td>Resource:</td><td>ACM Central European Programming Contest, Prague 2000</td></tr>													</tbody>
		</table>

		<div class="right-box-hehe">
			<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- spoj_problem_336x280_right2 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:336px;height:280px"
     data-ad-client="ca-pub-4453360425583535"
     data-ad-slot="3836605032"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	
		<!-- BEGIN: Voting for problem -->
		
				
		<!-- END: Voting the problem -->
		
		<div class="right-box-hehe">
							<div class="c336x280"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<!-- spoj_problem_336x280_right -->
	<ins class="adsbygoogle"
			style="display:inline-block;width:336px;height:280px"
					data-ad-client="ca-pub-4453360425583535"
							data-ad-slot="7873511834"></ins>
							<script>
							(adsbygoogle = window.adsbygoogle || []).push({});
	</script></div>
						<br/>
		</div>
		
				
		
		<script type="text/javascript">
			function callback_after_vote(type, data)
			{
				var response = $.parseJSON(data);
				manage_vote_interface(type);
				//.html('<div class="vote-thank-you">Thank you!</div>');
				

				if (type == "problem" || type == "implementation") {
					var progressBarValue = Math.round(2 + 98 * response.avg / 3);
					var progressBarType;
					if (progressBarValue < 25) progressBarType = "progress-bar-primary";
					else if (progressBarValue < 50) progressBarType = "progress-bar-success";
					else if (progressBarValue < 75) progressBarType = "progress-bar-warning";
					else progressBarType = "progress-bar-danger";
					
					$("#rate-" + type + "-box .progress-bar").css("width", progressBarValue.toString() +"%");
					$("#rate-" + type + "-box .progress-bar").attr("aria-valuenow", progressBarValue.toString());
					$("#rate-" + type + "-box .progress-bar").attr("class", "progress-bar " + progressBarType);
					$("#rate-" + type + "-box .progress-value").html(progressBarValue.toString() +"%");
				}
				else if (type == "quality") {
					var quality_plus = response.sum_plus;
					var quality_minus = response.sum_minus;

					var box_content = '';

					if (quality_plus > 0 || quality_minus > 0) {
						if (quality_plus > 0) {
							box_content += '<font size="+2"><span class="label label-success">' +
								quality_plus.toString() + 
								' <span class="fa fa-thumbs-o-up"></span></span></font>';
						}
						if (quality_minus > 0) {
							box_content += '<font size="+2"><span class="label label-danger">' +
								quality_minus.toString() + 
								' <span class="fa fa-thumbs-o-down"></span></span></font>';
						}
					}

					$( "#rate-" + type + "-box" ).empty().html(box_content);
				}

				// update count
				if (response.update_count == 1) {
					var count = parseInt($("#votes_count").html(), 10);
					count++;
					var votes_word = " vote";
					if (count > 1) votes_word += "s";
					$("#votes_count").empty().html(count.toString() + votes_word);
				}
			}
			$( ".rate-btn" ).click(function() {
				var rate_type = $(this).attr('data-rate-type').toString();
				var rate_type_full = "";
				var rate = $(this).attr('data-rate').toString();
				if (rate_type == "p") rate_type_full = "problem";
				else if (rate_type == "i") rate_type_full = "implementation";
				else if (rate_type == "q") rate_type_full = "quality";
				$.get( '/?a=vote&pid=14&t=' + rate_type + '&r=' + rate, function( data ) {
				  callback_after_vote(rate_type_full, data);
				});
			});
			function manage_vote_interface(type) {
				number_of_voteboxes--;
				/*
				if (number_of_voteboxes == 0) {
					$( "#vote-box" ).fadeOut(1500, function() {
						$(this).remove();
					});
				} else {
					$( "#vote-" + type + "-box" ).fadeOut(1500, function() {
						$(this).remove();
					});
				}
				*/
				var n = $('.vote-thank-you').length;
				var offset = (n * 60).toString() + "px";
				$(document.body).append(
					'<div class="vote-thank-you" style="margin: 40%;">' +
					'<div class="alert alert-success" style="position: fixed; top: '+offset+';">' +
					'<strong>Thank you for voting!</strong>' +				
					'</div></div>');
				setTimeout(function(){$( ".vote-thank-you" ).fadeOut(1500, function() {
					$(this).remove();
				});},2000);
			}
		</script>
		
		
	</div><!-- endof col-lg-4 col-md-4 -->
</div>






<style>
ul.list-unstyled li{
	margin-bottom: 5px;
}
ul.list-unstyled li a.btn{
	width: 100%;
}
ul.ui-autocomplete{
	z-index: 10000;
	width: 200px !important;
}
</style>
	<br/>
</div>
		
		
		<div class="container" id="footer">
			<div class="row">
				<div class="col-md-2">
					
				</div>
				<div class="col-md-8 text-center">
					<a href="/info">About</a> | <a href="/tutorials">Tutorial</a> | <a href="/tools">Tools</a> | <a href="/clusters">Clusters</a> | <a href="/credits">Credits</a> | <a href="/jobs">Jobs</a> | <a href="/sphereengine">API</a> | <a href="/gfx/spoj-terms.pdf" target="_blank">Terms</a>
				</div>
				<div class="col-md-2 text-right">
					<a href="/rss/" ><img src="//stx1.spoj.com/gfx/rss10x10.gif" border=0>&nbsp;RSS</a>&nbsp;
				</div>
			</div>
		</div>
		
		<div class="text-center" id="footer-srl">
			
	&copy; Spoj.com. All Rights Reserved. Spoj uses <a href="http://sphere-engine.com?utm_campaign=permanent&amp;utm_medium=footer&amp;utm_source=spoj" style="color:black">Sphere Engine</a>&trade; &copy; by <a href="http://sphere-research.com?utm_campaign=permanent&amp;utm_medium=footer&amp;utm_source=spoj" style="color:black">Sphere Research Labs</a>.

		</div> 
	</div>

	<!-- JavaScripts -->
	
		
	
	<script type="text/javascript">
	$(function(){
		setTimeout(function(){
			$('.no_a_info').css('visibility', 'visible');
		}, 5000);
		
		if(!$('.aProblemTop').length && !$('.aProblemsTop').length && !$('.aSubmitTop').length && !$('.aStatusTop').length && !$('.aMainRight').length){
			ga('send', 'event', 'ads', 'no-ads', 'main-contest');
		}
		if ($('.aProblemTop').height() == 0){
			$('.aProblemTop').css({'border': '1px solid #ddd', 'background': '#f0f4e3', 'height': 90});
			$('.aProblemTop').html($('<p class="text-center">using adblock?</p><h4 class="text-center">Online ads help us to maintain site.</h4><p class="text-center"><strong>please whitelist *.spoj.com</strong></p>'));
			ga('send', 'event', 'ads', 'adblock2', 'aProblemTop');
		}
		if ($('.aProblemsTop').height() == 0){
			ga('send', 'event', 'ads', 'adblock2', 'aProblemsTop');
		}
		if ($('.aSubmitTop').height() == 0){
			ga('send', 'event', 'ads', 'adblock2', 'aSubmitTop');
		}
		if ($('.aStatusTop').height() == 0){
			ga('send', 'event', 'ads', 'adblock2', 'aStatusTop');
		}
		if ($('.aMainRight').height() == 0){
			ga('send', 'event', 'ads', 'adblock2', 'aMainRight');
		}
	});
	</script>
	
	
	<script type="text/javascript" src="//stx1.spoj.com/gfx/jquery.timers.js"></script>
	<script type="text/javascript" src="//stx1.spoj.com/gfx/jquery.cookie.js"></script>
	
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

	<script src="//stx1.spoj.com/gfx/md5.js"></script>
	<script src="//stx1.spoj.com/gfx/bootstrap-tour/build/js/bootstrap-tour.min.js"></script>
	<script src="//stx1.spoj.com/gfx/scripts/tour.js"></script>
	
	
	<div id="fb-root"></div>
	<script>(function(d, s, id) {
	  var js, fjs = d.getElementsByTagName(s)[0];
	  if (d.getElementById(id)) return;
	  js = d.createElement(s); js.id = id;
	  js.src = "//connect.facebook.net/pl_PL/sdk.js#xfbml=1&appId=321676846207&version=v2.0";
	  fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));</script>
	
	


<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	  ga('create', 'UA-10507872-1', 'auto');
	  ga('require', 'linkid', 'linkid.js');
	  ga('send', 'pageview');
	</script>
<!-- Hotjar Tracking Code for http://www.spoj.com -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:334656,hjsv:5};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<script type="text/javascript">
	$(function(){
		$(document).on('click', '.track', function(){
			var event = $(this).attr('data-event');
			var action = $(this).attr('data-action');
			var value = $(this).attr('data-value');
			ga('send', 'event', event, action, value);
		});
	});
	//window.open('http://incoming.hotjar.com/s/7366', '_blank');
	</script>


</body>
</html>