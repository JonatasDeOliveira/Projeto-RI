<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>F. Chapaev and a Cipher Grille @ NEERC 2010, Eastern subregional contest @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=82&amp;num=6"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=82&amp;num=6&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=82&amp;num=6&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=82&amp;num=6&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=82&amp;num=6&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">NEERC 2010, Eastern subregional contest</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=82">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=82" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=82">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=82">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=82">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">F. Chapaev and a Cipher Grille</H2><DIV class="problem_limits">Time limit: 0.5 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">When searching the Whites' deserted headquarters, Petka and Chapaev found
several <i>n</i> × <i>n</i> squares filled with letters. Chapaev supposed that
the Whites were communicating secretly by using a cipher grille and the
squares were ciphered messages.
</DIV></DIV><IMG SRC="/image/get.aspx/35d0e166-c634-426f-b9e0-2d43957875f8" BORDER="0" ALT="Problem illustration" ALIGN="RIGHT" CLASS="problem_raimage"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">A cipher grille is an <i>n</i> × <i>n</i> paper square with windows made by cutting
out <i>n</i><sup>2</sup>/4 cells. Putting the grille on a paper sheet of the same size,
the coder writes the first <i>n</i><sup>2</sup>/4 symbols of a message in the windows.
After that he turns the grille clockwise by 90 degrees. He writes the next
<i>n</i><sup>2</sup>/4 symbols of the message in the windows and turns the grille by 90
degrees again. Then he writes the following <i>n</i><sup>2</sup>/4 symbols, turns the
grille one more time, and writes the last <i>n</i><sup>2</sup>/4 symbols of the message.
Each turn of the grille covers all the symbols written earlier and opens
empty cells.
</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Despite searching the headquarters thoroughly, Petka and Chapaev found no
cipher grilles. Evidently, the Whites had destroyed them before leaving
the premises. On the next day Anka noticed that there was an integer <i>k</i>
written on a wall of the headquarters. She informed Chapaev at once,
and he surmised that the Whites had used the <i>k</i>th cipher grille in the
lexicographic order. In order to decipher the messages, they had to
make such a grille.
</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Every <i>n</i> × <i>n</i> cipher grille can be coded as an <i>n</i> × <i>n</i> matrix
consisting of zeros and ones in which ones denote windows and zeros
denote other cells. We say that a matrix <i>a</i> is lexicographically smaller
that a matrix <i>b</i> (both matrices are of the size <i>n</i> × <i>n</i>) if there
exists a number <i>i</i> such that the first <i>i</i> cells of the matrices <i>a</i>
and <i>b</i> coincide, the (<i>i</i>+1)th cell of the matrix <i>a</i> contains zero,
and the (<i>i</i>+1)th cell of the matrix <i>b</i> contains one. The cells
of matrices are numbered as in the picture.
</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The only line contains the integers <i>n</i> and <i>k</i> (4 ≤ <i>n</i> ≤ 10;
<i>n</i> is even; 1 ≤ <i>k</i> ≤ 10<sup>18</sup>). It is guaranteed that 
<i>k</i> does not exceed the total number of cipher grilles
of size <i>n</i> × <i>n</i>.
</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Output the grille Chapaev had to make in order to read the Whites'
messages.
</DIV></DIV><H3 CLASS="problem_subtitle">Sample</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>4 15
</PRE></TD><TD><PRE>0000
0000
1101
0001
</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Author: </B>Alexander Ipatov<BR><B>Problem Source: </B>NEERC 2010, Eastern subregional contest<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=82&amp;num=6" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=1805"><nobr>1805. Chapaev and a Cipher Grille</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>