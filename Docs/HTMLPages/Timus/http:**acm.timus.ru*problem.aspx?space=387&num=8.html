<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>H. Magic Programmer @ Ural Championship 2016 @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=387&amp;num=8"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=387&amp;num=8&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=387&amp;num=8&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=387&amp;num=8&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=387&amp;num=8&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">Ural Championship 2016</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=387">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=387" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=387">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=387">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=387">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">H. Magic Programmer</H2><DIV class="problem_limits">Time limit: 5.0 second<BR>Memory limit: 256 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">There are lots of projects in one well-known Ural IT company.
In many of them, unfortunately, there are some issues with the development process: deadlines are not met, system fails under load, users are dissatisfied.
Luckily, Ivan, a magic programmer, works at the company.
He is able to enter a project and raise the level of development to a principally higher level in almost no time, so that everything starts working without a hitch.
After that there is no point for him to stay in the project, as everything is fine here, while there are lots of other projects that only Ivan can save.
Such employee is very much appreciated in the company, and they always try to redirect him to the most problem-plagued place.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Ivan has some requirements of his own: not only wants he to save projects, but to learn new technologies as well. At the moment he is interested in <i>m</i> technologies not yet studied.
Ivan used to play ACM in those old times when the program was allotted 1MB of RAM, and one could do not that much during the available one second of time, so
he got used to value time and not to waste it.
Ivan has decided that, since he is destined to travel from one project to another, during his time in the company he should, firstly, work with all technologies that are of interest to him, and, secondly, should not employ any same technology in various projects (this is boring and would deprive him of originality-related emotions that are so essential to him in his work).
He also cannot, surely, enter one project twice.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">There are <i>n</i> projects at the company in total.
Due to various reasons, direct transfers between projects are not always possible.
There are <i>n</i>&minus;1 pairs of projects allowing direct transfer (either way).
Yet one can get from a project to any other via several direct transfers, not entering a single project twice, and there’s only one way to do that.
Each project employs some subset of technologies that are interesting to Ivan.
Help Ivan choose the first project and to draw up a plan of transfers so that he does not enter a single project twice and tries each of the <i>m</i> technologies exactly one time.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains two integer numbers <i>n</i> and <i>m</i> (1 &le; <i>n</i>, <i>m</i> &le; 10<sup>5</sup>) separated by space.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The following <i>n</i>&minus;1 lines contain descriptions of allowed direct transfers between projects.
<i>j</i>-th line contains two different numbers <i>u</i><sub><i>j</i></sub> and <i>v</i><sub><i>j</i></sub> (1 &le; <i>u</i><sub><i>j</i></sub>, <i>v</i><sub><i>j</i></sub> &le; <i>n</i>) &mdash; numbers of projects allowing direct transfer. It is guaranteed that the specified transfer system meets the aforementioned conditions.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Next <i>n</i> lines describe the technologies Ivan is interested in, that are used in each of the projects. <i>i</i>-th line starts with a number <i>a</i><sub><i>i</i></sub> (0 &le; <i>a</i><sub><i>i</i></sub> &le; <i>m</i>),
equal to number of technologies of interest to Ivan used in the project <i>i</i>.
Then in the same line, separated by space, <i>a</i><sub><i>i</i></sub> of various integer numbers between 1 and <i>m</i> follow &mdash; the numbers of these technologies.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">It is guaranteed that the sum of all <i>a</i><sub><i>i</i></sub> does not exceed 10<sup>6</sup>.</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">If a plan meeting Ivan’s requirements does not exist, output a single line "No solution" (without quotes).</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Otherwise output two numbers <i>s</i> and <i>t</i> &mdash; the numbers of the first and the last projects at the suitable transfer plan.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">If several solutions exist, output any.</DIV></DIV><H3 CLASS="problem_subtitle">Samples</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>5 3
1 2
1 3
3 4
3 5
1 1
1 3
0
2 1 3
1 2
</PRE></TD><TD><PRE>2 5
</PRE></TD></TR><TR><TD><PRE>3 3
1 2
1 3
2 2 3
3 1 2 3
1 3
</PRE></TD><TD><PRE>2 2
</PRE></TD></TR><TR><TD><PRE>2 3
1 2
2 1 2
2 1 3
</PRE></TD><TD><PRE>No solution
</PRE></TD></TR></TABLE><H3 CLASS="problem_subtitle">Notes</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In the second example there is no sense for Ivan to make any transfers, so he will spend all his career in the project 2, where he will try all technologies.
So the numbers of the first and the second project match.</DIV></DIV><DIV CLASS="problem_source"><B>Problem Author: </B>Alexander Fetisov<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=387&amp;num=8" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=2085"><nobr>2085. Magic Programmer</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>