<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>E. Martian Plates @ Dmitry Gozman Contest 1. Petrozavodsk training camp. Winter 2007 @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=58&amp;num=5"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=58&amp;num=5&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=58&amp;num=5&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=58&amp;num=5&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=58&amp;num=5&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">Dmitry Gozman Contest 1. Petrozavodsk training camp. Winter 2007</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=58">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=58" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=58">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=58">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=58">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">E. Martian Plates</H2><DIV class="problem_limits">Time limit: 2.0 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In a martian restaurant, there is a choice of <i>n</i> dishes, and a holiday
dinner consists of <i>l</i> dishes. Some of the dishes could appear more than
once at the holiday dinner, while some other ones could never appear.
During the dinner, plates are placed one above another. The waiter
sometimes brings next dishes or takes the empty plates away. However, an
empty plate could not be taken away until all the plates from the next
delivered dishes are also taken away. Moreover, for some ordered pairs of
dishes there is a Martian custom: first of these dishes can not be brought
while the plate from the second dish stands on the table; such pairs are
called <i>uncommon</i>.
</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Let's call a <i>time-table</i> of the waiter the order of bringing dishes
and taking away plates. Thus, there are 2<i>l</i> items in a time-table.
Your task will be to count how many different time-tables exist for a holiday
dinner of <i>l</i> dishes modulo <i>p</i>.

</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line of input contains <i>p</i> (2&nbsp;&le;&nbsp;<i>p</i>&nbsp;&le;&nbsp;10<sup>4</sup>), <i>t</i>
(1 &le; <i>t</i>&nbsp;&le;&nbsp;200) which is the number of items in a time table,
<i>n</i> (1&nbsp;&le;&nbsp;<i>n</i>&nbsp;&le;&nbsp;10) which is the number of dishes at the restaurant
and <i>m</i> (0&nbsp;&le;&nbsp;<i>m</i> &le; 100)&nbsp;— the number of uncommon pairs.
The next <i>m</i> lines each contain an ordered pair of numbers <i>i</i> and <i>j</i>
which means that the dish <i>j</i> could not be brought while the plate from
the dish <i>i</i> stands on the table. Note that the number <i>t</i> is even.

</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Output the number of different time-tables modulo <i>p</i>.
</DIV></DIV><H3 CLASS="problem_subtitle">Samples</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>10000 4 2 1
1 2
</PRE></TD><TD><PRE>7
</PRE></TD></TR><TR><TD><PRE>9999 6 10 2
2 3
6 7
</PRE></TD><TD><PRE>4866
</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Author: </B>Dmitry Gozman<BR><B>Problem Source: </B>Dmitry Gozman Contest 1, Petrozavodsk training camp, January 2007<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=58&amp;num=5" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=1526"><nobr>1526. Martian Plates</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>