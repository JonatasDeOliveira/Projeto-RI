<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>E. Trade Guilds of Erathia @ Ural SU Team.GOV contest. Petrozavodsk training camp. Summer 2011 @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=90&amp;num=5"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=90&amp;num=5&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=90&amp;num=5&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=90&amp;num=5&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=90&amp;num=5&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">Ural SU Team.GOV contest. Petrozavodsk training camp. Summer 2011</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=90">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=90" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=90">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=90">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=90">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">E. Trade Guilds of Erathia</H2><DIV class="problem_limits">Time limit: 2.0 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The continent of Antagarich was colonized slowly.
Long ago its northern part was inhabited by the elves of Avlee.
Later, the hot southern desert of Bracada was occupied by the white mages.
At the same time, necromancers settled in Deyja, a land to the north
of Bracada and to the south-west of Avlee.
Although white and dark mages didn't really like each other,
each group had some artifacts that the other group would be happy to buy.
As a result, the trading relationship between Bracada and Deyja grew stronger,
and soon the mages built a very busy trade route between these lands.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Erathia was founded later, and at first it was stretched along this route.
At that time Erathia's economy was based solely on trading,
so new trading guilds appeared all the time.
Each of the guilds was present in a few cities which were consecutively
situated along the route.
Caravans of each guild travelled between
all pairs of cities of that guild equally often.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The state's treasury was replenished by fees collected from all the caravans
moving along the trade route.
There was a fee for each route segment connecting two neighboring cities,
and this fee could change over time.
For example, the fee could be decreased in the areas of frequent
goblin attacks, or increased in the areas with high traffic.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Loins, the royal treasurer, studies Erathia's economy and tries
to predict the profit of trade guilds.
He wants to know the amount of money paid in fees by each guild.
He has a chronologically ordered list of documents that contains all the royal
orders changing the fee and all the papers establishing new guilds.
This data should be used to calculate the average fee paid by a caravan
of a given trade guild.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains the number <i>n</i> of cities in Erathia and the number <i>m</i>
of documents collected by Loins (2 &le; <i>n</i> &le; 10<sup>5</sup>; <nobr>1 &le; <i>m</i> &le; 10<sup>5</sup></nobr>).
The following <i>m</i> lines describe the documents of two possible types:
<ul>
<li>
&ldquo;change <i>a</i> <i>b</i> <i>d</i>&rdquo;: the fee for travelling along each route segment
between cities <i>a</i> and <i>b</i> changed by <i>d</i> gold coins (if <i>d</i> is positive,
the fee increased; if <i>d</i> is negative, the fee decreased);
<li>
&ldquo;establish <i>a</i> <i>b</i>&rdquo;: a new guild which is present in all cities
between <i>a</i> and <i>b</i> was established.
</ul>
All numbers are integers; 1 &le; <i>a</i> &lt; <i>b</i> &le; <i>n</i>; &minus;10&nbsp;000 &le; <i>d</i> &le; 10&nbsp;000.
Cities are numbered in the order they are located along the route:
from Bracada to Deyja.
The fee for travelling along a segment was never larger than 10&nbsp;000 gold
coins, otherwise merchants would protest.
Of course, the fee was always non-negative.
Before the first royal order changing the fee,
it is equal to zero for all route segments.</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">After each document establishing the new guild, output in a single line the
average amount of fee paid by a caravan of this guild.
The absolute or relative error should not exceed 10<sup>&minus;6</sup>.</DIV></DIV><H3 CLASS="problem_subtitle">Sample</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>4 5
change 1 4 2
change 1 2 -1
establish 1 2
establish 2 4
establish 1 4
</PRE></TD><TD><PRE>1.00000000
2.66666667
2.83333333
</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Author: </B>Alexander Fetisov (prepared by Denis Dublennykh)<BR><B>Problem Source: </B>Ural SU Team.GOV Contest. Petrozavodsk Summer Session, August 2011<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=90&amp;num=5" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=1855"><nobr>1855. Trade Guilds of Erathia</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>