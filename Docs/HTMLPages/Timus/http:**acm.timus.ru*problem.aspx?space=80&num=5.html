<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>E. Chinese Hockey 2 @ Open Ural SU Championship 2010 @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=80&amp;num=5"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=80&amp;num=5&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=80&amp;num=5&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=80&amp;num=5&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=80&amp;num=5&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">Open Ural SU Championship 2010</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=80">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=80" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=80">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=80">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=80">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">E. Chinese Hockey 2</H2><DIV class="problem_limits">Time limit: 1.0 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Oh, these hockey fans! They attend all the games of their favorite team
and don't care about their money or spare time. Often fans of a hockey
team from a city of Harbin gather in a small group of several thousand
people to visit the next match of their idols.

</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Harbin fans are well-organized. Each of them has his own ID number
that is an integer from 1 to <i>n</i>. All <i>n</i> fans decided to visit the next
match, so the fanclub ordered <i>m</i> buses and assigned the fans to buses
in such a way, that there would be at least <i>a</i> and at most <i>b</i>
fans in each bus. To avoid the mess, the buses were numbered 1 through <i>m</i>,
and every fan got a tag with a number of his bus. It is known that fans with
larger IDs were assigned to buses with larger numbers.
</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">An emigrant from Vietnam, Li Si Tsyn is not accustomed to the discipline of his
comrades yet. When he came to a boarding station, he realized he had forgotten
a tag with his bus number at home! Li Si Tsyn asked several friends for their IDs
and their bus numbers. He wants to use this information to calculate the
number of his bus.
</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains space-separated integers <i>n</i>, <i>m</i>, <i>a</i> and 
<i>b</i> (<nobr>2 ≤ <i>m</i> ≤ <i>n</i> ≤ 10<sup>5</sup>;</nobr> <nobr>1 ≤ <i>a</i> ≤ 
<i>b</i> ≤ <i>n</i>;</nobr>
<nobr><i>ma</i> ≤ <i>n</i> ≤ <i>mb</i></nobr>). The second line contains an
integer <i>r</i> (<nobr>1 ≤ <i>r</i> ≤ <i>n</i></nobr>), which is the
Li Si Tsyn's ID. The third line contains an integer <i>s</i> <nobr>(1 ≤ 
<i>s</i> ≤ <i>n</i> − 1)</nobr>, which is the number of fans asked by
Li Si Tsyn. The <i>i</i>-th of the next <i>s</i> lines contains space-separated 
integers <i>r<sub>i</sub></i> and <i>f<sub>i</sub></i> (<nobr>1 
≤ <i>r<sub>i</sub></i> ≤ <i>n</i>;</nobr> <nobr>1 ≤ <i>f<sub>i</sub></i> ≤ 
<i>m</i></nobr>), which are the ID of a fan and the number of his bus.
All <i>r<sub>i</sub></i> are distinct and none of them is equal to <i>r</i>.
</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">If the information received from the fans is inconsistent, output a single word
“IMPOSSIBLE”. Otherwise, in the first line you should output the number of
options that could be written on the Li Si Tsyn's tag, and in the the second line
you should output a space-separated list of these options in ascending order.</DIV></DIV><H3 CLASS="problem_subtitle">Sample</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>16 4 1 16
3
2
2 2
4 3
</PRE></TD><TD><PRE>2
2 3</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Author: </B>Alex Samsonov<BR><B>Problem Source: </B>XV Open USU Championship<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=80&amp;num=5" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=1778"><nobr>1778. Chinese Hockey 2</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>