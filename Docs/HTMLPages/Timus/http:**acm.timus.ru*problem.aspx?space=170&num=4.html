<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>D. Simple Magic @ Ural Regional School Programming Contest 2013 @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=170&amp;num=4"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=170&amp;num=4&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=170&amp;num=4&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=170&amp;num=4&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=170&amp;num=4&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">Ural Regional School Programming Contest 2013</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=170">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=170" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=170">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=170">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=170">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">D. Simple Magic</H2><DIV class="problem_limits">Time limit: 1.0 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Do you think that magic is simple? That some hand-waving and muttering 
incomprehensible blubber is enough to conjure wonderful gardens or a 
fireball to burn your enemies to ashes? </DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The reality is a little more complicated than that. To master skills, 
young wizards spend years studying such subjects as magical analysis and 
demonology practice. </DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In fact, Oleg, a student of the Institute of Magic and Common Sorcery 
(IMCS) is preparing for an exam. And there’s no way he can calculate the 
Dumbledore determinant. As you might have guessed, he asked you to help 
him. </DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Let us remind you the basic definitions just in case you haven’t been 
visiting lectures on the theory of nonlinear spells. The Gandalf theorem 
states that any part of subspace can be represented as a vector of magic 
potentials that is an array of <i>n</i> positive integers.
A Dumbledore determinant of this array equals the 
minimum number of elementary magical transformations required to turn the 
original array into the array where all elements are equal to one. 
One elementary magical transformation turns the original array of 
length <i>k</i> into a new array of length <i>k</i> &middot; (<i>k</i> &minus; 1) / 2. 
The elements of the new array are greatest common divisors of 
each pair of elements of the original array. For example, the 
elementary magical transformation of array {2, 3, 3, 6} turns it into array 
{gcd(2, 3), gcd(2, 3), gcd(2, 6), gcd(3, 3), gcd(3, 6), gcd(3, 6)}, 
that is {1, 1, 2, 3, 3, 3}.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains number <i>n</i> that is the length of 
the original array (3 &le; <i>n</i> &le; 10&nbsp;000). Next <i>n</i> lines 
contain the elements of array that are positive integers not exceeding 10<sup>7</sup>.  </DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Output Dumbledore determinant for the array given in the input.
If Dumbledore determinant is not defined or it exceeds 
10<sup>18</sup>, output &ldquo;infinity&rdquo;. </DIV></DIV><H3 CLASS="problem_subtitle">Samples</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>3
1
2
3
</PRE></TD><TD><PRE>1
</PRE></TD></TR><TR><TD><PRE>4
2
2
2
2
</PRE></TD><TD><PRE>infinity
</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Author: </B>Kirill Borozdin<BR><B>Problem Source: </B>Ural Regional School Programming Contest 2013<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=170&amp;num=4" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=2003"><nobr>2003. Simple Magic</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>