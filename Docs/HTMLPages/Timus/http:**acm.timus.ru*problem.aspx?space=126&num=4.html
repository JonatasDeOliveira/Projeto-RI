<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>D. Scary Politics @ Ural Regional School Programming Contest 2012 @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=126&amp;num=4"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=126&amp;num=4&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=126&amp;num=4&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=126&amp;num=4&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=126&amp;num=4&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">Ural Regional School Programming Contest 2012</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=126">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=126" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=126">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=126">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=126">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">D. Scary Politics</H2><DIV class="problem_limits">Time limit: 1.0 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The world is in danger!
Not so long ago the relations between two most powerful countries&nbsp;&mdash; Brazico and Mexil were merely cold, but now the world is on the brink
of a new world war.
Both Brazico and Mexil leaders are well-versed in politics, so before they declare war they try to acquire as many allies as possible.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In the beginning each country belonged to one of 10 alliances. 
Both rivaling empires do the same trick. The empire chooses one of the alliances (different from the one it belongs to in the moment)
and joins it. As a result, all countries
of the chosen alliance, that border on the empire become parts of the empire. As soon as the new territories are acquired, the
leaders of the empire wait for their opponent to make a similar turn.
Naturally, neither empire will join the alliance its rival is currently in. 
The alliances have quite different opinions on many things, so Brazico and Mexil can only be in
one alliance at a time, but the territories they have once acquired remain parts of the empire
forever, so each day makes their conflict more and more dangerous.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Fortunately, there is the political genius, who hasn’t pledged his service to any country yet.
He is ready to propose a way to stop the war, but he needs to know exactly what the area of Brazico and Mexil
are at the moment.
You have the information on what alliances Brazico and Mexil joined
during their political confrontation. Help to save the world&nbsp;&mdash; provide the political genius with information he requested.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The world map is a rectangle <i>n</i> &times; <i>m</i>, divided in 1 &times; 1 cells.
In the first line are two numbers separated with white spaces: <i>n</i> and <i>m</i>&nbsp;&mdash; the size of the world map (2 &le; <i>n</i>, <i>m</i> &le; 50).
Next <i>n</i> lines contain <i>m</i> digits each, describing the world map. 
For each cell the number from 0 to 9 denotes the alliance, this territory belongs to.
All adjacent cells, belonging to one alliance form one country. The cells are called adjacent if they have common edge.
Two countries border on each other, if they have at least a pair of adjacent cells.
Initially Brazico is the country, containing the lower left cell, and the Mexill&nbsp;&mdash; the country containing upper right cell.
It is given, that initially Brazico and Mexil belong to different alliances.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">After that an integer <i>l</i> is given&nbsp;&mdash; a number of times the opposing empires joined different
alliances (2 &le; <i>l</i> &le; 100).
In the next <i>n</i> lines are integer numbers from 0 to 9, showing the number of alliance the corresponding empire joins.
These numbers are given in chronological order, the first empire to join an alliance was Brazico.
                                                                                                                           </DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In the first line print one integer number&nbsp;&mdash; the area of Brazico, in the second line&nbsp;&mdash; the area of Mexil.</DIV></DIV><H3 CLASS="problem_subtitle">Sample</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>6 12
000233434133
000233434143
001223434133
101023434143
101223434133
110233434143
4
0 4 2 1
</PRE></TD><TD><PRE>23
18
</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Author: </B>folklore, prepared by Dmitry Karpenko<BR><B>Problem Source: </B>Ural Regional School Programming Contest 2012<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=126&amp;num=4" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=1923"><nobr>1923. Scary Politics</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>