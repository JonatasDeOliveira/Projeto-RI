<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>D. Black Spot @ Open Ural FU Championship 2012 @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=129&amp;num=4"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=129&amp;num=4&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=129&amp;num=4&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=129&amp;num=4&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=129&amp;num=4&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">Open Ural FU Championship 2012</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=129">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=129" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=129">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=129">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=129">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">D. Black Spot</H2><DIV class="problem_limits">Time limit: 1.0 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_epigraph">Bootstrap: Jones's terrible leviathan will find you and drag the Pearl back to the depths and you along with it.<br>
Jack: Any idea when Jones might release said terrible beastie?<br>
Bootstrap: I already told you, Jack. Your time is up. It comes now, drawn with ravenous hunger to the man what bears the black spot.
</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Captain Jack Sparrow has got a black spot on his hand and 
he avoids going to high seas because sea monster Kraken 
is waiting there for him. But he can’t stay in his place due 
to his freedom-loving nature. And now Jack is going to Tortuga.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">There are <i>n</i> islands in the Caribbean Sea. Jack is going to reach Tortuga, 
sailing from island to island by routes that allow him to be 
in the high seas for a short time. 
Jack knows such routes for some pairs of islands, 
but they could also be dangerous for him. 
There is a probability to meet Kraken on each route. </DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Jack is in a hurry and he wants to reach Tortuga visiting as 
small number of islands as possible. 
If there are several variants of such paths he wants to 
choose a path with the least probability of meeting Kraken.
<b>But Jack will be satisfied with any path with minimal number of islands if the probability
of meeting Kraken on this path differs from the minimal one in no more than 10<sup>&minus;6</sup></b>.
Help Jack find such path.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains two integers <i>n</i>, <i>m</i>&nbsp;&mdash; the quantity of islands 
and known routes between them (2 &le; <i>n</i> &le; 10<sup>5</sup>; 1 &le; <i>m</i> &le; 10<sup>5</sup>). 
The second line contains two integers <i>s</i> and <i>t</i>&nbsp;&mdash; 
the number of island where Jack is and the number of Tortuga (1 &le; <i>s</i>, <i>t</i> &le; <i>n</i>; <i>s</i> &ne; <i>t</i>). 
Each of the following <i>m</i> lines contains three integers&nbsp;&mdash; 
the numbers of islands <i>a</i><sub><i>i</i></sub> and <i>b</i><sub><i>i</i></sub> where the route is known and <i>p</i><sub><i>i</i></sub>&nbsp;&mdash; 
probability to meet Kraken on that route as percentage (1 &le; <i>a</i><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub> &le; <i>n</i>; <i>a</i><sub><i>i</i></sub> &ne; <i>b</i><sub><i>i</i></sub>; 0 &le; <i>p</i><sub><i>i</i></sub> &le; 99). 
No more than one route is known between each pair of islands.</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In the first line output <i>k</i>&nbsp;&mdash; number of islands along the 
path and <i>p</i>&nbsp;&mdash; probability to meet Kraken on that path. 
An absolute error of <i>p</i> should be up to 10<sup>&minus;6</sup>. 
In the next line output <i>k</i> integers&nbsp;&mdash; numbers of islands in the order of the path. 
If there are several solutions, output any of them.</DIV></DIV><H3 CLASS="problem_subtitle">Sample</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>4 4
1 3
1 2 50
2 3 50
1 4 10
4 3 10
</PRE></TD><TD><PRE>3 0.19
1 4 3
</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Author: </B>Denis Dublennykh (prepared by Egor Shchelkonogov)<BR><B>Problem Source: </B>Open Ural FU Championship 2012<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=129&amp;num=4" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=1934"><nobr>1934. Black Spot</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>