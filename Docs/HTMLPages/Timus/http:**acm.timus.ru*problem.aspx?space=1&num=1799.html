<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1799. Sasha and swag strings @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1799"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1799&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1799&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1799&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1799&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1799. Sasha and swag strings</h2><div class="problem_limits">Time limit: 2.0 second<br>Memory limit: 256 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Sasha enjoys strings and problems on string theory. Especially he loves suffix structures. As Sasha loves <b>TopForces</b> community he is going to write an entry named <i>“On suffix trees, part 37”</i>. Surely, he wants everybody to understand what the article says, so he decided to decorate it with some nice examples. After a recent contest on <b>TopForces</b>, Sasha has achieved the rank “International swagger”, and now he wants to match it. To achieve this, Sasha wants to choose the swaggest strings among some given set.</div></div><div class="problem_par"><div class="problem_par_normal">Of course, Sasha’s concept of string swagness is based on suffix structures. To be precise, on suffix trees. To calculate the swagness of a string, Sasha performs the following actions:
<ol>
<li>
He constructs the compressed suffix tree of the string.
Let us recall that a suffix tree is the trie built from all suffixes of the string. A compressed suffix tree is the same trie in which consecutive edges are merged. See the notes section for an example.
</li><li>
On each edge of the compressed suffix tree, he counts the number of distinct non-empty substrings of the string which is written on the edge.
</li></ol></div></div><div class="problem_par"><div class="problem_par_normal">The swagness of the string is defined as the sum of the calculated values among all edges. Unfortunately, Sasha is not so good with the suffix trees as he wants you to think, and can’t handle the problem on his own. Help him!</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains an integer <i>n</i> (1 ≤ <i>n</i> ≤ 10<sup>5</sup>).</div></div><div class="problem_par"><div class="problem_par_normal">Each of the next <i>n</i> lines contains a string. The <i>i</i>-th line contains a non-empty string <i>s</i><sub><i>i</i></sub>. Each string consists entirely of lowercase Latin letters. The total length of all strings <i>s</i><sub><i>i</i></sub> does not exceed 10<sup>5</sup>.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Print <i>n</i> integers, one per line. The <i>i</i>-th number must be the swagness of the string <i>s</i><sub><i>i</i></sub>.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3
umqra
umnik
merkurev
</pre></td><td><pre>35
35
101
</pre></td></tr><tr><td><pre>1
abaaa
</pre></td><td><pre>17
</pre></td></tr></tbody></table><h3 class="problem_subtitle">Notes</h3><div class="problem_par"><div class="problem_par_normal">Compressed suffix tree for string <i>abaaa</i>:</div></div><div class="problem_centered_picture"><img src="/image/get.aspx/2b69a3f1-46b4-4780-9f31-727004d33f40" border="0" alt="Problem illustration"></div><div class="problem_par"><div class="problem_par_normal">Edges are <i>a</i>, <i>aa</i>, <i>baaa</i> and <i>baaa</i>. They have 1, 2, 7 and 7 distinct non-empty substrings, respectively. So, the answer is 1 + 2 + 7 + 7 = 17.</div></div><div class="problem_source"><b>Problem Author: </b>Alexander Kulkov<br><b>Problem Source: </b>Petrozavodsk Summer 2015. Moscow IPT Contest<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=string">string algorithms</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1799" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1799" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 5276</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1799" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1799">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1799">Discussion (2)</a><br><a href="status.aspx?space=1&amp;num=1799">All submissions (201)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1799&amp;status=accepted">All accepted submissions (71)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1799">Solutions rating (10)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>