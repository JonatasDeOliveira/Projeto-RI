<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>D. Similar Tunes @ Ural Championship 2013 @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=155&amp;num=4"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=155&amp;num=4&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=155&amp;num=4&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=155&amp;num=4&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=155&amp;num=4&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">Ural Championship 2013</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=155">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=155" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=155">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=155">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=155">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">D. Similar Tunes</H2><DIV class="problem_limits">Time limit: 1.0 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">‘The boss gave me a disk with soundtracks of all six episodes of the <i> Star Wars</i>.
We must make sure that the tune we want to use in our game isn’t similar to any of the tunes on the disk.
He says that even though we’ve written the tune ourselves, copyright holders
may file a lawsuit against us if they find a slightest similarity between our tune and any of their tunes.
Then we’ll have to pay multimillion fines.’<br>
‘But it can take us many hours to listen to all the tunes from the disk,
and it can be difficult to find similar tunes by listening.
We need to automate the process.’<br>
‘I think we can write a program for comparing the tunes and then listen to the tunes from the disk
for which the computed similarity to our tune is high enough.
The comparison algorithm can be the following. If we neglect pauses and the lengths of sounds,
we can write each tune as a string of sounds.
For strings <i>s</i> and <i>t</i> of equal length, let’s call the number of positions <i>i</i> in which <i>s</i>[<i>i</i>] = <i>t</i>[<i>i</i>]
the <i> intersection size</i> <i>I</i>(<i>s</i>, <i>t</i>) of these strings.
The <i> absolute similarity</i> of strings <i>s</i> and <i>t</i> will be the maximum of <i>I</i>(<i>u</i>, <i>v</i>) for all <i>u</i> and&nbsp;<i>v</i>,
where <i>u</i> is a substring of <i>s</i> and <i>v</i> is a substring of <i>t</i> and the lengths of <i>u</i> and <i>v</i> are the same.
For example, the absolute similarity of the strings &ldquo;AAAAA&rdquo; and &ldquo;ABABA&rdquo; is three, and the
absolute similarity of the strings &ldquo;BABAB&rdquo; and &ldquo;ABABA&rdquo; is four.
The <i> relative similarity</i> between our tune and a tune from the disk is the ratio of their absolute similarity to the length
of the tune from the disk. This value will be computed by our program.’<br></DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line describes the tune used in the game.
The description of the tune starts with the length <i>n</i> of the tune,
which is followed by the description of <i>n</i> sounds.
The second line contains the number <i>m</i> of tunes on the <i> Star Wars</i> soundtrack disk (1 &le; <i>m</i> &le; 100).
Each of the following <i>m</i> lines describes these tunes in the same format as the tune from the game is described.
All tunes have lengths from 1 to 1000.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The description of sound is a string &ldquo;dN&rdquo;, &ldquo;dN+&rdquo;, or &ldquo;dN-&rdquo;, where 
d is a number of octave, N is a note letter name (an uppercase English letter), &ldquo;+&rdquo; and &ldquo;-&rdquo; are 
symbols of raising and lowering a note by a half tone. There are eight octaves numbered from 1 to 8.
Each octave consists of 12 sounds: C, C+, D, D+, E, F, F+, G, G+, A,
A+, B (sounds follow in this order in the octave). Some of these sounds have alternative notation.
In the following pairs both notations denote the same sound of this octave: (C+,&nbsp;D-), (D+,&nbsp;E-),
(E,&nbsp;F-), (F,&nbsp;E+), (F+,&nbsp;G-), (G+,&nbsp;A-), and (A+,&nbsp;B-).
Also a notation B+ denotes a sound C of the next octave, and a notation C- denotes a sound B 
of the previous octave. There are no sounds 1C- and 8B+.</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Output <i>m</i> lines, each containing one number. The numbers are the relative similarities
between the tune from the game and the tunes from the disk.
The answer must have absolute or relative error not exceeding&nbsp;10<sup>&minus;6</sup>.</DIV></DIV><H3 CLASS="problem_subtitle">Sample</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>4 5C+ 5D 5C 5G
3
2 5D- 5D
2 5D 4B+
4 5D 5C+ 5D 5F-
</PRE></TD><TD><PRE>1.000000
1.000000
0.500000
</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Author: </B>Denis Dublennykh<BR><B>Problem Source: </B>Ural Sport Programming Championship 2013<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=155&amp;num=4" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=1974"><nobr>1974. Similar Tunes</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>