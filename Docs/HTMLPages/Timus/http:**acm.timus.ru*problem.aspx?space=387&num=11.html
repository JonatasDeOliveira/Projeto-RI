<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>K. Nostalgic Evening @ Ural Championship 2016 @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=387&amp;num=11"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=387&amp;num=11&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=387&amp;num=11&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=387&amp;num=11&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=387&amp;num=11&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">Ural Championship 2016</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=387">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=387" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=387">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=387">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=387">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">K. Nostalgic Evening</H2><DIV class="problem_limits">Time limit: 2.0 second<BR>Memory limit: 256 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Sasha and Slava inhabit sunny California, work at large successful companies and are totally content with life.
But, without doubt, from time to time they happen to miss their motherland.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">That is why they keep taking part in ACM contests held in Russia both as contestants and as organizers.
They also like to sit on a skyscraper roof beside a chimney, discuss latest news from Russia and simply get a little bit nostalgic.
And it somehow naturally became a tradition to finish the "nostalgic evenings" with the Tunnel Towards Rutracker (TTR) table game.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">A deck of cards of <i>k</i>+1 various colors (colors enumerated from 0 to <i>k</i>) is used in the game.
Color 0 is special, this will be described further in the rules.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The game goes as follows.
At first Sasha takes several cards in his hand and shows them to Slava.
Then Slava shuffles the remaining deck and "blindly" gives Sasha <i>t</i> cards from the top. Only Sasha can see these cards.
Next Slava sets and reads out two numbers <i>x</i> and <i>y</i> &mdash; parameters of the tunnel that Sasha will have to build.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In order to build a tunnel, Sasha looks at his cards and names a color <i>color</i> (1 &le; <i>color</i> &le; <i>k</i>) used for construction.
After that Slava opens <i>y</i> top cards from the deck, selects all cards of colors 0 and <i>color</i> from them, and puts the selected cards on the table.
Then Sasha repeats this procedure with the cards in his hand: selects all cards of colors 0 and <i>color</i>, and puts the selected cards on the table.
Sasha wins if he puts on the table at least <i>x</i> cards more than Slava, otherwise he loses.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">When choosing a color for construction Sasha, of course, decides in favor of the one that maximizes the probability of his win.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Slava got tired of setting <i>x</i> and <i>y</i> parameters randomly.
Now before reading them out he wants to calculate the probability of Sasha’s win.
It is known that Slava shuffles the cards fairly &mdash; all combinations are equiprobable.
Slava also knows that Sasha employs the aferementioned strategy.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains two numbers <i>k</i> and <i>t</i> (1 &le; <i>k</i> &le; 100, 0 &le; <i>t</i> &le; 100) separated by space &nbsp;&mdash; maximum possible color and the number of cards that Slava gave to Sasha "blindly".</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The second line contains integers <i>c</i><sub>0</sub>, &hellip;, <i>c</i><sub><i>k</i></sub>, separated by space, where <i>c</i><sub><i>i</i></sub> is the number of cards of color <i>i</i> in the deck  (0 &le; <i>c</i><sub><i>i</i></sub>). Total number of cards in the deck does not exceed 100.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The third line contains integers <i>s</i><sub>0</sub>, &hellip;, <i>s</i><sub><i>k</i></sub>, separated by space, where <i>s</i><sub><i>i</i></sub> is the number of cards of color <i>i</i> which Sasha initially took in his hand in the beginning of the game (0 &le; <i>s</i><sub><i>i</i></sub> &le; <i>c</i><sub><i>i</i></sub>).</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The fourth line contains two integer numbers <i>x</i> and <i>y</i> (0 &le; <i>x</i>, <i>y</i> &le; 100) separated by space &nbsp;&mdash; tunnel parameters set by Slava.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">It is guaranteed that there are not less than <i>y</i> cards left in the deck after Sasha receives all his cards.</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Find the probability of Sasha’s win. Let the resulting probability be an irreducible fraction <i>p</i>/<i>q</i>, then output the number <i>p</i>&middot;(<i>q</i>)<sup>&minus;1</sup> modulo 10<sup>9</sup>+7.</DIV></DIV><H3 CLASS="problem_subtitle">Samples</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>3 1
1 2 0 1
0 1 0 0
1 2
</PRE></TD><TD><PRE>666666672
</PRE></TD></TR><TR><TD><PRE>2 3
6 5 3
2 2 0
5 3
</PRE></TD><TD><PRE>176428573
</PRE></TD></TR></TABLE><H3 CLASS="problem_subtitle">Notes</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In the first example Sasha may have the following sets of cards: {0, 1}, {1, 1} and {1, 3} (each variant has a probability of 1/3).
Two more cards (i.e. all cards remaining in the deck) will be opened when building the tunnel.
WIth any available combination Sasha will try to build the tunnel with cards of color 1, and in two cases of three he will succeed. Thus, the answer is 2/3.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Let’s look at the second example. Let’s take the case in which Sasha gets three cards of color 0.
It will occur with a probability of 1/30.
In this case he will choose color 1, because choosing color 1 gives a win probability of 31/35, and choosing color 2 &nbsp;&mdash; 1/35.
In the case when Sasha gets 3 cards of color 2 (this will happen with a probability of 1/120), he will choose color 2, because choosing color 1 gives a win probability of 0, and choosing color 2 &nbsp;&mdash; 1/35.
Having analyzed other combinations the same way, we get a total probability of 471/1400.</DIV></DIV><DIV CLASS="problem_source"><B>Problem Author: </B>Eugene Kurpilyansky<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=387&amp;num=11" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=2088"><nobr>2088. Nostalgic Evening</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>