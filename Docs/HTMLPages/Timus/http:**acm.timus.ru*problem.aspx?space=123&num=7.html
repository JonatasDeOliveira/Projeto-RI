<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>G. Titan Ruins: Waiting for Stability @ NEERC 2012, Eastern subregional contest @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=123&amp;num=7"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=123&amp;num=7&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=123&amp;num=7&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=123&amp;num=7&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=123&amp;num=7&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">NEERC 2012, Eastern subregional contest</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=123">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=123" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=123">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=123">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=123">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">G. Titan Ruins: Waiting for Stability</H2><DIV class="problem_limits">Time limit: 1.0 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">`Things are going from bad to worse,' Soren said when he and Alba entered a
room with painfully familiar coins.  This time something was a bit different.
All the coins were arranged into neat stacks, and strange soft claps were heard
from time to time. Soren felt that the coins contained magic power and some of
them were unstable.  A slight impulse was enough to make such a coin transform
into several new coins. Some of the new coins had no magic power and were
absolutely stable, while others were unstable and could transform in
the same manner.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Having studied the book lying on the table, Alba learned that there were only
several types of unstable coins and that coins of the same type always
transformed in the same way. When an unstable coin transformed all
the coins above it were pushed up and placed on top of the new coins.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">One of the walls had a vertical cavity exactly one coin wide. Soren conjectured
that the door would open if the cavity was filled with a stack of coins.  But
which coins? Alba and Soren understood that they couldn't put unstable coins
into the cavity, because their transformations might cause unpredictable
effects.  They decided to wait until one of the unstable coins turned into a
stack of stable coins, take several consecutive coins from this stack, and put
them into the cavity. But first they wanted to know the number of different
ways to fill the cavity in this way.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains the number <i>n</i> of coin types and the number <i>k</i> of coins in a stack that can fill the cavity (2 &le; <i>n</i>, <i>k</i> &le; 100). The <i>i</i>-th of the following lines describes the <i>i</i>-th type of coins.
If the type is stable, the line contains the number&nbsp;&minus;1. Otherwise, the line starts with the number
<i>k</i><sub><i>i</i></sub> of coins into which a coin of type&nbsp;<i>i</i> transforms. After this number, there are <i>k</i><sub><i>i</i></sub> integers <i>x</i><sub><i>ij</i></sub>,
which describe the appearing stack (1 &le; <i>k</i><sub><i>i</i></sub> &le; 100; 1 &le; <i>x</i><sub><i>ij</i></sub> &le; <i>n</i>).
The integers <i>x</i><sub><i>ij</i></sub> are the types of coins in this stack from bottom to top.
The sum of all <i>k</i><sub><i>i</i></sub> does not exceed&nbsp;100.
It is guaranteed that any unstable coin will eventually transform into a stack of
stable coins.</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Output the remainder in division of the number of different suitable parts of
stacks by 10<sup>9</sup> + 7.</DIV></DIV><H3 CLASS="problem_subtitle">Sample</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>7 3
3 3 2 2
3 4 5 5
1 7
-1
-1
3 7 7 7
-1
</PRE></TD><TD><PRE>5
</PRE></TD></TR></TABLE><H3 CLASS="problem_subtitle">Notes</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">A coin of type&nbsp;3 produces one coin of type&nbsp;7.
A coin of type&nbsp;2 produces a stack 4-5-5.
From a coin of type&nbsp;1, in the end we obtain a stack 7-4-5-5-4-5-5,
and a coin of type&nbsp;6 produces a stack 7-7-7.
Therefore, all possible parts of stacks of height&nbsp;3 are 7-7-7, 4-5-5, 7-4-5, 5-5-4, and 5-4-5.</DIV></DIV><DIV CLASS="problem_source"><B>Problem Author: </B>Ivan Burmistrov (prepared by Dmitry Ivankov)<BR><B>Problem Source: </B>NEERC 2012, Eastern subregional contest<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=123&amp;num=7" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=1916"><nobr>1916. Titan Ruins: Waiting for Stability</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>