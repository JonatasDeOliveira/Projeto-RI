<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>G. Go out of here! @ SPbSU ITMO contest. Petrozavodsk training camp. Winter 2008 @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=52&amp;num=7"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=52&amp;num=7&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=52&amp;num=7&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style52.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=52&amp;num=7&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=52&amp;num=7&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><H2 CLASS="title">SPbSU ITMO contest. Petrozavodsk training camp. Winter 2008</H2><DIV STYLE="text-align:center; margin-bottom:1em;"><A HREF="/contest.aspx?id=52">About</A> &nbsp; &nbsp; <A HREF="/problemset.aspx?space=52" CLASS="selectedMenu">Problems</A> &nbsp; &nbsp; <A HREF="/submit.aspx?space=52">Submit solution</A> &nbsp; &nbsp; <A HREF="/status.aspx?space=52">Judge status</A> &nbsp; &nbsp; <A HREF="/monitor.aspx?id=52">Standings</A></DIV><DIV STYLE="margin-bottom:1em;"><DIV STYLE="text-align:center; font-weight:bold;">Contest is over</DIV></DIV><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">G. Go out of here!</H2><DIV class="problem_limits">Time limit: 2.0 second<BR>Memory limit: 64 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Two scouts were sent on a top-secret mission. Unfortunately, they were captured and put in prison.
</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The plan of the prison is a rectangle divided into square cells with walls parallel to the North-to-South and East-to-West lines. There are doors between some pairs of neighbour cells and walls between the others. Surely, all the outer prison sides are walls&nbsp;&mdash; if not, what a sort of prison would it be?</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Scouts have to get out of the prison as soon as they could. However, there is an aggravating circumstance: they have been made blind (luckily, only temporarily) by special medicine. Still, both of them have transmitters embedded under their skin, so they could communicate with a base.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The problem is that the scouts didn't know their coordinates relative to the prison. Furthermore, they are unable neither to communicate, nor to see each other, even if occupy the same prison cell.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">So the headquaters ordered to proceed as follows: scouts in turn try to move to the neighbour prison cell in one of the four directions (North, South, East or West&nbsp;&mdash; what sort of a scout you are if you can't find north with eyes closed!) and report the direction and whether the move was successful or not.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The scouts should be located by their reports and helped to get out. You are given the records of reports of the scouts. Now, determine the minimal number of steps made by scouts after that it becomes possible to determine precisely the coordinates of the scouts.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains the prison width <i>W</i> and height <i>H</i>, and the number of scouts' reports <i>K</i> (<nobr>2 &le; <i>W</i> &middot; <i>H</i> &le; 150;</nobr> <nobr>1 &le; <i>K</i> &le; 10<sup>5</sup></nobr>). <i>W</i>&nbsp;is the number of square cells in the direction from East to West, and <i>H</i>&nbsp;&mdash; from North to South.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The reports of the scouts are located in the following <i>K</i> lines. Each report consists of two symbols: ("N", "S", "E", "W")&nbsp;&mdash; the direction and ("+", "-")&nbsp;&mdash; whether the move was successful or not. The odd reports are of the first scout, the even are of the second one.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">If a scout makes a successful move, he moves to the destination square. Otherwise, he remains in the same square.</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">If it is possible to determine the coordinates of both scouts, output "The scouts are safe at step number" and the one-based number of report after which they become known.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">If it is impossible to determine the coordinates, output "There is not enough data".</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">If there are mistakes in the reports (not in the input format), output "A mistake has been made at step number" and the number of first report incompatible with some of the previous ones. Note that you should output this even if there is a mistake after the moment the coordinates are determined.</DIV></DIV><H3 CLASS="problem_subtitle">Samples</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>2 1 4
E+ 
W-
N- 
S-
</PRE></TD><TD><PRE>The scouts are safe at step number 2</PRE></TD></TR><TR><TD><PRE>2 1 4
N-
W-
N-
S-</PRE></TD><TD><PRE>There is not enough data</PRE></TD></TR><TR><TD><PRE>2 1 4
N-
W-
N-
S+</PRE></TD><TD><PRE>A mistake has been made at step number 4</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Source: </B>SPbSU ITMO contest. Petrozavodsk training camp. Winter 2008.<BR></DIV></DIV></DIV><DIV CLASS="problem_links"><A HREF="print.aspx?space=52&amp;num=7" TARGET="_blank">Printable version</A><BR></DIV>To submit the solution for this problem go to the Problem set: <A HREF="problem.aspx?space=1&amp;num=1624"><nobr>1624. Go out of here!</nobr></A></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2017 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>