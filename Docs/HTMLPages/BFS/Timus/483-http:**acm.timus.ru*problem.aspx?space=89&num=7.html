<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>G. Zamkadye @ Ural SU contest. Petrozavodsk training camp. Summer 2010 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=89&amp;num=7"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=89&amp;num=7&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=89&amp;num=7&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=89&amp;num=7&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=89&amp;num=7&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><h2 class="title">Ural SU contest. Petrozavodsk training camp. Summer 2010</h2><div style="text-align:center; margin-bottom:1em;"><a href="/contest.aspx?id=89">About</a> &nbsp; &nbsp; <a href="/problemset.aspx?space=89" class="selectedMenu">Problems</a> &nbsp; &nbsp; <a href="/submit.aspx?space=89">Submit solution</a> &nbsp; &nbsp; <a href="/status.aspx?space=89">Judge status</a> &nbsp; &nbsp; <a href="/monitor.aspx?id=89">Standings</a></div><div style="margin-bottom:1em;"><div style="text-align:center; font-weight:bold;">Contest is over</div></div><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">G. Zamkadye</h2><div class="problem_limits">Time limit: 0.5 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">There are <i>n</i> cities in the kingdom of Zamkadye, situated on the Great Plain. Once upon
a time, a founder of the kingdom built <i>n</i> − 1 bidirectional roads. It is possible to get from any city to
any other city using these roads. The founder was very avaricious, so the total length of the roads
is minimal possible.</div></div><div class="problem_par"><div class="problem_par_normal">Karl the First, the king of Zamkadye, grew old and decided to start on a journey and visit all cities of his
kingdom. He began his trip at the city of Ponaekhovsk, where a royal palace was situated, and acted in the following way:
<ul>
<li> If Karl the First entered the city where he hadn't been before, he described his impressions in his diary
and remembered the city, from which he came into this one.
</li><li> If there was a road to the city where Karl the First hadn't been before, he took this road.
In the other case, Karl the First returned to the city, from which he came into this one for the first time.
</li></ul></div></div><div class="problem_par"><div class="problem_par_normal">Soon after the journey Karl the First died and his diary went to his son, Karl the Second…</div></div><div class="problem_par"><div class="problem_par_normal">A few decades later Karl the Second grew old and decided to visit all cities of his kingdom in the order they are described
in the diary of his father. Karl the Second decided to use a zeppelin, which doesn't care about the roads and can fly
from any city to any other city directly. Karl the Second was much lazier than his father, so he decided to visit
each city exactly once and return to Ponaekhovsk after that.</div></div><div class="problem_par"><div class="problem_par_normal">A wife of Karl the Second asked for your help. She wants to know when her husband returns, but she doesn't know
the order in which the cities are described in the diary. Calculate the minimal possible distance Karl the Second
will have to cover during his journey.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains a number of cities in Zamkadye <i>n</i> (2 ≤ <i>n</i> ≤ 1&nbsp;000). The cities
are numbered with integers from 1 to <i>n</i>, Ponaekhovsk has number 1. The <i>i</i>-th of the next <i>n</i> lines contains
coordinates of the <i>i</i>-th city. Coordinates are integers and don't exceed 10&nbsp;000 in their absolute value.
Any two cities are located in the different points.
Then follows a blank line and <i>n</i> − 1 lines describing the roads in Zamkadye. Each road is described as a pair of numbers of cities it connects.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output the minimal distance Karl the Second will have to cover on zeppelin, with relative error not exceeding 10<sup>−9</sup>.</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>4
0 0
1 0
1 1
0 1

1 2
1 4
4 3
</pre></td><td><pre>4.000
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Alexander Ipatov<br><b>Problem Source: </b>Ural SU Contest. Petrozavodsk Summer Session, August 2010<br></div></div></div><div class="problem_links"><a href="print.aspx?space=89&amp;num=7" target="_blank">Printable version</a><br></div>To submit the solution for this problem go to the Problem set: <a href="problem.aspx?space=1&amp;num=1847"><nobr>1847. Zamkadye</nobr></a></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>