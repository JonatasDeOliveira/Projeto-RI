<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>H. Kirill the Gardener 2 @ Ural FU Dandelion contest. Petrozavodsk training camp. Summer 2014 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=223&amp;num=8"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=223&amp;num=8&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=223&amp;num=8&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=223&amp;num=8&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=223&amp;num=8&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><h2 class="title">Ural FU Dandelion contest. Petrozavodsk training camp. Summer 2014</h2><div style="text-align:center; margin-bottom:1em;"><a href="/contest.aspx?id=223">About</a> &nbsp; &nbsp; <a href="/problemset.aspx?space=223" class="selectedMenu">Problems</a> &nbsp; &nbsp; <a href="/submit.aspx?space=223">Submit solution</a> &nbsp; &nbsp; <a href="/status.aspx?space=223">Judge status</a> &nbsp; &nbsp; <a href="/monitor.aspx?id=223">Standings</a></div><div style="margin-bottom:1em;"><div style="text-align:center; font-weight:bold;">Contest is over</div></div><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">H. Kirill the Gardener 2</h2><div class="problem_limits">Time limit: 4.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Today is the third moon day, so it’s time to plant potato! Gardener Kirill stands on a huge rectangle potato field which has
<i>n</i> × <i>m</i> sockets. Distance between two adjacent sockets equals one step. Luckily, they are already dug up. Also, Kirill has a bucket big enough to hold <i>k</i> potatoes.</div></div><div class="problem_par"><div class="problem_par_normal">Kirill is a very organized young man, so he plants potatoes using a strict algorithm. He starts from south-west corner and moves to the north
until he reaches the end of the field. Then he takes one step east and moves to the south border of the field.
After that, he takes one more step east. He repeats these steps while there are
still unprocessed sockets. However, the volume of his potato bucket is limited, so after each <i>k</i> sockets, Kirill has to go to the south border of the field and then one step out of the field to fill
the bucket again (there are infinitely many potatoes outside the south border of the field). After that, he makes one step north to return to the socket from which he left the field,
and then goes to the next unprocessed socket using the shortest path (Kirill comes from Manhattan and can move
only parallel to coordinate axes). Surely, if the bucket becomes empty after Kirill plants a potato in the last socket, he won’t go back for more potatoes.
How many steps will our young gardener make?</div></div><div class="problem_centered_picture"><img src="/image/get.aspx/ba8e842e-2268-4b6e-8f87-60b3b533218d" border="0" alt="Problem illustration"></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains the number of test cases: an integer <i>t</i> from 1 to 10.
Next <i>t</i> lines contain test cases, one test case per line.
Each test case line contains three integers <i>n</i>, <i>m</i>, <i>k</i> (1 ≤ <i>n</i>, <i>m</i> ≤ 10<sup>12</sup>; 1 ≤ <i>k</i> ≤ 10<sup>18</sup>; min(<i>n</i>, <i>m</i>) ≤ 10<sup>6</sup>) which are
the number of sockets on the field’s south border,
on its west border and the capacity of the bucket.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">For each test case, print one line containing the answer modulo 10<sup>9</sup> + 7.</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>1
5 3 5</pre></td><td><pre>20
</pre></td></tr></tbody></table><h3 class="problem_subtitle">Notes</h3><div class="problem_par"><div class="problem_par_normal">The sequence of visited squares will be as follows: 1, 2, 3, 4, 5, 6, out, 6, 7, 8, 9, 10,
11, 12, out, 12, 11, 12, 13, 14, 15 (see the picture).  So, the total number of steps is 20.</div></div><div class="problem_source"><b>Problem Author: </b>Ilya Kuchumov (Prepared by Kirill Borozdin)<br><b>Problem Source: </b>Ural FU Dandelion contest. Petrozavodsk training camp. Summer 2014<br></div></div></div><div class="problem_links"><a href="print.aspx?space=223&amp;num=8" target="_blank">Printable version</a><br></div>To submit the solution for this problem go to the Problem set: <a href="problem.aspx?space=1&amp;num=2043"><nobr>2043. Kirill the Gardener 2</nobr></a></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>