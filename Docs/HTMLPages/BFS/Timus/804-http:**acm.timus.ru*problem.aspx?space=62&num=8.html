<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>H. TruCoders Linguistics @ Novosibirsk SU contest. Petrozavodsk training camp. Summer 2007 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=62&amp;num=8"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=62&amp;num=8&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=62&amp;num=8&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=62&amp;num=8&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=62&amp;num=8&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><h2 class="title">Novosibirsk SU contest. Petrozavodsk training camp. Summer 2007</h2><div style="text-align:center; margin-bottom:1em;"><a href="/contest.aspx?id=62">About</a> &nbsp; &nbsp; <a href="/problemset.aspx?space=62" class="selectedMenu">Problems</a> &nbsp; &nbsp; <a href="/submit.aspx?space=62">Submit solution</a> &nbsp; &nbsp; <a href="/status.aspx?space=62">Judge status</a> &nbsp; &nbsp; <a href="/monitor.aspx?id=62">Standings</a></div><div style="margin-bottom:1em;"><div style="text-align:center; font-weight:bold;">Contest is over</div></div><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">H. TruCoders Linguistics</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Several months ago our team thought that it would be quite good if we knew language of
TruCoders, creatures that founded the first civilization on the Earth. (How, you haven't
heard about them yet?!) But because they were much more intellectual beings than humans,
their language (maybe) consisted of very many words and we doubt that we will be able to
remember all of them.
</div></div><div class="problem_par"><div class="problem_par_normal">It is known that every NSU2 teammate can memorize at most 10<sup>100000</sup> words. For example,
if TruCoders' language consists of 4000 words, one of them can learn 2000 words and every
of two others will learn 1000 words. And so NSU2 will be able to read all of TruCoders' texts.
</div></div><div class="problem_par"><div class="problem_par_normal">And now we want you to write a program that can determine whether the team can read all of TruCoders' texts or not.</div></div><div class="problem_par"><div class="problem_par_normal">TruCoders' language is based on English lowercase letters. Overall set of TruCoders' words
can be described as a string expression, giving the set of words. All TruCoders' words are
strings (possibly empty) of letters. So:

<ol>
<li>Letter 'a'..'z' means the set consisting of one word consisting of this letter.</li>

<li>Symbol '0' (zero) means an empty set of words.</li>

<li>(&lt;<i>expression</i>&gt;) means the same set of words as &lt;<i>expression</i>&gt;.</li>

<li>&lt;<i>symbol</i>&gt; is either a lowercase letter or '0' or an expression in parentheses&nbsp;— (&lt;<i>expression</i>&gt;).</li>

<li>&lt;<i>expression</i>&gt; is &lt;<i>concatenation</i>&gt; or &lt;<i>concatenation</i><sub>1</sub>&gt;|&lt;<i>concatenation</i><sub>2</sub>&gt;|…</li>|&lt;<i>concatenation<sub>n</sub></i>&gt; and it means union of sets of words from all &lt;<i>concatenation<sub>i</sub></i>&gt;.

<li>&lt;<i>concatenation</i>&gt; is &lt;<i>closure</i>&gt; or &lt;<i>closure</i><sub>1</sub>&gt;&lt;<i>closure</i><sub>2</sub>&gt;…&lt;<i>closure<sub>n</sub></i>&gt;
and it means set of all words that are concatenations of a word from &lt;<i>closure</i><sub>1</sub>&gt;, a word from &lt;<i>closure</i><sub>2</sub>&gt; and so on.</li>

<li>&lt;<i>closure</i>&gt; is &lt;<i>symbol</i>&gt; or &lt;<i>symbol</i>&gt;* or &lt;<i>closure</i>&gt;* and it means
(if there is '*') &lt;<i>symbol</i>&gt;<sup>0</sup>|&lt;<i>symbol</i>&gt;<sup>1</sup>|…|&lt;<i>symbol</i>&gt;<sup><i>n</i></sup>|… (arbitrarily many times)
where &lt;<i>symbol</i>&gt;<sup><i>i</i></sup> means &lt;<i>symbol</i>&gt;&lt;<i>symbol</i>&gt;…&lt;<i>symbol</i>&gt; (<i>i</i> times) and &lt;<i>symbol</i>&gt;<sup>0</sup>
means the set consisting of one empty word. And if &lt;<i>closure</i>&gt; is &lt;<i>symbol</i>&gt; it means the same set of words as
&lt;<i>symbol</i>&gt; of course.</li>
</ol>

For example, if language is described as "((a|b)(c|d))", it consists of four words:
"ac", "bc", "ad" and "bd".
</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">In the input there is one nonempty string with maximal length of 10000 describing TruCoders' language.
</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">If our team will be able to remember all words of TruCoders' language write 'F'.
In the other case write 'N'.
</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>((a|b)(c|d))
</pre></td><td><pre>F</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Source: </b>Novosibirsk SU Contest. Petrozavodsk training camp, September 2007<br></div></div></div><div class="problem_links"><a href="print.aspx?space=62&amp;num=8" target="_blank">Printable version</a><br></div>To submit the solution for this problem go to the Problem set: <a href="problem.aspx?space=1&amp;num=1559"><nobr>1559. TruCoders Linguistics</nobr></a></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>