<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>A. Pass Licenses @ NEERC, Eastern subregion, Yekaterinburg, October 2006 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=56&amp;num=1"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=56&amp;num=1&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=56&amp;num=1&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=56&amp;num=1&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=56&amp;num=1&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><h2 class="title">NEERC, Eastern subregion, Yekaterinburg, October 2006</h2><div style="text-align:center; margin-bottom:1em;"><a href="/contest.aspx?id=56">About</a> &nbsp; &nbsp; <a href="/problemset.aspx?space=56" class="selectedMenu">Problems</a> &nbsp; &nbsp; <a href="/submit.aspx?space=56">Submit solution</a> &nbsp; &nbsp; <a href="/status.aspx?space=56">Judge status</a> &nbsp; &nbsp; <a href="/monitor.aspx?id=56">Standings</a></div><div style="margin-bottom:1em;"><div style="text-align:center; font-weight:bold;">Contest is over</div></div><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">A. Pass Licenses</h2><div class="problem_limits">Time limit: 2.5 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">A New Russian Kolyan believes that to spend his time in traffic jams is below his dignity. This is why he had put an emergency flashlight upon the roof of his Hummer and had no problems until a recent decision of the city administration. Now each street of the city belongs to one or several categories, and a driver must have a separate license in order to use an emergency flashlight in the streets of each category. If a street belongs to several categories, it is sufficient to have a license only for one of these categories. For each category, a license is issued by a separate city official. Although these officials are different, they accept bribes of the same amount for giving a license. Help Kolyan to find a way from his home to work such that he can go this way with his flashlight turned on and having spent the minimal amount of money for bribes.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The input contains the street plan in the following format. There are integers <i>K</i>, <i>N</i>, and <i>M</i> in the first line, where <i>K</i> is the number of street categories (1 ≤ <i>K</i> ≤ 20), <i>N</i> is the number of crossroads (2 ≤ <i>N</i> ≤ 30), and <i>M</i> is the number of descriptions of street segments between crossroads.</div></div><div class="problem_par"><div class="problem_par_normal">Each of the next <i>M</i> lines describes a street segment by three integers <i>V<sub>1</sub></i> <i>V<sub>2</sub></i> <i>C</i>, where <i>V<sub>1</sub></i> and <i>V<sub>2</sub></i> are the numbers of the crossroads limiting this segment, and <i>C</i> is its category. Crossroads are numbered from 0 to <i>N</i>&nbsp;–&nbsp;1, categories are numbered from 0 to <i>K</i>&nbsp;–&nbsp;1. For any pair of crossroads no two segments of the same category connect these crossroads.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output in the first line the minimal number of licenses necessary for going from the crossroad 0 (Kolyan's home) to the crossroad 1 (Kolyan's work) with an emergency flashlight turned on.</div></div><div class="problem_par"><div class="problem_par_normal">In the second line, give the list of categories for which licenses must be obtained. The numbers should be separated with spaces. It is guaranteed that such list is always exist.</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3 3 3
0 2 0
0 2 1
1 2 2
</pre></td><td><pre>2
0 2
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Magaz Asanov, Alexander Mironenko, Anton Botov, Evgeny Krokhalev<br><b>Problem Source: </b>Quarter-Final of XXXI ACM ICPC - Yekaterinburg - 2006<br></div></div></div><div class="problem_links"><a href="print.aspx?space=56&amp;num=1" target="_blank">Printable version</a><br></div>To submit the solution for this problem go to the Problem set: <a href="problem.aspx?space=1&amp;num=1500"><nobr>1500. Pass Licenses</nobr></a></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>