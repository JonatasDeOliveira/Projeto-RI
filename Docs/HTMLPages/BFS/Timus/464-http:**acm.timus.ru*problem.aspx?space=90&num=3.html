<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>C. Laser Technologies @ Ural SU Team.GOV contest. Petrozavodsk training camp. Summer 2011 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=90&amp;num=3"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=90&amp;num=3&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=90&amp;num=3&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=90&amp;num=3&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=90&amp;num=3&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><h2 class="title">Ural SU Team.GOV contest. Petrozavodsk training camp. Summer 2011</h2><div style="text-align:center; margin-bottom:1em;"><a href="/contest.aspx?id=90">About</a> &nbsp; &nbsp; <a href="/problemset.aspx?space=90" class="selectedMenu">Problems</a> &nbsp; &nbsp; <a href="/submit.aspx?space=90">Submit solution</a> &nbsp; &nbsp; <a href="/status.aspx?space=90">Judge status</a> &nbsp; &nbsp; <a href="/monitor.aspx?id=90">Standings</a></div><div style="margin-bottom:1em;"><div style="text-align:center; font-weight:bold;">Contest is over</div></div><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">C. Laser Technologies</h2><div class="problem_limits">Time limit: 0.5 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Almost every gift shop sells cubes and balls of glass with beautiful images
inside them.
Young girl Anya wanted to learn the way these images are created,
so she entered the department of laser technologies.
Now she knows that if two laser beams of frequency 3.1415 PHz intersect
inside the glass object, the glass will become opaque at the intersection
point, although this opacity will not block other laser beams passing
through this point.</div></div><div class="problem_par"><div class="problem_par_normal">Now Anya herself wants to draw an image inside a polygonal prism.
She decided to start with a flat image located in a section
parallel to the base of the prism.
Unfortunately, Anya spilled her tea on the second laser emitter,
and it broke down.
However, Anya knows that if two laser beams will pass through some point
consecutively within a short period of time, this point will also
become opaque.
Now she wants to move the laser emitter all the way
along the perimeter of the section.
Laser beam will always lie inside the plane of this section.
Laser beam should always be directed to a special receiver.</div></div><div class="problem_par"><div class="problem_par_normal">The frequency of the laser beams is extremely high,
so the opaque points will be very close to each other,
and will be recognized as parts of continuous curves.
Anya wants to know the total length of all these curves,
and asks for your help.</div></div><div class="problem_par"><div class="problem_par_normal">More formally, the section of the prism is a convex polygon with <i>n</i> vertices.
Initially, Anya places an emitter at some point of its perimeter.
She then places the receiver at some other point of the perimeter
such that the distance between the emitter and the receiver
measured along the perimeter is <i>d</i>.
After that, Anya starts to move both the emitter and the receiver
with equal constant speed in one direction along the perimeter.
She stops when the emitter and the receiver move to their initial positions.</div></div><img src="/image/get.aspx/998a4cf5-b3c6-4eba-bbd1-9c24ea07f00f" border="0" alt="Problem illustration" align="RIGHT" class="problem_raimage"><div class="problem_par"><div class="problem_par_normal">The formal definition of the resulting opaque parts of curves is as follows.
Consider some moment <i>t</i> when the emitter is at point <i>A</i> and receiver
is at point <i>B</i>.
In a near moment <i>t</i> + <i>ε</i>, the emitter
(moving along the perimeter) arrives at some point <i>A</i>' while the receiver
(moving with the same speed along some other part of the perimeter)
arrives at some point <i>B</i>'.
In general case, there will be exactly one
intersection point of segments <i>A</i><i>B</i> and <i>A</i>'<i>B</i>'.
Now let <i>ε</i> → 0 to get the point which becomes opaque
at the moment <i>t</i>.
Do that for all possible moments <i>t</i> to get all the points
which become opaque.
This set of points in fact can be viewed as a set of curves.
Your task is to find their total length.</div></div><div class="problem_par"><div class="problem_par_normal">On the illustration, the perimeter is a square, dashed lines represent
the laser beam at different moments of time, and bold points are the points
which become opaque as the emitter and the receiver move along the perimeter.
The distance between the emitter and the receiver
(measured along the perimeter) remains equal to the constant <i>d</i>.
Note that it does <b>not</b> mean the lengths of dashed lines are equal.
As you can see, the opaque points lie on a certain curve.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains an integer <i>n</i> (3 ≤ <i>n</i> ≤ 10&nbsp;000).
Each of the following <i>n</i> lines contains two integers which are the
coordinates of vertices of the polygon in counter-clockwise order.
The coordinates don't exceed 10<sup>6</sup> by their absolute values.
It is guaranteed that no three vertices lie on the same line.</div></div><div class="problem_par"><div class="problem_par_normal">The last line contains a positive integer <i>d</i>.
It is guaranteed that <i>d</i> doesn't exceed half of the length of polygon's
perimeter and is strictly greater than the longest of its sides.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output the total length of all curves formed by the opaque points
with absolute or relative error not exceeding 10<sup>−6</sup>.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3
-1 0
1 0
0 10
11
</pre></td><td><pre>22.3730148246
</pre></td></tr><tr><td><pre>4
0 0
10 0
10 10
0 10
11
</pre></td><td><pre>56.1255583559
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Denis Dublennykh<br><b>Problem Source: </b>Ural SU Team.GOV Contest. Petrozavodsk Summer Session, August 2011<br></div></div></div><div class="problem_links"><a href="print.aspx?space=90&amp;num=3" target="_blank">Printable version</a><br></div>To submit the solution for this problem go to the Problem set: <a href="problem.aspx?space=1&amp;num=1853"><nobr>1853. Laser Technologies</nobr></a></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>