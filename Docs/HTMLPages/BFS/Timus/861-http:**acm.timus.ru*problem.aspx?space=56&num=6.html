<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>F. Oil Transfer @ NEERC, Eastern subregion, Yekaterinburg, October 2006 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=56&amp;num=6"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=56&amp;num=6&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=56&amp;num=6&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=56&amp;num=6&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=56&amp;num=6&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><h2 class="title">NEERC, Eastern subregion, Yekaterinburg, October 2006</h2><div style="text-align:center; margin-bottom:1em;"><a href="/contest.aspx?id=56">About</a> &nbsp; &nbsp; <a href="/problemset.aspx?space=56" class="selectedMenu">Problems</a> &nbsp; &nbsp; <a href="/submit.aspx?space=56">Submit solution</a> &nbsp; &nbsp; <a href="/status.aspx?space=56">Judge status</a> &nbsp; &nbsp; <a href="/monitor.aspx?id=56">Standings</a></div><div style="margin-bottom:1em;"><div style="text-align:center; font-weight:bold;">Contest is over</div></div><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">F. Oil Transfer</h2><div class="problem_limits">Time limit: 2.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">A New Russian Kolyan wants an oil delivery to foreign partners to become his main source of income. His company owns a number of pumping stations with network of pipelines connecting them. First, Kolyan wants to increase the amount of the transferred oil by 1 million barrels per day. Help Kolyan to achieve this goal spending the minimal amount of money.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains an integer <i>N</i>, which is the number of pumping stations between which there are pipelines (1&nbsp;≤&nbsp;<i>N</i>&nbsp;≤&nbsp;10000). The stations are numbered from 1 to <i>N</i>. The next <i>N</i> lines describe the stations.</div></div><div class="problem_par"><div class="problem_par_normal">The <i>i<sup>th</sup></i> line contains quadruples of integers <i>a</i> <i>b</i> <i>c</i> <i>d</i> (1 ≤ <i>a</i> ≤ <i>N</i>; 0 ≤ <i>c</i> ≤ <i>b</i> ≤ 10000;
0 ≤ <i>d</i> ≤ 10<sup>6</sup>), where<br>
<i>a</i> is the number of a station to which a pipeline from the station <i>i</i> exists,<br>
<i>b</i> is the flow capacity of the pipeline from <i>i</i> to <i>a</i> in millions of barrels per day,<br>
<i>c</i> is the present oil flow from <i>i</i> to <i>a</i> in millions of barrels per day,<br>
<i>d</i> is the amount of money (in roubles) necessary for the increase in the flow capacity of the pipeline from <i>i</i> to <i>a</i> by 1 million barrels per day.
There can be at most 1 pipeline from station <i>i</i> to station <i>a</i> and no pipeline connects a station with itself.</div></div><div class="problem_par"><div class="problem_par_normal">These quadruples in the line are separated with commas, and there is a period after the last quadruple. If oil is not transported anywhere from the <i>i<sup>th</sup></i> station, then the corresponding line contains only one symbol ".". It is guaranteed that there are no more than 100000 quadruples describing pipelines in the input.</div></div><div class="problem_par"><div class="problem_par_normal">Oil is transferred to foreign partners at only one pumping station with the number <i>N</i>. The cross-border oil flow is equal to the incoming flow at this station. From this station, oil is not transported to other pumping stations in the described pipeline network. Pumping stations with numbers less than <i>N</i> are transit stations. It is known that for each transit station the incoming oil flow is not more than the outgoing flow. If the incoming flow is less than the outgoing flow, then there is an oil-producing well nearby, whose oil production can easily be increased by 1 million barrels per day. </div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">In the first line output the minimal cost <i>K</i> of reconstructing the pipeline network in such a way that the oil transfer to foreign partners is increased by 1 million barrels per day. Then output <i>N</i> lines describing the oil flow in the pipelines after the reconstruction, in the following format: the <i>i<sup>th</sup></i> of these lines must contain a list of pairs <i>a b</i> separated with commas; <i>a</i> is the number of a station to which oil is transported from the station <i>i</i>, and <i>b</i> is the number of the transported oil in millions of barrels per day. Each of these lines must end with a period.</div></div><div class="problem_par"><div class="problem_par_normal">If it's impossible to reach Kolyan's goal then output single word "Impossible".</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>4
2 1 1 1, 3 1 1 3.
3 1 0 2, 4 1 1 2.
4 1 1 1.
.
</pre></td><td><pre>2
2 2, 3 1.
3 1, 4 1.
4 2.
.
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Magaz Asanov, Evgeny Krokhalev<br><b>Problem Source: </b>Quarter-Final of XXXI ACM ICPC - Yekaterinburg - 2006<br></div></div></div><div class="problem_links"><a href="print.aspx?space=56&amp;num=6" target="_blank">Printable version</a><br></div>To submit the solution for this problem go to the Problem set: <a href="problem.aspx?space=1&amp;num=1505"><nobr>1505. Oil Transfer</nobr></a></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>