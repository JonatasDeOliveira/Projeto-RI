<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>C. Titan Ruins: Passing through Walls @ NEERC 2012, Eastern subregional contest @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=123&amp;num=3"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=123&amp;num=3&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=123&amp;num=3&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=123&amp;num=3&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=123&amp;num=3&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><h2 class="title">NEERC 2012, Eastern subregional contest</h2><div style="text-align:center; margin-bottom:1em;"><a href="/contest.aspx?id=123">About</a> &nbsp; &nbsp; <a href="/problemset.aspx?space=123" class="selectedMenu">Problems</a> &nbsp; &nbsp; <a href="/submit.aspx?space=123">Submit solution</a> &nbsp; &nbsp; <a href="/status.aspx?space=123">Judge status</a> &nbsp; &nbsp; <a href="/monitor.aspx?id=123">Standings</a></div><div style="margin-bottom:1em;"><div style="text-align:center; font-weight:bold;">Contest is over</div></div><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">C. Titan Ruins: Passing through Walls</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Soren opened his eyes with an effort but this didn't help much—there was a deaf darkness around.
An unbearable pain in the back of his head prompted that he had hit his head in the fall.
Spreading his arms he realized that he was in a very small room without any openings.
Luckily, the wand was intact, which meant that Soren could still use magic.</div></div><div class="problem_par"><div class="problem_par_normal">Casting the Scanning Spell, he discovered disappointingly that identical small square rooms with solid walls were spreading evenly in all directions.
There was only one thing to be glad about—Alba, still alive, was in the adjoining room. Soren contacted him telepathically.<br>
`Are you alright?'<br>
`Almost.'<br>
`Have you got any ideas on how to get out of here?'<br>
`There's no way out through the top, but we can try passing through the walls. Some of them are thinner than others.
If we combine our powers, we can take one of us through a thin wall. It's a pity the rooms are so small—we can't get into the same room together.
And we always have to stay in rooms that have at least one common corner so that we can keep contact. It'll be hard, but let's try.'</div></div><div class="problem_par"><div class="problem_par_normal">Soren draw a scheme of all the rooms and marked thin and thick walls. It turned out that all the rooms together formed a large rectangle,
around which there were no walls, so that it was possible to move freely anywhere outside the rectangle.
Now Alba and Soren had to understand how they should move between the rooms to get both of them out of the trap.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains the dimensions of the rectangle <i>n</i> and <i>m</i> (2 ≤ <i>n</i>, <i>m</i> ≤ 250).
In the following 2<i>n</i> + 1 lines you are given a scheme of the trap. There are 2<i>m</i> + 1 symbols in each line.
Soren and Alba are denoted by the symbols “1” and “2”; their rooms have at least one common corner.
The symbols “|” and “-” denote thick walls. The symbols “.”, “+”, and “ ” denote thin walls, corners, and empty rooms, respectively.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">If Soren and Alba can't get out of the trap, output the line “Death”. Otherwise, output the minimum number of passages through thin walls that Soren and Alba must make to free themselves.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3 4
+.+-+-+-+
| . .1. |
+-+-+-+.+
| .2. . |
+.+.+.+-+
| . | | |
+.+.+-+-+
</pre></td><td><pre>13
</pre></td></tr><tr><td><pre>2 2
+-+-+
.1|2.
+-+-+
| | |
+-+-+
</pre></td><td><pre>Death
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Stanislav Vasilyev (prepared by Denis Mukhametianov)<br><b>Problem Source: </b>NEERC 2012, Eastern subregional contest<br></div></div></div><div class="problem_links"><a href="print.aspx?space=123&amp;num=3" target="_blank">Printable version</a><br></div>To submit the solution for this problem go to the Problem set: <a href="problem.aspx?space=1&amp;num=1912"><nobr>1912. Titan Ruins: Passing through Walls</nobr></a></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>