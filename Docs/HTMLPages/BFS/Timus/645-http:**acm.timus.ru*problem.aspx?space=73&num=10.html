<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>J. Penguin-Avia @ Ural Championship 2009 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=73&amp;num=10"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=73&amp;num=10&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=73&amp;num=10&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=73&amp;num=10&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=73&amp;num=10&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><h2 class="title">Ural Championship 2009</h2><div style="text-align:center; margin-bottom:1em;"><a href="/contest.aspx?id=73">About</a> &nbsp; &nbsp; <a href="/problemset.aspx?space=73" class="selectedMenu">Problems</a> &nbsp; &nbsp; <a href="/submit.aspx?space=73">Submit solution</a> &nbsp; &nbsp; <a href="/status.aspx?space=73">Judge status</a> &nbsp; &nbsp; <a href="/monitor.aspx?id=73">Standings</a></div><div style="margin-bottom:1em;"><div style="text-align:center; font-weight:bold;">Contest is over</div></div><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">J. Penguin-Avia</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">The Penguin-Avia airline, along with other Antarctic airlines, experiences
financial difficulties because of the world's economic crisis. People of
Antarctica economize on flights and use trains or prefer to stay at home.
The airline's management hopes that the number of their clients will increase
in the summer due to the tourists visiting the coastal resorts. In order to
hold out till the summer, it was decided to optimize the flight scheme by
cancelling some flights and introducing some new flights.
</div></div><div class="problem_par"><div class="problem_par_normal">Director of Penguin-Avia assumes that after the optimization the flight scheme
must have the following properties:
<ol>
<li>Using one or more Penguin-Avia flights, one can get from any Antarctic airport to any
other.
</li><li>The scheme must contain the minimal number of flights among all the schemes
satisfying the first property.
</li></ol>
However, not everything is that easy in Antarctica. For cancelling a flight,
the airline must pay a one-time forfeit of <i>d</i> Antarctic dollars. To
obtain slots for a new flight, the company must spend <i>a</i> Antarctic
dollars to grease the palm of the godfather of the Antarctic mafia nicknamed Walrus.
</div></div><div class="problem_par"><div class="problem_par_normal">Help Director of Penguin-Avia transform the existing flight scheme spending as
little money as possible. For doing that, you will be presented with a travel card
for all flights of the airline.
</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">In the first line you are given the number <i>n</i> of airports in Antarctica, 2 ≤ <i>n</i> ≤ 100.
In the second line you are given the integers <i>d</i> and <i>a</i>, 1 ≤ <i>d</i>, <i>a</i> ≤ 10<sup>6</sup>.
The following <i>n</i> lines describe the existing scheme of Penguin-Avia
flights in the form of an <i>n</i> × <i>n</i> matrix. There is “1” in a cell (<i>i</i>,
<i>j</i>) of the matrix if the airline has flights between the airports <i>i</i> and <i>j</i>.
Otherwise, there is “0” in the cell. It is guaranteed that the matrix is symmetric
and there are only zeros on its diagonal.
</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">In the first line output the minimal amount of money necessary for the
optimization of the existing flight scheme. In the next <i>n</i> lines give the
plan of changing the scheme in the form of an <i>n</i> × <i>n</i> matrix.
A cell (<i>i</i>, <i>j</i>) of this matrix contains the symbol
“d” if the flights between the airports <i>i</i> and <i>j</i>
should be cancelled. In the case when a new flight should be introduced between
these airports, the cell contains the symbol “a”. The remaining
cells contain the symbol “0”. The matrix must be symmetric.
If there are several optimal schemes, output any one of them.
</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>6
2 3
011000
101000
110000
000011
000101
000110
</pre></td><td><pre>7
0d0000
d00000
000a00
00a0d0
000d00
000000
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Alexander Ipatov<br><b>Problem Source: </b>The 13th Urals Collegiate Programing Championship, April 04, 2009<br></div></div></div><div class="problem_links"><a href="print.aspx?space=73&amp;num=10" target="_blank">Printable version</a><br></div>To submit the solution for this problem go to the Problem set: <a href="problem.aspx?space=1&amp;num=1709"><nobr>1709. Penguin-Avia</nobr></a></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>