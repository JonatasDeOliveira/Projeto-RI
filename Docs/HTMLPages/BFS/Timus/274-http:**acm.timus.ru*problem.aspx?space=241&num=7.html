<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>G. Awesome Backup System @ Ural Regional School Programming Contest 2014 @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=241&amp;num=7"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=241&amp;num=7&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=241&amp;num=7&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=241&amp;num=7&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=241&amp;num=7&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><h2 class="title">Ural Regional School Programming Contest 2014</h2><div style="text-align:center; margin-bottom:1em;"><a href="/contest.aspx?id=241">About</a> &nbsp; &nbsp; <a href="/problemset.aspx?space=241" class="selectedMenu">Problems</a> &nbsp; &nbsp; <a href="/submit.aspx?space=241">Submit solution</a> &nbsp; &nbsp; <a href="/status.aspx?space=241">Judge status</a> &nbsp; &nbsp; <a href="/monitor.aspx?id=241">Standings</a></div><div style="margin-bottom:1em;"><div style="text-align:center; font-weight:bold;">Contest is over</div></div><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">G. Awesome Backup System</h2><div class="problem_limits">Time limit: 2.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">It is known that all people can be divided into two groups: those who have never lost important data and those who regularly perform data backups. Kirill is on his way from the first group to the second after the incident with tests described in the problem “<a href="/problem.aspx?space=1&amp;num=2035" target="_blank">Another Dress Rehearsal</a>”.
Not satisfied with the existing data backup solutions for various reasons, he decided to design his own backup system. He chose a simple but proud name for it: the “Awesome Backup System,” ABS for short. Since errors in such an important system are absolutely unacceptable, Kirill asks you to test the beta version of his product.</div></div><div class="problem_par"><div class="problem_par_normal">The ABS is organized as follows: let there be <i>n</i> computers in a local network. The computers are numbered with integers from 1 to&nbsp;<i>n</i>.
Some pairs of computers are connected by cables. For economy, the network doesn’t have unnecessary cables, which means that there is a unique cable path between any two computers. Initially there are <i>a</i><sub><i>i</i></sub> bytes of information written on the <i>i</i>-th computer.
The ABS can process two types of requests:
<ol>
<li>
Copy all the information from computer&nbsp;<i>v</i> to all adjacent computers (i.e., to all computers directly connected to it by a cable)
If computer&nbsp;<i>v</i> had <i>x</i><sub><i>v</i></sub> bytes of information, then, after copying, all adjacent computers will have <i>x</i><sub><i>v</i></sub> bytes of information more, while computer&nbsp;<i>v</i> will still have <i>x</i><sub><i>v</i></sub> bytes of information.
</li><li>
Output the current amount of information on computer&nbsp;<i>v</i>. Since this amount can grow very quickly, output the remainder of its division by the number&nbsp;10<sup>9</sup>&nbsp;+&nbsp;7.
</li></ol>
For testing the ABS, you are asked to write a program for a quick processing of such requests.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains the number <i>n</i> of computers in the network (1 ≤ <i>n</i> ≤ 10<sup>5</sup>).
In the second line you are given integers <i>a</i><sub>1</sub>,&nbsp;…,&nbsp;<i>a</i><sub><i>n</i></sub>, which are the amounts of information (in bytes) on the computers at the initial time (0 ≤ <i>a</i><sub><i>i</i></sub> ≤ 10<sup>9</sup>). Each of the following <i>n</i>&nbsp;−&nbsp;1 lines contains integers <i>x</i> and <i>y</i> (1 ≤ <i>x</i>, <i>y</i> ≤ <i>n</i>; <i>x</i> ≠ <i>y</i>), which mean that the computers with numbers <i>x</i> and&nbsp;<i>y</i> are connected by a cable. It is guaranteed that the network is connected.</div></div><div class="problem_par"><div class="problem_par_normal">The next line contains the number <i>m</i> of requests to the system (1 ≤ <i>m</i> ≤ 10<sup>5</sup>). In the following <i>m</i> lines you are given the requests in the order of their execution. Each request is a pair of integers <i>t</i> and&nbsp;<i>v</i> (1 ≤ <i>t</i> ≤ 2 and 1 ≤ <i>v</i> ≤ <i>n</i>), where <i>t</i> specifies the type of the request and <i>v</i> is the number of the computer to which the request is applied.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">For each request of the second type, output in a separate line the remainder of the division of the answer by the number&nbsp;10<sup>9</sup>&nbsp;+&nbsp;7.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>4
1 1 1 1
1 2
1 3
2 4
9
2 1
2 2
2 3
2 4
1 1
2 1
2 2
2 3
2 4
</pre></td><td><pre>1
1
1
1
1
2
2
1
</pre></td></tr><tr><td><pre>2
1 1
1 2
14
2 2
2 1
1 1
2 2
1 2
2 1
1 1
2 2
1 2
2 1
1 1
2 2
1 2
2 1
</pre></td><td><pre>1
1
2
3
5
8
13
21
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Nikita Sivukhin<br><b>Problem Source: </b>Ural Regional School Programming Contest 2014<br></div></div></div><div class="problem_links"><a href="print.aspx?space=241&amp;num=7" target="_blank">Printable version</a><br></div>To submit the solution for this problem go to the Problem set: <a href="problem.aspx?space=1&amp;num=2030"><nobr>2030. Awesome Backup System</nobr></a></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>