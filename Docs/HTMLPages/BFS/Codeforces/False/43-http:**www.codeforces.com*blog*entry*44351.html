<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="6be8332ac61f4ba74ddca248880082ac">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">
    <script type="text/javascript" async="" src="http://www.google-analytics.com/ga.js"></script><script id="facebook-jssdk" src="//connect.facebook.net/en_US/sdk.js"></script><script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }
    </script>
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="d1">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="http://st.codeforces.com/s/95195/images/codeforces-telegram-square.png">
    <link rel="image_src" href="http://st.codeforces.com/s/95195/images/codeforces-telegram-square.png">
    <meta property="og:title" content="[Tutorial] Sack (dsu on tree) - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>[Tutorial] Sack (dsu on tree) - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/font-awesome.min.css" type="text/css" charset="utf-8">

        <link href="//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">
        <link href="//fonts.googleapis.com/css?family=Cuprum&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">


    <link rel="shortcut icon" type="image/png" href="http://st.codeforces.com/s/95195/favicon.png">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="http://st.codeforces.com/s/95195/css/community.css" type="text/css" charset="utf-8">

    <!-- MathJax -->
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    </script>
    <script type="text/javascript" async="" src="http://mathjax.codeforces.com/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/pushstream.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/facebox.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/controls/wysiwyg.link.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/aac2d68a80f4a13435a138c396c62a83/en/codeforces-options.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/js/codeforces.js?v=20160131"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/markitup/skins/markitup/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="http://st.codeforces.com/s/95195/markitup/sets/markdown/style.css" type="text/css" charset="utf-8">

    <script type="text/javascript" src="//yandex.st/share/share.js" charset="utf-8"></script>

    <script type="text/javascript" src="http://st.codeforces.com/s/95195/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="http://st.codeforces.com/s/95195/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->


<style type="text/css" media="screen">#swfcontainer {visibility:hidden}</style><style type="text/css" id="ya_share_style">.b-share-popup-wrap{z-index:1073741823;position:absolute;width:500px}.b-share-popup{position:absolute;z-index:1073741823;border:1px solid #888;background:#FFF;color:#000}.b-share-popup-wrap .b-share-popup_down{top:0}.b-share-popup-wrap .b-share-popup_up{bottom:0}.b-share-popup-wrap_state_hidden{position:absolute!important;top:-9999px!important;right:auto!important;bottom:auto!important;left:-9999px!important;visibility:hidden!important}.b-share-popup,x:nth-child(1){border:0;padding:1px!important}@media all and (resolution=0){.b-share-popup,x:nth-child(1),x:-o-prefocus{padding:0!important;border:1px solid #888}}.b-share-popup__i{display:-moz-inline-box;display:inline-block;padding:5px 0!important;overflow:hidden;vertical-align:top;white-space:nowrap;visibility:visible;background:#FFF;-webkit-box-shadow:0 2px 9px rgba(0,0,0,.6);-moz-box-shadow:0 2px 9px rgba(0,0,0,.6);box-shadow:0 2px 9px rgba(0,0,0,.6)}.b-share-popup__item{font:1em/1.25em Arial,sans-serif;display:block;padding:5px 15px!important;white-space:nowrap;background:#FFF}.b-share-popup__item,a.b-share-popup__item:link,a.b-share-popup__item:visited{text-decoration:none!important;border:0!important}a.b-share-popup__item{cursor:pointer}a.b-share-popup__item .b-share-popup__item__text{display:inline;text-decoration:underline;color:#1A3DC1}a.b-share-popup__item:hover{word-spacing:0}a.b-share-popup__item:hover .b-share-popup__item__text{color:red;cursor:pointer}.b-share-popup__icon{display:-moz-inline-box;display:inline-block;margin:-3px 0 0;padding:0 5px 0 0!important;vertical-align:middle}.b-share-popup__icon_input{width:21px;height:16px;margin-top:-6px;padding:0!important}.b-share-popup__icon__input{margin-right:0;margin-left:2px;vertical-align:top}.b-share-popup__spacer{display:block;padding-top:10px!important}.b-share-popup__header{font:86%/1em Verdana,sans-serif;display:block;padding:10px 15px 5px!important;color:#999}.b-share-popup__header_first{padding-top:5px!important}.b-share-popup__input{font:86%/1em Verdana,sans-serif;display:block;padding:5px 15px!important;color:#999;text-align:left}.b-share-popup__input__input{font:1em/1em Verdana,sans-serif;display:block;width:10px;margin:5px 0 0;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;resize:none;text-align:left;direction:ltr}.b-share-popup_down .b-share-popup_with-link .b-share-popup__input_link{position:absolute;top:5px;right:0;left:0}.b-share-popup_up .b-share-popup_with-link .b-share-popup__input_link{position:absolute;right:0;bottom:5px;left:0}.b-share-popup_down .b-share-popup_with-link{padding-top:55px!important}.b-share-popup_up .b-share-popup_with-link{padding-bottom:55px!important}.b-share-popup_down .b-share-popup_expandable .b-share-popup__main{padding-bottom:25px!important}.b-share-popup_up .b-share-popup_expandable .b-share-popup__main{padding-top:25px!important}.b-share-popup_down .b-share-popup_yandexed{padding-bottom:10px!important}.b-share-popup_up .b-share-popup_yandexed{padding-top:10px!important}.b-share-popup__yandex{position:absolute;right:4px;bottom:2px;font:78.125%/1em Verdana,sans-serif;padding:3px!important;background:0 0}a.b-share-popup__yandex:link,a.b-share-popup__yandex:visited{color:#C6C5C5;text-decoration:none}a.b-share-popup__yandex:link:hover,a.b-share-popup__yandex:visited:hover{color:red;text-decoration:underline}.b-share-popup_up .b-share-popup__yandex{top:2px;bottom:auto}.b-share-popup_expandable .b-share-popup__yandex{right:auto;left:4px}.b-share-popup_to-right .b-share-popup_expandable .b-share-popup__yandex{right:4px;left:auto}.b-share-popup__expander .b-share-popup__item{position:absolute;bottom:5px;font:86%/1em Verdana,sans-serif;margin:10px 0 0;padding:5px 10px!important;cursor:pointer;color:#999;background:0 0}.b-share-popup_to-right,.b-share-popup_to-right .b-share-popup__expander{direction:rtl}.b-share-popup_to-right .b-share-popup__expander .b-share-popup__icon{padding:0 0 0 5px!important}.b-share-popup_up .b-share-popup__expander .b-share-popup__item{top:-5px;bottom:auto}.b-share-popup__expander .b-share-popup__item:hover .b-share-popup__item__text{text-decoration:underline}.b-share-popup__expander .b-ico_action_rarr,.b-share-popup_to-right .b-share-popup__expander .b-ico_action_larr,.b-share-popup_full .b-share-popup__expander .b-ico_action_larr,.b-share-popup_to-right .b-share-popup_full .b-share-popup__expander .b-ico_action_rarr,.b-share-popup__expander .b-share-popup__item__text_collapse,.b-share-popup_full .b-share-popup__item__text_expand{display:none}.b-share-popup_to-right .b-share-popup__expander .b-ico_action_rarr,.b-share-popup_full .b-share-popup__item__text_collapse,.b-share-popup_full .b-share-popup__expander .b-ico_action_rarr,.b-share-popup_to-right .b-share-popup_full .b-share-popup__expander .b-ico_action_larr{display:inline}.b-ico_action_rarr,.b-ico_action_larr{width:8px;height:7px;border:0}.b-share-popup__main,.b-share-popup__extra{direction:ltr;vertical-align:bottom;text-align:left}.b-share-popup_down .b-share-popup__main,.b-share-popup_down .b-share-popup__extra{vertical-align:top}.b-share-popup__main{display:-moz-inline-stack;display:inline-block}.b-share-popup__extra{display:none;margin:0 -10px 0 0}.b-share-popup_full .b-share-popup__extra{display:-moz-inline-stack;display:inline-block}.b-share-popup_to-right .b-share-popup__extra{margin:0 0 0 -10px}.b-share-popup__tail{position:absolute;width:21px;height:10px;margin:0 0 0 -11px}.b-share-popup_down .b-share-popup__tail{top:-10px;background:url("//yastatic.net/share/static/b-share-popup_down__tail.gif") 0 0 no-repeat}.b-share-popup_up .b-share-popup__tail{bottom:-10px;background:url("//yastatic.net/share/static/b-share-popup_up__tail.gif") 0 0 no-repeat}.b-share-popup_down .b-share-popup__tail,x:nth-child(1){top:-9px;background-image:url("//yastatic.net/share/static/b-share-popup_down__tail.png")}.b-share-popup_up .b-share-popup__tail,x:nth-child(1){bottom:-9px;background-image:url("//yastatic.net/share/static/b-share-popup_up__tail.png")}@media all and (resolution=0){.b-share-popup_down .b-share-popup__tail,x:nth-child(1),x:-o-prefocus{top:-10px;background-image:url("//yastatic.net/share/static/b-share-popup_down__tail.gif")}.b-share-popup_up .b-share-popup__tail,x:nth-child(1),x:-o-prefocus{bottom:-10px;background-image:url("//yastatic.net/share/static/b-share-popup_up__tail.gif")}}.b-share-popup .b-share-popup_show_form_mail,.b-share-popup .b-share-popup_show_form_html{padding:0!important}.b-share-popup .b-share-popup_show_form_mail .b-share-popup__main,.b-share-popup .b-share-popup_show_form_html .b-share-popup__main,.b-share-popup .b-share-popup_show_form .b-share-popup__main,.b-share-popup .b-share-popup_show_form_mail .b-share-popup__extra,.b-share-popup .b-share-popup_show_form_html .b-share-popup__extra,.b-share-popup .b-share-popup_show_form .b-share-popup__extra{height:15px;padding:0!important;overflow:hidden;visibility:hidden}.b-share-popup_show_form_mail .b-share-popup__expander,.b-share-popup_show_form_html .b-share-popup__expander,.b-share-popup_show_form .b-share-popup__expander,.b-share-popup_show_form_mail .b-share-popup__input_link,.b-share-popup_show_form_html .b-share-popup__input_link,.b-share-popup_show_form .b-share-popup__input_link{display:none}.b-share-popup__form{position:relative;display:none;overflow:hidden;padding:5px 0 0!important;margin:0 0 -15px;white-space:normal}.b-share-popup_show_form_mail .b-share-popup__form_mail,.b-share-popup_show_form_html .b-share-popup__form_html,.b-share-popup_show_form .b-share-popup__form{display:block}.b-share-popup__form__link{padding:5px!important;margin:0 0 5px 10px;text-decoration:underline;cursor:pointer;color:#1A3DC1}.b-share-popup__form__link,.b-share-popup__form__button{font:86%/1.4545em Verdana,sans-serif;float:left;display:inline}.b-share-popup__form__button{margin:5px 0 0 15px}.b-share-popup__form__close{font:86%/1.4545em Verdana,sans-serif;float:right;display:inline;padding:5px!important;margin:0 10px 5px 0;cursor:pointer;color:#999}a.b-share-popup__form__link:hover,a.b-share-popup__form__close:hover{text-decoration:underline;color:red}.b-share-popup_font_fixed .b-share-popup__item{font-size:12.8px}.b-share-popup_font_fixed .b-share-popup__header,.b-share-popup_font_fixed .b-share-popup__input,.b-share-popup_font_fixed .b-share-popup__expander .b-share-popup__item,.b-share-popup_font_fixed .b-share-popup__form__link,.b-share-popup_font_fixed .b-share-popup__form__button,.b-share-popup_font_fixed .b-share-popup__form__close{font-size:11px}.b-share-popup_font_fixed .b-share-popup__yandex{font-size:10px}.b-share-form-button{font:86%/17px Verdana,Arial,sans-serif;display:-moz-inline-box;display:inline-block;position:relative;height:19px;margin:0 3px;padding:0 4px;cursor:default;white-space:nowrap;text-decoration:none!important;color:#000!important;border:none;outline:none;background:url("//yastatic.net/share/static/b-share-form-button.png") 0 -20px repeat-x}.b-share-form-button:link:hover,.b-share-form-button:visited:hover{color:#000!important}.b-share-form-button__before,.b-share-form-button__after{position:absolute;width:3px;height:19px;background:url("//yastatic.net/share/static/b-share-form-button.png")}.b-share-form-button__before{margin-left:-7px}.b-share-form-button__after{margin-left:4px;background-position:-3px 0}.b-share-form-button::-moz-focus-inner{border:none}button.b-share-form-button .b-share-form-button__before,button.b-share-form-button .b-share-form-button__after{margin-top:-1px}@-moz-document url-prefix(){button.b-share-form-button .b-share-form-button__after{margin-top:-2px;margin-left:6px}button.b-share-form-button .b-share-form-button__before{margin-top:-2px;margin-left:-9px}}SPAN.b-share-form-button:hover,.b-share-form-button_state_hover{background-position:0 -60px}SPAN.b-share-form-button:hover .b-share-form-button__before,.b-share-form-button_state_hover .b-share-form-button__before{background-position:0 -40px}SPAN.b-share-form-button:hover .b-share-form-button__after,.b-share-form-button_state_hover .b-share-form-button__after{background-position:-3px -40px}.b-share-form-button_state_pressed,.b-share-form-button_state_pressed .b-share-form-button_share{background-position:0 -100px!important}.b-share-form-button_state_pressed .b-share-form-button__before{background-position:0 -80px!important}.b-share-form-button_state_pressed .b-share-form-button__after{background-position:-3px -80px!important}button.b-share-form-button_state_pressed{overflow:visible}.b-share-form-button_icons{position:relative;padding:0;background-position:0 -20px!important}.b-share-form-button_icons .b-share-form-button__before{left:0;margin-left:-3px;background-position:0 0!important}.b-share-form-button_icons .b-share-form-button__after{z-index:-1;margin-left:0;background-position:-3px 0!important}.b-share-form-button_icons .b-share__handle{padding:2px!important}.b-share-form-button_icons .b-share__handle_more{position:relative;padding-right:6px!important;margin-right:-4px}.b-share-form-button_icons .b-share-icon{opacity:.5;background-image:url("//yastatic.net/share/static/b-share-icon_size_14.png")}.b-share-form-button_icons A.b-share__handle:hover .b-share-icon{opacity:1}.b-share{font:86%/1.4545em Arial,sans-serif;display:-moz-inline-box;display:inline-block;padding:1px 3px 1px 4px!important;vertical-align:middle}.b-share .b-share-form-button{font-size:1em}.b-share__text .b-share-icon{margin:0 5px 0 0;border:none}.b-share__text{margin-right:5px}.b-share__handle{float:left;height:16px;padding:5px 3px 5px 2px!important;cursor:pointer;text-align:left;text-decoration:none!important}.b-share__handle_cursor_default{cursor:default}.b-share__handle .b-share-form-button{margin-top:-2px}.b-share__hr{display:none;float:left;width:1px;height:26px;margin:0 3px 0 2px}a.b-share__handle:hover .b-share__text{text-decoration:underline;color:red}.b-share_bordered{padding:0 2px 0 3px!important;border:1px solid #E4E4E4;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px}.b-share_bordered .b-share__hr{display:inline;background:#E4E4E4}.b-share_link{margin:-8px 0}a.b-share_link{margin:0}.b-share_link .b-share__text{text-decoration:underline;color:#1A3DC1}.b-share-form-button_share{padding-left:26px!important;vertical-align:top}.b-share-form-button_share .b-share-form-button__before{margin-left:-29px}.b-share-form-button_share .b-share-form-button__icon{position:absolute;width:20px;height:17px;margin:1px 0 0 -23px;background:url("//yastatic.net/share/static/b-share-form-button_share__icon.png") 0 0 no-repeat}.b-share-pseudo-link{border-bottom:1px dotted;cursor:pointer;text-decoration:none!important}.b-share_font_fixed{font-size:11px}.b-share__handle_more{font-size:9px;margin-top:-1px;color:#7B7B7B}A.b-share__handle_more:hover{color:#000}.b-share__group{float:left}.b-share-icon{float:left;display:inline;overflow:hidden;width:16px;height:16px;padding:0!important;vertical-align:top;border:0;background:url("//yastatic.net/share/static/b-share-icon.png") 0 99px no-repeat}.b-share-icon_vkontakte,.b-share-icon_custom{background-position:0 0}.b-share-icon_yaru,.b-share-icon_yaru_photo,.b-share-icon_yaru_wishlist{background-position:0 -17px}.b-share-icon_lj{background-position:0 -34px}.b-share-icon_twitter{background-position:0 -51px}.b-share-icon_facebook{background-position:0 -68px}.b-share-icon_moimir{background-position:0 -85px}.b-share-icon_friendfeed{background-position:0 -102px}.b-share-icon_mail{background-position:0 -119px}.b-share-icon_html{background-position:0 -136px}.b-share-icon_postcard{background-position:0 -153px}.b-share-icon_odnoklassniki{background-position:0 -170px}.b-share-icon_blogger{background-position:0 -187px}.b-share-icon_delicious{background-position:0 -221px}.b-share-icon_gbuzz{background-position:0 -238px}.b-share-icon_linkedin{background-position:0 -255px}.b-share-icon_myspace{background-position:0 -272px}.b-share-icon_evernote{background-position:0 -289px}.b-share-icon_digg{background-position:0 -306px}.b-share-icon_juick{background-position:0 -324px}.b-share-icon_moikrug{background-position:0 -341px}.b-share-icon_yazakladki{background-position:0 -358px}.b-share-icon_liveinternet{background-position:0 -375px}.b-share-icon_tutby{background-position:0 -392px}.b-share-icon_diary{background-position:0 -409px}.b-share-icon_gplus{background-position:0 -426px}.b-share-icon_pocket{background-position:0 -443px}.b-share-icon_surfingbird{background-position:0 -460px}.b-share-icon_pinterest{background-position:0 -477px}.b-share-icon_renren{background-position:0 0}.b-share-icon_renren,.b-share-icon_sina_weibo{background:url("//yastatic.net/share/static/b-share-icon__china.png") no-repeat}.b-share-icon_sina_weibo{background-position:-18px 0}.b-share-icon_qzone{background-position:-36px 0}.b-share-icon_qzone,.b-share-icon_tencent_weibo{background:url("//yastatic.net/share/static/b-share-icon__china.png") no-repeat}.b-share-icon_tencent_weibo{background-position:-54px 0}.b-share_theme_dark .b-share-icon{background:url("//yastatic.net/share/static/b-share-icons__theme_dark.png") 99px 0 no-repeat}.b-share_theme_dark .b-share-icon_odnoklassniki{background-position:-4px -3px}.b-share_theme_dark .b-share-icon_vkontakte{background-position:-24px -3px}.b-share_theme_dark .b-share-icon_twitter{background-position:-44px -3px}.b-share_theme_dark .b-share-icon_facebook{background-position:-64px -3px}.b-share_theme_dark .b-share-icon_lj{background-position:-85px -3px}.b-share_theme_dark .b-share-icon_yaru{background-position:-105px -3px}.b-share_theme_dark .b-share-popup .b-share-icon_odnoklassniki,.b-share_theme_dark .b-share-icon_odnoklassniki:hover{background-position:-4px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_vkontakte,.b-share_theme_dark .b-share-icon_vkontakte:hover{background-position:-24px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_twitter,.b-share_theme_dark .b-share-icon_twitter:hover{background-position:-44px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_facebook,.b-share_theme_dark .b-share-icon_facebook:hover{background-position:-64px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_lj,.b-share_theme_dark .b-share-icon_lj:hover{background-position:-85px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_yaru,.b-share_theme_dark .b-share-icon_yaru:hover{background-position:-105px -28px}.b-share_theme_dark .b-share-form-button_share .b-share-form-button__icon{background-image:url("//yastatic.net/share/static/b-share-form-button_share__icon_dark.png")}.b-share_theme_dark .b-share-form-button{color:#fff!important;opacity:.8}.b-share_theme_dark .b-share__handle:hover .b-share-form-button,.b-share_theme_dark .b-share-form-button:hover{opacity:1;cursor:pointer}.b-share_theme_dark .b-share-form-button,.b-share_theme_dark .b-share-form-button__before,.b-share_theme_dark .b-share-form-button__after{background:0 0}.b-share_theme_dark .b-share-popup__i{background-color:#333;border-radius:10px;-webkit-box-shadow:0 2px 9px rgba(255,255,255,.6);-moz-box-shadow:0 2px 9px rgba(255,255,255,.6);box-shadow:0 2px 9px rgba(255,255,255,.6)}.b-share_theme_dark .b-share__text{color:#AAA}.b-share_theme_dark .b-share-popup{color:#AAA;border-radius:10px;background-color:#333;background-color:rgba(50,50,50,.3)}.b-share_theme_dark .b-share-popup__item{background:0 0;color:#ccc}.b-share_theme_dark .b-share-popup .b-share-popup__item__text{color:#ccc}.b-share_theme_counter .b-share{display:inline-block;vertical-align:middle;white-space:nowrap}.b-share-counter{font:14px Arial,sans-serif;line-height:18px;display:none;float:left;margin:3px 6px 3px 3px;color:#fff}.b-share_theme_counter .b-share_type_small .b-share-counter{font-size:11px;line-height:14px;margin:2px 6px 2px 1px}.b-share_theme_counter .b-share-btn__counter .b-share-counter{display:block}.b-share-btn__counter{text-decoration:none}.b-share_theme_counter .b-share-btn__wrap{position:relative;float:left;margin-left:5px}.b-share_theme_counter .b-share_type_small .b-share-btn__wrap{margin-left:4px}.b-share_theme_counter .b-share-btn__wrap:first-child{margin-left:0}.b-share_theme_counter .b-share__link{display:inline-block;cursor:pointer;-webkit-border-radius:3px;border-radius:3px}.b-share_theme_counter .b-share_type_small .b-share__link{-webkit-border-radius:2px;border-radius:2px}.b-share_theme_counter .b-share-icon{display:block;float:left;width:24px;height:24px;background-image:url("//yastatic.net/share/static/b-share_counter_large.png");background-position:-20px 0}.b-share_theme_counter .b-share_type_small .b-share-icon{width:18px;height:18px;background-image:url("//yastatic.net/share/static/b-share_counter_small.png")}.b-share_theme_counter .b-share-icon_facebook{background-position:0 0}.b-share_theme_counter .b-share-btn__facebook{background-color:#3c5a98}.b-share_theme_counter .b-share-btn__facebook:hover{background-color:#30487a}.b-share_theme_counter .b-share-btn__facebook:active{border-top:2px solid #24365a;background-color:#334d81}.b-share_theme_counter .b-share-icon_moimir{background-position:0 -29px}.b-share_theme_counter .b-share-btn__moimir{background-color:#226eb7}.b-share_theme_counter .b-share-btn__moimir:hover{background-color:#1b5892}.b-share_theme_counter .b-share-btn__moimir:active{border-top:2px solid #14426d;background-color:#1d5e9c}.b-share_theme_counter .b-share-icon_vkontakte{background-position:0 -58px}.b-share_theme_counter .b-share-btn__vkontakte{background-color:#48729e}.b-share_theme_counter .b-share-btn__vkontakte:hover{background-color:#3a5b7e}.b-share_theme_counter .b-share-btn__vkontakte:active{border-top:2px solid #2b445e;background-color:#3d6186}.b-share_theme_counter .b-share-icon_twitter{background-position:0 -87px}.b-share_theme_counter .b-share-btn__twitter{background-color:#00aced}.b-share_theme_counter .b-share-btn__twitter:hover{background-color:#008abe}.b-share_theme_counter .b-share-btn__twitter:active{border-top:2px solid #00668d;background-color:#0092ca}.b-share_theme_counter .b-share-icon_odnoklassniki{background-position:0 -116px}.b-share_theme_counter .b-share-btn__odnoklassniki{background-color:#ff9f4d}.b-share_theme_counter .b-share-btn__odnoklassniki:hover{background-color:#cc7f3e}.b-share_theme_counter .b-share-btn__odnoklassniki:active{border-top:2px solid #975e2e;background-color:#d98742}.b-share_theme_counter .b-share-icon_gplus{background-position:0 -145px}.b-share_theme_counter .b-share-btn__gplus{background-color:#c25234}.b-share_theme_counter .b-share-btn__gplus:hover{background-color:#9b422a}.b-share_theme_counter .b-share-btn__gplus:active{border-top:2px solid #73311f;background-color:#a5462c}.b-share_theme_counter .b-share-icon_yaru{background-position:0 -174px}.b-share_theme_counter .b-share-btn__yaru{background-color:#d83933}.b-share_theme_counter .b-share-btn__yaru:hover{background-color:#ad2e29}.b-share_theme_counter .b-share-btn__yaru:active{border-top:2px solid #80221e;background-color:#b8312b}.b-share_theme_counter .b-share-icon_pinterest{background-position:0 -203px}.b-share_theme_counter .b-share-btn__pinterest{background-color:#cd1e27}.b-share_theme_counter .b-share-btn__pinterest:hover{background-color:#a4181f}.b-share_theme_counter .b-share-btn__pinterest:active{border-top:2px solid #7b1217;background-color:#ae1921}.b-share_theme_counter .b-share__link:active{height:22px}.b-share_theme_counter .b-share_type_small .b-share__link:active{height:16px}.b-share_theme_counter .b-share__link:active .b-share-icon,.b-share_theme_counter .b-share__link:active .b-share-counter{position:relative;top:-1px}.b-share_theme_counter .b-share__link::after{position:absolute;top:0;right:0;bottom:0;left:0;content:"";background-image:url(data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==)}.b-share_theme_counter .b-share__handle{height:auto;padding:0!important}</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_customer_chat_bounce_in{animation-duration:250ms;animation-name:fb_bounce_in}.fb_customer_chat_bounce_out{animation-duration:250ms;animation-name:fb_fade_out}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_mobile_overlay_active{background-color:#fff;height:100%;overflow:hidden;position:fixed;visibility:hidden;width:100%}@keyframes fb_fade_out{from{opacity:1}to{opacity:0}}@keyframes fb_bounce_in{0%{opacity:0;transform:scale(.8, .8);transform-origin:100% 100%}10%{opacity:.1}20%{opacity:.2}30%{opacity:.3}40%{opacity:.4}50%{opacity:.5}60%{opacity:.6}70%{opacity:.7}80%{opacity:.8;transform:scale(1.03, 1.03)}90{opacity:.9}100%{opacity:1;transform:scale(1, 1)}}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body><span style="display:none;" class="csrf-token" data-csrf="6be8332ac61f4ba74ddca248880082ac">&nbsp;</span>

<div class="button-up" style="display: none; opacity: 0.7; width: 30px; height: 100%; position: fixed; left: 0px; top: 0px; cursor: pointer; text-align: center; line-height: 30px; color: rgb(211, 219, 228); font-weight: bold; font-size: 20px;"><i class="icon-circle-arrow-up"></i></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile == "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>
<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>
<script type="text/javascript">
    window.fbAsyncInit = function() {
        FB.init({
            appId      : '554666954583323',
            xfbml      : true,
            version    : 'v2.8'
        });
        FB.AppEvents.logPageView();
    };

    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>

    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 1000
        });
    }, 0);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        //info("j=" + JSON.stringify(json));

        if (json.t != "a") {
            return;
        }
        // console.log("Got announcement from channel");
        setTimeout(function() {
            Codeforces.showAnnouncements(json.d, "en");
        }, Math.random() * 500);
    }
    if (Codeforces.getParticipantChannel()) {
        Codeforces.subscribe(Codeforces.getParticipantChannel(), function(json) {
            showAnnouncements(json);
        });
    }

    if (Codeforces.getContestChannel()) {
        Codeforces.subscribe(Codeforces.getContestChannel(), function(json) {
            showAnnouncements(json);
        });
    }

    if (Codeforces.getGlobalChannel()) {
        Codeforces.subscribe(Codeforces.getGlobalChannel(), function(json) {
            showAnnouncements(json);
        });
    }

    if (Codeforces.getUserChannel()) {
        Codeforces.subscribe(Codeforces.getUserChannel(), function(json) {
            showAnnouncements(json);
        });
    }

    $(".clickable-title").click(function() {
        Codeforces.alert($(this).attr("title"));
    }).css("position", "relative").css("bottom", "3px");


    Codeforces.reformatTimes();
    Codeforces.initializePubSub();

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = (document.location.protocol == 'https:' ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<div id="body">
        

<div class="side-bell" style="visibility: hidden; display: none; opacity: 0.7; width: 40px; position: fixed; right: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 1.5rem;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>


<div id="header" style="position: relative;">
    <div style="float:left;">
            <a href="/"><img src="http://st.codeforces.com/s/95195/images/codeforces-logo-with-telegram.png"></a>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;">
            <a href="?locale=en"><img src="http://st.codeforces.com/s/95195/images/flags/24/gb.png" title="In English" alt="In English"></a>
            <a href="?locale=ru"><img src="http://st.codeforces.com/s/95195/images/flags/24/ru.png" title="По-русски" alt="По-русски"></a>
        </div>

        <div>
                        <a href="/enter?back=%2Fblog%2Fentry%2F44351">Enter</a>
                     | 
                        <a href="/register">Register</a>
                    
        </div>



    </div>
    <br style="clear: both;">
</div>
        

    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/contests">Contests</a></li>
                <li class=""><a href="/gyms">Gym</a></li>
                <li class=""><a href="/problemset">Problemset</a></li>
                <li class=""><a href="/groups">Groups</a></li>
                <li class=""><a href="/ratings">Rating</a></li>
                <li class=""><a href="/api/help">API</a></li>
                <li class=""><a href="/vkcup2018">VK Cup <img class="icon" src="http://st.codeforces.com/images/icons/cup.png"></a></li>
                <li class=""><a href="/calendar">Calendar</a></li>
                <li class=""><a href="/8years"><span style="color:#ce2a2a;position:relative;bottom:3px;font-weight:bold;">8 years!</span><img src="http://assets.codeforces.com/images/icons/gift-small.png"></a></li>
    </ul>
        <form method="post" action="/search"><input type="hidden" name="csrf_token" value="6be8332ac61f4ba74ddca248880082ac">
            <input class="search" name="query" data-isplaceholder="true" value="">
        <input type="hidden" name="_tta" value="487"></form>
    <br style="clear: both;">
</div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
            <br style="height: 3em; clear: both;">

        <div style="position: relative;">
                        <div id="sidebar">
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Pay attention
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        <div style="text-align:center;border-bottom: 1px solid rgb(185, 185, 185);margin:0 -0.5em 0.5em -0.5em;padding: 0 1em 0.5em 1em;">
            <span class="contest-state-phase">Before contest</span><br><a href="/contests/983,984">Codeforces Round #481 (Div. 1) [Thanks, Botan Investments and Victor Shaburov!]</a><br><span class="countdown" home="http://st.codeforces.com/s/95195" noredirection="true" textbeforeredirect="" cdid="i1"><span title="117:07:40">5 days</span></span>
        </div>
        <div style="text-align:center;border-bottom: 1px solid rgb(185, 185, 185);margin:0 -0.5em 0.5em -0.5em;padding: 0 1em 0.5em 1em;">
            <span class="contest-state-phase">Before contest</span><br><a href="/contests/983,984">Codeforces Round #481 (Div. 2) [Thanks, Botan Investments and Victor Shaburov!]</a><br><span class="countdown" home="http://st.codeforces.com/s/95195" noredirection="true" textbeforeredirect="" cdid="i2"><span title="117:07:40">5 days</span></span>
        </div>
        <div style="text-align:center;">
            <div class="socials" style="text-align: left;">
                <div style="margin-top: 0.85em;position: relative;">

        <div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="http://staticxx.facebook.com/connect/xd_arbiter/r/2VRzCA39w_9.js?version=42#channel=f22de2660&amp;origin=http%3A%2F%2Fcodeforces.com" style="border: none;"></iframe><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="https://staticxx.facebook.com/connect/xd_arbiter/r/2VRzCA39w_9.js?version=42#channel=f22de2660&amp;origin=http%3A%2F%2Fcodeforces.com" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div>
        <script>
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s); js.id = id;
            js.src = "http://connect.facebook.net/en_EN/all.js#appId=554666954583323&xfbml=1";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
        </script>
        <div class="fb-like fb_iframe_widget" data-href="http://codeforces.com/contests/983,984" data-send="false" data-width="256" data-show-faces="false" data-font="arial" data-ref="699801661" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=554666954583323&amp;container_width=264&amp;font=arial&amp;href=http%3A%2F%2Fcodeforces.com%2Fcontests%2F983%2C984&amp;locale=en_US&amp;ref=699801661&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=256"><span style="vertical-align: bottom; width: 256px; height: 28px;"><iframe name="f3771a07e4" width="256px" height="1000px" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" title="fb:like Facebook Social Plugin" src="https://www.facebook.com/v2.8/plugins/like.php?app_id=554666954583323&amp;channel=http%3A%2F%2Fstaticxx.facebook.com%2Fconnect%2Fxd_arbiter%2Fr%2F2VRzCA39w_9.js%3Fversion%3D42%23cb%3Df72e96ddc%26domain%3Dcodeforces.com%26origin%3Dhttp%253A%252F%252Fcodeforces.com%252Ff22de2660%26relation%3Dparent.parent&amp;container_width=264&amp;font=arial&amp;href=http%3A%2F%2Fcodeforces.com%2Fcontests%2F983%2C984&amp;locale=en_US&amp;ref=699801661&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=256" style="border: none; visibility: visible; width: 256px; height: 28px;" class=""></iframe></span></div>

        </div>
</div>

        </div>
</div>
    </div>

<div class="roundbox sidebox top-contributed" style="">
<div class="roundbox-lt">&nbsp;</div>
<div class="roundbox-rt">&nbsp;</div>
<div class="caption titled">→ Top rated
<div class="top-links">
</div>
</div>
<table class="rtable ">
<tbody>
<tr>
<th class="left" style="width:2.25em;">#</th>
<th class="">User</th>
<th class="" style="width:5em;">Rating</th>
</tr>
<tr>
<td class="left dark">1</td>
<td class=" dark"><a href="/profile/Petr" title="Legendary grandmaster Petr" class="rated-user user-legendary"><span class="legendary-user-first-letter">P</span>etr</a></td>
<td class=" dark">3353</td>
</tr>
<tr>
<td class="left ">2</td>
<td class=""><a href="/profile/Um_nik" title="Legendary grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
<td class="">3278</td>
</tr>
<tr>
<td class="left dark">3</td>
<td class=" dark"><a href="/profile/Syloviaely" title="Legendary grandmaster Syloviaely" class="rated-user user-legendary"><span class="legendary-user-first-letter">S</span>yloviaely</a></td>
<td class=" dark">3274</td>
</tr>
<tr>
<td class="left ">4</td>
<td class=""><a href="/profile/V--o_o--V" title="Legendary grandmaster V--o_o--V" class="rated-user user-legendary"><span class="legendary-user-first-letter">V</span>--o_o--V</a></td>
<td class="">3236</td>
</tr>
<tr>
<td class="left dark">5</td>
<td class=" dark"><a href="/profile/tourist" title="Legendary grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
<td class=" dark">3235</td>
</tr>
<tr>
<td class="left ">6</td>
<td class=""><a href="/profile/OO0OOO00O0OOO0O00OOO0OO" title="Legendary grandmaster OO0OOO00O0OOO0O00OOO0OO" class="rated-user user-legendary smaller"><span class="legendary-user-first-letter">O</span>O0OOO00O0OOO0O0…O</a></td>
<td class="">3201</td>
</tr>
<tr>
<td class="left dark">7</td>
<td class=" dark"><a href="/profile/Radewoosh" title="Legendary grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
<td class=" dark">3197</td>
</tr>
<tr>
<td class="left ">8</td>
<td class=""><a href="/profile/fateice" title="Legendary grandmaster fateice" class="rated-user user-legendary"><span class="legendary-user-first-letter">f</span>ateice</a></td>
<td class="">3172</td>
</tr>
<tr>
<td class="left dark">9</td>
<td class=" dark"><a href="/profile/mnbvmar" title="Legendary grandmaster mnbvmar" class="rated-user user-legendary"><span class="legendary-user-first-letter">m</span>nbvmar</a></td>
<td class=" dark">3096</td>
</tr>
<tr>
<td class="left bottom">10</td>
<td class="bottom"><a href="/profile/dotorya" title="Legendary grandmaster dotorya" class="rated-user user-legendary"><span class="legendary-user-first-letter">d</span>otorya</a></td>
<td class="bottom">3086</td>
</tr>
</tbody>
</table>
<div class="bottom-links">
<table style="width:100%;">
<tbody>
<tr>
<td style="text-align:left;">
<a href="/ratings/countries">Countries</a> |
<a href="/ratings/cities">Cities</a> |
<a href="/ratings/organizations">Organizations</a>
</td>
<td style="text-align:right;">
<a href="/ratings">View all →</a>
</td>
</tr>
</tbody>
</table>
</div>
</div>

    <div class="roundbox sidebox top-contributed" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Top contributors
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">User</th>
                            <th class="" style="width:5em;">Contrib.</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark"><a href="/profile/tourist" title="Legendary grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
                                <td class=" dark">178</td>
                    </tr>
                    <tr>
                                <td class="left ">2</td>
                                <td class=""><a href="/profile/rng_58" title="International Grandmaster rng_58" class="rated-user user-red">rng_58</a></td>
                                <td class="">169</td>
                    </tr>
                    <tr>
                                <td class="left  dark">3</td>
                                <td class=" dark"><a href="/profile/csacademy" title="Unrated, csacademy" class="rated-user user-black">csacademy</a></td>
                                <td class=" dark">159</td>
                    </tr>
                    <tr>
                                <td class="left ">3</td>
                                <td class=""><a href="/profile/Petr" title="Legendary grandmaster Petr" class="rated-user user-legendary"><span class="legendary-user-first-letter">P</span>etr</a></td>
                                <td class="">159</td>
                    </tr>
                    <tr>
                                <td class="left  dark">5</td>
                                <td class=" dark"><a href="/profile/lewin" title="Grandmaster lewin" class="rated-user user-red">lewin</a></td>
                                <td class=" dark">151</td>
                    </tr>
                    <tr>
                                <td class="left ">6</td>
                                <td class=""><a href="/profile/Swistakk" title="Legendary grandmaster Swistakk" class="rated-user user-legendary"><span class="legendary-user-first-letter">S</span>wistakk</a></td>
                                <td class="">149</td>
                    </tr>
                    <tr>
                                <td class="left  dark">7</td>
                                <td class=" dark"><a href="/profile/matthew99" title="Grandmaster matthew99" class="rated-user user-red">matthew99</a></td>
                                <td class=" dark">141</td>
                    </tr>
                    <tr>
                                <td class="left ">8</td>
                                <td class=""><a href="/profile/BledDest" title="Grandmaster BledDest" class="rated-user user-red">BledDest</a></td>
                                <td class="">140</td>
                    </tr>
                    <tr>
                                <td class="left  dark">9</td>
                                <td class=" dark"><a href="/profile/Errichto" title="Grandmaster Errichto" class="rated-user user-red">Errichto</a></td>
                                <td class=" dark">139</td>
                    </tr>
                    <tr>
                                <td class="left bottom">9</td>
                                <td class="bottom"><a href="/profile/adamant" title="International master adamant" class="rated-user user-orange">adamant</a></td>
                                <td class="bottom">139</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/top-contributed">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>



    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Find user
            <div class="top-links">
            </div>
        </div>
        <form class="handleForm" method="post" autocomplete="off"><input type="hidden" name="csrf_token" value="6be8332ac61f4ba74ddca248880082ac">
            <div style="padding:1em;text-align:right;">
                <label style="padding-right:1em;">Handle:
                    <input style="width:12em;" type="text" class="handleBox ac_input" autocomplete="off">
                </label>
            </div>
            <div style="padding: 0 1em 1em 1em;text-align:right;">
                <input style="height:1.65em;padding:0 0.75em;" type="submit" value="Find">
            </div>
        <input type="hidden" name="_tta" value="487"></form>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".handleBox").autocomplete("/data/handles", {
        delay: 200,
        width: 200,
        selectFirst: false,
        matchContains: true,
        minChars: 3
    });
    $(".handleForm").attr("autocomplete", "off").submit(function () {
        var link = "/profile/userHandle".replace(
            "userHandle", $(this).find(".handleBox").val()
        );
        window.location = link;
        return false;
    });
        });
    </script>




    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Recent actions
            <div class="top-links">
            </div>
        </div>
        <div class="recent-actions">
            <ul>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Hasan0540" title="Master Hasan0540" class="rated-user user-orange">Hasan0540</a>        →
        <a href="/blog/entry/59322">Codeforces Round #480 (Div. 2)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Vovuh" title="Candidate Master Vovuh" class="rated-user user-violet">Vovuh</a>        →
        <a href="/blog/entry/59281">Codeforces Round #479 (Div. 3) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/physichna" title="Pupil physichna" class="rated-user user-green">physichna</a>        →
        <a href="/blog/entry/59341">Centroidal decomposition</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="http://st.codeforces.com/s/95195/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/UndisputedEra" title="Unrated, UndisputedEra" class="rated-user user-black">UndisputedEra</a>        →
        <a href="/blog/entry/59342">480 had stupid problem statements</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="http://st.codeforces.com/s/95195/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/brdy" title="Expert brdy" class="rated-user user-blue">brdy</a>        →
        <a href="/blog/entry/59340">Dynamic Segment Tree Problems</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/dmkozyrev" title="Expert dmkozyrev" class="rated-user user-blue">dmkozyrev</a>        →
        <a href="/blog/entry/59311">Dynamic programming problem</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MiptLited" title="Unrated, MiptLited" class="rated-user user-black">MiptLited</a>        →
        <a href="/blog/entry/59329">Moscow Workshops ICPC will be held in Grodno and Vladivostok on July 23-30, 2018</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="http://st.codeforces.com/s/95195/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/kleenex" title="Pupil kleenex" class="rated-user user-green">kleenex</a>        →
        <a href="/blog/entry/58360">My friend wants new subject for R&amp;E(Research and Education), plz recommend something.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/jerryseinfeldfmy" title="Pupil jerryseinfeldfmy" class="rated-user user-green">jerryseinfeldfmy</a>        →
        <a href="/blog/entry/59239">TIMUS oj 1049. Brave Balloonists...</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a>        →
        <a href="/blog/entry/44351">[Tutorial] Sack (dsu on tree)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/rajarshi_basu" title="Candidate Master rajarshi_basu" class="rated-user user-violet">rajarshi_basu</a>        →
        <a href="/blog/entry/58564">Segment Tree Beats. A simpler understanding.</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="http://st.codeforces.com/s/95195/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Rollo" title="Candidate Master Rollo" class="rated-user user-violet">Rollo</a>        →
        <a href="/blog/entry/59186">Codeforces Round #478 (Div. 2)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/hmehta" title="Unrated, hmehta" class="rated-user user-black">hmehta</a>        →
        <a href="/blog/entry/59315">TCO18 Poland Regionals — University of Warsaw</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/I_Can_Do_It" title="Pupil I_Can_Do_It" class="rated-user user-green">I_Can_Do_It</a>        →
        <a href="/blog/entry/21742">Delete codeforces account </a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Endagorion" title="International Grandmaster Endagorion" class="rated-user user-red">Endagorion</a>        →
        <a href="/blog/entry/59173">Разбор VK 2018 Round 3 + Codeforces Round #477</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/XMORE" title="Pupil XMORE" class="rated-user user-green">XMORE</a>        →
        <a href="/blog/entry/59326">Help with probability problem please</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/dj3500" title="Grandmaster dj3500" class="rated-user user-red">dj3500</a>        →
        <a href="/blog/entry/13141">Hightail — automatic tester for programming contests</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ROIgold" title="Pupil ROIgold" class="rated-user user-green">ROIgold</a>        →
        <a href="/blog/entry/59323">Help with Segment Tree problem, please!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Rollo" title="Candidate Master Rollo" class="rated-user user-violet">Rollo</a>        →
        <a href="/blog/entry/59202">Codeforces Round #478 (Div. 2), Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Vovuh" title="Candidate Master Vovuh" class="rated-user user-violet">Vovuh</a>        →
        <a href="/blog/entry/59262">Codeforces Round #479 (Div. 3)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Sereja" title="Master Sereja" class="rated-user user-orange">Sereja</a>        →
        <a href="/blog/entry/7560">Codeforces Round #182 tutorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/I_LOVE_THU_HUYEN" title="Specialist I_LOVE_THU_HUYEN" class="rated-user user-cyan">I_LOVE_THU_HUYEN</a>        →
        <a href="/blog/entry/59310">Did Codefights remove 1-on-1 challenge?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Hiasat" title="Candidate Master Hiasat" class="rated-user user-violet">Hiasat</a>        →
        <a href="/blog/entry/17885">Is it possible to be red in 1 Year</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Nickolas" title="Expert Nickolas" class="rated-user user-blue">Nickolas</a>        →
        <a href="/blog/entry/58681">April Fools Day Contest 2018: editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/walnutwaldo20" title="Master walnutwaldo20" class="rated-user user-orange">walnutwaldo20</a>        →
        <a href="/blog/entry/59298">Bug With Rating Changes in Contests Tab</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="http://st.codeforces.com/s/95195/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
            </ul>
        </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/recent-actions">Detailed →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list"><li class="backLava" style="position: absolute; display: block; margin: 0px; padding: 0px; left: 39.75px; top: 0px; width: 39px; height: 20px;"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li><a href="/profile/Arpa">Arpa</a></li>
        <li class="current selectedLava"><a href="/blog/Arpa">Blog</a></li>
        <li><a href="/teams/with/Arpa">Teams</a></li>
        <li><a href="/submissions/Arpa">Submissions</a></li>
        <li><a href="/groups/with/Arpa">Groups</a></li>
        <li><a href="/contests/with/Arpa">Contests</a></li>
        <li><a href="/contests/writer/Arpa">Problemsetting</a></li>
</ul>
</div>
    <div style="margin-top:0;">
    <div>
        <h3><a href="/blog/Arpa" style="text-decoration:none;color:black !important;">Arpa's blog</a></h3>
    </div>
        <div style="margin-top:2em;">


<div class="topic" topicid="44511">
    <div class="title">
            <a href="/blog/entry/44351">            <p>[Tutorial] Sack (dsu on tree)</p>
</a>
    </div>

    <div class="info" style="position:relative;">
            By&nbsp;<a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a>,
                <a href="/topic/44511/en40">history</a>,
                <span class="format-humantime" title="Apr/14/2016 12:11 UTC">2 years ago</span>,
            
            <img style="position: relative;top: 5px;" src="http://st.codeforces.com/s/95195/images/flags/24/gb.png" alt="In English" title="In English">,

<a class="attach-blogEntry-44351-to-contest-link" href="#"><img src="http://st.codeforces.com/s/95195/images/icons/paperclip-16x16.png" title="Attach this blog to some contest as a resource"></a>

<style type="text/css">
    .attach-blogEntry-44351-to-contest-form tr:not(:last-of-type) td {
        padding-bottom: 1em;
    }

    .blogEntry-44351-error {
        font-size: 1.1rem;
    }
</style>

<div class="attach-blogEntry-44351-to-contest-form-holder" style="display: none;padding: 1em;margin: 1em;">
    <form class="attach-blogEntry-44351-to-contest-form" method="post"><input type="hidden" name="csrf_token" value="6be8332ac61f4ba74ddca248880082ac">
        <table style="width: 100%;">
            <thead>
            </thead>
            <tbody>
        <tr class="subscription-row blogEntry-44351-blogId-error blogEntry-44351-error" style="display: none;">
            <td>&nbsp;</td>
        <td colspan="2"><div class="shiftUp">        <span class="error for__blogEntry-44351-blogId">-</span>
</div></td>
        </tr>
            <tr>
                <td style="width: 30%;"><label for="blogEntry-44351-contestId">Contest:</label></td>
                <td>
                    <select id="blogEntry-44351-contestId" name="contestId" style="width: 100%;float: left;" disabled="">
                        <option value=""></option>
                    </select>
                </td>
                <td>
                    <img id="blogEntry-44351-contestId-loading-indicator" src="http://st.codeforces.com/s/95195/images/indicator.gif">
                </td>
            </tr>
        <tr class="subscription-row blogEntry-44351-contestId-error blogEntry-44351-error" style="display: none;">
            <td>&nbsp;</td>
        <td colspan="2"><div class="shiftUp">        <span class="error for__blogEntry-44351-contestId">-</span>
</div></td>
        </tr>
            <tr>
                <td style="width: 30%;"><label for="blogEntry-44351-resourceType">Type:</label></td>
                <td>
                    <select id="blogEntry-44351-resourceType" name="resourceType" style="width: 100%;">
                        <option value="" selected=""></option>
                        <option value="STATEMENT">statements</option>
                        <option value="TUTORIAL">tutorial</option>
                        <option value="ANNOUNCEMENT">announcement</option>
                        <option value="DISCUSSION">discussion</option>
                    </select>
                </td>
                <td></td>
            </tr>
        <tr class="subscription-row blogEntry-44351-resourceType-error blogEntry-44351-error" style="display: none;">
            <td>&nbsp;</td>
        <td colspan="2"><div class="shiftUp">        <span class="error for__blogEntry-44351-resourceType">-</span>
</div></td>
        </tr>
            <tr>
                <td colspan="2" style="text-align: center;">
                    <input type="submit" id="blogEntry-44351-resource-submit" value="Attach" disabled="" style="padding: 0.25em 0.5em;margin: 1em;width: 8em;">
                </td>
                <td>
                    <img id="blogEntry-44351-resource-submitting-indicator" src="http://st.codeforces.com/s/95195/images/indicator.gif" style="display: none;">
                </td>
            </tr>
            </tbody>
        </table>
    <input type="hidden" name="_tta" value="487"></form>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        $(".blogEntry-44351-error").hide();

        $(".attach-blogEntry-44351-to-contest-link").click(function () {
            Codeforces.facebox(".attach-blogEntry-44351-to-contest-form-holder", "http://st.codeforces.com/s/95195");

            $("#facebox .attach-blogEntry-44351-to-contest-form").submit(function () {
                if ($(this).find(":disabled").length === 0) {
                    $("#facebox .blogEntry-44351-error").hide();
                    $("#facebox #blogEntry-44351-resource-submitting-indicator").show();
                    $("#facebox #blogEntry-44351-resource-submit").attr("disabled", "disabled");

                    //noinspection JSUnusedGlobalSymbols
                    $.post("/data/blogAndContest?action=attachBlogToContest", {
                        blogId:"20412", contestId:$("#facebox #blogEntry-44351-contestId").val(),
                        blogEntryId:"44351",
                        resourceType:$("#facebox #blogEntry-44351-resourceType").val()
                    }, function (json) {
                        var validated = true;

                        for (var key in json) {
                            if (json.hasOwnProperty(key) && key.indexOf("error__") === 0) {
                                validated = false;
                                $("#facebox .blogEntry-44351-" + key.substring("error__".length) + "-error").show();
                                $("#facebox .for__blogEntry-44351-" + key.substring("error__".length)).text(json[key]);
                            }
                        }

                        $("#facebox #blogEntry-44351-resource-submitting-indicator").hide();
                        $("#facebox #blogEntry-44351-resource-submit").removeAttr("disabled");

                        if (validated) {
                            $.facebox.close();
                            if (json["success"] === "true") {
                                Codeforces.showMessage("Blog has been successfully attached to selected contest");
                            } else {
                                Codeforces.showMessage("There is unexpected error while attaching blog to the contest");
                            }
                        }
                    }, "json");
                }

                return false;
            });

            var contestSelect = $("#blogEntry-44351-contestId");
            var popupContestSelect = $("#facebox #blogEntry-44351-contestId");

            if (popupContestSelect.is(":disabled")) {
                $.post("/data/contests?action=getContestListWithEditableResources", function (data) {
                    if (data["result"] === "success") {
                        var contests = data["contests"];

                        for (var i = 0, contestCount = contests.length; i < contestCount; ++i) {
                            //noinspection StringLiteralBreaksHTMLJS
                            var contestOptionHtml = "<option value=\"" + contests[i]["id"] + "\">"
                                    + contests[i]["id"] + " - " + contests[i]["name"] + "</option>";
                            contestSelect.append(contestOptionHtml);
                            popupContestSelect.append(contestOptionHtml);
                        }

                        contestSelect.removeAttr("disabled");
                        $("#blogEntry-44351-contestId-loading-indicator").hide();
                        $("#blogEntry-44351-resource-submit").removeAttr("disabled");

                        popupContestSelect.removeAttr("disabled");
                        $("#facebox #blogEntry-44351-contestId-loading-indicator").hide();
                        $("#facebox #blogEntry-44351-resource-submit").removeAttr("disabled");
                    } else {
                        alert("Can't receive contest list");
                    }
                }, "json");
            }

            return false;
        });
    });
</script>



        <span style="position:absolute;right:0;top:0.05em;margin-right:1em;display:inline;font-size:0.75em;">
            <div style="margin-top:0.25em;">
            </div>
        </span>
    </div>

    <div class="content">
        <div class="ttypography"><p><strong>Changes are available in history section.</strong></p><p>Hi!</p><p>Most of the people know about dsu but what is the "dsu on tree"?</p><p>In Iran, we call this technique "Guni" (the word means "sack" in English), instead of "dsu on tree".</p><p>I will explain it and post ends with several problems in CF that can be solved by this technique.</p><h1>What is the dsu on tree?</h1><p>With dsu on tree we can answer queries of this type:</p><p>How many vertices in the subtree of vertex <code class="tt">v</code> has some property in <img align="middle" class="tex-formula" src="/predownloaded/92/33/9233e5a9ea86381add3ad78777a93e32e45fa5b8.png" style="max-width: 100.0%;max-height: 100.0%;"> time (for all of the queries)?</p><p>For example:</p><p>Given a tree, every vertex has color. Query is <strong>how many vertices in subtree of vertex <code class="tt">v</code> are colored with color <code class="tt">c</code>?</strong></p><p>Let's see how we can solve this problem and similar problems.</p><p>First, we have to calculate the size of the subtree of every vertice. It can be done with simple dfs:</p> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> getsz</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
    sz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">  </span><span class="com">// every vertex has itself in its subtree</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
            getsz</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">);</span><span class="pln">
            sz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln"> </span><span class="com">// add size of child u to its parent(v)</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Now we have the size of the subtree of vertex <code class="tt">v</code> in <code class="tt">sz[v]</code>.</p><p>The naive method for solving that problem is this code(that works in O(N ^ 2) time)</p> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u</span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">)</span><span class="pln">
            add</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
    add</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="com">//now cnt[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</span><span class="pln">
    add</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">)</span><span class="pln">
            dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>Now, how to improve it? There are several styles of coding for this technique.</p><h3>1. easy to code but <img align="middle" class="tex-formula" src="/predownloaded/ca/4c/ca4c38da7d143fc87534d50aa6d551dd861caae9.png" style="max-width: 100.0%;max-height: 100.0%;">.</h3> <pre><code class="prettyprint"><span class="pln">map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">*</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
           dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">);</span><span class="pln">
           </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> mx</span><span class="pun">)</span><span class="pln">
               mx </span><span class="pun">=</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
       </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bigChild </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">bigChild</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">();</span><span class="pln">
    </span><span class="pun">(*</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">++;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">){</span><span class="pln">
           </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
               </span><span class="pun">(*</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])[</span><span class="pln">x</span><span class="pun">.</span><span class="pln">first</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> x</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;</span><span class="pln">
       </span><span class="pun">}</span><span class="pln">
    </span><span class="com">//now (*cnt[v])[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</span><span class="pln">

</span><span class="pun">}</span></code></pre><h3>2. easy to code and <img align="middle" class="tex-formula" src="/predownloaded/e7/0f/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png" style="max-width: 100.0%;max-height: 100.0%;">.</h3> <pre><code class="prettyprint"><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> keep</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> mx</span><span class="pun">)</span><span class="pln">
           mx </span><span class="pun">=</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">)</span><span class="pln">
           dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bigChild </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        dfs</span><span class="pun">(</span><span class="pln">bigChild</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> vec</span><span class="pun">[</span><span class="pln">bigChild</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln">
        vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> vector</span><span class="str">&lt;int&gt;</span><span class="pln"> </span><span class="pun">();</span><span class="pln">
    vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-&gt;</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">)</span><span class="pln">
           </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]){</span><span class="pln">
               cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
               vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
           </span><span class="pun">}</span><span class="pln">
    </span><span class="com">//now (*cnt[v])[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</span><span class="pln">
    </span><span class="com">// note that in this step *vec[v] contains all of the subtree of vertex v.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">keep </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]--;</span><span class="pln">
</span><span class="pun">}</span></code></pre><h3>3. heavy-light decomposition style <img align="middle" class="tex-formula" src="/predownloaded/e7/0f/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png" style="max-width: 100.0%;max-height: 100.0%;">.</h3> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">bool</span><span class="pln"> big</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u</span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">!</span><span class="pln">big</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
            add</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">)</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> keep</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> mx</span><span class="pun">)</span><span class="pln">
          mx </span><span class="pun">=</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">)</span><span class="pln">
            dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">  </span><span class="com">// run a dfs on small childs and clear them from cnt</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bigChild </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        dfs</span><span class="pun">(</span><span class="pln">bigChild</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> big</span><span class="pun">[</span><span class="pln">bigChild</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">  </span><span class="com">// bigChild marked as big and not cleared from cnt</span><span class="pln">
    add</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="com">//now cnt[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bigChild </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        big</span><span class="pun">[</span><span class="pln">bigChild</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">keep </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        add</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></code></pre><h3>4. My invented style <img align="middle" class="tex-formula" src="/predownloaded/e7/0f/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png" style="max-width: 100.0%;max-height: 100.0%;">.</h3><p>This implementation for "Dsu on tree" technique is new and invented by me. This implementation is easier to code than others. Let <span class="tex-span"><i>st</i>[<i>v</i>]</span> dfs starting time of vertex <span class="tex-span"><i>v</i></span>, <span class="tex-span"><i>ft</i>[<i>v</i>]</span> be it's finishing time and <span class="tex-span"><i>ver</i>[<i>time</i>]</span> is the vertex which it's starting time is equal to <span class="tex-span"><i>time</i></span>.</p> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> keep</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> mx</span><span class="pun">)</span><span class="pln">
          mx </span><span class="pun">=</span><span class="pln"> sz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> bigChild </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">)</span><span class="pln">
            dfs</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">  </span><span class="com">// run a dfs on small childs and clear them from cnt</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">bigChild </span><span class="pun">!=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        dfs</span><span class="pun">(</span><span class="pln">bigChild</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">  </span><span class="com">// bigChild marked as big and not cleared from cnt</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">)</span><span class="pln">
	    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> st</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln"> p </span><span class="pun">&lt;</span><span class="pln"> ft</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln"> p</span><span class="pun">++)</span><span class="pln">
		cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln"> ver</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
    cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
    </span><span class="com">//now cnt[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">keep </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> st</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln"> p </span><span class="pun">&lt;</span><span class="pln"> ft</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln"> p</span><span class="pun">++)</span><span class="pln">
	    cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln"> ver</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">]--;</span><span class="pln">
</span><span class="pun">}</span></code></pre><p>But why it is <img align="middle" class="tex-formula" src="/predownloaded/e7/0f/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png" style="max-width: 100.0%;max-height: 100.0%;">? You know that why dsu has <img align="middle" class="tex-formula" src="/predownloaded/0f/23/0f239d055af9bea3474df8b031eb77f1e3db2398.png" style="max-width: 100.0%;max-height: 100.0%;"> time (for <span class="tex-span"><i>q</i></span> queries); the code uses the same method. Merge smaller to greater.</p><p>If you have heard <code class="tt">heavy-light decomposition</code> you will see that function <code class="tt">add</code> will go light edges only, because of this, code works in <img align="middle" class="tex-formula" src="/predownloaded/e7/0f/e70fbdc8079c0b9ff4f31073012937bac199bc6b.png" style="max-width: 100.0%;max-height: 100.0%;"> time.</p><p>Any problems of this type can be solved with same <code class="tt">dfs</code> function and just differs in <code class="tt">add</code> function.</p><p>Hmmm, this is what you want, problems that can be solved with this technique:</p><p>(List is sorted by difficulty and my code for each problem is given, my codes has <code class="tt">heavy-light</code> style)</p><p><a href="/contest/600/problem/E" title="Educational Codeforces Round 2">600E - Lomsat gelral</a> : <code class="tt">heavy-light decomposition</code> style : <a href="/contest/600/submission/14607801" title="Submission 14607801 by Arpa">14607801</a>, easy style : <a href="/contest/600/submission/14554536" title="Submission 14554536 by Arpa">14554536</a>. I think this is the easiest problem of this technique in CF and it's good to start coding with this problem.</p><p><a href="/contest/570/problem/D" title="Codeforces Round 316 (Div. 2)">570D - Tree Requests</a> : <a href="/contest/570/submission/17961189" title="Submission 17961189 by Arpa">17961189</a> Thanks to <a class="rated-user user-blue" href="/profile/Sorasorasora" title="Expert Sorasorasora">Sorasorasora</a>; this problem is also good for start coding.</p><p><a href="http://acm.sgu.ru/problem.php?contest=0&amp;problem=507">Sgu507</a> (SGU is unavailable, read the problem statements <a href="https://vjudge.net/problem/SGU-507">here</a>) This problem is also good for the start.</p><p><a href="https://www.hackerearth.com/practice/algorithms/graphs/depth-first-search/practice-problems/algorithm/the-grass-type/">HackerEarth, The Grass Type</a> This problem is also good for start (See <a class="rated-user user-cyan" href="/profile/bhishma" title="Specialist bhishma">bhishma</a>'s comment <a href="#comment-332421">below</a>).</p><p><a href="/contest/246/problem/E" title="Codeforces Round 151 (Div. 2)">246E - Blood Cousins Return</a> : <a href="/contest/246/submission/15409328" title="Submission 15409328 by Arpa">15409328</a></p><p><a href="/contest/208/problem/E" title="Codeforces Round 130 (Div. 2)">208E - Blood Cousins</a> : <a href="/contest/208/submission/16897324" title="Submission 16897324 by Arpa">16897324</a></p><p><a href="http://www.ioinformatics.org/locations/ioi11/contest/">IOI 2011, Race</a> (See <a class="rated-user user-violet" href="/profile/SaSaSaS" title="Candidate Master SaSaSaS">SaSaSaS</a>'s comment <a href="#comment-332425">below</a>).</p><p><a href="/contest/291/problem/E" title="Croc Champ 2013 - Qualification Round">291E - Tree-String Problem</a> : See <a class="rated-user user-blue" href="/profile/bhargav104" title="Expert bhargav104">bhargav104</a>'s comment <a href="#comment-316011">below</a>.</p><p><a href="/contest/343/problem/D" title="Codeforces Round 200 (Div. 1)">343D - Water Tree</a> : <a href="/contest/343/submission/15063078" title="Submission 15063078 by Arpa">15063078</a> Note that problem is not easy and my code doesn't use this technique (dsu on tree), but <a class="rated-user user-violet" href="/profile/AmirAz" title="Candidate Master AmirAz">AmirAz</a> 's solution to this problem uses this technique : <a href="/contest/343/submission/14904379" title="Submission 14904379 by AmirAz">14904379</a>.</p><p><a href="/contest/375/problem/D" title="Codeforces Round 221 (Div. 1)">375D - Tree and Queries</a> : <a href="/contest/375/submission/15449102" title="Submission 15449102 by Arpa">15449102</a> Again note that problem is not easy :)).</p><p><a href="/contest/716/problem/E" title="Codeforces Round 372 (Div. 2)">716E - Digit Tree</a> : <a href="/contest/716/submission/20776957">20776957</a> A hard problem. Also can be solved with centroid decomposition.</p><p><a href="/contest/741/problem/D" title="Codeforces Round 383 (Div. 1)">741D - Arpa’s letter-marked tree and Mehrdad’s Dokhtar-kosh paths</a> : <a href="/contest/741/submission/22796438" title="Submission 22796438 by Arpa">22796438</a> A hard problem. You must be very familiar with Dsu on tree to solve it.</p><p>For Persian users, there is another problem in Shaazzz contest round #4 (season 2016-2017) problem 3 that is a very hard problem with this technique.</p><p>If you have another problem with this tag, give me to complete the list :)).</p><p>And after all, special thanks from <a class="rated-user user-red" href="/profile/amd" title="Grandmaster amd">amd</a> who taught me this technique.</p></div>
    </div>


        <div style="font-size: 1.1rem;line-height: 11px;">
            <img style="vertical-align: middle;" src="http://st.codeforces.com/s/95195/images/blog/tags.png" title="Tags" alt="Tags">
                <span style="padding: 0 0.35em;">
    <a href="/search?query=dsu%2520on%2520tree" class="tag notice" style="text-decoration: none;">dsu on tree</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="/search?query=sack" class="tag notice" style="text-decoration: none;">sack</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="/search?query=guni" class="tag notice" style="text-decoration: none;">guni</a>
                </span>
        </div>

    <div class="roundbox meta" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
        <div class="left-meta">
            <ul>
                    <li>        <a href="#" class="topic-vote-up-44511"><img style="vertical-align:middle;position:relative;top:-0.2em;" src="http://st.codeforces.com/s/95195/images/actions/voteup.png" alt="Vote: I like it" title="Vote: I like it"></a>
        &nbsp;


        <a href="#" class="topic-vote-up-44511">
        
        </a>
</li>
                    <li>

        
        <span title="Topic rating" style="font-size:larger;font-weight:bold;color:green">+68</span>
        
</li>
                    <li>        <a href="#" class="topic-vote-down-44511"><img style="vertical-align:middle;position:relative;top:-0.2em;" src="http://st.codeforces.com/s/95195/images/actions/votedown.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
        &nbsp;


        <a href="#" class="topic-vote-down-44511">
        
        </a>
</li>
            </ul>
        </div>

        <div class="yashare-auto-init" style="display: inline; position: relative; top: 5px; left: 0;" data-yasharel10n="en" data-yasharetype="none" data-yasharelink="http://codeforces.com/blog/entry/44351" data-yasharetitle="Codeforces: [Tutorial] Sack (dsu on tree)" data-yasharequickservices="vkontakte,facebook,twitter,lj"><span class="b-share"><a rel="nofollow" target="_blank" title="VKontakte" class="b-share__handle b-share__link b-share-btn__vkontakte" href="https://share.yandex.net/go.xml?service=vkontakte&amp;url=http%3A%2F%2Fcodeforces.com%2Fblog%2Fentry%2F44351&amp;title=Codeforces%3A%20%5BTutorial%5D%20Sack%20(dsu%20on%20tree)" data-service="vkontakte"><span class="b-share-icon b-share-icon_vkontakte"></span></a><a rel="nofollow" target="_blank" title="Facebook" class="b-share__handle b-share__link b-share-btn__facebook" href="https://share.yandex.net/go.xml?service=facebook&amp;url=http%3A%2F%2Fcodeforces.com%2Fblog%2Fentry%2F44351&amp;title=Codeforces%3A%20%5BTutorial%5D%20Sack%20(dsu%20on%20tree)" data-service="facebook"><span class="b-share-icon b-share-icon_facebook"></span></a><a rel="nofollow" target="_blank" title="Twitter" class="b-share__handle b-share__link b-share-btn__twitter" href="https://share.yandex.net/go.xml?service=twitter&amp;url=http%3A%2F%2Fcodeforces.com%2Fblog%2Fentry%2F44351&amp;title=Codeforces%3A%20%5BTutorial%5D%20Sack%20(dsu%20on%20tree)" data-service="twitter"><span class="b-share-icon b-share-icon_twitter"></span></a><a rel="nofollow" target="_blank" title="LiveJournal" class="b-share__handle b-share__link b-share-btn__lj" href="https://share.yandex.net/go.xml?service=lj&amp;url=http%3A%2F%2Fcodeforces.com%2Fblog%2Fentry%2F44351&amp;title=Codeforces%3A%20%5BTutorial%5D%20Sack%20(dsu%20on%20tree)" data-service="lj"><span class="b-share-icon b-share-icon_lj"></span></a></span></div>

        <span style="position: relative; top: 7px; left: 0.8em;">
        </span>

        <div class="right-meta">
            <ul>
                    <li>        <a href="/profile/Arpa"><img style="vertical-align:middle;position:relative;top:-0.2em;" src="http://st.codeforces.com/s/95195/images/blog/user_16x16.png" alt="Author" title="Author"></a>
        &nbsp;


        <a href="/profile/Arpa">
        Arpa
        </a>
</li>
                    <li>        <img style="vertical-align:middle;position:relative;top:-0.2em;" src="http://st.codeforces.com/s/95195/images/blog/date_16x16.png" alt="Publication date" title="Publication date">
        &nbsp;


        
        <span class="format-humantime" title="Apr/14/2016 12:11 UTC">2 years ago</span>
        
</li>
                    <li>        <a href="/blog/entry/44351#comments"><img style="vertical-align:middle;position:relative;top:-0.2em;" src="http://st.codeforces.com/s/95195/images/blog/comments_16x16.png" alt="Comments" title="Comments"></a>
        &nbsp;


        <a href="/blog/entry/44351#comments">
        86
        </a>
</li>
            </ul>
        </div>

        <br style="clear:both;">
    </div>


<div class="comments" commentableid="44528">
    <div class="title">
        <img src="http://st.codeforces.com/s/95195/images/icons/comments-48x48.png" alt="Comments" title="Comments" style="position:relative;top:0.6em;">
        <a name="comments">Comments (86)</a>
    </div>
    <div><a href="#" class="new-root-comment" style="float:right;position:relative;bottom:3.25em;">Write comment?</a></div>

<div class="comment">
    <table class="comment-table" commentid="290526" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/maximaxi" style="position: relative;">
<img src="http://userpic.codeforces.com/257652/avatar/e50c1d977d6fb635.jpg">        </a>
        <div><a href="/profile/maximaxi" title="Specialist maximaxi" class="rated-user user-cyan">maximaxi</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/24/2016 19:17 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290526" href="?#comment-290526" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="290526" data-commentrating="4" data-commentuserid="257652">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+4</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290526">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://a2oj.com/category?ID=98">A2OJ's DSU Section</a> has quite a few tree DSU problems.</p><p>Thank you for this post, it explains the theory well and is very easy to read.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290526 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290526 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290526">
            <li>
<div class="comment">
    <table class="comment-table" commentid="309660" commentparentid="290526">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/gotosleep" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/gotosleep" title="Specialist gotosleep" class="rated-user user-cyan">gotosleep</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/11/2016 18:57 UTC">21 month(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-309660" href="?#comment-309660" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290526" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="309660" data-commentrating="-6" data-commentuserid="417511">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-309660">
                    <div class="moveup">
                    <div class="ttypography"><p>بدك تضل تتمنيك عكل بوستات الخرا ؟</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-309660 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-309660 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-309660">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="290623" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/dumbass" style="position: relative;">
<img src="http://userpic.codeforces.com/91604/avatar/c62eef684f1999af.jpg">        </a>
        <div><a href="/profile/dumbass" title="Candidate Master dumbass" class="rated-user user-violet">dumbass</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/24/2016 21:19 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290623" href="?#comment-290623" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="290623" data-commentrating="0" data-commentuserid="91604">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290623">
                    <div class="moveup">
                    <div class="ttypography"><p>What does the variable "keep" denote ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290623 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290623 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290623">
            <li>
<div class="comment">
    <table class="comment-table" commentid="290699" commentparentid="290623">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/NibNalin" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/NibNalin" title="Expert NibNalin" class="rated-user user-blue">NibNalin</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/25/2016 06:09 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290699" href="?#comment-290699" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290623" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="290699" revisioncount="4" revision="4">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">4</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="290699" data-commentrating="3" data-commentuserid="245756">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290699">
                    <div class="moveup">
                    <div class="ttypography"><p>The way I understand HLD here is basically if a child is the big child, we don't want to recompute answer for it to reduce computation. So we just store the answer for it in the <code class="tt">cnt</code> array already so that it's parent doesn't need to re-dfs this subtree. <code class="tt">keep</code> denotes whether or not this child is that big child. Please correct me if I'm wrong. :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290699 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290699 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290699">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="290707" commentparentid="290623">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/25/2016 06:44 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290707" href="?#comment-290707" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290623" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="290707" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="290707" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290707">
                    <div class="moveup">
                    <div class="ttypography"><p>Look at last two lines:</p> <pre><code class="prettyprint"><span class="pln">    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">keep </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        add</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span></code></pre><p>It means that if <code class="tt">keep == false</code> after <code class="tt">dfs</code> clear <code class="tt">v</code>s subtree information from <code class="tt">cnt</code>. And if <code class="tt">keep == true</code>, don't clear <code class="tt">v</code>s subtree information from <code class="tt">cnt</code>. In other word if <code class="tt">keep == true</code>after calling <code class="tt">dfs</code>, for each <code class="tt">u</code> from subtree of vertice <code class="tt">v</code>, <code class="tt">col[u]</code> is in <code class="tt">cnt</code> (<code class="tt">cnt[ col[u] ]++</code>).</p><p>And <a class="rated-user user-cyan" href="/profile/NibNalin" title="Specialist NibNalin">NibNalin</a> is right. <code class="tt">keep</code> is <code class="tt">true</code> if and only if <code class="tt">v</code> is biggest child of it's parent.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290707 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290707 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290707">
            <li>
<div class="comment">
    <table class="comment-table" commentid="309408" commentparentid="290707">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/ka89" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/ka89" title="Unrated, ka89" class="rated-user user-black">ka89</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/10/2016 18:49 UTC">21 month(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-309408" href="?#comment-309408" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290707" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="309408" data-commentrating="0" data-commentuserid="297381">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-309408">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi Arpa, thanks a ton for this awesome post. I have really learnt lot from it.</p><p>I do have one question though. What is the advantage of having keep=false? If that part is kept as it is, without clearing, doesnt the computation become faster? Can you please help clearing this doubt?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-309408 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-309408 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-309408">
            <li>
<div class="comment">
    <table class="comment-table" commentid="309436" commentparentid="309408">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/11/2016 04:01 UTC">21 month(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-309436" href="?#comment-309436" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-309408" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="309436" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-309436">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi, Thanks.</p><p>Consider vertex v has two children, q and p. If you call dfs for both of them with keep = true, they will mixed up their information, and queries will be incorrectly answered.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-309436 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-309436 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-309436">
            <li>
<div class="comment">
    <table class="comment-table" commentid="309469" commentparentid="309436">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/ka89" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/ka89" title="Unrated, ka89" class="rated-user user-black">ka89</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/11/2016 10:41 UTC">21 month(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-309469" href="?#comment-309469" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-309436" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="309469" data-commentrating="0" data-commentuserid="297381">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-309469">
                    <div class="moveup">
                    <div class="ttypography"><p>oh..ok. Got it now. Thanks.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-309469 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-309469 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-309469">
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="371768" commentparentid="309436">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Lance_HAOH" style="position: relative;">
<img src="http://userpic.codeforces.com/472788/avatar/715ea669ad4a80c5.jpg">        </a>
        <div><a href="/profile/Lance_HAOH" title="Pupil Lance_HAOH" class="rated-user user-green">Lance_HAOH</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/05/2017 16:24 UTC">10 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-371768" href="?#comment-371768" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-309436" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="371768" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="371768" data-commentrating="0" data-commentuserid="472788">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-371768">
                    <div class="moveup">
                    <div class="ttypography"><p>I guess this method is only viable if DP cannot be used? (i.e. Too many states to memoize)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-371768 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-371768 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-371768">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="290753" commentparentid="290623">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/bk2dcradle" style="position: relative;">
<img src="http://userpic.codeforces.com/229418/avatar/365db85632d16e2d.jpg">        </a>
        <div><a href="/profile/bk2dcradle" title="Candidate Master bk2dcradle" class="rated-user user-violet">bk2dcradle</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/25/2016 12:14 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290753" href="?#comment-290753" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290623" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="290753" data-commentrating="34" data-commentuserid="229418">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+34</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290753">
                    <div class="moveup">
                    <div class="ttypography"><p>Observations to understand the complexity:</p> <ol>   <li>The <code class="tt">dfs</code> function visits each node exactly once.</li>   <li>The problem might seem with the add function. You might think that it is making the algorithm <code class="tt">n^2</code>. Note that in the <code class="tt">add</code> function, we only go down from a vertex to its children if the edge connecting the vertex to the child is a light edge.</li> </ol><p>You can think of it in this way, each vertex <code class="tt">v</code> will be visited by a call to the <code class="tt">add</code> function for any ancestor of <code class="tt">v</code> that is connected to a light edge. Since there are at most <code class="tt">log(n)</code> light edges going up from any vertex to the root, each vertex will be visited at most <code class="tt">log(n)</code> times.</p><p>So the algorithm is: Say you are at a vertex <code class="tt">v</code>, first you find the bigchild, then you run dfs on small childs, passing the value of keep as <code class="tt">0</code>. Why? So they are cleared from cnt. Then you run a dfs on bigchild, and you do not clear it from <code class="tt">cnt</code>. Now, <code class="tt">cnt</code> stores the results for all vertices in the subtree of <code class="tt">bigchild</code> (since we cleared <code class="tt">cnt</code> for small childs and didn't do so for the bigchild), so we call the <code class="tt">add</code> function to "add" the information of children of current vertex that are connected to it via a light edge. Now we are ready to compute the answer</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290753 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290753 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290753">
            <li>
<div class="comment">
    <table class="comment-table" commentid="370756" commentparentid="290753">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/gogateiiit" style="position: relative;">
<img src="http://userpic.codeforces.com/342197/avatar/3a1d2285ca7fc2ce.jpg">        </a>
        <div><a href="/profile/gogateiiit" title="Expert gogateiiit" class="rated-user user-blue">gogateiiit</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/30/2017 19:11 UTC">10 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-370756" href="?#comment-370756" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290753" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="370756" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="370756" data-commentrating="3" data-commentuserid="342197">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-370756">
                    <div class="moveup">
                    <div class="ttypography"><p>As you said "add" function goes down using only light edges,Don't these two lines <code class="tt">if(bigChild != -1)         big[bigChild] = 0;</code> of heavy light decomposition implementation would affect it as if you call "add" after all dfs are done and returned to the root then we only have one heavy edge marked that of root itself others are zero so as "add" goes below it traverses whole tree. Help me here.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-370756 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-370756 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-370756">
            <li>
<div class="comment">
    <table class="comment-table" commentid="370831" commentparentid="370756">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/gogateiiit" style="position: relative;">
<img src="http://userpic.codeforces.com/342197/avatar/3a1d2285ca7fc2ce.jpg">        </a>
        <div><a href="/profile/gogateiiit" title="Expert gogateiiit" class="rated-user user-blue">gogateiiit</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/01/2017 11:38 UTC">10 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-370831" href="?#comment-370831" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-370756" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="370831" data-commentrating="0" data-commentuserid="342197">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-370831">
                    <div class="moveup">
                    <div class="ttypography"><p>Got it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-370831 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-370831 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-370831">
            <li>
<div class="comment">
    <table class="comment-table" commentid="371371" commentparentid="370831">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/gogateiiit" style="position: relative;">
<img src="http://userpic.codeforces.com/342197/avatar/3a1d2285ca7fc2ce.jpg">        </a>
        <div><a href="/profile/gogateiiit" title="Expert gogateiiit" class="rated-user user-blue">gogateiiit</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/03/2017 06:47 UTC">10 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-371371" href="?#comment-371371" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-370831" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="371371" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="371371" data-commentrating="3" data-commentuserid="342197">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-371371">
                    <div class="moveup">
                    <div class="ttypography"><p>For those who had same doubt as I had: First lets understand why it is wrong to remove it,consider you are at particular node(let it be called A) in recursion,above line is not there,you have 3 children one of them is big child(3rd) while others are normal so you traversed inside 1st and came back to A then you traversed inside 2nd child if you do not have above line then while going inside this children you would have all answer for big children of 1st child which would mess your answer. Now let's understand why complexity is O(n(log(n)):</p><p>Note 1: To calculate complexity you need to measure how many times add function visits the ever y node.</p><p>Note 2: For first add called at a node: A node will visited by add only through its ancestors which are connected by light edges so n nodes log(n) light edges above it this gives us O(n(log(n)))</p><p>Note 3: For second add called at a node: Now somebody may protest that that after above mentioned line(big[bigChild]=0) we are unmarking heavy edge and also calling add after that which may mess up complexity as it travels every node below it which is O(n) but keep==0 condition ensures that for each node there atmost log(n) nodes above in ancestor which have keep=0 function is called.which again gives O(n(log(n)).</p><p>Giving us finally O(n(log(n))) complexity. Follow this link to understand heavy light decomposition's properties: <a href="https://blog.anudeep2011.com/heavy-light-decomposition/">https://blog.anudeep2011.com/heavy-light-decomposition/</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-371371 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-371371 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-371371">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="290906" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/the_art_of_war" style="position: relative;">
<img src="http://userpic.codeforces.com/281181/avatar/33d0d7060aba26e0.jpg">        </a>
        <div><a href="/profile/the_art_of_war" title="International master the_art_of_war" class="rated-user user-orange">the_art_of_war</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/26/2016 14:26 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-290906" href="?#comment-290906" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="290906" data-commentrating="0" data-commentuserid="281181">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-290906">
                    <div class="moveup">
                    <div class="ttypography"><p>In second easy with O(n*lg n)</p><p>Why if(keep==false) we delete only vertex from main vector</p> <pre><code class="prettyprint"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]--;</span></code></pre><p>but we don't delete vertex from cnt which we changed here:</p> <pre><code class="prettyprint"><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">){</span><span class="pln">
           </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
               cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
       </span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-290906 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-290906 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-290906">
            <li>
<div class="comment">
    <table class="comment-table" commentid="293924" commentparentid="290906">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/13/2016 06:08 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293924" href="?#comment-293924" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-290906" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="293924" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="293924" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293924">
                    <div class="moveup">
                    <div class="ttypography"><p>There was a mistake in writing. I'm sorry.</p><p>Thanks for reporting this problem.</p><p>code should be:</p> <pre><code class="prettyprint"><span class="pln">       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">){</span><span class="pln">
           </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
               cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
       </span><span class="pun">}</span></code></pre><p>Instead of:</p> <pre><code class="prettyprint"><span class="pln">       </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u </span><span class="pun">!=</span><span class="pln"> p </span><span class="pun">&amp;&amp;</span><span class="pln"> u </span><span class="pun">!=</span><span class="pln"> bigChild</span><span class="pun">){</span><span class="pln">
           </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> </span><span class="pun">*</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
               cnt</span><span class="pun">[</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">]++;</span><span class="pln">
       </span><span class="pun">}</span></code></pre><p>I have edited that.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293924 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293924 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293924">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="293430" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/SProf" style="position: relative;">
<img src="http://userpic.codeforces.com/343400/avatar/b62236ec5eade4cb.jpg">        </a>
        <div><a href="/profile/SProf" title="Pupil SProf" class="rated-user user-green">SProf</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/11/2016 13:25 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293430" href="?#comment-293430" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="293430" data-commentrating="0" data-commentuserid="343400">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293430">
                    <div class="moveup">
                    <div class="ttypography"><p>can someone tell me how 208E is solved with this technique? thanks a lot.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293430 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293430 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293430">
            <li>
<div class="comment">
    <table class="comment-table" commentid="293772" commentparentid="293430">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/bk2dcradle" style="position: relative;">
<img src="http://userpic.codeforces.com/229418/avatar/365db85632d16e2d.jpg">        </a>
        <div><a href="/profile/bk2dcradle" title="Candidate Master bk2dcradle" class="rated-user user-violet">bk2dcradle</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/12/2016 10:33 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293772" href="?#comment-293772" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-293430" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="293772" data-commentrating="0" data-commentuserid="229418">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293772">
                    <div class="moveup">
                    <div class="ttypography"><p>You need to compute for each pair <code class="tt">v p</code> the p-th cousin of v. That is equivalent to finding the number of p-th descendants of the p-th ancestor of <code class="tt">v</code> — 1.</p><p>So for each query, replace <code class="tt">v p</code> with <code class="tt">p_th_ancestor_of_v p</code>. Now you need to store in <code class="tt">cnt</code> the number of nodes at a certain depth. In other words, <code class="tt">cnt[x]</code> should be equal to number of nodes at depth <code class="tt">x</code> in the current subtree.</p><p>Code for Reference: <a href="http://codeforces.com/contest/208/submission/17513471">http://codeforces.com/contest/208/submission/17513471</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293772 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293772 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293772">
            <li>
<div class="comment">
    <table class="comment-table" commentid="293898" commentparentid="293772">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/shavidze" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/shavidze" title="Pupil shavidze" class="rated-user user-green">shavidze</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/12/2016 21:10 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293898" href="?#comment-293898" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-293772" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="293898" data-commentrating="0" data-commentuserid="369978">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293898">
                    <div class="moveup">
                    <div class="ttypography"><p>can't understand why for every vertex v we ans[depth[v]] increase by 1 when we call add function,why must we do it?or why it must be ans[deth[v]] when depth[v] means distance from root to v? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293898 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293898 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293898">
            <li>
<div class="comment">
    <table class="comment-table" commentid="293931" commentparentid="293898">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/13/2016 06:57 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293931" href="?#comment-293931" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-293898" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="293931" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="293931" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293931">
                    <div class="moveup">
                    <div class="ttypography"><p><code class="tt">ans[h]</code> is equal to number of vertices with height h, (with distance h from root).</p><p>Let par, p'th ancestor of v, the answer to query is:</p><p>Consider only subtree of vertice par, print ans[ height[v] ] — 1.</p><p>So with method above we can process all of the queries.</p><p>See my code for better understanding.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293931 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293931 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293931">
            <li>
<div class="comment">
    <table class="comment-table" commentid="293949" commentparentid="293931">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/shavidze" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/shavidze" title="Pupil shavidze" class="rated-user user-green">shavidze</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/13/2016 10:19 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-293949" href="?#comment-293949" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-293931" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="293949" data-commentrating="5" data-commentuserid="369978">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-293949">
                    <div class="moveup">
                    <div class="ttypography"><p>thanks everyone , now i understand.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-293949 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-293949 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-293949">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="294284" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Sora233" style="position: relative;">
<img src="http://userpic.codeforces.com/265481/avatar/fba4a8a3cf91ef1d.jpg">        </a>
        <div><a href="/profile/Sora233" title="Candidate Master Sora233" class="rated-user user-violet">Sora233</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/16/2016 07:38 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-294284" href="?#comment-294284" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="294284" data-commentrating="10" data-commentuserid="265481">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-294284">
                    <div class="moveup">
                    <div class="ttypography"><p>If i haven't read this article, i wouldn't get ac on <a href="http://codeforces.com/contest/570/problem/D">this</a> problem. It is another problem which can be solved easily by dsu. </p><p><a href="http://codeforces.com/contest/570/submission/17927999">here</a> is my code in HLD-style.</p><p>Thanks!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-294284 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-294284 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-294284">
            <li>
<div class="comment">
    <table class="comment-table" commentid="294479" commentparentid="294284">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/16/2016 19:49 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-294479" href="?#comment-294479" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-294284" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="294479" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-294479">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks! Added to list ;)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-294479 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-294479 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-294479">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="294295" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Batman" style="position: relative;">
<img src="http://userpic.codeforces.com/223127/avatar/268d35c85c51c800.jpg">        </a>
        <div><a href="/profile/Batman" title="Grandmaster Batman" class="rated-user user-red">Batman</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/16/2016 09:59 UTC">2 years ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-294295" href="?#comment-294295" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="294295" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="294295" data-commentrating="12" data-commentuserid="223127">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+12</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-294295">
                    <div class="moveup">
                    <div class="ttypography"><p>I can't understand why the second code is correct...</p><p>Consider this example:</p><p><img alt=" " src="/predownloaded/3a/15/3a156555cb73c2ee9d6a31f44f572bb8d57740f8.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>We wanna calculate the cnt for Vertex 8. These are the steps:</p><p>Going to Vertex 1</p><p>Going to Vertex 2 by keep=0</p><p>Going to Vertex 3 by keep=0,Vec[3]={3}</p><p>Going to Vertex 4 by keep=1,Vec[4]={4},Cnt[color[4]]=1</p><p>Going back to Vertex 2,Vec[2]={2,4},Cnt[color[4]]=0,Cnt[color[3]]=1</p><p>And then when we go to Vertices 5,6,7,8 still Cnt[color[3]]=1.</p><p>Also sorry if I did the steps wrong...</p><p><strong>UPD</strong> Thank you for editing the blog. My problem fixed.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-294295 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-294295 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-294295">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="304299" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/gabrielsimoes" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/gabrielsimoes" title="Expert gabrielsimoes" class="rated-user user-blue">gabrielsimoes</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/08/2016 00:13 UTC">22 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-304299" href="?#comment-304299" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="304299" revisioncount="4" revision="4">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">4</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="304299" data-commentrating="0" data-commentuserid="299517">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-304299">
                    <div class="moveup">
                    <div class="ttypography"><p>Great post. If you explained the idea before showing the code, it would be better to understand. Also commenting the variables meaning in the code would be of great help.</p><p>It would be good to mention that most solutions will answer the queries offline, which may be a problem sometime (maybe someone didn't notice this lol).</p><p>Also, it would be nice to post hints about the solutions.</p><p>Proving explicitly why it is <span class="tex-span"><i>nlogn</i></span> would be good too (ie. as each node's subtree set gets merged into one set of size equal or greater, and the base set has size <span class="tex-span">1</span> and the last set has size <span class="tex-span"><i>n</i></span>, then we take <span class="tex-span"><i>logn</i></span> steps to go from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>. Summarizing, each node gets merged <span class="tex-span"><i>logn</i></span> times, so the total complexity is <span class="tex-span"><i>O</i>(<i>nlogn</i>)</span>).</p><p>Here's my solution to 343D, maybe it will be of help to someone: <a href="http://codeforces.com/contest/343/submission/18958875">18958875</a>. A lot easier to code than the one in the tutorial.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-304299 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-304299 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-304299">
            <li>
<div class="comment">
    <table class="comment-table" commentid="308597" commentparentid="304299">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2016 02:51 UTC">21 month(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-308597" href="?#comment-308597" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-304299" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="308597" data-commentrating="2" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+2</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-308597">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks for your suggestions first !</p><p>I proved that it is O(nlogn) : <em>You know that why dsu has O(q log n) time (for q queries); the code uses same method. Merge smaller to greater.</em></p><p>And about your code (<a href="/contest/343/submission/18958875" title="Submission 18958875 by gabrielsimoes">18958875</a>), anyone has a different opinion !</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-308597 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-308597 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-308597">
            <li>
<div class="comment">
    <table class="comment-table" commentid="308623" commentparentid="308597">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/gabrielsimoes" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/gabrielsimoes" title="Expert gabrielsimoes" class="rated-user user-blue">gabrielsimoes</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2016 10:17 UTC">21 month(s) ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-308623" href="?#comment-308623" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-308597" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="308623" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="308623" data-commentrating="0" data-commentuserid="299517">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-308623">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks for the reply!</p><p>Yeah, you did prove. People who remember DSU's proof will most likely understand. I stated a more extensive proof would be better thinking about people who don't exactly know the proof. Don't take me wrong, but they may get a little confused reading this proof.</p><p>I mentioned my code exactly because everyone has a different opinion,. Maybe it'll help a later reader, that's all.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-308623 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-308623 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-308623">
            <li>
<div class="comment">
    <table class="comment-table" commentid="316073" commentparentid="308623">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/pivorics" style="position: relative;">
<img src="http://userpic.codeforces.com/363194/avatar/963a3c74be0cb8b9.jpg">        </a>
        <div><a href="/profile/pivorics" title="Unrated, pivorics" class="rated-user user-black">pivorics</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/20/2016 15:32 UTC">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-316073" href="?#comment-316073" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-308623" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="316073" data-commentrating="0" data-commentuserid="363194">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-316073">
                    <div class="moveup">
                    <div class="ttypography"><p>Sorry this might be a stupid question to bring up, but why is the complexity of the heavy-light decomposition style one in <span class="tex-span"><i>O</i>(<i>nlogn</i>)</span>?</p><p>In the case where each node has at most two children: Denote the root node of the tree as <span class="tex-span"><i>u</i></span>, which is of size <span class="tex-span"><i>s</i></span>. The child of <span class="tex-span"><i>u</i></span> connected to the lighter edge is of size at most <img align="middle" class="tex-formula" src="/predownloaded/b4/96/b496aff80f2a13c88d1f13ed172dd40658607029.png" style="max-width: 100.0%;max-height: 100.0%;">. So the total number of nodes on which we run the "add" function would be at most <img align="middle" class="tex-formula" src="/predownloaded/62/e0/62e0b48e457b6451dd78792c4f64cb760a693ada.png" style="max-width: 100.0%;max-height: 100.0%;">. So I don't understand where the <span class="tex-span"><i>log</i>(<i>n</i>)</span> factor comes from. </p><p>The online tutorial for HLD says a new chain is built when we arrive at a child node via a lighter edge, where each chain is stored as a segment tree, and so I can see there is indeed a <span class="tex-span"><i>O</i>(<i>logn</i>)</span> factor involved.</p><p>Regardless can you perhaps elaborate a little bit more on the time complexity of the dsu structure? Thank you!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-316073 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-316073 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-316073">
            <li>
<div class="comment">
    <table class="comment-table" commentid="316139" commentparentid="316073">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/21/2016 09:10 UTC">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-316139" href="?#comment-316139" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-316073" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="316139" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-316139">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi !</p><p><em>The online tutorial for HLD says a new chain is built when we arrive at a child node via a lighter edge, where each chain is stored as a segment tree, and so I can see there is indeed a O(logn) factor involved.</em></p><p>As you know, if you use <code class="tt">segment tree</code> in <code class="tt">heavy-light decomposition</code>, each query time complexity will be <span class="tex-span"><i>O</i>(<i>log</i><sup class="upper-index">2</sup>(<i>n</i>))</span>. Because in each query you will go <span class="tex-span"><i>O</i>(<i>log</i>(<i>n</i>))</span> chains and in each chain it will spend <span class="tex-span"><i>O</i>(<i>log</i>(<i>n</i>))</span> time.</p><p>Now, I will proof that "heavy-light decomposition style implementation" of "dsu on tree" is <span class="tex-span"><i>O</i>(<i>n</i>.<i>log</i>(<i>n</i>))</span>:</p><p>Consider a complete binary tree with n vertices. In dfs function you will run another dfs function in child (<span class="tex-span"><i>T</i>(<i>n</i> / 2) * 2</span>) and you will call <code class="tt">add</code> function and it will spend <span class="tex-span"><i>O</i>(<i>n</i> / 2)</span> time. So, <span class="tex-span"><i>T</i>(<i>n</i>) = <i>n</i> / 2 + 2 * <i>T</i>(<i>n</i> / 2) = <i>O</i>(<i>n</i>.<i>log</i>(<i>n</i>))</span></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-316139 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-316139 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-316139">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="335199" commentparentid="308597">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Emphi" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/Emphi" title="Specialist Emphi" class="rated-user user-cyan">Emphi</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/02/2017 23:21 UTC">16 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-335199" href="?#comment-335199" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-308597" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="335199" data-commentrating="0" data-commentuserid="387480">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-335199">
                    <div class="moveup">
                    <div class="ttypography"><blockquote>   <blockquote><p>You know that why dsu has O(q log n) time (for q queries); the code uses same method. Merge smaller to greater.</p>   </blockquote> </blockquote><p>Pardon me , but I don't follow. Which dsu are you talking about? The one with inverse-Ackermann function?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-335199 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-335199 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-335199">
            <li>
<div class="comment">
    <table class="comment-table" commentid="335249" commentparentid="335199">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/03/2017 10:03 UTC">16 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-335249" href="?#comment-335249" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-335199" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="335249" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-335249">
                    <div class="moveup">
                    <div class="ttypography"><p>No. Dsu with size compare. Like this : </p> <pre><code class="prettyprint"><span class="kwd">int</span><span class="pln"> find</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> par</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> x </span><span class="pun">?</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">par</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> merge</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">){</span><span class="pln">
    v </span><span class="pun">=</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">v</span><span class="pun">),</span><span class="pln"> u </span><span class="pun">=</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">v </span><span class="pun">==</span><span class="pln"> u</span><span class="pun">)</span><span class="pln">  </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">size</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> size</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">  swap</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> u</span><span class="pun">);</span><span class="pln">
    par</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    size</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> size</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span></code></pre></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-335249 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-335249 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-335249">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="312836" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/rcg_" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/rcg_" title="Candidate Master rcg_" class="rated-user user-violet">rcg_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/29/2016 18:38 UTC">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-312836" href="?#comment-312836" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="312836" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="312836" data-commentrating="0" data-commentuserid="350715">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-312836">
                    <div class="moveup">
                    <div class="ttypography"><p>In easy to code but O(nlog^ 2), I cant't understand why do we store the size of subtrees of vertices in array sz and use it as the criteria for choosing the big child, I think we should store in the array "sz" the number of distinct colors in the subtree of any node v, because that is what we actually iterate on when transferring the map from v to u, why is this wrong?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-312836 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-312836 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-312836">
            <li>
<div class="comment">
    <table class="comment-table" commentid="312897" commentparentid="312836">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/30/2016 05:22 UTC">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-312897" href="?#comment-312897" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-312836" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="312897" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-312897">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi !</p><p>It isn't wrong! Both of your method and mine have the same worst case. But your average is better.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-312897 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-312897 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-312897">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="312855" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/algo.experiments" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/algo.experiments" title="Candidate Master algo.experiments" class="rated-user user-violet">algo.experiments</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/29/2016 21:16 UTC">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-312855" href="?#comment-312855" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="312855" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="312855" data-commentrating="0" data-commentuserid="407163">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-312855">
                    <div class="moveup">
                    <div class="ttypography"><p>Ahh, thanks gabrielsimoes, for anyone struggling to understand: n*log^2n is about answering queries OFFLINE right during the dfs. After the dfs has finished the cnt[v] will no longer be a valid map for vertices that were chosen as bigChild.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-312855 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-312855 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-312855">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="316011" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/bhargav104" style="position: relative;">
<img src="http://userpic.codeforces.com/246134/avatar/2697e92750c0dd9.jpg">        </a>
        <div><a href="/profile/bhargav104" title="Expert bhargav104" class="rated-user user-blue">bhargav104</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/19/2016 17:47 UTC">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-316011" href="?#comment-316011" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="316011" data-commentrating="8" data-commentuserid="246134">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-316011">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="http://codeforces.com/problemset/problem/291/E">http://codeforces.com/problemset/problem/291/E</a> <a href="/contest/291/problem/E" title="Croc Champ 2013 - Qualification Round">291E - Tree-String Problem</a> <a class="rated-user user-violet" href="/profile/Arpa" title="Candidate Master Arpa">Arpa</a> This problem can also be done by dsu on trees. Calculate hash value for each suffix value of target string. Then for each suffix of an edge if it is a valid prefix of the target string we would just need the frequency of the hash value of the remaining suffix of the target string in its subtree which can be maintained by this technique. The case when the entire string occurs in an edge can be dealt with separately.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-316011 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-316011 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-316011">
            <li>
<div class="comment">
    <table class="comment-table" commentid="316047" commentparentid="316011">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Sep/20/2016 11:26 UTC">20 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-316047" href="?#comment-316047" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-316011" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="316047" data-commentrating="5" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-316047">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks added to list, but it can be solved very easier : <a href="/contest/291/submission/19827525" title="Submission 19827525 by Arpa">19827525</a>, just use KMP.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-316047 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-316047 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-316047">
            <li>
<div class="comment">
    <table class="comment-table" commentid="378467" commentparentid="316047">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Dalgerok" style="position: relative;">
<img src="http://userpic.codeforces.com/483933/avatar/3f9b3b4b09d7b7a8.jpg">        </a>
        <div><a href="/profile/Dalgerok" title="Expert Dalgerok" class="rated-user user-blue">Dalgerok</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/13/2017 11:04 UTC">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-378467" href="?#comment-378467" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-316047" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="378467" data-commentrating="0" data-commentuserid="483933">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-378467">
                    <div class="moveup">
                    <div class="ttypography"><p>Just use hashes :) <a href="http://codeforces.com/contest/291/submission/29431526">http://codeforces.com/contest/291/submission/29431526</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-378467 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-378467 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-378467">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
            <li>
<div class="comment">
    <table class="comment-table" commentid="423599" commentparentid="316011">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/bktl1love" style="position: relative;">
<img src="http://userpic.codeforces.com/415658/avatar/fc6a2047fd5bd4c8.jpg">        </a>
        <div><a href="/profile/bktl1love" title="Candidate Master bktl1love" class="rated-user user-violet">bktl1love</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/05/2018 13:58 UTC">5 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-423599" href="?#comment-423599" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-316011" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="423599" data-commentrating="0" data-commentuserid="415658">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-423599">
                    <div class="moveup">
                    <div class="ttypography"><p>Please send me a code of the solution with this techinque)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-423599 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-423599 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-423599">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="329434" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/sengxian" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/sengxian" title="Candidate Master sengxian" class="rated-user user-violet">sengxian</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/07/2016 03:27 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329434" href="?#comment-329434" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="329434" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="329434" data-commentrating="13" data-commentuserid="338917">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-329434">
                    <div class="moveup">
                    <div class="ttypography"><p>Actually, in China, we call this method as "Heuristic Merge" which always merge the smaller to the bigger. Not hard to understand each vertex will be visited in O(log n) times because when we visited a vertex, then the size of tree which the vertex is in doubled.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329434 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329434 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329434">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="329879" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/abhigarg1796" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/abhigarg1796" title="Specialist abhigarg1796" class="rated-user user-cyan">abhigarg1796</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/09/2016 16:17 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329879" href="?#comment-329879" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="329879" data-commentrating="1" data-commentuserid="417191">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-329879">
                    <div class="moveup">
                    <div class="ttypography"><p>Hey Arpa,</p><p>In your my invented style I'm unable to understand that why in third loop are you not checking for u not being parent of v. Why are you only checking for just u not being the big child.</p><p>Thanks in Advance</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329879 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329879 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329879">
            <li>
<div class="comment">
    <table class="comment-table" commentid="329880" commentparentid="329879">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/09/2016 16:20 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329880" href="?#comment-329880" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-329879" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="329880" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-329880">
                    <div class="moveup">
                    <div class="ttypography"><p>Sorry, fixed. It's because I've copied my code from <a href="/contest/741/problem/D" title="Codeforces Round 383 (Div. 1)">741D - Arpa’s letter-marked tree and Mehrdad’s Dokhtar-kosh paths</a>, input for this problem was a rooted tree.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329880 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329880 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329880">
            <li>
<div class="comment">
    <table class="comment-table" commentid="329882" commentparentid="329880">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/abhigarg1796" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/abhigarg1796" title="Specialist abhigarg1796" class="rated-user user-cyan">abhigarg1796</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/09/2016 16:59 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329882" href="?#comment-329882" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-329880" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="329882" data-commentrating="2" data-commentuserid="417191">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+2</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-329882">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks a lot,</p><p>Also, I think there is one more mistake. You never added col[v] to the array. Am I missing something. Thanks in advance.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329882 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329882 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329882">
            <li>
<div class="comment">
    <table class="comment-table" commentid="329889" commentparentid="329882">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/09/2016 17:45 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-329889" href="?#comment-329889" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-329882" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="329889" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-329889">
                    <div class="moveup">
                    <div class="ttypography"><p>You are right, I'm very thankful to you. I was careless while coping the code from polygon.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-329889 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-329889 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-329889">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="332417" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/bhishma" style="position: relative;">
<img src="http://userpic.codeforces.com/305276/avatar/7dd72ae4c71f849a.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="http://st.codeforces.com/s/95195/images/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/bhishma" title="Expert bhishma" class="rated-user user-blue">bhishma</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 10:40 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332417" href="?#comment-332417" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332417" data-commentrating="0" data-commentuserid="305276">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332417">
                    <div class="moveup">
                    <div class="ttypography"><p>In the easy to code <span class="tex-span"><i>O</i>(<i>nlogn</i>)</span> method <code class="tt">vec[v]</code> stores all the vertices in the the subtree rooted at v . How will this fit into memory if we are not deleting the vec of child after merging it with the parent</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332417 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332417 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332417">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332420" commentparentid="332417">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 11:07 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332420" href="?#comment-332420" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332417" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332420" data-commentrating="1" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332420">
                    <div class="moveup">
                    <div class="ttypography"><p>Used memory is always less than or equal to time complexity, so when time complexity is <img align="middle" class="tex-formula" src="/predownloaded/67/0e/670ed5e279d3e4a1f2f6aa6f9791e74d91b527ef.png" style="max-width: 100.0%;max-height: 100.0%;">, used memory is less than or equal to <img align="middle" class="tex-formula" src="/predownloaded/67/0e/670ed5e279d3e4a1f2f6aa6f9791e74d91b527ef.png" style="max-width: 100.0%;max-height: 100.0%;">. In this case, used memory is <img align="middle" class="tex-formula" src="/predownloaded/67/0e/670ed5e279d3e4a1f2f6aa6f9791e74d91b527ef.png" style="max-width: 100.0%;max-height: 100.0%;">. Although if you delete useless <span class="tex-span"><i>vec</i></span>'s the memory become <img align="middle" class="tex-formula" src="/predownloaded/d1/49/d149e37848c7f7e231f2f79fcfe74bfa4ddab02a.png" style="max-width: 100.0%;max-height: 100.0%;">.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332420 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332420 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332420">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332421" commentparentid="332420">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/bhishma" style="position: relative;">
<img src="http://userpic.codeforces.com/305276/avatar/7dd72ae4c71f849a.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="http://st.codeforces.com/s/95195/images/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/bhishma" title="Expert bhishma" class="rated-user user-blue">bhishma</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 11:09 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332421" href="?#comment-332421" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332420" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332421" data-commentrating="0" data-commentuserid="305276">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332421">
                    <div class="moveup">
                    <div class="ttypography"><p>Thanks for the reply . I think this problem can also be solved using your approach. <a href="https://www.hackerearth.com/practice/algorithms/graphs/depth-first-search/practice-problems/algorithm/the-grass-type/">(The Grass Type HackerEarth)</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332421 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332421 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332421">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332422" commentparentid="332421">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 11:13 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332422" href="?#comment-332422" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332421" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="332422" revisioncount="3" revision="3">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">3</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="332422" data-commentrating="1" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332422">
                    <div class="moveup">
                    <div class="ttypography"><p>I'll add this problem to the post if I find it related, I'm thankful anyway.</p><p><strong>Edit</strong> : Note that this is not <strong>my</strong> approach, but I'm the first man who publishes a tutorial about this (not sure), Sack has been used in INOI, IOI and ACM several times, so it isn't a new thing, invented be me.</p><p><strong>Edit</strong> : Added.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332422 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332422 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332422">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332425" commentparentid="332422">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/SaYami" style="position: relative;">
<img src="http://userpic.codeforces.com/370431/avatar/cc959eadd8b2c093.jpg">        </a>
        <div><a href="/profile/SaYami" title="Expert SaYami" class="rated-user user-blue">SaYami</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 11:53 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332425" href="?#comment-332425" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332422" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332425" data-commentrating="0" data-commentuserid="370431">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332425">
                    <div class="moveup">
                    <div class="ttypography"><p>Can you mention probelms from the IOI that are solved with sack ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332425 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332425 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332425">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332426" commentparentid="332425">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/21/2016 11:55 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332426" href="?#comment-332426" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332425" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="332426" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="332426" data-commentrating="6" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332426">
                    <div class="moveup">
                    <div class="ttypography"><p>I'll add one of them tonight.</p><p><strong>Edit</strong> : Added.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332426 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332426 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332426">
            <li>
<div class="comment">
    <table class="comment-table" commentid="332514" commentparentid="332426">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/SaYami" style="position: relative;">
<img src="http://userpic.codeforces.com/370431/avatar/cc959eadd8b2c093.jpg">        </a>
        <div><a href="/profile/SaYami" title="Expert SaYami" class="rated-user user-blue">SaYami</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/22/2016 09:20 UTC">17 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-332514" href="?#comment-332514" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-332426" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="332514" data-commentrating="0" data-commentuserid="370431">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-332514">
                    <div class="moveup">
                    <div class="ttypography"><p>Wow, I didn't think of solving it with sack.Thx</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-332514 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-332514 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-332514">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="333721" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Agassaa" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/Agassaa" title="Pupil Agassaa" class="rated-user user-green">Agassaa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/28/2016 18:34 UTC">16 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-333721" href="?#comment-333721" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="333721" data-commentrating="0" data-commentuserid="355039">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-333721">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi <a class="rated-user user-violet" href="/profile/Arpa" title="Candidate Master Arpa">Arpa</a>, I can not understand, why is this approach called <strong>dsu</strong> on tree? This approach has a nice trick to reduce complexity by saving data about "big child". I can't see any special similarity with general dsu approach. In general dsu problems, we merge 2 subset into 1 set by linked list approach. But, in your tutorial there is no "merge" function. Am I missing something? </p><p>Also I see that, in your 600E's solution <a href="/contest/600/submission/14554536" title="Submission 14554536 by Arpa">14554536</a> you used merge functon. I can't understand, could you please explain that code?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-333721 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-333721 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-333721">
            <li>
<div class="comment">
    <table class="comment-table" commentid="333954" commentparentid="333721">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/29/2016 15:09 UTC">16 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-333954" href="?#comment-333954" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-333721" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="333954" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-333954">
                    <div class="moveup">
                    <div class="ttypography"><p>In fact we are merging information of small children with big child. Think more.</p><p>In that code, <span class="tex-span"><i>mrg</i></span> function merges information in <span class="tex-span"><i>u</i></span> into <span class="tex-span"><i>v</i></span>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-333954 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-333954 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-333954">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="334003" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/beAwesome" style="position: relative;">
<img src="http://userpic.codeforces.com/231693/avatar/c862a42501f3a088.jpg">        </a>
        <div><a href="/profile/beAwesome" title="Specialist beAwesome" class="rated-user user-cyan">beAwesome</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/29/2016 17:27 UTC">16 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-334003" href="?#comment-334003" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="334003" data-commentrating="1" data-commentuserid="231693">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-334003">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi <a class="rated-user user-violet" href="/profile/Arpa" title="Candidate Master Arpa">Arpa</a>! Thanks for making this tutorial.</p><p>I just want to make sure my understanding is correct: this merging smaller maps into larger ones takes logarithmic time because when a vertex is merged, the new map it is in at least twice its size. Hence, merging can only happen <span class="tex-span"><i>log</i>(<i>n</i>)</span> times for each of the <span class="tex-span"><i>n</i></span> vertices, leading to a total runtime of <span class="tex-span"><i>O</i>(<i>nlogn</i>)</span>?</p><p>Thanks!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-334003 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-334003 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-334003">
            <li>
<div class="comment">
    <table class="comment-table" commentid="334005" commentparentid="334003">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/29/2016 17:30 UTC">16 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-334005" href="?#comment-334005" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-334003" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="334005" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-334005">
                    <div class="moveup">
                    <div class="ttypography"><p>Yes, but note that if you use map, it's <img align="middle" class="tex-formula" src="/predownloaded/20/da/20da09178d7e4cd7a5aae9ab05892f920b6eb200.png" style="max-width: 100.0%;max-height: 100.0%;">.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-334005 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-334005 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-334005">
            <li>
<div class="comment">
    <table class="comment-table" commentid="334006" commentparentid="334005">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/beAwesome" style="position: relative;">
<img src="http://userpic.codeforces.com/231693/avatar/c862a42501f3a088.jpg">        </a>
        <div><a href="/profile/beAwesome" title="Specialist beAwesome" class="rated-user user-cyan">beAwesome</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/29/2016 17:34 UTC">16 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-334006" href="?#comment-334006" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-334005" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="334006" data-commentrating="0" data-commentuserid="231693">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-334006">
                    <div class="moveup">
                    <div class="ttypography"><p>If you use unordered_map, does it become <span class="tex-span"><i>O</i>(<i>n</i>·<i>logn</i>)</span>, then?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-334006 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-334006 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-334006">
            <li>
<div class="comment">
    <table class="comment-table" commentid="334020" commentparentid="334006">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Dec/29/2016 19:03 UTC">16 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-334020" href="?#comment-334020" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-334006" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="334020" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-334020">
                    <div class="moveup">
                    <div class="ttypography"><p>Unordered_map is theoretically <span class="tex-span"><i>O</i>(<i>n</i>)</span> per query. But you can suppose that it's O(1) per query in code.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-334020 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-334020 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-334020">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="339408" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/surajghosh" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/surajghosh" title="Pupil surajghosh" class="rated-user user-green">surajghosh</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/24/2017 06:36 UTC">15 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-339408" href="?#comment-339408" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="339408" data-commentrating="0" data-commentuserid="315023">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-339408">
                    <div class="moveup">
                    <div class="ttypography"><p>This <a href="http://codeforces.com/contest/758/problem/E">758E</a>.Read <a href="http://codeforces.com/blog/entry/49880?#comment-338657">this</a> comment on how to use it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-339408 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-339408 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-339408">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="348567" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/HUECTRUM1" style="position: relative;">
<img src="http://userpic.codeforces.com/512204/avatar/1a05429262bfd712.jpg">        </a>
        <div><a href="/profile/HUECTRUM1" title="Expert HUECTRUM1" class="rated-user user-blue">HUECTRUM1</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/13/2017 03:23 UTC">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-348567" href="?#comment-348567" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="348567" data-commentrating="0" data-commentuserid="512204">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-348567">
                    <div class="moveup">
                    <div class="ttypography"><p>Why do we need to iterate through the children of v after <code class="tt">add(v,p,-1)</code>in the naive approach? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-348567 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-348567 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-348567">
            <li>
<div class="comment">
    <table class="comment-table" commentid="348571" commentparentid="348567">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/satyaki3794" style="position: relative;">
<img src="http://userpic.codeforces.com/229270/avatar/b1a19567ff40a815.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="http://st.codeforces.com/s/95195/images/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/satyaki3794" title="International master satyaki3794" class="rated-user user-orange">satyaki3794</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/13/2017 04:54 UTC">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-348571" href="?#comment-348571" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-348567" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="348571" data-commentrating="0" data-commentuserid="229270">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-348571">
                    <div class="moveup">
                    <div class="ttypography"><p>dfs() solves the problem for all the nodes, not just one. So, after you've gotten the answer for v, it will calculate the answer for its children.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-348571 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-348571 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-348571">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="350281" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/vatsalsharma376" style="position: relative;">
<img src="http://userpic.codeforces.com/317733/avatar/501c4de31c9b6916.jpg">        </a>
        <div><a href="/profile/vatsalsharma376" title="Specialist vatsalsharma376" class="rated-user user-cyan">vatsalsharma376</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/22/2017 10:43 UTC">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350281" href="?#comment-350281" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350281" data-commentrating="8" data-commentuserid="317733">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-350281">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="https://www.hackerrank.com/contests/101hack47/challenges/summing-in-a-tree">101 Hack 47 Summing Tree</a> was solved using this technique by <a class="rated-user user-violet" href="/profile/satyaki3794" title="Candidate Master satyaki3794">satyaki3794</a> <a href="https://www.hackerrank.com/contests/101hack47/challenges/summing-in-a-tree/submissions/code/1301038152">Submission</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350281 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350281 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350281">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="350329" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/lukecavabarrett" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/lukecavabarrett" title="Expert lukecavabarrett" class="rated-user user-blue">lukecavabarrett</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/22/2017 17:49 UTC">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350329" href="?#comment-350329" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350329" data-commentrating="3" data-commentuserid="464823">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-350329">
                    <div class="moveup">
                    <div class="ttypography"><p>also <a href="/contest/778/problem/C" title="Codeforces Round 402 (Div. 1)">778C - Peterson Polyglot</a> is solvable with a similar tecnique: is that DSU on tree?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350329 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350329 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350329">
            <li>
<div class="comment">
    <table class="comment-table" commentid="350330" commentparentid="350329">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/radoslav11" style="position: relative;">
<img src="http://userpic.codeforces.com/201686/avatar/f85a8ba632721b32.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="http://st.codeforces.com/s/95195/images/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/radoslav11" title="Master radoslav11" class="rated-user user-orange">radoslav11</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/22/2017 17:51 UTC">14 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-350330" href="?#comment-350330" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-350329" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="350330" data-commentrating="3" data-commentuserid="201686">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-350330">
                    <div class="moveup">
                    <div class="ttypography"><p>yes</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-350330 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-350330 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-350330">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="364138" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/__W__" style="position: relative;">
<img src="http://userpic.codeforces.com/456151/avatar/cb6293da044bef20.jpg">        </a>
        <div><a href="/profile/__W__" title="Master __W__" class="rated-user user-orange">__W__</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/03/2017 14:31 UTC">11 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-364138" href="?#comment-364138" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="364138" data-commentrating="6" data-commentuserid="456151">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-364138">
                    <div class="moveup">
                    <div class="ttypography"><p>Can anyone give me a link to "Shaazzz contest round #4 (season 2016-2017) problem 3" or tell me where can I find it? Thanks.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-364138 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-364138 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-364138">
            <li>
<div class="comment">
    <table class="comment-table" commentid="364139" commentparentid="364138">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/03/2017 14:32 UTC">11 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-364139" href="?#comment-364139" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-364138" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="364139" data-commentrating="5" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-364139">
                    <div class="moveup">
                    <div class="ttypography"><p>It's a Persian contest.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-364139 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-364139 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-364139">
            <li>
<div class="comment">
    <table class="comment-table" commentid="364140" commentparentid="364139">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/__W__" style="position: relative;">
<img src="http://userpic.codeforces.com/456151/avatar/cb6293da044bef20.jpg">        </a>
        <div><a href="/profile/__W__" title="Master __W__" class="rated-user user-orange">__W__</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/03/2017 14:40 UTC">11 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-364140" href="?#comment-364140" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-364139" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="364140" data-commentrating="6" data-commentuserid="456151">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-364140">
                    <div class="moveup">
                    <div class="ttypography"><p>Can you tell me where can I find it? I searched for it just now but didn't get it.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-364140 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-364140 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-364140">
            <li>
<div class="comment">
    <table class="comment-table" commentid="364141" commentparentid="364140">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/03/2017 14:42 UTC">11 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-364141" href="?#comment-364141" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-364140" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="364141" data-commentrating="6" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-364141">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="http://bayanbox.ir/download/1100498381793313195/shaazzz4.7z">Link</a>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-364141 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-364141 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-364141">
            <li>
<div class="comment">
    <table class="comment-table" commentid="364142" commentparentid="364141">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/__W__" style="position: relative;">
<img src="http://userpic.codeforces.com/456151/avatar/cb6293da044bef20.jpg">        </a>
        <div><a href="/profile/__W__" title="Master __W__" class="rated-user user-orange">__W__</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/03/2017 14:44 UTC">11 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-364142" href="?#comment-364142" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-364141" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="364142" data-commentrating="11" data-commentuserid="456151">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+11</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-364142">
                    <div class="moveup">
                    <div class="ttypography"><p>Thank you!</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-364142 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-364142 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-364142">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="366361" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/tak_fate" style="position: relative;">
<img src="http://userpic.codeforces.com/418180/avatar/93038af361d69183.jpg">        </a>
        <div><a href="/profile/tak_fate" title="Specialist tak_fate" class="rated-user user-cyan">tak_fate</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jun/12/2017 18:11 UTC">11 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-366361" href="?#comment-366361" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="366361" data-commentrating="0" data-commentuserid="418180">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-366361">
                    <div class="moveup">
                    <div class="ttypography"><p>I can AC easily Problem 375D by the 3th way ,but WA by the 4th way.... WA on the test 4.. why..</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-366361 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-366361 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-366361">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="370871" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/gabrielsimoes" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/gabrielsimoes" title="Expert gabrielsimoes" class="rated-user user-blue">gabrielsimoes</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jul/01/2017 14:09 UTC">10 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-370871" href="?#comment-370871" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="370871" data-commentrating="0" data-commentuserid="299517">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-370871">
                    <div class="moveup">
                    <div class="ttypography"><p>APIO 2016 Fireworks uses this, but is a much harder problem.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-370871 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-370871 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-370871">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="377346" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/maxorand" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/maxorand" title="Pupil maxorand" class="rated-user user-green">maxorand</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2017 08:29 UTC">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-377346" href="?#comment-377346" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="377346" data-commentrating="0" data-commentuserid="588224">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-377346">
                    <div class="moveup">
                    <div class="ttypography"><p><a class="rated-user user-violet" href="/profile/Arpa" title="Candidate Master Arpa">Arpa</a>, in the <strong>Easy to code but <span class="tex-span"><i>O</i>(<i>nlog</i><sup class="upper-index">2</sup><i>n</i>)</span></strong> section code you have written a commented line that is : <code class="tt">//now (*cnt)[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</code>. But I think it would be <code class="tt">//now (*cnt[v])[c] is the number of vertices in subtree of vertex v that has color c. You can answer the queries easily.</code>. Will <code class="tt">(*cnt)[c]</code> changed with <code class="tt">(*cnt[v])[c]</code> ?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-377346 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-377346 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-377346">
            <li>
<div class="comment">
    <table class="comment-table" commentid="377351" commentparentid="377346">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/06/2017 09:59 UTC">9 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-377351" href="?#comment-377351" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-377346" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="377351" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-377351">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi. Thanks. Edited.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-377351 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-377351 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-377351">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="382293" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Trath" style="position: relative;">
<img src="http://userpic.codeforces.com/471966/avatar/d6806c6ddd9f10ab.jpg">        </a>
        <div><a href="/profile/Trath" title="Specialist Trath" class="rated-user user-cyan">Trath</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Aug/30/2017 02:10 UTC">8 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-382293" href="?#comment-382293" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="382293" data-commentrating="0" data-commentuserid="471966">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-382293">
                    <div class="moveup">
                    <div class="ttypography"><p>You can solve <a href="https://dmoj.ca/problem/apio12p1">APIO 2012 Dispatching</a> with this technique too.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-382293 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-382293 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-382293">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="392942" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/mochow" style="position: relative;">
<img src="http://userpic.codeforces.com/93201/avatar/237d4abc7842e53f.jpg">        </a>
        <div><a href="/profile/mochow" title="Specialist mochow" class="rated-user user-cyan">mochow</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Oct/30/2017 16:28 UTC">6 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-392942" href="?#comment-392942" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="392942" data-commentrating="0" data-commentuserid="93201">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-392942">
                    <div class="moveup">
                    <div class="ttypography"><p>IOI 2011 — Race What is the idea of DSU on tree for this problem? I know of a solution based on Centroid Decomposition.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-392942 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-392942 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-392942">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="408987" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/CyberSword" style="position: relative;">
<img src="http://userpic.codeforces.com/595640/avatar/27c9e8a70ad7eb9d.jpg">        </a>
        <div><a href="/profile/CyberSword" title="Candidate Master CyberSword" class="rated-user user-violet">CyberSword</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Jan/21/2018 08:48 UTC">4 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-408987" href="?#comment-408987" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="408987" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="408987" data-commentrating="8" data-commentuserid="595640">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-408987">
                    <div class="moveup">
                    <div class="ttypography"><p><a href="/contest/914/problem/E">914E - Palindromes in a Tree</a> can solve with sack too, Arpa :) </p><p>ps: for this problem centroid decompose works too... :)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-408987 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-408987 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-408987">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="414426" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/pk845" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/pk845" title="Expert pk845" class="rated-user user-blue">pk845</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/15/2018 17:52 UTC">3 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-414426" href="?#comment-414426" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="414426" data-commentrating="0" data-commentuserid="622451">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-414426">
                    <div class="moveup">
                    <div class="ttypography"><p>can anyone please explain how to solve 716E using this technique?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-414426 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-414426 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-414426">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="416220" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/shahidul_brur" style="position: relative;">
<img src="http://userpic.codeforces.com/334688/avatar/86dfeb391bb85038.jpg">        </a>
        <div><a href="/profile/shahidul_brur" title="Expert shahidul_brur" class="rated-user user-blue">shahidul_brur</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/22/2018 07:35 UTC">2 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-416220" href="?#comment-416220" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="416220" data-commentrating="5" data-commentuserid="334688">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-416220">
                    <div class="moveup">
                    <div class="ttypography"><p>In the contest 600, no one can view other's submissions except his own.</p><p>That's why no can see your submissions for <a href="/contest/600/problem/E" title="Educational Codeforces Round 2">600E - Lomsat gelral</a> except you.</p><p>So, please give alternating link of your solutions for the first problem in the list, <a href="/contest/600/problem/E" title="Educational Codeforces Round 2">600E - Lomsat gelral</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-416220 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-416220 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-416220">
            <li>
<div class="comment">
    <table class="comment-table" commentid="416234" commentparentid="416220">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Arpa" style="position: relative;">
<img src="http://userpic.codeforces.com/124237/avatar/608989d694c02e01.jpg">        </a>
        <div><a href="/profile/Arpa" title="Master Arpa" class="rated-user user-orange">Arpa</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/22/2018 10:27 UTC">2 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-416234" href="?#comment-416234" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-416220" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="416234" data-commentrating="0" data-commentuserid="124237">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-416234">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi.</p><p>Thanks for your feedback. Here it is: <a href="https://gist.github.com/ar-pa/efc71c4ea8ede3e56eeea40f9465496e">Link</a>.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-416234 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-416234 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-416234">
            <li>
<div class="comment">
    <table class="comment-table" commentid="416235" commentparentid="416234">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/shahidul_brur" style="position: relative;">
<img src="http://userpic.codeforces.com/334688/avatar/86dfeb391bb85038.jpg">        </a>
        <div><a href="/profile/shahidul_brur" title="Expert shahidul_brur" class="rated-user user-blue">shahidul_brur</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Feb/22/2018 10:30 UTC">2 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-416235" href="?#comment-416235" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-416234" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="416235" data-commentrating="0" data-commentuserid="334688">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-416235">
                    <div class="moveup">
                    <div class="ttypography"><p>Thank you !</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-416235 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-416235 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-416235">
    </ul>
</div>
</li>
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="417852" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Vicennial" style="position: relative;">
<img src="http://userpic.codeforces.com/447187/avatar/1710742b12e148ec.jpg"><img title="Badge of honor for supporting Codeforces on its 8th anniversary" src="http://st.codeforces.com/s/95195/images/if_medal-bronze-red_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/Vicennial" title="Candidate Master Vicennial" class="rated-user user-violet">Vicennial</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/02/2018 14:21 UTC">2 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-417852" href="?#comment-417852" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="417852" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="417852" data-commentrating="0" data-commentuserid="447187">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-417852">
                    <div class="moveup">
                    <div class="ttypography"><p>Another problem which can be solved by this technique: <a href="https://www.hackerrank.com/challenges/coloring-tree/problem">Coloring Tree</a><br>Its easier than <a href="/contest/600/problem/E" title="Educational Codeforces Round 2">600E - Lomsat gelral</a>. </p><p>One more : <a href="/contest/932/problem/F">932F - Escape Through Leaf</a></p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-417852 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-417852 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-417852">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="419614" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/lzoi_hhn" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/lzoi_hhn" title="Unrated, lzoi_hhn" class="rated-user user-black">lzoi_hhn</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/10/2018 14:52 UTC">2 months ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-419614" href="?#comment-419614" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="419614" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="419614" data-commentrating="0" data-commentuserid="692530">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-419614">
                    <div class="moveup">
                    <div class="ttypography"><p>Hi, I would like to ask you about the code in heavy-light decomposition style.Why the bigChild is cleared before clearing the subtree at the end of the code? From my perspective, in add function bigChild will be visited and the array “big” doesn’t make sense.Can you explain it in detail? Thanks a lot.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-419614 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-419614 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-419614">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="420968" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/kirito_" style="position: relative;">
<img src="http://userpic.codeforces.com/no-avatar.jpg">        </a>
        <div><a href="/profile/kirito_" title="Specialist kirito_" class="rated-user user-cyan">kirito_</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/19/2018 11:43 UTC">7 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-420968" href="?#comment-420968" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="420968" data-commentrating="-7" data-commentuserid="347821">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-7</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-420968">
                    <div class="moveup">
                    <div class="ttypography"><p>No good explanation! Only code! Worst tutorial.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-420968 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-420968 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-420968">
            <li>
<div class="comment">
    <table class="comment-table" commentid="421076" commentparentid="420968">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/satvik007" style="position: relative;">
<img src="http://userpic.codeforces.com/492227/avatar/591b81d0dddf7de1.jpg">        </a>
        <div><a href="/profile/satvik007" title="Expert satvik007" class="rated-user user-blue">satvik007</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/20/2018 09:57 UTC">7 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-421076" href="?#comment-421076" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-420968" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="421076" data-commentrating="0" data-commentuserid="492227">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-421076">
                    <div class="moveup">
                    <div class="ttypography"><p>If you have a doubt why not ask in the comments rather than whining about how bad the tutorial is.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-421076 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-421076 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-421076">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="421136" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/M_H_H_7" style="position: relative;">
<img src="http://userpic.codeforces.com/572976/avatar/c33b864791fb826a.jpg">        </a>
        <div><a href="/profile/M_H_H_7" title="Specialist M_H_H_7" class="rated-user user-cyan">M_H_H_7</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Mar/20/2018 21:48 UTC">7 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-421136" href="?#comment-421136" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="421136" data-commentrating="5" data-commentuserid="572976">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-421136">
                    <div class="moveup">
                    <div class="ttypography"><p>Nice tutorial!</p><p>and also happy <a href="https://en.wikipedia.org/wiki/Nowruz">Nowruz</a>:)</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-421136 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-421136 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-421136">
            <li>
<div class="comment">
    <table class="comment-table" commentid="426077" commentparentid="421136">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Ehsan_sShuvo" style="position: relative;">
<img src="http://userpic.codeforces.com/323480/avatar/cad925cef2bc8465.jpg">        </a>
        <div><a href="/profile/Ehsan_sShuvo" title="Pupil Ehsan_sShuvo" class="rated-user user-green">Ehsan_sShuvo</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/20/2018 17:47 UTC">3 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-426077" href="?#comment-426077" style="font-size:1.2em;">#</a></span>
                        <span class="item"><a title="Parent comment" href="#comment-421136" style="font-size:1.2em;">^</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        <span style="" commentid="426077" revisioncount="2" revision="2">
                            <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                            Rev. <span class="revision">2</span>
                            <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                        </span>
                        &nbsp;

<span commentid="426077" data-commentrating="0" data-commentuserid="323480">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-426077">
                    <div class="moveup">
                    <div class="ttypography"><p>Could you please explain 2no. style ? [Upd : Got it ]</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-426077 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-426077 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-426077">
    </ul>
</div>
</li>
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="426090" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Ehsan_sShuvo" style="position: relative;">
<img src="http://userpic.codeforces.com/323480/avatar/cad925cef2bc8465.jpg">        </a>
        <div><a href="/profile/Ehsan_sShuvo" title="Pupil Ehsan_sShuvo" class="rated-user user-green">Ehsan_sShuvo</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="Apr/20/2018 18:39 UTC">3 weeks ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-426090" href="?#comment-426090" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="426090" data-commentrating="0" data-commentuserid="323480">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-426090">
                    <div class="moveup">
                    <div class="ttypography"><p>If i do my code using 2nd approach , shouldn't my problem be static ? And for query operation , we will do offline query , won't that ? </p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-426090 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-426090 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-426090">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="429261" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/Azurey" style="position: relative;">
<img src="http://userpic.codeforces.com/469008/avatar/dbe37b4eaba7d7.jpg">        </a>
        <div><a href="/profile/Azurey" title="Candidate Master Azurey" class="rated-user user-violet">Azurey</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/08/2018 12:38 UTC">5 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-429261" href="?#comment-429261" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="429261" data-commentrating="0" data-commentuserid="469008">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-429261">
                    <div class="moveup">
                    <div class="ttypography"><p>For those who still confused about the time complexity, I found <a href="http://codeforces.com/blog/entry/57955?#comment-416293">this</a> explanation by <a class="rated-user user-orange" href="/profile/radoslav11" title="Master radoslav11">radoslav11</a> helps a lot.</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-429261 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-429261 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-429261">
    </ul>
</div>

<div class="comment">
    <table class="comment-table" commentid="429271" commentparentid="-1">
        <tbody><tr>
            <td class="left">
                <div style="position: absolute; left: 0;" class="comment-indent-holder">
                        <div class="comment-no-indent">
                            <span>»</span>
                        </div>
                </div>
    <div class="avatar">
        <a href="/profile/a.kleber.d" style="position: relative;">
<img src="http://userpic.codeforces.com/585437/avatar/791543c1ff94d1f3.jpg">        </a>
        <div><a href="/profile/a.kleber.d" title="Pupil a.kleber.d" class="rated-user user-green">a.kleber.d</a></div>
    </div>
            </td>
            <td class="right">
                <div class="info">
                    
                    <span class="item"><span class="format-humantime" title="May/08/2018 14:27 UTC">3 hours ago</span>,</span>
                    <span class="item"><a title="Link to comment" name="comment-429271" href="?#comment-429271" style="font-size:1.2em;">#</a></span>
                    <span class="item">|</span>
                    <span style="position: relative; top: 2px;">
</span>
                    <div style="position:absolute;right:0;top:0;">
                        &nbsp;

<span commentid="429271" data-commentrating="0" data-commentuserid="585437">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>                    </div>
                </div>
                <div class="comment-content comment-content-429271">
                    <div class="moveup">
                    <div class="ttypography"><p>What is col[v]?</p></div>
                    </div>
                </div>
                <div class="reply info">
                    <a class="comment-429271 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                    <a class="comment-429271 en false" href="#">Reply</a>
                </div>
            </td>
        </tr>
    </tbody></table>
    <ul class="comment-children comment-429271">
    </ul>
</div>
    <br>

<div id="editBox-44528" style="width:50em;display:none;">
    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
    <div style="width: 1px">&nbsp;</div>
    <div class="commentLocale" style="position: relative; top: 0.5em;left:4px;display: none;">
        <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
        <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
    </div>
    <textarea data-drafts-id="CommentReplyFrame" class="wysiwyg" name="editContent" rows="20" style="width:99%;"></textarea>
    <div class="error error__content"></div>
    <div style="text-align:center;">
        <input type="button" name="preview" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Preview">
        <input type="button" name="save" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Save">
    </div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {

var firstPreview44528 = true;
var lastPreviewContent44528 = '';

if (!window.moveCommentRevision) {
    moveCommentRevision = function(e, dir) {
        var p = e.parent();
        var revisionCount = parseInt(p.attr("revisionCount"));
        var revision = parseInt(p.attr("revision"));
        var next = revision + dir;
        var commentId = p.attr("commentId");
        if (next >= 1 && next <= revisionCount) {
            $.post(
                "/data/comment-data",
                {action: "revision", commentId: commentId, revision: next},
                function(json) {
                    if (json.success == "true") {
                        var parentDiv = e;

                        while (parentDiv !== null && (parentDiv[0].nodeName.toLowerCase() !== "td" || !parentDiv.hasClass("right"))) {
                            parentDiv = parentDiv.parent();
                        }

                        if (parentDiv === null) {
                            return;
                        }

                        parentDiv.find("div.comment-content-" + commentId + " .moveup").html(json.content);
                        Codeforces.setupSpoilers(parentDiv.find("div.comment-content-" + commentId + " .moveup"));
                        p.attr("revision", next);
                        p.find("span.revision").text(next);
                        if (next == 1) {
                            p.find("a.leftRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.leftRevision").css("visibility", "visible");
                        }
                        if (next == revisionCount) {
                            p.find("a.rightRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.rightRevision").css("visibility", "visible");
                        }

                        window.updateTypography();
                    } else {
                        alert(e.error);
                    }
                },
                "json"
            );
        }
    };
}

$("div[commentableId=44528] a.leftRevision").click(function () {
    window.moveCommentRevision($(this), -1);
    return false;
});

$("div[commentableId=44528] a.rightRevision").click(function () {
    window.moveCommentRevision($(this), +1);
    return false;
});



        });
    </script>


        <script src="http://st.codeforces.com/s/95195/js/swfobject-2.2.min.js" type="text/javascript"></script>
        <script src="http://st.codeforces.com/s/95195/js/ftaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                if (window.evercookie) {
                    var ec = new evercookie({
                        history: false,
                        silverlight: false,
                        baseurl: '',
                        asseturi: '/assets',
                        phpuri: '/2fdcd78',
                        pngPath: '/eps',
                        etagPath: '/ees',
                        cachePath: '/ecs'
                    });

                    var randomNumber = function () {
                        return Math.random().toString(36).substr(2);
                    };

                    var randomToken = function () {
                        return (randomNumber() + randomNumber()).substring(0, 18);
                    };

                    window._ftaa = "";

                    ec.get("70a7c28f3de", function (value) {
                        window._ftaa = value;
                        if (!window._ftaa) {
                            window._ftaa = randomToken();
                            ec.set("70a7c28f3de", window._ftaa);
                        }
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                } else {
                    window._ftaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

        <script src="http://st.codeforces.com/s/95195/js/bfaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                if (window.Fingerprint2) {
                    var options = {swfPath: undefined};
                    window._bfaa = "";

                    new Fingerprint2(options).get(function(result){
                        window._bfaa = result;
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                } else {
                    window._bfaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

    <script type="text/javascript">
        $(document).ready(function () {
    $("a.new-root-comment").click(function () {
            window.location = "/enter";
        return false;
    });

    $(".comment-table .reply a").click(function () {
            window.location = "/enter";
        return false;
    });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".vote-for-comment").mouseover(function () {
        var vote = $(this);
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (direction == 1 && !ownComment) {
            vote.find("img").attr("src", "http://st.codeforces.com/s/95195/images/actions/comment-voteup.png");
            vote.find("img").attr("popacity", vote.find("img").css("opacity"));
            vote.find("img").css("opacity", "1.0");
        }
        if (direction == -1 && !ownComment) {
            vote.find("img").attr("src", "http://st.codeforces.com/s/95195/images/actions/comment-votedown.png");
            vote.find("img").attr("popacity", vote.find("img").css("opacity"));
            vote.find("img").css("opacity", "1.0");
        }
    });

    $(".vote-for-comment").mouseout(function () {
        var vote = $(this);
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (direction == 1 && !ownComment) {
            vote.find("img").attr("src", "http://st.codeforces.com/s/95195/images/actions/comment-voteup-blue.png");
            vote.find("img").css("opacity", vote.find("img").attr("popacity"));
        }
        if (direction == -1 && !ownComment) {
            vote.find("img").attr("src", "http://st.codeforces.com/s/95195/images/actions/comment-votedown-blue.png");
            vote.find("img").css("opacity", vote.find("img").attr("popacity"));
        }
    });

    $(".vote-for-comment").click(function () {
        var vote = $(this);
        var commentId = $(this).parent().attr("commentid");
        var commentRating = $(this).parent().attr("data-commentRating");
        var direction = $(this).attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        $.post("/data/comment/vote", {commentId: commentId, _tta: Codeforces.tta(), vote: direction, commentRating: commentRating}, function(data) {
            if (direction != 0 && !ownComment && data["success"] == "true") {
                vote.parent().find(".vote-for-comment").attr("voteDirection", 0);
                if (direction == 1)
                    vote.find("img").attr("src", "http://st.codeforces.com/s/95195/images/actions/comment-voteup.png");
                else
                    vote.find("img").attr("src", "http://st.codeforces.com/s/95195/images/actions/comment-votedown.png");
                vote.find("img").attr("popacity", "1.0");
                vote.find("img").css("opacity", "1.0");
                vote.parent().find(".commentRating").html(data["commentRating"]);
            }
            Codeforces.showMessage(data["message"]);
        }, "json");
        return false;
    });

    $(".negative-comment-vote").closest(".comment-table").addClass("comment-bad");

    $(".troll-comment-vote").closest(".comment").css("display", "none");

    $(".too-negative-comment-vote").closest(".comment-table").each(function () {
        var e = $(this);
        e.addClass("comment-too-bad");
        var commentId = e.attr("commentId");
        $("<div class='bad-comment-replacement ttypography'>The comment is hidden because of too negative feedback, click <a href=# class=show-bad-comment-link>here</a> to view it</div>").appendTo(
            e.find(".right")
        );
        e.find(".comment-content").hide();
        e.find(".show-bad-comment-link").click(function () {
            e.find(".comment-content").show();
            e.find(".bad-comment-replacement").hide();
            return false;
        });
    });
        });
    </script>
</div>

<style type="text/css">
    .new-comments-box {
        padding: 0.5em;
        width: 22px;
        font-size: 1.3rem;
        font-weight: bold !important;

        position: fixed;
        top: 40%;
        right: 0;
        opacity: 0.2;
        color: white;
        text-align: center;

        border: 1px solid #222;
        background-color: #888 !important;
        border-radius: 3px;
        -moz-border-radius: 3px;
        -webkit-border-radius: 3px;
    }

    .new-comments-box:hover {
        opacity: 1;
    }

    .new-comments-box .dir:hover {
        background: #3B5998 !important;
        cursor: pointer;
    }
</style>

<div class="new-comments-box" data-position="outside" data-index="-1" style="display: none;">
    <div class="up dir" title="Ctrl+Up">↑<hr></div>
    <div class="info" title="New comments"></div>
    <div class="down dir" title="Ctrl+Down"><hr>↓</div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {
    function gotoComment(direction) {
        var box = $(".new-comments-box");
        var index = parseInt(box.attr("data-index"));
        if (index == -1)
            index = 0;
        else
            index = Math.max(0, Math.min(parseInt(box.find(".info").text()) - 1, index + direction));
        box.attr("data-index", index);
        var comment = $($(".comment .highlight-blue[commentId]").get(index));
        $('html, body').animate({
          'scrollTop': Math.max(0, comment.offset().top - ($(window).height() - comment.height()) / 2)
        });
        return false;
    }

    $(".new-comments-box .down").click(function () {
        return gotoComment(1);
    });

    $(".new-comments-box .up").click(function () {
        return gotoComment(-1);
    });

    $(document).keydown(function (e) {
         var code = (e.keyCode ? e.keyCode : e.which);
         if (e.ctrlKey) {
            if (code == 38 || code == 40) {
                gotoComment(code - 39);
            }
         }
    });

    var newCommentCount = $(".comment .highlight-blue[commentId]").length;
    if (newCommentCount > 0) {
        $(".new-comments-box .info").text(newCommentCount);
        $(".new-comments-box").show();
    }

    $('table.comment-table').mouseenter(function () {
        var comment = $(this);
        var cnt = 0;
        while (true) {
            var id = comment.attr("commentId");
            var parentId = comment.attr("commentParentId");
            comment.find(".comment-indent-holder:first .comment-no-indent").addClass("comment-indent");
            if (parentId == -1) {
                break;
            }
            comment = $("table.comment-table[commentId=" + parentId + "]");
        }
        return false;
    });

    $('table.comment-table').mouseleave(function () {
        var comment = $(this);
        var cnt = 0;
        while (true) {
            var id = comment.attr("commentId");
            var parentId = comment.attr("commentParentId");
            comment.find(".comment-indent-holder:first .comment-no-indent").removeClass("comment-indent");
            if (parentId == -1) {
                break;
            }
            comment = $("table.comment-table[commentId=" + parentId + "]");
        }
        return false;
    });
        });
    </script>


    <script type="text/javascript">
        $(document).ready(function () {
    $(".topic-vote-up-44511").click(function () {
        $.post("/data/topic/vote", {topicId: 44511, _tta: Codeforces.tta(), topicRevisionId: 123980, vote: +1}, function(data) {
            Codeforces.showMessage(data);
        }, "json");
        return false;
    });
    $(".topic-vote-down-44511").click(function () {
        $.post("/data/topic/vote", {topicId: 44511, _tta: Codeforces.tta(), topicRevisionId: 123980, vote: -1}, function(data) {
            Codeforces.showMessage(data);
        }, "json");
        return false;
    });
        });
    </script>
</div>
        </div>
    </div>
                </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2018 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: May/08/2018 17:27:20<sup title="timezone offset" style="font-size:8px;">UTC</sup> (d1).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="?mobile=true">mobile version</a>.</div>
                <div class="smaller"><a href="/privacy">Privacy Policy</a></div>

            </div>
        <script type="text/javascript">
            $(function() {
                $(".switchToMobile").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "true"));
                    return false;
                });
                $(".switchToDesktop").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "false"));
                    return false;
                });
            });
        </script>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }
            Codeforces.focusOnError();
        });
    </script>

        <div class="userListsFacebox" style="display:none;">
            <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt">&nbsp;</div>
            <div class="rt">&nbsp;</div>
            <div class="lb">&nbsp;</div>
            <div class="rb">&nbsp;</div>

            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists

                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>

                    <img class="closed" src="http://st.codeforces.com/s/95195/images/icons/control.png">

                    <span class="filter" style="display:none;">
                        <img class="opened" src="http://st.codeforces.com/s/95195/images/icons/control-270.png">
                        <input style="padding:0;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;">
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt">&nbsp;</div>
            <div class="irt">&nbsp;</div>
            <table class="">
                    <thead>
                    <tr>
                        <th class="top left right">Name</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr class="no-items visible"><td style="text-align:left;" colspan="32" class="bottom dark left right">No items</td></tr></tbody>
            </table>
            </div>
        </div>
    <script type="text/javascript">
        $(document).ready(function () {
                // Create new ':containsIgnoreCase' selector for search
                jQuery.expr[':'].containsIgnoreCase = function(a, i, m) {
                    return jQuery(a).text().toUpperCase()
                            .indexOf(m[3].toUpperCase()) >= 0;
                };

                if (window.updateDatatableFilter == undefined) {
                    window.updateDatatableFilter = function(i) {
                        var parent = $(i).parent().parent().parent().parent();
                        $("tr.no-items", parent).remove();
                        $("tr", parent).hide().removeClass('visible');
                        var text = $(i).val();
                        if (text) {
                            $("tr" + ":containsIgnoreCase('" + text + "')", parent).show().addClass('visible');
                        } else {
                            parent.find(".rowCount").text("");
                            $("tr", parent).show().addClass('visible');
                        }

                        var found = false;
                        var visibleRowCount = 0;
                        $("tr", parent).each(function () {
                            if (!found) {
                                if ($(this).find("th").size() > 0) {
                                    $(this).show().addClass('visible');
                                    found = true;
                                }
                            }
                            if ($(this).hasClass('visible')) {
                                visibleRowCount++;
                            }
                        });
                        if (text) {
                            parent.find(".rowCount").text("Matches: " + (visibleRowCount - (found ? 1 : 0)));
                        }
                        if (visibleRowCount == (found ? 1 : 0)) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo($(parent).find('table'));
                        }
                        $(parent).find("tr td").removeClass("dark");
                        $(parent).find("tr.visible:odd td").addClass("dark");
                    }

                    $(".datatable .closed").click(function () {
                        var parent = $(this).parent();
                        $(this).hide();
                        $(".filter", parent).fadeIn(function () {
                            $("input", parent).val("").focus().css("border", "1px solid #aaa");
                        });
                    });

                    $(".datatable .opened").click(function () {
                        var parent = $(this).parent().parent();
                        $(".filter", parent).fadeOut(function () {
                            $(".closed", parent).show();
                            $("input", parent).val("").each(function () {
                                window.updateDatatableFilter(this);
                            });
                        });
                    });

                    $(".datatable .filter input").keyup(function(e) {
                        window.updateDatatableFilter(this);
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    $(".datatable table").each(function () {
                        var found = false;
                        $("tr", this).each(function () {
                            if (!found && $(this).find("th").size() == 0) {
                                found = true;
                            }
                        });
                        if (!found) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo(this);
                        }
                    });

                    // Applies styles to datatables.
                    $(".datatable").each(function () {
                        $(this).find("tr:first th").addClass("top");
                        $(this).find("tr:last td").addClass("bottom");
                        $(this).find("tr:odd td").addClass("dark");
                        $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                        $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                    });

                    $(".datatable table.tablesorter").each(function () {
                        $(this).bind("sortEnd", function () {
                            $(".datatable").each(function () {
                                $(this).find("th, td")
                                    .removeClass("top").removeClass("bottom")
                                    .removeClass("left").removeClass("right")
                                    .removeClass("dark");
                                $(this).find("tr:first th").addClass("top");
                                $(this).find("tr:last td").addClass("bottom");
                                $(this).find("tr:odd td").addClass("dark");
                                $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                                $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                            });
                        });
                    });
                }
        });
    </script>
            </div>
        </div>
        <script type="application/javascript">
            $(function() {
                $(".userListMarker").click(function() {
                    $.post("/data/lists", {action: "findTouched"}, function(json) {
                        Codeforces.facebox(".userListsFacebox");
                        var tbody = $("#facebox tbody");
                        tbody.empty();
                        for (var i in json) {
                            tbody.append(
                                    $("<tr></tr>").append(
                                            $("<td></td>").attr("data-readKey", json[i].readKey).text(json[i].name)
                                    )
                            );
                        }
                        Codeforces.updateDatatables();
                        tbody.find("td").css("cursor", "pointer").click(function() {
                            document.location = Codeforces.updateUrlParameter(document.location.href, "list", $(this).attr("data-readKey"));
                        });
                    }, "json");
                });
            });
        </script>


</div><div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div id="swfcontainer" style="visibility: visible;"></div><div id="userdata_el" style="visibility: hidden; position: absolute;"></div></body></html>