<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - The Fox and the Wolf</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "3b3becad3952029946138f43401e9563";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Ffoxw"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<style type="text/css">
    #descContent span.nobr {
        white-space: nowrap;
    }
    
    #input-table {
        text-align: justify;
    }

    #input-table > tbody > tr > td:first-child {
        vertical-align: top;
        width: 120px;
        text-align: left;
    }
</style>

<h2 align="center">The Fox and the Wolf</h2>

<p>In a certain peaceful forest, there live a fox and a wolf. Due to common misconception, one might suppose that the wolf would want to hunt the fox - however, both are in fact nice animals, and get along just fine. Indeed, they have such nice manners that if they ever meet up, they will have a nice little chat for <var>C</var> minutes (1 ≤ <var>C</var> ≤ 9).</p>

<p>The forest that the fox and the wolf live in is a rectangle, <var>N</var> km long along its east side and <var>M</var> km wide along its north side (1 ≤ <var>N</var>, <var>M</var> ≤ 20). It is divided into a grid of squares, each with a side length of 1 km. Each such square either contains a meadow (marked by a '<code>.</code>'), is full of burrs ('<code>B</code>'), is blocked by trees ('<code>T</code>'), contains the fox's den ('<code>F</code>'), contains the wolf's lair ('<code>W</code>'), currently contains the fox ('<code>f</code>'), or currently contains the wolf ('<code>w</code>').</p>

<p>At the end of a long day at work (consisting of solving complex computer science problems in their heads), both animals wish to get to their respective homes as soon as possible. Every minute, each of them can walk one km directly north, east, south, or west, or just stay put - however, they cannot enter squares blocked by trees, nor can they enter each other's homes (that wouldn't be very polite). They also don't want to leave the forest, seeing as humans jealous of their supreme intellect are constantly lurking just outside.</p>

<p>Every time the fox or the wolf goes from a square full of burrs to a meadow, he must spend <var>B</var> minutes (1 ≤ <var>B</var> ≤ 9) picking burrs off of himself. As mentioned above, they must also stop and chat every time they meet up. Though each square is quite big, the animals always walk to its exact centre before moving on. This means that they will meet up if they either occupy the same square at the same time, or if they pass each other while walking between squares (which would happen if they switched positions in the space of a minute). Once the animals have chatted once, they never have to chat again, having already satisfied the demands of etiquette. Both animals are great multitaskers, and can pick burrs while chatting to each other.</p>

<p>Each animal wants to get home as soon as possible, but is also considerate of the other - as such, they will collaborate so as to minimize the time for both of them to get home. Due to their extreme intelligence, both animals will calculate this minimium time in their heads instantly - however you, the observer, will probably need to write a program to figure it out…</p>


<h3>Input</h3>

<table id="input-table">
<tbody><tr>
    <td>Line 1:</td>
    <td>Four integers — <var>N</var>, <var>M</var>, <var>C</var>, and <var>B</var></td>
</tr>
<tr>
    <td>The next <var>N</var> lines:</td>
    <td><var>M</var> characters, representing a row of the forest as described above</td>
</tr>
</tbody></table>

<h3>Output</h3>

<p>A single number - the minimum time for both the fox and the wolf to get to their respective homes, in minutes. If it's impossible, output <code>-1</code>.</p>

<h3>Sample Input</h3>
<pre>5 6 5 1
......
BWTTTB
B.TB..
BBT..T
.FTfw.</pre>

<h3>Sample Output</h3>
<pre>17</pre>

<h3>Explanation</h3>
<p>The wolf should wait for the first three minutes, letting the fox go first. From then on, the fox can continue along its only possible route home. The wolf will be 2 squares behind the fox most of the time, except for when it enters the burr-filled square, when it will temporarily be 1 behind. With this strategy, the wolf will take 14 minutes to get home, while the fox will take 17, and since we only care about the larger, the total time is 17 minutes.</p>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,foxw">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/foxw">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 30 (partial)<br>
    <b>Time Limit:</b> 2.00s<br>
    <b>Memory Limit:</b> 256M<br>
    <b>Added:</b> Mar 11, 2009<br>
        <b>Author:</b> <a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a>  </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=foxw">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment2470">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/2470">Sep 01, 2009 - 5:31:45 pm UTC</a>      </span>
      <a class="comment_title" id="title2470" onclick="toggle(&quot;body2470&quot;)">Testcase 14 Fixed</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating2470">
    (<span class="upvotes"><span id="upvotes2470">1</span></span>/<span class="downvotes"><span id="downvotes2470">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body2470" class="comment_body">
    <pre id="msg2470" style="display: none">Testcase 14 had an error - the value of N was 20, but there were only 19 rows in the grid. This has been fixed.

Sorry to Foundation for lots of time wasted trying to debug his correct program.</pre>
    <div style="opacity: 1">
      Testcase 14 had an error - the value of N was 20, but there were only 19 rows in the grid. This has been fixed. <br> <br>Sorry to Foundation for lots of time wasted trying to debug his correct program.    </div>
    <br><div class="comment_block" id="comment2472">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/Foundation">Foundation</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/2472">Sep 01, 2009 - 8:33:41 pm UTC</a>      </span>
      <a class="comment_title" id="title2472" onclick="toggle(&quot;body2472&quot;)">Re: Testcase 14 Fixed</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating2472">
    (<span class="upvotes"><span id="upvotes2472">0</span></span>/<span class="downvotes"><span id="downvotes2472">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body2472" class="comment_body">
    <pre id="msg2472" style="display: none">No problem. Glad it's fixed. :)</pre>
    <div style="opacity: 1">
      No problem. Glad it's fixed. :)    </div>
      </div>
</div>
  </div>
</div>
<br>
<div class="comment_block" id="comment2125">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/SourSpinach">SourSpinach</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/2125">Apr 20, 2009 - 1:55:38 am UTC</a>      </span>
      <a class="comment_title" id="title2125" onclick="toggle(&quot;body2125&quot;)">Hint</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating2125">
    (<span class="upvotes"><span id="upvotes2125">1</span></span>/<span class="downvotes"><span id="downvotes2125">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body2125" class="comment_body">
    <pre id="msg2125" style="display: none">This problem is similar to the classic Maze-type problem, solvable with BFS. The only difference is that there's a lot more to store here than just your location and number of moves.</pre>
    <div style="opacity: 1">
      This problem is similar to the classic Maze-type problem, solvable with BFS. The only difference is that there's a lot more to store here than just your location and number of moves.    </div>
      </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0247s.<br>
    Server time on page load:
    May 5, 2018 17:07:35 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Ffoxw">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>