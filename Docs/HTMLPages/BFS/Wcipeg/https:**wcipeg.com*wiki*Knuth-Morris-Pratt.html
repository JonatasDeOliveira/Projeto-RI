<!DOCTYPE html><html lang="en" dir="ltr" class="client-js"><head>
<meta charset="UTF-8">
<title>Knuth–Morris–Pratt algorithm - PEGWiki</title>
<meta name="generator" content="MediaWiki 1.25.2">
<link rel="alternate" type="application/x-wiki" title="Edit" href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit">
<link rel="edit" title="Edit" href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/opensearch_desc.php" title="PEGWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wcipeg.com/wiki/api.php?action=rsd">
<link rel="alternate" hreflang="x-default" href="/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm">
<link rel="copyright" href="http://creativecommons.org/licenses/by/3.0/">
<link rel="alternate" type="application/atom+xml" title="PEGWiki Atom feed" href="/wiki/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="canonical" href="/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm">
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=ext.math.styles%7Cext.rtlcite%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*">
<style>
.cite-accessibility-label{position:absolute !important; top:-99999px;clip:rect(1px 1px 1px 1px); clip:rect(1px,1px,1px,1px);padding:0 !important;border:0 !important;height:1px !important;width:1px !important;overflow:hidden}.mw-cite-backlink,.cite-accessibility-label{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none} ol.references li:target,sup.reference:target{background-color:#def; background-color:rgba(0,127,255,0.133)}@media print{.mw-cite-backlink{display:none}}
/* cache key: wikidb:resourceloader:filter:minify-css:7:2970940d33044e6aa6a620ce3c93c662 */
.mw-collapsible-toggle{float:right;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}  .mw-content-ltr .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr .mw-collapsible-toggle{float:right} .mw-content-rtl .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl .mw-collapsible-toggle{float:left}.mw-customtoggle,.mw-collapsible-toggle{cursor:pointer} caption .mw-collapsible-toggle,.mw-content-ltr caption .mw-collapsible-toggle,.mw-content-rtl caption .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr caption .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl caption .mw-collapsible-toggle{float:none} li .mw-collapsible-toggle,.mw-content-ltr li .mw-collapsible-toggle,.mw-content-rtl li .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr li .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl li .mw-collapsible-toggle{float:none} .mw-collapsible-toggle-li{list-style:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:e1ffd603cbaaa5f1a36e0d13fe843535 */
.suggestions{overflow:hidden;position:absolute;top:0;left:0;width:0;border:none;z-index:1099;padding:0;margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0}.suggestions-result{color:black;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left; overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}.suggestions-result-current{background-color:#4C59A6;color:white}.suggestions-special .special-label{color:gray;text-align:left}.suggestions-special .special-query{color:black;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:silver}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:white}.highlight{font-weight:bold}
/* cache key: wikidb:resourceloader:filter:minify-css:7:f8d0c6895ce3ae14434c16b8fca59432 */
.postedit-container{margin:0 auto;position:fixed;top:0;height:0;left:50%;z-index:1000;font-size:13px}.postedit-container:hover{cursor:pointer}.postedit{position:relative;top:0.6em;left:-50%;padding:.6em 3.6em .6em 1.1em;line-height:1.5625em;color:#626465;background-color:#f4f4f4;border:1px solid #dcd9d9;text-shadow:0 0.0625em 0 rgba(255,255,255,0.5);border-radius:5px;box-shadow:0 2px 5px 0 #ccc;-webkit-transition:all 0.25s ease-in-out;-moz-transition:all 0.25s ease-in-out;-ms-transition:all 0.25s ease-in-out;-o-transition:all 0.25s ease-in-out;transition:all 0.25s ease-in-out}.skin-monobook .postedit{top:6em !important}.postedit-faded{opacity:0}.postedit-icon{padding-left:41px;  line-height:25px;background-repeat:no-repeat;background-position:8px 50%}.postedit-icon-checkmark{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABblBMVEUAAAD///////9PfTf///80aRdTgjn///9Feij///////////9Rfzf///////////9PfjZRgDh1o1xOfTb///////+bwYqLtnj///////9PfTa82K////9WhT6YxIL///9QgDdTgzr////////j7uDl7eLq8efi693k7OH///////9UhjuBr2rp9uRUhjr///9YljVKgir///9WiTlYjT3////9/v57vFlbkT5PjC9dlD/5/fhuq09stUTs9uhxuElctCpfnT1huDFloEZloUZmpENmvDZpvDxpvTxqvjxrvT5rvT9rwTxsqktswD5uwkBvuUdxw0NztFBztU9ztVBzwkp0tlJ1xkd2t1R3uVR4w1F4xk54x014yE15uVZ5v1R5xVB6v1R7yFJ8wVh9xVl9yFR9yVd9ylN+xVh+yFd/x1l/yFeAylmEx1+Ny2uY0Hqe04Wj1Ymv3Ze33qLD47TJ5L3O6cPU7Mrq9eb2+/Q4j37OAAAAQHRSTlMAAQIEBAUFBQwPFB4fJCUoKiosQEhJS01RUlZZXmdydXaChYuSlJSWmJmoq6uur8LExcvM19fg5ejt8fX2+Pr7SljgewAAAKpJREFUGBkFwQNCAwAAAMDLtl3LtrG4rWXbtvX77gAgZ6grFwC0bhwNVgKgdPZx8b0dgLi+s7Wn0VoAqpfOI9+BNADZI7fLrz2pSEwGHZuH+78lSK8ZLkLezF3ooyUG3VPXq2USei9WngeyoG195yBYWDF3E/2pAhl1e9Gr8bGT+bfOFCC2fnvh4X7rcqIAQNNu+HT6sxkAjceTL/2ZAIhv+PorBwBJxfkA//dFHSCBy/UTAAAAAElFTkSuQmCC);background-image:url(https://wcipeg.com/wiki/resources/src/mediawiki.action/images/green-checkmark.png?2015-08-10T21:21:40Z)!ie;background-position:left}.postedit-close{position:absolute;padding:0 .8em;right:0;top:0;font-size:1.25em;font-weight:bold;line-height:2.3em;color:black;text-shadow:0 0.0625em 0 white;text-decoration:none;opacity:0.2;filter:alpha(opacity=20)}.postedit-close:hover{color:black;text-decoration:none;opacity:0.4;filter:alpha(opacity=40)}
/* cache key: wikidb:resourceloader:filter:minify-css:7:86d7c89b7cadf5004340279c398253d8 */</style><style>
.suggestions a.mw-searchSuggest-link,.suggestions a.mw-searchSuggest-link:hover,.suggestions a.mw-searchSuggest-link:active,.suggestions a.mw-searchSuggest-link:focus{color:black;text-decoration:none}.suggestions-result-current a.mw-searchSuggest-link,.suggestions-result-current a.mw-searchSuggest-link:hover,.suggestions-result-current a.mw-searchSuggest-link:active,.suggestions-result-current a.mw-searchSuggest-link:focus{color:white}.suggestions a.mw-searchSuggest-link .special-query{ overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}
/* cache key: wikidb:resourceloader:filter:minify-css:7:ae3fa4570b5ac0c6cf7b3776c8ae4d6f */</style><meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*">
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:b36fd1c042133c9c9b60260f7c29b237 */</style>
<script src="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script><script src="/wiki/load.php?debug=false&amp;lang=en&amp;modules=jquery%2Cmediawiki&amp;only=scripts&amp;skin=vector&amp;version=20161103T112730Z"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Knuth–Morris–Pratt_algorithm","wgTitle":"Knuth–Morris–Pratt algorithm","wgCurRevisionId":1480,"wgRevisionId":1480,"wgArticleId":303,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Knuth–Morris–Pratt_algorithm","wgRelevantArticleId":303,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRedirectedFrom":"Knuth-Morris-Pratt","wgInternalRedirectTargetUrl":"/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wikidb:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.redirect","mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script><script src="/wiki/load.php?debug=false&amp;lang=en&amp;modules=jquery.accessKeyLabel%2Cclient%2CmwExtension%2CtabIndex%2Cthrottle-debounce%7Cmediawiki.action.view.redirect%7Cmediawiki.legacy.ajax%2Cwikibits%7Cmediawiki.notify%2Cutil%7Cmediawiki.page.startup%7Cskins.vector.js&amp;skin=vector&amp;version=20161103T112730Z&amp;*"></script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Knuth–Morris–Pratt_algorithm skin-vector action-view">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<div class="mw-indicators">
</div>
			<h1 id="firstHeading" class="firstHeading" lang="en">Knuth–Morris–Pratt algorithm</h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From PEGWiki</div>
								<div id="contentSub"><span class="mw-redirectedfrom">(Redirected from <a href="/wiki/index.php?title=Knuth-Morris-Pratt&amp;redirect=no" title="Knuth-Morris-Pratt">Knuth-Morris-Pratt</a>)</span></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>The <b>Knuth–Morris–Pratt (KMP) algorithm</b> is a linear time solution to the single-pattern <a href="/wiki/String_search" title="String search" class="mw-redirect">string search</a> problem. It is based on the observation that a partial match gives useful information about whether or not the needle may partially match subsequent positions in the haystack. This is because a partial match indicates that some part of the haystack is the same as some part of the needle, so that if we have preprocessed the <i>needle</i> in the right way, we will be able to draw some conclusions about the contents of the <i>haystack</i> (because of the partial match) without having to go back and re-examine characters already matched. In particular, this means that, in a certain sense, we will want to precompute how the needle matches itself. The algorithm thus "never looks back" and makes a single pass over the haystack. Together with linear time preprocessing of the needle, this gives a linear time algorithm overall.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2><span class="toctoggle">&nbsp;[<a href="#" id="togglelink">hide</a>]&nbsp;</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Motivation"><span class="tocnumber">1</span> <span class="toctext">Motivation</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Example_1"><span class="tocnumber">1.1</span> <span class="toctext">Example 1</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Example_2"><span class="tocnumber">1.2</span> <span class="toctext">Example 2</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Example_3"><span class="tocnumber">1.3</span> <span class="toctext">Example 3</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Concept"><span class="tocnumber">2</span> <span class="toctext">Concept</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Computation_of_the_prefix_function"><span class="tocnumber">3</span> <span class="toctext">Computation of the prefix function</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Matching"><span class="tocnumber">4</span> <span class="toctext">Matching</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#References"><span class="tocnumber">5</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#External_links"><span class="tocnumber">6</span> <span class="toctext">External links</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Motivation">Motivation</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit&amp;section=1" title="Edit section: Motivation">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The motivation behind KMP is best illustrated using a few simple examples.
</p>
<h3><span class="mw-headline" id="Example_1">Example 1</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit&amp;section=2" title="Edit section: Example 1">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In this example, we are searching for the string <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> = <b>aaa</b> in the string <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> = <b>aaaaaaaaa</b> (in which it occurs seven times). The naive algorithm would begin by comparing <img class="mwe-math-fallback-image-inline tex" alt="S_1" src="/wiki/images/math/8/d/c/8dc4eef060814e559aff4c5fac3f51fe.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_1" src="/wiki/images/math/a/5/7/a5749ec33f2c95fe8c19d702d76d4968.png">, <img class="mwe-math-fallback-image-inline tex" alt="S_2" src="/wiki/images/math/9/7/a/97a6ae0695c4b2723ff5c8bccdb1e735.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_2" src="/wiki/images/math/f/0/6/f066e1184caa1b9991cbceb207ea6341.png">, and <img class="mwe-math-fallback-image-inline tex" alt="S_3" src="/wiki/images/math/e/f/f/eff9b86742e85cfc8d927f72f872442d.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_3" src="/wiki/images/math/2/3/7/237459530aee1ee033edbe48a9991055.png">, and thus find a match for <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> at position 1 of <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">. Then it would proceed to compare <img class="mwe-math-fallback-image-inline tex" alt="S_1" src="/wiki/images/math/8/d/c/8dc4eef060814e559aff4c5fac3f51fe.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_2" src="/wiki/images/math/f/0/6/f066e1184caa1b9991cbceb207ea6341.png">, <img class="mwe-math-fallback-image-inline tex" alt="S_2" src="/wiki/images/math/9/7/a/97a6ae0695c4b2723ff5c8bccdb1e735.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_3" src="/wiki/images/math/2/3/7/237459530aee1ee033edbe48a9991055.png">, and <img class="mwe-math-fallback-image-inline tex" alt="S_3" src="/wiki/images/math/e/f/f/eff9b86742e85cfc8d927f72f872442d.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_4" src="/wiki/images/math/8/c/f/8cfdd0c85516cef88adbacf929258b9a.png">, and thus find a match at position 2 of <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">, and so on, until it finds all the matches. But we can do better than this, if we preprocess <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> and note that <img class="mwe-math-fallback-image-inline tex" alt="S_1" src="/wiki/images/math/8/d/c/8dc4eef060814e559aff4c5fac3f51fe.png"> and <img class="mwe-math-fallback-image-inline tex" alt="S_2" src="/wiki/images/math/9/7/a/97a6ae0695c4b2723ff5c8bccdb1e735.png"> are the same, and <img class="mwe-math-fallback-image-inline tex" alt="S_2" src="/wiki/images/math/9/7/a/97a6ae0695c4b2723ff5c8bccdb1e735.png"> and <img class="mwe-math-fallback-image-inline tex" alt="S_3" src="/wiki/images/math/e/f/f/eff9b86742e85cfc8d927f72f872442d.png"> are the same. That is, the <b>prefix</b> of length 2 in <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> matches the <b>substring</b> of length 2 starting at position 2 in <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png">; <i><img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> partially matches itself</i>. Now, after finding that <img class="mwe-math-fallback-image-inline tex" alt="S_1, S_2, S_3" src="/wiki/images/math/6/1/5/6154f77f3c303e332f91c2e2f404d2e5.png"> match <img class="mwe-math-fallback-image-inline tex" alt="T_1, T_2, T_3" src="/wiki/images/math/3/9/3/39331fe84f9ea9d53f09aac923bb42c4.png">, respectively, we no longer care about <img class="mwe-math-fallback-image-inline tex" alt="T_1" src="/wiki/images/math/a/5/7/a5749ec33f2c95fe8c19d702d76d4968.png">, since we are trying to find a match at position 2 now, but we still know that <img class="mwe-math-fallback-image-inline tex" alt="S_2, S_3" src="/wiki/images/math/3/a/1/3a14af3f858d612e8a8676a62a31ad27.png"> match <img class="mwe-math-fallback-image-inline tex" alt="T_2, T_3" src="/wiki/images/math/c/b/1/cb1874b45d2dd18e4aa269b7aac30b88.png"> respectively. Since we already know <img class="mwe-math-fallback-image-inline tex" alt="S_1 = S_2, S_2 = S_3" src="/wiki/images/math/c/7/e/c7ec913429b04c13cb2faf872e3946fc.png">, we now know that <img class="mwe-math-fallback-image-inline tex" alt="S_1, S_2" src="/wiki/images/math/9/3/9/939edc4e740953f97f18de8659b89f97.png"> match <img class="mwe-math-fallback-image-inline tex" alt="T_2, T_3" src="/wiki/images/math/c/b/1/cb1874b45d2dd18e4aa269b7aac30b88.png"> respectively; there is no need to examine <img class="mwe-math-fallback-image-inline tex" alt="T_2" src="/wiki/images/math/f/0/6/f066e1184caa1b9991cbceb207ea6341.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T_3" src="/wiki/images/math/2/3/7/237459530aee1ee033edbe48a9991055.png"> again, as the naive algorithm would do. If we now check that <img class="mwe-math-fallback-image-inline tex" alt="S_3" src="/wiki/images/math/e/f/f/eff9b86742e85cfc8d927f72f872442d.png"> matches <img class="mwe-math-fallback-image-inline tex" alt="T_4" src="/wiki/images/math/8/c/f/8cfdd0c85516cef88adbacf929258b9a.png">, then, after finding <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> at position 1 in <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">, we only need to do <i>one</i> more comparison (not three) to conclude that <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> also occurs at position 2 in <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">. So now we know that <img class="mwe-math-fallback-image-inline tex" alt="S_1, S_2, S_3" src="/wiki/images/math/6/1/5/6154f77f3c303e332f91c2e2f404d2e5.png"> match <img class="mwe-math-fallback-image-inline tex" alt="T_2, T_3, T_4" src="/wiki/images/math/9/f/a/9fa519d8c50d83736dd48a8391c83b27.png">, respectively, which allows us to conclude that <img class="mwe-math-fallback-image-inline tex" alt="S_1, S_2" src="/wiki/images/math/9/3/9/939edc4e740953f97f18de8659b89f97.png"> match <img class="mwe-math-fallback-image-inline tex" alt="T_3, T_4" src="/wiki/images/math/a/e/1/ae15b8b70d54fe1f75ab0ad62017c430.png">. Then we compare <img class="mwe-math-fallback-image-inline tex" alt="S_3" src="/wiki/images/math/e/f/f/eff9b86742e85cfc8d927f72f872442d.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_5" src="/wiki/images/math/7/b/d/7bd34e9313d3b44fa4c3a172445d0267.png">, and find another match, and so on. Whereas the naive algorithm needs three comparisons to find each occurrence of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> in <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">, our technique only needs three comparisons to find the <i>first</i> occurrence, and only one for each after that, and doesn't go back to examine previous characters of <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> again. (This is how a human would probably do this search, too.)
</p>
<h3><span class="mw-headline" id="Example_2">Example 2</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit&amp;section=3" title="Edit section: Example 2">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Now let's search for the string <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> = <b>aaa</b> in the string <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> = <b>aabaabaaa</b>. Again, we start out the same way as in the naive algorithm, hence, we compare <img class="mwe-math-fallback-image-inline tex" alt="S_1" src="/wiki/images/math/8/d/c/8dc4eef060814e559aff4c5fac3f51fe.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_1" src="/wiki/images/math/a/5/7/a5749ec33f2c95fe8c19d702d76d4968.png">, <img class="mwe-math-fallback-image-inline tex" alt="S_2" src="/wiki/images/math/9/7/a/97a6ae0695c4b2723ff5c8bccdb1e735.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_2" src="/wiki/images/math/f/0/6/f066e1184caa1b9991cbceb207ea6341.png">, and <img class="mwe-math-fallback-image-inline tex" alt="S_3" src="/wiki/images/math/e/f/f/eff9b86742e85cfc8d927f72f872442d.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_3" src="/wiki/images/math/2/3/7/237459530aee1ee033edbe48a9991055.png">. Here we find a mismatch between <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">, so <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> does <i>not</i> occur at position 1 in <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">. Now, the naive algorithm would continue by comparing <img class="mwe-math-fallback-image-inline tex" alt="S_1" src="/wiki/images/math/8/d/c/8dc4eef060814e559aff4c5fac3f51fe.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_2" src="/wiki/images/math/f/0/6/f066e1184caa1b9991cbceb207ea6341.png"> and <img class="mwe-math-fallback-image-inline tex" alt="S_2" src="/wiki/images/math/9/7/a/97a6ae0695c4b2723ff5c8bccdb1e735.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_3" src="/wiki/images/math/2/3/7/237459530aee1ee033edbe48a9991055.png">, and would find a mismatch; then it would compare <img class="mwe-math-fallback-image-inline tex" alt="S_1" src="/wiki/images/math/8/d/c/8dc4eef060814e559aff4c5fac3f51fe.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_3" src="/wiki/images/math/2/3/7/237459530aee1ee033edbe48a9991055.png">, and find a mismatch, and so on. But a human would notice that after the first mismatch, the possibilities of finding <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> at positions 2 and 3 in <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> are extinguished. This is because, as noted in Example 1, <img class="mwe-math-fallback-image-inline tex" alt="S_2" src="/wiki/images/math/9/7/a/97a6ae0695c4b2723ff5c8bccdb1e735.png"> is the same as <img class="mwe-math-fallback-image-inline tex" alt="S_3" src="/wiki/images/math/e/f/f/eff9b86742e85cfc8d927f72f872442d.png">, and since <img class="mwe-math-fallback-image-inline tex" alt="S_3 \neq T_3" src="/wiki/images/math/3/9/4/394c6f8e923abccdcd5312b4e87d85cf.png">, <img class="mwe-math-fallback-image-inline tex" alt="S_2 \neq T_3" src="/wiki/images/math/8/f/0/8f00981d2ab48d09fd77393e4aa18420.png"> also (so we will not find <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> at position 2 of <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">). And, likewise, since <img class="mwe-math-fallback-image-inline tex" alt="S_1 \neq S_2" src="/wiki/images/math/c/b/9/cb99c2ca1731edd8a0159df70e2463a5.png">, and <img class="mwe-math-fallback-image-inline tex" alt="S_2 \neq T_3" src="/wiki/images/math/8/f/0/8f00981d2ab48d09fd77393e4aa18420.png">, it is also true that <img class="mwe-math-fallback-image-inline tex" alt="S_1 \neq T_3" src="/wiki/images/math/b/a/b/babc57607d6204cc4caba885f225fe73.png">, so it is pointless looking for a match at the third position of <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">. Thus, it would make sense to start comparing again at the fourth position of <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> (<i>i.e.</i>, <img class="mwe-math-fallback-image-inline tex" alt="S_1, S_2, S_3" src="/wiki/images/math/6/1/5/6154f77f3c303e332f91c2e2f404d2e5.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_4, T_5, T_6" src="/wiki/images/math/c/4/6/c460a53169ec45dc0726b540aa8842da.png">, respectively). Again finding a mismatch, we use similar reasoning to rule out the fifth and sixth positions in <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">, and begin matching again at <img class="mwe-math-fallback-image-inline tex" alt="T_7" src="/wiki/images/math/5/5/a/55aab1086ec24e215327b12fb7f03314.png"> (where we finally find a match.) Again, notice that the characters of <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> were examined strictly in order.
</p>
<h3><span class="mw-headline" id="Example_3">Example 3</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit&amp;section=4" title="Edit section: Example 3">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>As a more complex example, imagine searching for the string <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> = <b>tartan</b> in the string <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> = <b>tartaric_acid</b>. We make the observation that the <b>prefix</b> of length 2 in <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> matches the <b>substring</b> of length 2 in <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> starting from position 4. Now, we start by comparing <img class="mwe-math-fallback-image-inline tex" alt="S_1, S_2, S_3, S_4, S_5, S_6" src="/wiki/images/math/7/5/1/7518924619fb6336eb239c863525ba18.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_1, T_2, T_3, T_4, T_5, T_6" src="/wiki/images/math/d/c/f/dcfa66fd274a6ff2e4cb4c10ec7e2cb4.png">, respectively. We find that <img class="mwe-math-fallback-image-inline tex" alt="S_6" src="/wiki/images/math/d/5/d/d5d20f293f091036ebfc4481821ceffc.png"> does not match <img class="mwe-math-fallback-image-inline tex" alt="T_6" src="/wiki/images/math/a/3/a/a3a0d7fb3c546096ce71627dae13b624.png">, so there is no match at position 1. At this point, we note that since <img class="mwe-math-fallback-image-inline tex" alt="S_1 \neq S_2" src="/wiki/images/math/c/b/9/cb99c2ca1731edd8a0159df70e2463a5.png"> and <img class="mwe-math-fallback-image-inline tex" alt="S_1 \neq S_3" src="/wiki/images/math/f/a/1/fa13e3831e390d5170d71185f7c0b8e0.png">, and <img class="mwe-math-fallback-image-inline tex" alt="S_2 = T_2, S_3 = T_3" src="/wiki/images/math/4/6/0/460477c1235ca40d55ace86546f374c6.png">, obviously, <img class="mwe-math-fallback-image-inline tex" alt="S_1 \neq T_2" src="/wiki/images/math/8/9/a/89acf346bbbef2964d7d1821f93dfff5.png"> and <img class="mwe-math-fallback-image-inline tex" alt="S_1 \neq T_3" src="/wiki/images/math/b/a/b/babc57607d6204cc4caba885f225fe73.png">, so there cannot be a match at position 2 or position 3. Now, recall that <img class="mwe-math-fallback-image-inline tex" alt="S_1 = S_4" src="/wiki/images/math/5/b/4/5b4f3ab33c17ced5e2d20b34bbaf84bf.png"> and <img class="mwe-math-fallback-image-inline tex" alt="S_2 = S_5" src="/wiki/images/math/e/1/7/e17eec71c2853ebead62cd4d355c37cb.png">, and that <img class="mwe-math-fallback-image-inline tex" alt="S_4 = T_4, S_5 = T_5" src="/wiki/images/math/b/b/f/bbfee2d5408d97fb355adbe8fa713f7a.png">. We can translate this to <img class="mwe-math-fallback-image-inline tex" alt="S_1 = T_4, S_2 = T_5" src="/wiki/images/math/a/5/6/a563492ddd092eac2141b6b7e180d80e.png">. So we proceed to compare <img class="mwe-math-fallback-image-inline tex" alt="S_3" src="/wiki/images/math/e/f/f/eff9b86742e85cfc8d927f72f872442d.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_6" src="/wiki/images/math/a/3/a/a3a0d7fb3c546096ce71627dae13b624.png">. In this way, we have ruled out two possible positions, and we have restarted comparing not at the beginning of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> but in the middle, avoiding re-examining <img class="mwe-math-fallback-image-inline tex" alt="T_4" src="/wiki/images/math/8/c/f/8cfdd0c85516cef88adbacf929258b9a.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T_5" src="/wiki/images/math/7/b/d/7bd34e9313d3b44fa4c3a172445d0267.png">.
</p>
<h2><span class="mw-headline" id="Concept">Concept</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit&amp;section=5" title="Edit section: Concept">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><i>Let the prefix of length <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png"> of string <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> be denoted <img class="mwe-math-fallback-image-inline tex" alt="S^i" src="/wiki/images/math/5/4/a/54ad29302a51fafccfdcb96c3211d78c.png">.</i>
</p><p>The examples above show that the KMP algorithm relies on noticing that certain substrings of the needle match or do not match other substrings of the needle, but it is probably not clear what the unifying organizational principle for all this match information is. Here it is:
</p>
<dl><dd><i>At each position <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png"> of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png">, find the longest proper suffix of <img class="mwe-math-fallback-image-inline tex" alt="S^i" src="/wiki/images/math/5/4/a/54ad29302a51fafccfdcb96c3211d78c.png"> that is also a prefix of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png">.</i></dd></dl>
<p>We shall denote the length of this substring by <img class="mwe-math-fallback-image-inline tex" alt="\pi_i" src="/wiki/images/math/2/9/0/290401a8e62e89331cfaa44efff73c73.png">, following <sup id="cite_ref-CLRS_1-0" class="reference"><a href="#cite_note-CLRS-1">[1]</a></sup>. We can also state the definition of <img class="mwe-math-fallback-image-inline tex" alt="\pi_i" src="/wiki/images/math/2/9/0/290401a8e62e89331cfaa44efff73c73.png"> equivalently as <i>the maximum <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> such that <img class="mwe-math-fallback-image-inline tex" alt="S_j \sqsupset S_i" src="/wiki/images/math/c/a/2/ca2413957bef45625e1c128e842edfa2.png"></i>.
</p><p>The table <img class="mwe-math-fallback-image-inline tex" alt="\pi" src="/wiki/images/math/5/2/2/522359592d78569a9eac16498aa7a087.png">, called the <i>prefix function</i>, occupies linear space, and, as we shall see, can be computed in linear time. It contains <i>all</i> the information we need in order to execute the "smart" searching techniques described in the examples. In particular, in examples 1 and 2, we used the fact that <img class="mwe-math-fallback-image-inline tex" alt="\pi_3 = 2" src="/wiki/images/math/8/a/4/8a4f95fe8eef146e0856c7c930dd3ff5.png">, that is, the prefix <b>aa</b> matches the suffix <b>aa</b>. In example 3, we used the facts that <img class="mwe-math-fallback-image-inline tex" alt="\pi_5 = 2" src="/wiki/images/math/9/a/b/9abd69641f1d49ab4b6f5ab45f102719.png">. This tells us that the prefix <b>ta</b> matches the substring <b>ta</b> ending at the fifth position. In general, the table <img class="mwe-math-fallback-image-inline tex" alt="\pi" src="/wiki/images/math/5/2/2/522359592d78569a9eac16498aa7a087.png"> tells us, after either a successful match or a mismatch, what the next position is that we should check in the haystack. Comparison proceeds from where it was left off, never revisiting a character of the haystack after we have examined the next one.
</p>
<h2><span class="mw-headline" id="Computation_of_the_prefix_function">Computation of the prefix function</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit&amp;section=6" title="Edit section: Computation of the prefix function">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>To compute the prefix function, we shall first make the following observation:
</p>
<dl><dd><i>Prefix function iteration lemma</i><sup id="cite_ref-CLRS_1-1" class="reference"><a href="#cite_note-CLRS-1">[1]</a></sup>: The sequence <img class="mwe-math-fallback-image-inline tex" alt="\pi^*_i = i, \pi_i, \pi_{\pi_i}, \pi_{\pi_{\pi_i}}, \ldots, 0" src="/wiki/images/math/a/4/d/a4d85a5c2b1729f44e15c5f5cd73192e.png"> contains exactly those values <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> such that <img class="mwe-math-fallback-image-inline tex" alt="S^j \sqsupset S^i" src="/wiki/images/math/2/d/a/2da399105ca67382af5accb8d4f2c888.png">.</dd></dl>
<p>That is, we can enumerate all suffixes of <img class="mwe-math-fallback-image-inline tex" alt="S^i" src="/wiki/images/math/5/4/a/54ad29302a51fafccfdcb96c3211d78c.png"> that are also prefixes of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> by starting with <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png">, looking it up in the table <img class="mwe-math-fallback-image-inline tex" alt="\pi" src="/wiki/images/math/5/2/2/522359592d78569a9eac16498aa7a087.png">, looking up the result, looking up the result, and so on, giving a strictly decreasing sequence, terminating with zero.
</p>
<dl><dd><i>Proof</i>: We first show by induction that if <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> appears in the sequence <img class="mwe-math-fallback-image-inline tex" alt="\pi^*_i" src="/wiki/images/math/d/4/6/d46e28072737227e9ad687d6e2bf051d.png"> then <img class="mwe-math-fallback-image-inline tex" alt="S^j \sqsupset S^i" src="/wiki/images/math/2/d/a/2da399105ca67382af5accb8d4f2c888.png">, <i>i.e</i>, <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> indeed belongs in the sequence <img class="mwe-math-fallback-image-inline tex" alt="\pi^*_i" src="/wiki/images/math/d/4/6/d46e28072737227e9ad687d6e2bf051d.png">. Suppose <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> is the first entry in <img class="mwe-math-fallback-image-inline tex" alt="\pi^*_i" src="/wiki/images/math/d/4/6/d46e28072737227e9ad687d6e2bf051d.png">. Then <img class="mwe-math-fallback-image-inline tex" alt="j = i" src="/wiki/images/math/d/e/b/deb35ac698cfcb065d7aab02afd1dcd0.png"> and it is trivially true that <img class="mwe-math-fallback-image-inline tex" alt="S^j \sqsupset S^i" src="/wiki/images/math/2/d/a/2da399105ca67382af5accb8d4f2c888.png">. Now suppose <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> is not the first entry, but is preceded by the entry <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> which is valid. That is, <img class="mwe-math-fallback-image-inline tex" alt="\pi_k = j" src="/wiki/images/math/8/f/8/8f8c6b6f09a102ab560679268db007f4.png">. By definition, <img class="mwe-math-fallback-image-inline tex" alt="S^j \sqsupset S^k" src="/wiki/images/math/4/a/9/4a9d9073caeeff1e5d8ff31d203efbcb.png">. But <img class="mwe-math-fallback-image-inline tex" alt="S^k \sqsupset S^i" src="/wiki/images/math/a/4/b/a4b1e42dd52befbab36a439202d908c8.png"> by assumption. Since <img class="mwe-math-fallback-image-inline tex" alt="\sqsupset" src="/wiki/images/math/f/e/4/fe47401f278fa0892559bad5b9373ebe.png"> is <a href="/wiki/Partial_order" title="Partial order">transitive</a>, <img class="mwe-math-fallback-image-inline tex" alt="S^j \sqsupset S^i" src="/wiki/images/math/2/d/a/2da399105ca67382af5accb8d4f2c888.png">.</dd>
<dd>We now show by contradiction that if <img class="mwe-math-fallback-image-inline tex" alt="S^j \sqsupset S^i" src="/wiki/images/math/2/d/a/2da399105ca67382af5accb8d4f2c888.png">, then <img class="mwe-math-fallback-image-inline tex" alt="j \in \pi^*_i" src="/wiki/images/math/8/4/7/8471e48a34b326f41b1a530e0e106670.png">. Assume <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> does not appear in the sequence. Clearly <img class="mwe-math-fallback-image-inline tex" alt="0 &lt; j &lt; i" src="/wiki/images/math/2/e/d/2ed171d7ac27ff6ecd9fcd23c1af58b0.png"> since 0 and <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png"> both appear. Since <img class="mwe-math-fallback-image-inline tex" alt="\pi^*_i" src="/wiki/images/math/d/4/6/d46e28072737227e9ad687d6e2bf051d.png"> is strictly decreasing, we can find exactly one <img class="mwe-math-fallback-image-inline tex" alt="k \in \pi^*_i" src="/wiki/images/math/8/d/d/8dd3436cbbabcb6a9cdfa6efb72d4a52.png"> such that <img class="mwe-math-fallback-image-inline tex" alt="k &gt; j" src="/wiki/images/math/2/2/6/22609dcd05f1e73f023eec8045fbd2fb.png"> and <img class="mwe-math-fallback-image-inline tex" alt="\pi_k &lt; j" src="/wiki/images/math/2/a/1/2a12f0ea49c6138a87d057718c27f42e.png">; that is, we can find exactly one <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> after which <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> "should" appear (to keep the sequence decreasing). We know from the first part of the proof that <img class="mwe-math-fallback-image-inline tex" alt="S^k \sqsupset S^i" src="/wiki/images/math/a/4/b/a4b1e42dd52befbab36a439202d908c8.png">. Since the suffix of <img class="mwe-math-fallback-image-inline tex" alt="S^i" src="/wiki/images/math/5/4/a/54ad29302a51fafccfdcb96c3211d78c.png"> of length <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> is a suffix of the suffix of <img class="mwe-math-fallback-image-inline tex" alt="S^i" src="/wiki/images/math/5/4/a/54ad29302a51fafccfdcb96c3211d78c.png"> of length <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png">, it follows that the suffix of <img class="mwe-math-fallback-image-inline tex" alt="S^i" src="/wiki/images/math/5/4/a/54ad29302a51fafccfdcb96c3211d78c.png"> of length <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> matches the suffix of length <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> of <img class="mwe-math-fallback-image-inline tex" alt="S^k" src="/wiki/images/math/8/3/4/83481703a58de47792a9b2f09b3b4121.png">. But the suffix of <img class="mwe-math-fallback-image-inline tex" alt="S^i" src="/wiki/images/math/5/4/a/54ad29302a51fafccfdcb96c3211d78c.png"> of length <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> also matches <img class="mwe-math-fallback-image-inline tex" alt="S^j" src="/wiki/images/math/a/0/e/a0eaf797bb066ea839ff9a6ee546b86a.png">, so <img class="mwe-math-fallback-image-inline tex" alt="S^j" src="/wiki/images/math/a/0/e/a0eaf797bb066ea839ff9a6ee546b86a.png"> matches the suffix of <img class="mwe-math-fallback-image-inline tex" alt="S^k" src="/wiki/images/math/8/3/4/83481703a58de47792a9b2f09b3b4121.png"> of length <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png">. We therefore conclude that <img class="mwe-math-fallback-image-inline tex" alt="\pi_k \geq j" src="/wiki/images/math/6/0/b/60bb549003c0ede645de47a983d4ae63.png">. But <img class="mwe-math-fallback-image-inline tex" alt="j &gt; \pi_k" src="/wiki/images/math/2/e/3/2e3e467592c77af17e6fb2a2e2c794bb.png">, a contradiction. <img class="mwe-math-fallback-image-inline tex" alt="_\blacksquare" src="/wiki/images/math/7/7/3/773d97c085dfd2ddd2d1d170ff65aa2e.png"></dd></dl>
<p>With this in mind, we can design an algorithm to compute the table <img class="mwe-math-fallback-image-inline tex" alt="\pi" src="/wiki/images/math/5/2/2/522359592d78569a9eac16498aa7a087.png">. For each <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png">, we will first try to find some <img class="mwe-math-fallback-image-inline tex" alt="j &gt; 0" src="/wiki/images/math/0/8/1/0818d4c096ad314ff59869c0e49256bd.png"> such that <img class="mwe-math-fallback-image-inline tex" alt="S_j \sqsupset S_i" src="/wiki/images/math/c/a/2/ca2413957bef45625e1c128e842edfa2.png">. If we fail to do so, we will conclude that <img class="mwe-math-fallback-image-inline tex" alt="\pi_i = 0" src="/wiki/images/math/6/b/b/6bb0f52cf765d964ccb97e4caf6be011.png"> (clearly this is the case when <img class="mwe-math-fallback-image-inline tex" alt="i = 1" src="/wiki/images/math/9/a/0/9a041ce63f6c28100344427c6d71837b.png">.) Observe that if we do find such <img class="mwe-math-fallback-image-inline tex" alt="j &gt; 0" src="/wiki/images/math/0/8/1/0818d4c096ad314ff59869c0e49256bd.png">, then by removing the last character from this suffix, we obtain a suffix of <img class="mwe-math-fallback-image-inline tex" alt="S^{i-1}" src="/wiki/images/math/d/6/f/d6ff2163e0f818cf9ab11d0b34f29aeb.png"> that is also a prefix of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png">, <i>i.e.</i>, <img class="mwe-math-fallback-image-inline tex" alt="S^{j-1} \sqsupset S^{i-1}" src="/wiki/images/math/7/7/9/779d2f981f98711975f259e05884d57e.png">. Therefore, we first enumerate <i>all</i> nonempty proper suffixes of <img class="mwe-math-fallback-image-inline tex" alt="S^{i-1}" src="/wiki/images/math/d/6/f/d6ff2163e0f818cf9ab11d0b34f29aeb.png"> that are also prefixes of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png">. If we find such a suffix of length <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> which also satisfies <img class="mwe-math-fallback-image-inline tex" alt="S_k = S_i" src="/wiki/images/math/6/3/1/63139faa4c9773b2a64997bac962cd3d.png">, then <img class="mwe-math-fallback-image-inline tex" alt="S^{k+1} \sqsupset S^i" src="/wiki/images/math/c/0/0/c0041c284305e74fb47c036e5edf2b3a.png">, and <img class="mwe-math-fallback-image-inline tex" alt="k+1" src="/wiki/images/math/a/3/1/a31a860e7a59c7616c1515ec3ae652a6.png"> is a possible value of <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png">. So we will let <img class="mwe-math-fallback-image-inline tex" alt="k = \pi_{i-1}" src="/wiki/images/math/6/e/7/6e732ec90535104b0c48339957402425.png"> and keep iterating through the sequence <img class="mwe-math-fallback-image-inline tex" alt="\pi_k, \pi_{\pi_k}, \ldots" src="/wiki/images/math/a/1/1/a1115e4b7733caaa8811473e10d702b9.png">. We stop if we reach element <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> in this sequence such that <img class="mwe-math-fallback-image-inline tex" alt="S_{j+1} = S_i" src="/wiki/images/math/e/2/2/e22e605bda03357559584c087e53c1c2.png">, and declare <img class="mwe-math-fallback-image-inline tex" alt="\pi_i = j+1" src="/wiki/images/math/3/c/d/3cd69693a619a6494b00c6de6737ef45.png">; this always gives an optimal solution since the sequence <img class="mwe-math-fallback-image-inline tex" alt="\pi^*_{i-1}" src="/wiki/images/math/c/9/7/c97d46c2bff2ef8255a4bc25da01aeb7.png"> is decreasing and since it contains all possible valid <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png">'s. If we exhaust the sequence, then <img class="mwe-math-fallback-image-inline tex" alt="\pi_i = 0" src="/wiki/images/math/6/b/b/6bb0f52cf765d964ccb97e4caf6be011.png">.
</p><p>Here is the pseudocode:
</p>
<pre>π[1] ← 0
for i ∈ [2..m]
    k ← π[i-1]
    while k &gt; 0 and S[k+1] ≠ S[i]
        k ← π[k]
    if S[k+1] = S[i]
        π[i] ← 0
    else
        π[i] ← k+1
</pre>
<p>With a little bit of thought, this can be re-written as follows:
</p>
<pre>π[1] ← 0
k ← 0
for i ∈ [2..m]
    while k &gt; 0 and S[k+1] ≠ S[i]
        k ← π[k]
    if S[k+1] = S[i]
        k ← k+1
    π[i] ← k
</pre>
<p>This algorithm takes <img class="mwe-math-fallback-image-inline tex" alt="O(m)" src="/wiki/images/math/0/e/2/0e2ae329177722b1818828e92b441032.png"> time to execute. To see this, notice that the value of <code>k</code> is never negative; therefore it cannot decrease more than it increases. It only increases in the line <code>k ← k+1</code>, which can only be executed up to <img class="mwe-math-fallback-image-inline tex" alt="m-1" src="/wiki/images/math/4/e/3/4e3871ed52b5cdb1c75f85329fb472c5.png"> times. Therefore <code>k</code> can be decreased at most <code>k</code> times. But <code>k</code> is decreased in each iteration of the while loop, so the while loop can only run a linear number of times overall. All the other instructions in the for loop take constant time per iteration, so linear time overall.
</p>
<h2><span class="mw-headline" id="Matching">Matching</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit&amp;section=7" title="Edit section: Matching">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Suppose that we have already computed the table <img class="mwe-math-fallback-image-inline tex" alt="\pi" src="/wiki/images/math/5/2/2/522359592d78569a9eac16498aa7a087.png">. Here's where we apply this hard-won information. Suppose that so far we are testing position <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png"> for a match, and that the first <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> characters of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> have been successfully matched, that is, <img class="mwe-math-fallback-image-inline tex" alt="S_1 = T_j, S_2 = T_{j+1}, S_3 = T_{j+2}, \ldots S_k = T_{j+k-1}" src="/wiki/images/math/3/a/c/3acb44002e7f67427a96538b5bb96a13.png">. There are two possibilities: either we just continue going along <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> and comparing pairs of characters, or we decide we want to try out a new position in <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">. This occurs because either <img class="mwe-math-fallback-image-inline tex" alt="k = m" src="/wiki/images/math/f/8/3/f831bd5f5b8f3f9759dc35dc51e4b11b.png"> (<i>i.e</i>, we've successfully located <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> at position <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png"> in <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">, and now we want to check out other positions) or because <img class="mwe-math-fallback-image-inline tex" alt="S_{k+1} \neq T_{j+k}" src="/wiki/images/math/1/e/7/1e7268c721ac8640b6969945a04a5bc6.png"> (so we can rule out the current position).
</p><p>Given that <img class="mwe-math-fallback-image-inline tex" alt="S_1, \ldots, S_k = T_j, \ldots, T_{j+k-1}" src="/wiki/images/math/9/3/7/937a5bfbd940707937eded2d6ebb9311.png">, what positions in <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> can we rule out? Here is the result at the core of the KMP algorithm:
</p>
<dl><dd><i>Theorem</i>: If <img class="mwe-math-fallback-image-inline tex" alt="k &gt; 0" src="/wiki/images/math/1/c/e/1ceed399f1d8fa4a79cc94a5e6c5c76c.png"> then <img class="mwe-math-fallback-image-inline tex" alt="p = k - \pi_k" src="/wiki/images/math/9/d/1/9d1840fd7ea84533ec35266fbf7493ca.png"> is the least <img class="mwe-math-fallback-image-inline tex" alt="p &gt; 0" src="/wiki/images/math/0/8/2/08297f9dcc77d2e8f0a9d461fc8d29a7.png"> such that <img class="mwe-math-fallback-image-inline tex" alt="S_1, \ldots, S_{k-p}" src="/wiki/images/math/1/1/0/1108c8dc87ee41b9efb7110e011dca40.png"> match <img class="mwe-math-fallback-image-inline tex" alt="T_{j+p}, \ldots, T_{j+k-1}" src="/wiki/images/math/7/a/5/7a53d5284e5f701b5dffbcd1c207062c.png">, respectively. (If <img class="mwe-math-fallback-image-inline tex" alt="k = 0" src="/wiki/images/math/2/2/d/22d9bb2875d7a70aeb68696096f3b9b2.png">, then <img class="mwe-math-fallback-image-inline tex" alt="p = 1" src="/wiki/images/math/c/f/f/cff19eeeeb9692cbf8a6b0864c461f5e.png"> vacuously.)</dd></dl>
<p>Think carefully about what this means. If <img class="mwe-math-fallback-image-inline tex" alt="p &gt; 0" src="/wiki/images/math/0/8/2/08297f9dcc77d2e8f0a9d461fc8d29a7.png"> does not satisfy the statement that <img class="mwe-math-fallback-image-inline tex" alt="S_1, \ldots, S_{k-p}" src="/wiki/images/math/1/1/0/1108c8dc87ee41b9efb7110e011dca40.png"> match <img class="mwe-math-fallback-image-inline tex" alt="T_{j+p}, \ldots, T_{j+k-1}" src="/wiki/images/math/7/a/5/7a53d5284e5f701b5dffbcd1c207062c.png">, then the needle <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> <i>does not match</i> <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> at position <img class="mwe-math-fallback-image-inline tex" alt="j+p" src="/wiki/images/math/0/4/1/0419118acf09d2c4f24b3cd98e1c569a.png">, <i>i.e.</i>, we can <i>rule out</i> the position <img class="mwe-math-fallback-image-inline tex" alt="j+p" src="/wiki/images/math/0/4/1/0419118acf09d2c4f24b3cd98e1c569a.png">. On the other hand, if <img class="mwe-math-fallback-image-inline tex" alt="p &gt; 0" src="/wiki/images/math/0/8/2/08297f9dcc77d2e8f0a9d461fc8d29a7.png"> <i>does</i> satisfy this statement, then <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> <i>might</i> match <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> at position <img class="mwe-math-fallback-image-inline tex" alt="j+p" src="/wiki/images/math/0/4/1/0419118acf09d2c4f24b3cd98e1c569a.png">, and, in fact, all the characters up to but not including <img class="mwe-math-fallback-image-inline tex" alt="T_{j+k}" src="/wiki/images/math/b/b/a/bba137d86419afc9970dc77e0e62059d.png"> have already been verified to match the corresponding characters in <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png">, so we can proceed by comparing <img class="mwe-math-fallback-image-inline tex" alt="S_{k-p+1}" src="/wiki/images/math/d/8/d/d8d02c23923ec966a67f195f82f775c6.png"> with <img class="mwe-math-fallback-image-inline tex" alt="T_{j+k}" src="/wiki/images/math/b/b/a/bba137d86419afc9970dc77e0e62059d.png">, and, as promised, <i>never need to look back</i>.
</p>
<dl><dd><i>Proof</i>: Let <img class="mwe-math-fallback-image-inline tex" alt="0 \leq q &lt; k" src="/wiki/images/math/f/b/e/fbe73c3f0e6547e59c719e3ac18a0b55.png">. If <img class="mwe-math-fallback-image-inline tex" alt="S^q \sqsupset S^k" src="/wiki/images/math/e/d/a/edae3e81cdd0f8b54c48ac4bdd04481d.png">, then by definition we have <img class="mwe-math-fallback-image-inline tex" alt="S_1, \ldots, S_q = S_{k-q+1}, \ldots, S_k" src="/wiki/images/math/6/3/1/6311d7a69b13ef5d5ffe62cc60712536.png">. But since <img class="mwe-math-fallback-image-inline tex" alt="S_1, \ldots, S_k = T_j, \ldots, S_{j+k-1}" src="/wiki/images/math/b/a/7/ba7877690596f1793258a247fc1ef131.png">, it is also true that <img class="mwe-math-fallback-image-inline tex" alt="S_{k-q+1}, \ldots, S_k = T_{j+k-q}, \ldots, T_{j+k-1}" src="/wiki/images/math/3/5/7/357d23051dc383d806e90aed1c4a9ba8.png">. Therefore <img class="mwe-math-fallback-image-inline tex" alt="S_1, \ldots, S_q = T_{j+k-q}, \ldots, T_{j+k-1}" src="/wiki/images/math/9/f/4/9f4405b8a6897420715b1bb0ce5933ae.png">. If, on the other hand, it is not true that <img class="mwe-math-fallback-image-inline tex" alt="S^q \sqsupset S^k" src="/wiki/images/math/e/d/a/edae3e81cdd0f8b54c48ac4bdd04481d.png">, then it is not true that <img class="mwe-math-fallback-image-inline tex" alt="S_1, \ldots, S_q = S_{k-q+1}, \ldots, S_k" src="/wiki/images/math/6/3/1/6311d7a69b13ef5d5ffe62cc60712536.png">, so it is not true that <img class="mwe-math-fallback-image-inline tex" alt="S_{k-q+1}, \ldots, S_k = T_{j+k-q}, \ldots, T_{j+k-1}" src="/wiki/images/math/3/5/7/357d23051dc383d806e90aed1c4a9ba8.png">, so it is not true that <img class="mwe-math-fallback-image-inline tex" alt="S_1, \ldots, S_q = T_{j+k-q}, \ldots, T_{j+k-1}" src="/wiki/images/math/9/f/4/9f4405b8a6897420715b1bb0ce5933ae.png">. Therefore <img class="mwe-math-fallback-image-inline tex" alt="k-q" src="/wiki/images/math/c/4/f/c4f75ef48106f5a5f83c705e444f2498.png"> is a possible value of <img class="mwe-math-fallback-image-inline tex" alt="p" src="/wiki/images/math/8/3/8/83878c91171338902e0fe0fb97a8c47a.png"> if and only if <img class="mwe-math-fallback-image-inline tex" alt="S^q \sqsupset S^k" src="/wiki/images/math/e/d/a/edae3e81cdd0f8b54c48ac4bdd04481d.png">. Since the maximum possible value of <img class="mwe-math-fallback-image-inline tex" alt="q" src="/wiki/images/math/7/6/9/7694f4a66316e53c8cdd9d9954bd611d.png"> is <img class="mwe-math-fallback-image-inline tex" alt="\pi_k" src="/wiki/images/math/6/a/f/6af368843d5f75dbac760dd56aaeecb7.png">, the minimum possible value of <img class="mwe-math-fallback-image-inline tex" alt="p" src="/wiki/images/math/8/3/8/83878c91171338902e0fe0fb97a8c47a.png"> is given by <img class="mwe-math-fallback-image-inline tex" alt="k-\pi_k" src="/wiki/images/math/0/2/5/025065951992122f4b74e0333b29f833.png">. <img class="mwe-math-fallback-image-inline tex" alt="_\blacksquare" src="/wiki/images/math/7/7/3/773d97c085dfd2ddd2d1d170ff65aa2e.png"></dd></dl>
<p>Thus, here is the matching algorithm in pseudocode:
</p>
<pre>j ← 1
k ← 0
while j+m-1 ≤ n
    while k ≤ m and S[k+1] = T[j+k]
        k ← k+1
    if k = m
        print "Match at position " j
    if k = 0
        j ← j+1
    else
        j ← j+k-π[k]
        k ← π[k]
</pre>
<p>Thus, we scan the text one character at a time; the current character being examined is located at position <img class="mwe-math-fallback-image-inline tex" alt="j+k" src="/wiki/images/math/5/e/a/5ea4d93f23ea6550afb64156c364a150.png">. When there is a mismatch, we use the <img class="mwe-math-fallback-image-inline tex" alt="\pi" src="/wiki/images/math/5/2/2/522359592d78569a9eac16498aa7a087.png"> table to look up the next possible position at which the match might occur, and try to proceed.
</p><p>The fact that the algorithm scans one character at a time without looking back is more obvious when the code is cast into this equivalent form:<sup id="cite_ref-CLRS_1-2" class="reference"><a href="#cite_note-CLRS-1">[1]</a></sup>
</p>
<pre>k ← 0
for i ∈ [1..n]
    while k &gt; 0 and S[k+1] ≠ T[i]
        k ← π[k]
    if S[k+1] = T[i]
        k ← k+1
    if k = m
        print "Match at position " i-m+1
        k ← π[k]
</pre>
<p>Here, <code>i</code> is identified with <code>j+k</code> as above. Each iteration of the inner loop in one of these two segments corresponds to an iteration of the outer loop in the other. In this second form, we can also prove that the algorithm takes <img class="mwe-math-fallback-image-inline tex" alt="O(n)" src="/wiki/images/math/7/b/a/7ba55e7c64a9405a0b39a1107e90ca94.png"> time; each time the inner while loop is executed, the value of <code>k</code> decreases, but it cannot decrease more than <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png"> times because it starts as zero, is never negative, and is increased at most once per iteration of the outer loop (<i>i.e.</i>, at most <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png"> times in total), hence the inner loop is only executed up to <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png"> times. All other operations in the outer loop take constant time.
</p>
<h2><span class="mw-headline" id="References">References</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit&amp;section=8" title="Edit section: References">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ol class="references">
<li id="cite_note-CLRS-1"><span class="mw-cite-backlink">↑ <sup><a href="#cite_ref-CLRS_1-0"><span class="cite-accessibility-label">Jump up to: </span>1.0</a></sup> <sup><a href="#cite_ref-CLRS_1-1">1.1</a></sup> <sup><a href="#cite_ref-CLRS_1-2">1.2</a></sup></span> <span class="reference-text">Thomas H. Cormen; Charles E. Leiserson, Ronald L. Rivest, Clifford Stein (2001). "Section 32.4: The Knuth-Morris-Pratt algorithm". <i>Introduction to Algorithms</i> (Second ed.). MIT Press and McGraw-Hill. pp. 923–931. <a href="/wiki/Special:BookSources/9780262032933" class="internal mw-magiclink-isbn">ISBN 978-0-262-03293-3</a>.</span>
</li>
</ol>
<h2><span class="mw-headline" id="External_links">External links</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit&amp;section=9" title="Edit section: External links">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ul><li> <a rel="nofollow" class="external text" href="http://www.spoj.pl/problems/NHAY">A Needle in the Haystack</a></li></ul>

<!-- 
NewPP limit report
CPU time usage: 0.266 seconds
Real time usage: 0.302 seconds
Preprocessor visited node count: 2506/1000000
Preprocessor generated node count: 5642/1000000
Post‐expand include size: 59/2097152 bytes
Template argument size: 28/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    2.289      1 - -total
100.00%    2.289      1 - Template:SPOJ
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:303-0!*!0!!en!*!*!math=0 and timestamp 20180430182232 and revision id 1480
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wcipeg.com/wiki/index.php?title=Knuth–Morris–Pratt_algorithm&amp;oldid=1480">https://wcipeg.com/wiki/index.php?title=Knuth–Morris–Pratt_algorithm&amp;oldid=1480</a>"					</div>
													<div id="catlinks" class="catlinks catlinks-allhidden"></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-createaccount"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Knuth%E2%80%93Morris%E2%80%93Pratt+algorithm&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Knuth%E2%80%93Morris%E2%80%93Pratt+algorithm" title="You are encouraged to log in; however, it is not mandatory [ctrl-alt-o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li id="ca-nstab-main" class="selected"><span><a href="/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm" title="View the content page [ctrl-alt-c]" accesskey="c">Page</a></span></li>
															<li id="ca-talk" class="new"><span><a href="/wiki/index.php?title=Talk:Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit&amp;redlink=1" title="Discussion about the content page [ctrl-alt-t]" accesskey="t">Discussion</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label" tabindex="0"><span>Variants</span><a href="#" tabindex="-1"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm">Read</a></span></li>
															<li id="ca-edit"><span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=edit" title="You can edit this page. Please use the preview button before saving [ctrl-alt-e]" accesskey="e">Edit</a></span></li>
															<span class="placeholder" style="display: none;"></span>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu" aria-labelledby="p-cactions-label" style="">
						<h3 id="p-cactions-label" tabindex="0" style="width: 61px;"><span>More</span><a href="#" tabindex="-1"></a></h3>

						<div class="menu">
							<ul><li id="ca-history" class="collapsible" style="display: list-item;"><span><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=history" title="Past revisions of this page [ctrl-alt-h]" accesskey="h">View history</a></span></li>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="/wiki/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search PEGWiki [ctrl-alt-f]" accesskey="f" id="searchInput" tabindex="1" autocomplete="off"><input type="hidden" value="Special:Search" name="title"><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton">								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="/wiki/Main_Page" title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>

			<div class="body">
									<ul>
													<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [ctrl-alt-z]" accesskey="z">Main page</a></li>
													<li id="n-Index"><a href="/wiki/Special:AllPages">Index</a></li>
													<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [ctrl-alt-r]" accesskey="r">Recent changes</a></li>
													<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random page [ctrl-alt-x]" accesskey="x">Random page</a></li>
													<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm" title="A list of all wiki pages that link here [ctrl-alt-j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm" title="Recent changes in pages linked from this page [ctrl-alt-k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [ctrl-alt-q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;printable=yes" rel="alternate" title="Printable version of this page [ctrl-alt-p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;oldid=1480" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="/wiki/index.php?title=Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 11 December 2011, at 22:01.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by/3.0/">Attribution 3.0 Unported</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="/wiki/PEGWiki:Privacy_policy" title="PEGWiki:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="/wiki/PEGWiki:About" title="PEGWiki:About">About PEGWiki</a></li>
											<li id="footer-places-disclaimer"><a href="/wiki/PEGWiki:General_disclaimer" title="PEGWiki:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by/3.0/"><img src="http://i.creativecommons.org/l/by/3.0/88x31.png" alt="Attribution 3.0 Unported" width="88" height="31"></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="//www.mediawiki.org/"><img src="/wiki/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["ext.cite","mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wcipeg.com/wiki/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script><script src="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":68});
}</script>
	

<div class="suggestions" style="display: none; font-size: 13px;"><div class="suggestions-results"></div><div class="suggestions-special"></div></div></body></html>