<!DOCTYPE html><html lang="en" dir="ltr" class="client-js"><head>
<meta charset="UTF-8">
<title>Lowest common ancestor - PEGWiki</title>
<meta name="generator" content="MediaWiki 1.25.2">
<link rel="alternate" type="application/x-wiki" title="Edit" href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit">
<link rel="edit" title="Edit" href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/opensearch_desc.php" title="PEGWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wcipeg.com/wiki/api.php?action=rsd">
<link rel="alternate" hreflang="x-default" href="/wiki/Lowest_common_ancestor">
<link rel="copyright" href="http://creativecommons.org/licenses/by/3.0/">
<link rel="alternate" type="application/atom+xml" title="PEGWiki Atom feed" href="/wiki/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=ext.math.styles%7Cext.rtlcite%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*">
<style>
.cite-accessibility-label{position:absolute !important; top:-99999px;clip:rect(1px 1px 1px 1px); clip:rect(1px,1px,1px,1px);padding:0 !important;border:0 !important;height:1px !important;width:1px !important;overflow:hidden}.mw-cite-backlink,.cite-accessibility-label{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none} ol.references li:target,sup.reference:target{background-color:#def; background-color:rgba(0,127,255,0.133)}@media print{.mw-cite-backlink{display:none}}
/* cache key: wikidb:resourceloader:filter:minify-css:7:2970940d33044e6aa6a620ce3c93c662 */
.mw-collapsible-toggle{float:right;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}  .mw-content-ltr .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr .mw-collapsible-toggle{float:right} .mw-content-rtl .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl .mw-collapsible-toggle{float:left}.mw-customtoggle,.mw-collapsible-toggle{cursor:pointer} caption .mw-collapsible-toggle,.mw-content-ltr caption .mw-collapsible-toggle,.mw-content-rtl caption .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr caption .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl caption .mw-collapsible-toggle{float:none} li .mw-collapsible-toggle,.mw-content-ltr li .mw-collapsible-toggle,.mw-content-rtl li .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr li .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl li .mw-collapsible-toggle{float:none} .mw-collapsible-toggle-li{list-style:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:e1ffd603cbaaa5f1a36e0d13fe843535 */
.suggestions{overflow:hidden;position:absolute;top:0;left:0;width:0;border:none;z-index:1099;padding:0;margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0}.suggestions-result{color:black;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left; overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}.suggestions-result-current{background-color:#4C59A6;color:white}.suggestions-special .special-label{color:gray;text-align:left}.suggestions-special .special-query{color:black;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:silver}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:white}.highlight{font-weight:bold}
/* cache key: wikidb:resourceloader:filter:minify-css:7:f8d0c6895ce3ae14434c16b8fca59432 */
.postedit-container{margin:0 auto;position:fixed;top:0;height:0;left:50%;z-index:1000;font-size:13px}.postedit-container:hover{cursor:pointer}.postedit{position:relative;top:0.6em;left:-50%;padding:.6em 3.6em .6em 1.1em;line-height:1.5625em;color:#626465;background-color:#f4f4f4;border:1px solid #dcd9d9;text-shadow:0 0.0625em 0 rgba(255,255,255,0.5);border-radius:5px;box-shadow:0 2px 5px 0 #ccc;-webkit-transition:all 0.25s ease-in-out;-moz-transition:all 0.25s ease-in-out;-ms-transition:all 0.25s ease-in-out;-o-transition:all 0.25s ease-in-out;transition:all 0.25s ease-in-out}.skin-monobook .postedit{top:6em !important}.postedit-faded{opacity:0}.postedit-icon{padding-left:41px;  line-height:25px;background-repeat:no-repeat;background-position:8px 50%}.postedit-icon-checkmark{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABblBMVEUAAAD///////9PfTf///80aRdTgjn///9Feij///////////9Rfzf///////////9PfjZRgDh1o1xOfTb///////+bwYqLtnj///////9PfTa82K////9WhT6YxIL///9QgDdTgzr////////j7uDl7eLq8efi693k7OH///////9UhjuBr2rp9uRUhjr///9YljVKgir///9WiTlYjT3////9/v57vFlbkT5PjC9dlD/5/fhuq09stUTs9uhxuElctCpfnT1huDFloEZloUZmpENmvDZpvDxpvTxqvjxrvT5rvT9rwTxsqktswD5uwkBvuUdxw0NztFBztU9ztVBzwkp0tlJ1xkd2t1R3uVR4w1F4xk54x014yE15uVZ5v1R5xVB6v1R7yFJ8wVh9xVl9yFR9yVd9ylN+xVh+yFd/x1l/yFeAylmEx1+Ny2uY0Hqe04Wj1Ymv3Ze33qLD47TJ5L3O6cPU7Mrq9eb2+/Q4j37OAAAAQHRSTlMAAQIEBAUFBQwPFB4fJCUoKiosQEhJS01RUlZZXmdydXaChYuSlJSWmJmoq6uur8LExcvM19fg5ejt8fX2+Pr7SljgewAAAKpJREFUGBkFwQNCAwAAAMDLtl3LtrG4rWXbtvX77gAgZ6grFwC0bhwNVgKgdPZx8b0dgLi+s7Wn0VoAqpfOI9+BNADZI7fLrz2pSEwGHZuH+78lSK8ZLkLezF3ooyUG3VPXq2USei9WngeyoG195yBYWDF3E/2pAhl1e9Gr8bGT+bfOFCC2fnvh4X7rcqIAQNNu+HT6sxkAjceTL/2ZAIhv+PorBwBJxfkA//dFHSCBy/UTAAAAAElFTkSuQmCC);background-image:url(https://wcipeg.com/wiki/resources/src/mediawiki.action/images/green-checkmark.png?2015-08-10T21:21:40Z)!ie;background-position:left}.postedit-close{position:absolute;padding:0 .8em;right:0;top:0;font-size:1.25em;font-weight:bold;line-height:2.3em;color:black;text-shadow:0 0.0625em 0 white;text-decoration:none;opacity:0.2;filter:alpha(opacity=20)}.postedit-close:hover{color:black;text-decoration:none;opacity:0.4;filter:alpha(opacity=40)}
/* cache key: wikidb:resourceloader:filter:minify-css:7:86d7c89b7cadf5004340279c398253d8 */</style><style>
.suggestions a.mw-searchSuggest-link,.suggestions a.mw-searchSuggest-link:hover,.suggestions a.mw-searchSuggest-link:active,.suggestions a.mw-searchSuggest-link:focus{color:black;text-decoration:none}.suggestions-result-current a.mw-searchSuggest-link,.suggestions-result-current a.mw-searchSuggest-link:hover,.suggestions-result-current a.mw-searchSuggest-link:active,.suggestions-result-current a.mw-searchSuggest-link:focus{color:white}.suggestions a.mw-searchSuggest-link .special-query{ overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}
/* cache key: wikidb:resourceloader:filter:minify-css:7:ae3fa4570b5ac0c6cf7b3776c8ae4d6f */</style><meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*">
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:b36fd1c042133c9c9b60260f7c29b237 */</style>
<script src="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script><script src="/wiki/load.php?debug=false&amp;lang=en&amp;modules=jquery%2Cmediawiki&amp;only=scripts&amp;skin=vector&amp;version=20161103T112730Z"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Lowest_common_ancestor","wgTitle":"Lowest common ancestor","wgCurRevisionId":1968,"wgRevisionId":1968,"wgArticleId":392,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Lowest_common_ancestor","wgRelevantArticleId":392,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wikidb:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script><script src="/wiki/load.php?debug=false&amp;lang=en&amp;modules=jquery.accessKeyLabel%2Cclient%2CmwExtension%2CtabIndex%2Cthrottle-debounce%7Cmediawiki.legacy.ajax%2Cwikibits%7Cmediawiki.notify%2Cutil%7Cmediawiki.page.startup%7Cskins.vector.js&amp;skin=vector&amp;version=20161103T112730Z&amp;*"></script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Lowest_common_ancestor skin-vector action-view">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<div class="mw-indicators">
</div>
			<h1 id="firstHeading" class="firstHeading" lang="en">Lowest common ancestor</h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From PEGWiki</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>The <b>lowest common ancestor</b> or <b>least common ancestor</b> (LCA) of a nonempty set of nodes in a rooted <a href="/wiki/Tree" title="Tree">tree</a> is the unique node of greatest depth that is an ancestor of every node in the set. (In biology, this corresponds to the <i>most recent common ancestor</i> of a set of organisms.) We will denote the LCA of a set of nodes <img class="mwe-math-fallback-image-inline tex" alt="S = \{v_1, v_2, ..., v_n\}" src="/wiki/images/math/6/2/4/6240af0067f0347d4604e3df103160dd.png"> by <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(v_1, v_2, ..., v_n)" src="/wiki/images/math/f/b/5/fb59737ec6f796e768d6eadef800f347.png"> or by <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(S)" src="/wiki/images/math/1/5/9/159e7a64b458d8efc8ea3b42e34b2485.png">.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2><span class="toctoggle">&nbsp;[<a href="#" id="togglelink">hide</a>]&nbsp;</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Properties"><span class="tocnumber">1</span> <span class="toctext">Properties</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Algorithms_and_variations"><span class="tocnumber">2</span> <span class="toctext">Algorithms and variations</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Naive"><span class="tocnumber">2.1</span> <span class="toctext">Naive</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Offline"><span class="tocnumber">2.2</span> <span class="toctext">Offline</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Reduction_to_RMQ"><span class="tocnumber">2.3</span> <span class="toctext">Reduction to RMQ</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#With_heavy-light_decomposition"><span class="tocnumber">2.4</span> <span class="toctext">With heavy-light decomposition</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Dynamic"><span class="tocnumber">2.5</span> <span class="toctext">Dynamic</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#References"><span class="tocnumber">3</span> <span class="toctext">References</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Properties">Properties</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit&amp;section=1" title="Edit section: Properties">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><i>The proofs of these properties are left as an exercise to the reader.</i>
</p>
<ol><li> <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(\{u\}) = u" src="/wiki/images/math/5/2/5/5255736f2ab17c70c72581b829909b59.png">.</li>
<li> <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> is an ancestor of <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png"> if and only if <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(u,v) = u" src="/wiki/images/math/c/8/2/c8238320b8654ced21c25fc6b285546d.png">.</li>
<li> If neither <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> nor <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png"> is an ancestor of the other, than <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> and <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png"> lie in different immediate subtrees of <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(u,v)" src="/wiki/images/math/e/b/9/eb99e265e48771b95570cbda4efd61bc.png">. (That is, the child of the <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(u,v)" src="/wiki/images/math/e/b/9/eb99e265e48771b95570cbda4efd61bc.png"> of which <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> is a descendant is not the same as the child of the <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(u,v)" src="/wiki/images/math/e/b/9/eb99e265e48771b95570cbda4efd61bc.png"> of which <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png"> is a descendant.) Furthermore, the <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(u,v)" src="/wiki/images/math/e/b/9/eb99e265e48771b95570cbda4efd61bc.png"> is the only node in the tree for which this is true.</li>
<li> The entire set of common ancestors of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> is given by <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(S)" src="/wiki/images/math/1/5/9/159e7a64b458d8efc8ea3b42e34b2485.png"> and all of its ancestors (all the way up to the root of the tree). In particular, every common ancestor of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> is an ancestor of <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(S)" src="/wiki/images/math/1/5/9/159e7a64b458d8efc8ea3b42e34b2485.png">.</li>
<li> <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(S)" src="/wiki/images/math/1/5/9/159e7a64b458d8efc8ea3b42e34b2485.png"> precedes all nodes in <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> in the tree's preordering, and follows all nodes in <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> in the tree's postordering.</li>
<li> If <img class="mwe-math-fallback-image-inline tex" alt="S = A \cup B" src="/wiki/images/math/f/7/2/f72805de3e933710e21d162fcae01607.png"> with <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> and <img class="mwe-math-fallback-image-inline tex" alt="B" src="/wiki/images/math/9/d/5/9d5ed678fe57bcca610140957afab571.png"> both nonempty, then <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(S) = \operatorname{LCA}(\operatorname{LCA}(A),\operatorname{LCA}(B))" src="/wiki/images/math/6/a/3/6a33cbb5beff756103d8b8a225a16525.png">. For example, <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(u,v,w) = \operatorname{LCA}(u,\operatorname{LCA}(v,w))" src="/wiki/images/math/0/7/4/074e4f0538164398facb186d94eba5ef.png">. (The LCA shares this property with the similar-sounding <a href="/wiki/Lowest_common_multiple" title="Lowest common multiple" class="mw-redirect">lowest common multiple</a> and <a href="/wiki/Greatest_common_divisor" title="Greatest common divisor">greatest common divisor</a>; and this property can be used to compute the LCA of arbitrarily large sets using only binary LCA computations.)</li>
<li> <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(u,v)" src="/wiki/images/math/e/b/9/eb99e265e48771b95570cbda4efd61bc.png"> is the unique highest (least deep) node on the unique simple path from <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> to <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png">.</li>
<li> <img class="mwe-math-fallback-image-inline tex" alt="d(u,v) = h(u) + h(v) - 2h(\operatorname{LCA}(u,v))" src="/wiki/images/math/2/b/0/2b032d1093c923122cdb171357294717.png">, where <img class="mwe-math-fallback-image-inline tex" alt="d" src="/wiki/images/math/8/2/7/8277e0910d750195b448797616e091ad.png"> represents the distance between two nodes and <img class="mwe-math-fallback-image-inline tex" alt="h" src="/wiki/images/math/2/5/1/2510c39011c5be704182423e3a695e91.png"> represents the height of a node.</li></ol>
<h2><span class="mw-headline" id="Algorithms_and_variations">Algorithms and variations</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit&amp;section=2" title="Edit section: Algorithms and variations">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>Finding the lowest common ancestor of a given pair of nodes in a given tree is an extensively studied problem.
</p>
<h3><span class="mw-headline" id="Naive">Naive</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit&amp;section=3" title="Edit section: Naive">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The <a href="/wiki/Naive_algorithm" title="Naive algorithm">naive algorithm</a> runs in <img class="mwe-math-fallback-image-inline tex" alt="O(h)" src="/wiki/images/math/0/b/a/0ba11ebdc4068356183c1d861d1c0bd8.png"> time, where <img class="mwe-math-fallback-image-inline tex" alt="h" src="/wiki/images/math/2/5/1/2510c39011c5be704182423e3a695e91.png"> is the height of the tree. It works by computing the sequences <img class="mwe-math-fallback-image-inline tex" alt="u, P(u), P(P(u)), ..., r" src="/wiki/images/math/e/f/b/efb1aa814defa4702293c4da4953e2ca.png"> (where <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png"> represents the parent of a node and <img class="mwe-math-fallback-image-inline tex" alt="r" src="/wiki/images/math/4/b/4/4b43b0aee35624cd95b910189b3dc231.png"> the root of the tree) and <img class="mwe-math-fallback-image-inline tex" alt="v, P(v), P(P(v)), ..., r" src="/wiki/images/math/5/c/8/5c8778341d105ac11ea0fb2949bd3192.png"> for the two given nodes <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> and <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png">. The first element of the longest common suffix of these two sequences is then trivially the LCA. Note that if the tree is well-balanced, then this approach will actually perform quite well (around <img class="mwe-math-fallback-image-inline tex" alt="O(\log N)" src="/wiki/images/math/7/0/6/70664169d1bc6295401283e5520056e1.png"> time per query, where <img class="mwe-math-fallback-image-inline tex" alt="N" src="/wiki/images/math/8/d/9/8d9c307cb7f3c4a32822a51922d1ceaa.png"> is the size of the tree).
</p>
<h3><span class="mw-headline" id="Offline">Offline</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit&amp;section=4" title="Edit section: Offline">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>If we want to find the LCAs of multiple pairs of nodes in the same tree, and we know all the pairs of nodes in advance, then we can use <a href="/wiki/index.php?title=Tarjan%27s_offline_LCA&amp;action=edit&amp;redlink=1" class="new" title="Tarjan's offline LCA (page does not exist)">Tarjan's offline LCA</a> algorithm. It is not easy to picture how this algorithm works, but it is quite easy to implement it. It uses <img class="mwe-math-fallback-image-inline tex" alt="O(N)" src="/wiki/images/math/3/3/6/33697ce7dfa48ba80980d298c8089378.png"> <a href="/wiki/Disjoint_set" title="Disjoint set" class="mw-redirect">disjoint set</a> operations, so can easily be made to run in <img class="mwe-math-fallback-image-inline tex" alt="O(N \alpha(N) + M)" src="/wiki/images/math/3/f/5/3f5f664e354f5dee99ab0e773b34ba5f.png"> time (where <img class="mwe-math-fallback-image-inline tex" alt="M" src="/wiki/images/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"> is the size of the input), barely slower than linear. It is also possible to implement it so that it runs in <img class="mwe-math-fallback-image-inline tex" alt="O(N+M)" src="/wiki/images/math/7/5/c/75c1b8a8b7130870779b5b720f127fa6.png"> time (that is, linear)<sup id="cite_ref-1" class="reference"><a href="#cite_note-1">[1]</a></sup>, but this is unlikely to give faster code in practice.
</p>
<h3><span class="mw-headline" id="Reduction_to_RMQ">Reduction to RMQ</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit&amp;section=5" title="Edit section: Reduction to RMQ">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<div class="thumb tright"><div class="thumbinner" style="width:202px;"><a href="/wiki/File:Lca_example_tree.png" class="image"><img alt="" src="/wiki/images/thumb/b/b0/Lca_example_tree.png/200px-Lca_example_tree.png" width="200" height="133" class="thumbimage" srcset="/wiki/images/thumb/b/b0/Lca_example_tree.png/300px-Lca_example_tree.png 1.5x, /wiki/images/thumb/b/b0/Lca_example_tree.png/400px-Lca_example_tree.png 2x"></a>  <div class="thumbcaption"><div class="magnify"><a href="/wiki/File:Lca_example_tree.png" class="internal" title="Enlarge"></a></div>Example tree for this section</div></div></div>
<p>It is possible to solve any instance of the LCA problem by reducing it to an instance of the <a href="/wiki/Range_minimum_query" title="Range minimum query">range minimum query</a> (RMQ) problem. In particular, given a rooted tree, we can construct an array with the property that the LCA of any pair of nodes in the tree can be determined by finding the RMQ of some segment of that array.
</p><p>The correct way to construct this array may be described intuitively as "walking" around the tree. The following pseudocode expresses exactly how this "walk" is constructed, using a <a href="/wiki/Depth-first_search" title="Depth-first search">depth-first search</a>:
</p>
<pre>walk(node u)
    print u
    for v ∈ u's children
        walk(v)
        print u
</pre>
<p>In other words, a node with <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> children is visited <img class="mwe-math-fallback-image-inline tex" alt="k+1" src="/wiki/images/math/a/3/1/a31a860e7a59c7616c1515ec3ae652a6.png"> times; once when we first encounter it by recursing down from its parent, and once again after each of its child subtrees has been fully explored. In the example tree shown to the right, if we assume that we visit children in left-to-right order as shown on the diagram, we obtain the ordering ABDBEBFBACGCHCA. Observe that this is the same order that we would obtain if, on the diagram, we started out on the left side of the circle containing the letter "A", and started walking down along the edge between A and B, and walked "all the way around" the tree, writing down the label of each node we touched along the way. This traversal also corresponds to an <a href="/wiki/index.php?title=Eulerian_circuit&amp;action=edit&amp;redlink=1" class="new" title="Eulerian circuit (page does not exist)">Eulerian circuit</a> of the tree, assuming that we replace each undirected edge with a pair of directed edges. Since a tree with <img class="mwe-math-fallback-image-inline tex" alt="N" src="/wiki/images/math/8/d/9/8d9c307cb7f3c4a32822a51922d1ceaa.png"> nodes has <img class="mwe-math-fallback-image-inline tex" alt="N-1" src="/wiki/images/math/5/b/1/5b1ba2fe7e642d05d58d3df27466b069.png"> edges, and each edge is traversed once in each direction, this Eulerian circuit has length <img class="mwe-math-fallback-image-inline tex" alt="2N-2" src="/wiki/images/math/e/0/9/e091ee1a7a146bfb0b66cb1300243659.png">; and hence it contains <img class="mwe-math-fallback-image-inline tex" alt="2N-1" src="/wiki/images/math/6/b/c/6bc7e010fd052fb71ce43eb7a4f471b9.png"> vertices.
</p><p>This traversal has the very useful property that between (inclusive) any occurrence of node <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> in it and any occurrence of node <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png"> in it, <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(u,v)" src="/wiki/images/math/e/b/9/eb99e265e48771b95570cbda4efd61bc.png"> is guaranteed to appear at least once, and no other node with depth less than or equal to that of <img class="mwe-math-fallback-image-inline tex" alt="\operatorname{LCA}(u,v)" src="/wiki/images/math/e/b/9/eb99e265e48771b95570cbda4efd61bc.png"> will appear at all. For example, consider the positions of D and F in the traversal ABDBEBFBACGCHCA; we see that their LCA, that is, B, occurs between them, and that the nodes C and A do not occur at all.
</p>
<dl><dd> <i>Proof</i>: First, we show that the LCA occurs, in two cases:
<ol><li> If the LCA is <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> or <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png"> itself, then without loss of generality assume it is <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png">. Then, clearly, between any occurrence of <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> and any occurrence of <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png"> (inclusive) we find an occurrence of the LCA, since the LCA is <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> itself.</li>
<li> Otherwise, <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> and <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png"> are in different subtrees of their LCA <img class="mwe-math-fallback-image-inline tex" alt="w" src="/wiki/images/math/f/1/2/f1290186a5d0b1ceab27f4e77c0c5d68.png">. Let <img class="mwe-math-fallback-image-inline tex" alt="u'" src="/wiki/images/math/d/8/6/d861d3900eda89c562d90ba7bd7fa341.png"> and <img class="mwe-math-fallback-image-inline tex" alt="v'" src="/wiki/images/math/b/3/a/b3afdc4dc7644ad636e084509b04ddab.png"> be the roots of these respective subtrees, and children of <img class="mwe-math-fallback-image-inline tex" alt="w" src="/wiki/images/math/f/1/2/f1290186a5d0b1ceab27f4e77c0c5d68.png">. From the <code>walk</code> function above, it is clear that <img class="mwe-math-fallback-image-inline tex" alt="u'" src="/wiki/images/math/d/8/6/d861d3900eda89c562d90ba7bd7fa341.png"> is first visited before any of its proper descendants (including <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png">), and after it is last visited, none of its proper descendants will ever be visited again; the same is true of <img class="mwe-math-fallback-image-inline tex" alt="v'" src="/wiki/images/math/b/3/a/b3afdc4dc7644ad636e084509b04ddab.png"> and its children, including <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png">. Since neither <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> nor <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png"> is a descendant of the other, it is clear that, without loss of generality, all the descendants in <img class="mwe-math-fallback-image-inline tex" alt="u'" src="/wiki/images/math/d/8/6/d861d3900eda89c562d90ba7bd7fa341.png"> are visited before descendants of <img class="mwe-math-fallback-image-inline tex" alt="v'" src="/wiki/images/math/b/3/a/b3afdc4dc7644ad636e084509b04ddab.png">. But <img class="mwe-math-fallback-image-inline tex" alt="w" src="/wiki/images/math/f/1/2/f1290186a5d0b1ceab27f4e77c0c5d68.png"> is visited immediately after the last occurrence of <img class="mwe-math-fallback-image-inline tex" alt="u'" src="/wiki/images/math/d/8/6/d861d3900eda89c562d90ba7bd7fa341.png">, so it will occur between any descendant of <img class="mwe-math-fallback-image-inline tex" alt="u'" src="/wiki/images/math/d/8/6/d861d3900eda89c562d90ba7bd7fa341.png"> and any descendant of <img class="mwe-math-fallback-image-inline tex" alt="v'" src="/wiki/images/math/b/3/a/b3afdc4dc7644ad636e084509b04ddab.png">. Therefore, it will occur between any occurrence of <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> and any occurrence of <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png">.</li></ol></dd>
<dd>Now, consider nodes other than the LCA that have depth less than or equal to that of the LCA. Call such a node <img class="mwe-math-fallback-image-inline tex" alt="s" src="/wiki/images/math/0/3/c/03c7c0ace395d80182db07ae2c30f034.png">. <img class="mwe-math-fallback-image-inline tex" alt="s" src="/wiki/images/math/0/3/c/03c7c0ace395d80182db07ae2c30f034.png"> is obviously not a descendant of the LCA. Notice that <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> can only be visited between the entry and exit of the instance of <code>walk</code> with the LCA as argument, and that <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png"> too can only be visited during that time. However, only descendants of the LCA can be visited during this time, so <img class="mwe-math-fallback-image-inline tex" alt="s" src="/wiki/images/math/0/3/c/03c7c0ace395d80182db07ae2c30f034.png"> cannot possibly be visited. <img class="mwe-math-fallback-image-inline tex" alt="_{\blacksquare}" src="/wiki/images/math/7/1/b/71bd29496761f73ac935924fd05288c3.png"></dd></dl>
<p>Now construct the array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> by replacing each node in the traversal described above by its depth. The example tree gives <img class="mwe-math-fallback-image-inline tex" alt="A = [0, 1, 2, 1, 2, 1, 2, 1, 0, 1, 2, 1, 2, 1, 0]" src="/wiki/images/math/0/f/c/0fccce335b76becc0459bd76a0a57568.png">. This array has size <img class="mwe-math-fallback-image-inline tex" alt="2N-1" src="/wiki/images/math/6/b/c/6bc7e010fd052fb71ce43eb7a4f471b9.png">. Given <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png"> and <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png">, locate two elements in <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">, one that corresponds to <img class="mwe-math-fallback-image-inline tex" alt="u" src="/wiki/images/math/7/b/7/7b774effe4a349c6dd82ad4f4f21d34c.png">, and one that corresponds to <img class="mwe-math-fallback-image-inline tex" alt="v" src="/wiki/images/math/9/e/3/9e3669d19b675bd57058fd4664205d2a.png">. (This can be done in constant time using a lookup table that we compute while we are doing the traversal). We know from the preceding property that the LCA is the unique shallowest node corresponding to any element located between these two elements. Therefore, by finding the position of some minimum element in this range, we will locate the LCA. So if we can answer range minimum queries in <img class="mwe-math-fallback-image-inline tex" alt="O(f(M))" src="/wiki/images/math/0/c/c/0ccf0910b709a5ec94d02e48fe5303f4.png"> time (where <img class="mwe-math-fallback-image-inline tex" alt="M" src="/wiki/images/math/6/9/6/69691c7bdcc3ce6d5d8a1361f22d04ac.png"> is the size of the array) after <img class="mwe-math-fallback-image-inline tex" alt="O(g(M))" src="/wiki/images/math/4/b/2/4b22f871373dd67a461e2a5630c794e0.png"> preprocessing time, then we can use this technique to answer LCA queries in <img class="mwe-math-fallback-image-inline tex" alt="O(f(2N-1))" src="/wiki/images/math/5/9/2/5922101e900bdcd35db527690582bda1.png"> time and <img class="mwe-math-fallback-image-inline tex" alt="O(2N-1 + g(2N-1))" src="/wiki/images/math/4/5/8/458599b486bf82081c390de60367316e.png"> preprocessing time. We do so by constructing the array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> using <img class="mwe-math-fallback-image-inline tex" alt="O(2N-1)" src="/wiki/images/math/6/7/f/67fa685080bc063fdb6ef85e95a17a27.png"> time and space, carrying out whatever preprocessing on <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> our RMQ algorithm requires, and then converting each LCA query into an RMQ.
</p><p>Since there is an algorithm that solves RMQ with linear preprocessing time and constant query time, the LCA problem can also be solved in linear preprocessing time and constant query time.
</p>
<h3><span class="mw-headline" id="With_heavy-light_decomposition">With heavy-light decomposition</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit&amp;section=6" title="Edit section: With heavy-light decomposition">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>The <a href="/wiki/Heavy-light_decomposition" title="Heavy-light decomposition">heavy-light decomposition</a> provides an easy way to ascend a tree quickly, which allows an adaptation of the naive algorithm to run in <img class="mwe-math-fallback-image-inline tex" alt="O(\log N)" src="/wiki/images/math/7/0/6/70664169d1bc6295401283e5520056e1.png"> time after linear preprocessing time. This is not asymptotically optimal, as the LCA-to-RMQ reduction discussed in the previous section allows queries to be performed in constant time. However, if the decomposition is being used for other purposes than simply answering LCA queries, then the LCA query time might not dominate the overall runtime, anyway.
</p>
<h3><span class="mw-headline" id="Dynamic">Dynamic</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit&amp;section=7" title="Edit section: Dynamic">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>In the fully dynamic variant of the LCA problem, we must be prepared to handle LCA queries intermixed with operations that change the tree (that is, rearrange the tree by adding and removing edges). In general, we suppose that we have a forest of <img class="mwe-math-fallback-image-inline tex" alt="N" src="/wiki/images/math/8/d/9/8d9c307cb7f3c4a32822a51922d1ceaa.png"> nodes in which we can arbitrarily link together two nodes from different trees, cut an edge (thus dividing a tree into two trees), or change the root of a tree on a whim, and the answer to an LCA query is either a node or the finding that the two nodes given are in different trees.
</p><p>This variant can be solved using <img class="mwe-math-fallback-image-inline tex" alt="O(\log N)" src="/wiki/images/math/7/0/6/70664169d1bc6295401283e5520056e1.png"> time for all modifications and queries. This is done by maintaining the forest using the <a href="/wiki/index.php?title=Dynamic_trees&amp;action=edit&amp;redlink=1" class="new" title="Dynamic trees (page does not exist)">dynamic trees</a> data structure with partitioning by size; this then maintains a heavy-;light decomposition of each tree, and allows LCA queries to be carried out in logarithmic time as discussed in the previous section.
</p>
<h2><span class="mw-headline" id="References">References</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit&amp;section=8" title="Edit section: References">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<ol class="references">
<li id="cite_note-1"><span class="mw-cite-backlink"><a href="#cite_ref-1"><span class="cite-accessibility-label">Jump up </span>↑</a></span> <span class="reference-text">Gabow, H. N.; Tarjan, R. E. (1983), "A linear-time algorithm for a special case of disjoint set union", <i>Proceedings of the 15th ACM Symposium on Theory of Computing (STOC)</i>, pp. 246–251, doi:10.1145/800061.808753.</span>
</li>
</ol>

<!-- 
NewPP limit report
CPU time usage: 0.126 seconds
Real time usage: 0.143 seconds
Preprocessor visited node count: 1054/1000000
Preprocessor generated node count: 2346/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:392-0!*!0!!en!5!*!math=0 and timestamp 20180430055913 and revision id 1968
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wcipeg.com/wiki/index.php?title=Lowest_common_ancestor&amp;oldid=1968">https://wcipeg.com/wiki/index.php?title=Lowest_common_ancestor&amp;oldid=1968</a>"					</div>
													<div id="catlinks" class="catlinks catlinks-allhidden"></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-createaccount"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Lowest+common+ancestor&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Lowest+common+ancestor" title="You are encouraged to log in; however, it is not mandatory [ctrl-alt-o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li id="ca-nstab-main" class="selected"><span><a href="/wiki/Lowest_common_ancestor" title="View the content page [ctrl-alt-c]" accesskey="c">Page</a></span></li>
															<li id="ca-talk" class="new"><span><a href="/wiki/index.php?title=Talk:Lowest_common_ancestor&amp;action=edit&amp;redlink=1" title="Discussion about the content page [ctrl-alt-t]" accesskey="t">Discussion</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label" tabindex="0"><span>Variants</span><a href="#" tabindex="-1"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="/wiki/Lowest_common_ancestor">Read</a></span></li>
															<li id="ca-edit"><span><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=edit" title="You can edit this page. Please use the preview button before saving [ctrl-alt-e]" accesskey="e">Edit</a></span></li>
															<span class="placeholder" style="display: none;"></span>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu" aria-labelledby="p-cactions-label" style="">
						<h3 id="p-cactions-label" tabindex="0" style="width: 61px;"><span>More</span><a href="#" tabindex="-1"></a></h3>

						<div class="menu">
							<ul><li id="ca-history" class="collapsible" style="display: list-item;"><span><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=history" title="Past revisions of this page [ctrl-alt-h]" accesskey="h">View history</a></span></li>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="/wiki/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search PEGWiki [ctrl-alt-f]" accesskey="f" id="searchInput" tabindex="1" autocomplete="off"><input type="hidden" value="Special:Search" name="title"><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton">								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="/wiki/Main_Page" title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>

			<div class="body">
									<ul>
													<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [ctrl-alt-z]" accesskey="z">Main page</a></li>
													<li id="n-Index"><a href="/wiki/Special:AllPages">Index</a></li>
													<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [ctrl-alt-r]" accesskey="r">Recent changes</a></li>
													<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random page [ctrl-alt-x]" accesskey="x">Random page</a></li>
													<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Lowest_common_ancestor" title="A list of all wiki pages that link here [ctrl-alt-j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Lowest_common_ancestor" title="Recent changes in pages linked from this page [ctrl-alt-k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [ctrl-alt-q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;printable=yes" rel="alternate" title="Printable version of this page [ctrl-alt-p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;oldid=1968" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="/wiki/index.php?title=Lowest_common_ancestor&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 5 April 2016, at 23:03.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by/3.0/">Attribution 3.0 Unported</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="/wiki/PEGWiki:Privacy_policy" title="PEGWiki:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="/wiki/PEGWiki:About" title="PEGWiki:About">About PEGWiki</a></li>
											<li id="footer-places-disclaimer"><a href="/wiki/PEGWiki:General_disclaimer" title="PEGWiki:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by/3.0/"><img src="http://i.creativecommons.org/l/by/3.0/88x31.png" alt="Attribution 3.0 Unported" width="88" height="31"></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="//www.mediawiki.org/"><img src="/wiki/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["ext.cite","mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wcipeg.com/wiki/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script><script src="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":64});
}</script>
	

<div class="suggestions" style="display: none; font-size: 13px;"><div class="suggestions-results"></div><div class="suggestions-special"></div></div></body></html>