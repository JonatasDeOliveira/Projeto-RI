<!DOCTYPE html><html lang="en"><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!-- This should probably be done with a server-side include, but
         PHP is easier. -->
    <meta name="description" content="Woburn Collegiate Institute Programming
Enrichment Group Online Judge">
<meta name="keywords" content="PEG Judge,wcipeg.com,Online judge,Canadian
Computing Competition,CCC,American Computer Science League,ACSL,Programming
Enrichment Group,Validator,COCI,Croatian Open Competition in Informatics,
Woburn,Woburn Challenge,Woburn Collegiate Institute,APIO,Asian Pacific
Informatics Olympiad,BOI,Bulgarian Olympiad in Informatics,SMAC,Sane's Monthly
Algorithms Challenge,Problem Solving in Pascal,Bi-Weekly Challenge,Validator,
Hanson Wang,Canada">

    <title>PEG Judge - IOI '13 - Dreaming</title>

    <link href="https://wcipeg.com/assets/css/common.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/submissions.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/bbcode.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/highlight/styles/idea.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/icons/favicon.ico" rel="shortcut icon" type="text/css">
    <link href="https://wcipeg.com/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/jquery.autocomplete.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/desc.css" rel="stylesheet" type="text/css">
    <link href="https://wcipeg.com/assets/css/testcase_editor.css" rel="stylesheet" type="text/css">

    <script type="text/javascript">
        function get_csrf_key() {
            return "csrf_test_name";
        }
        function get_csrf_value() {
            return "1fdbc6b8ccc7593713bd1d708ca78f1e";
        }
        function get_site_url() {
            return "https:\/\/wcipeg.com\/";
        }
    </script>
    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-1.10.1.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/jquery-post-csrf.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/global.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/js/moment-timezone.min.js"></script>    <script type="text/javascript" src="https://wcipeg.com/assets/highlight/highlight.pack.js"></script>    <script type="text/javascript">hljs.initHighlightingOnLoad();</script>
  </head>

  <body style="">
    <div id="backheader"></div>
    <div id="backmenu"></div>

    <div id="wrapper">
      <div id="container">
        <div id="header">
          <div id="logo">
            <!-- TODO: Change "PEG" to something customizable -->
            <a href="https://wcipeg.com/main"><img src="https://wcipeg.com/assets/img/logo.gif" alt="PEG"></a>          </div>
          <div id="user">
                                      Please <a href="https://wcipeg.com/auth/login?ref=%2Fproblem%2Fioi1311"><b>log in</b></a>              or <a href="https://wcipeg.com/auth/register"><b>register an account</b></a>.
                      </div> <!-- user -->
                  </div> <!-- header -->

<div id="menu">
  <ul class="nav">
        <li><a href="https://wcipeg.com/main">main</a></li>        <li><a href="https://wcipeg.com/announcements">announcements</a></li>        <li><a href="https://wcipeg.com/problems">problems</a></li>        <li><a href="https://wcipeg.com/submissions">submissions</a></li>        <li><a href="https://wcipeg.com/users">users</a></li>        <li><a href="https://wcipeg.com/organizations">organizations</a></li>        <li><a href="https://wcipeg.com/submit">submit</a></li>        <li><a href="https://wcipeg.com/contests">contests</a></li>        <li><a href="/wiki/Judge:Help" target="_blank">help (<strong>README</strong>)</a></li>        <li><a href="/wiki" target="_blank">wiki</a></li>        <li><a href="/legacy" target="_blank">old</a></li>        <li><a href="/wiki/Judge:Contact" target="_blank">contact</a></li>          </ul>
</div>

<div id="content">


<div id="descContent">
<style type="text/css">
#descContent span.nobr {
    white-space: nowrap;
}

#fancy {
    border: 1px solid #AAAAAA;
    border-collapse: collapse;
    padding: 4px 5px 4px 5px;
}

#fancy th {
    font-weight: bold;
    border: 1px solid #AAAAAA;
    text-align: left;
    background-color: #E0E0E0;
    padding: 4px 5px 4px 5px;
}

#fancy tr, td {
    border: 1px solid #AAAAAA;
    padding: 4px 5px 4px 5px;
}

#fancy tr:nth-child(even) {
    background-color: #F8F8F8;
}
</style>

<h3>IOI '13 - Brisbane, Australia</h3>
<h2>Dreaming</h2>

<p>This story takes place a long time ago, when the world was new and the IOI had not yet
been dreamt.</p>
<p>Serpent lives in a land which has <var>N</var> billabongs (water holes), numbered 0, …, <var>N</var> - 1. There are <var>M</var> bidirectional trails, joining pairs of billabongs, which Serpent can travel along. Each pair of billabongs is connected (directly or indirectly) by at most one sequence of trails, though some pairs of billabongs may not be connected at all (thus, <var>M</var> ≤ N - 1). Each trail takes a certain number of days for Serpent to travel along it: this number may be different for each trail.</p>
<p>Serpent's friend, Kangaroo, wishes to make <var>N</var> - <var>M</var> - 1 new trails, so that it is possible for Serpent to travel between any pair of billabongs. Kangaroo can create trails between any pair of billabongs, and every trail that Kangaroo creates will take <var>L</var> days for Serpent to travel along it.</p>
<p>Additionally, Kangaroo wants to make Serpent's travels as fast as possible. Kangaroo will build the new trails so that the longest travel time between any two billabongs is as small as possible. Help Kangaroo and Serpent determine the longest travel time between any two billabongs, after Kangaroo has built the new trails in this way.</p>

<h3>Examples</h3>

<p>In first the picture below there are <var>N</var> = 12 billabongs and <var>M</var> = 8 trails. Suppose that <var>L</var> = 2, so that any new trail will require Serpent 2 days to travel. Then Kangaroo could build three new trails:</p>

<ul>
<li>between billabongs 1 and 2;</li>
<li>between billabongs 1 and 6;</li>
<li>between billabongs 4 and 10.</li>
</ul>

<p>The second picture below shows the final set of trails. The longest travel time is 18 days, between billabongs 0 and 11. This is the smallest result possible - no matter how Kangaroo builds the trails, there will be some pair of billabongs that requires Serpent to travel for 18 days or more.</p>

<p style="text-align: center"><img src="images/ioi1311/ioi1311.1.png" style="margin-right: 30px;"><img src="images/ioi1311/ioi1311.2.png"></p>
<br>

<h3>Input Format</h3>

<p>The first line of the input will consist of 3 integers: <var>N</var> <span class="nobr">(1 ≤ <var>N</var> ≤ 100 000)</span>, the number of billabongs, <var>M</var> <span class="nobr">(0 ≤ <var>M</var> ≤ <var>N</var> - 1)</span>, the number of trails that already exist, and <var>L</var> <span class="nobr">(1 ≤ <var>L</var> ≤ 10 000)</span>, the time in days that it takes Serpent to travel along a new trail.</p>
<p>The remaining <var>M</var> lines of the input will each contain 3 integers A<sub>i</sub>, B<sub>i</sub> <span class="nobr">(0 ≤ A<sub>i</sub>, B<sub>i</sub> ≤ <var>N</var> - 1)</span>, and T<sub>i</sub> <span class="nobr">(0 ≤ T<sub>i</sub> ≤ <var>N</var> - 1)</span>, specifying the endpoints and travel time of each pre-existing trail, so that the i<sup>th</sup> line joins billabongs A<sub>i</sub> to B<sub>i</sub>, and takes T<sub>i</sub> days to travel in either direction.</p>

<h3>Output Format</h3>

<p>One integer - the greatest travel time (measured in days) between any pair of billabongs, assuming that Kangaroo has added <var>N</var> - <var>M</var> - 1 trails in such a way that all billabongs are connected and this greatest travel time is as small as possible.</p>
<br>

<h3>Sample Input</h3>
<pre>12 8 2
0 8 4
8 2 2
2 7 4
5 11 3
5 1 7
1 3 1
1 9 5
10 6 3</pre>

<h3>Sample Output</h3>
<pre>18</pre>
<br>

<h3>Subtasks</h3>
<table id="fancy">
<tbody><tr><th>Subtask</th><th>Percent of Points</th><th>Additional Input Constraints</th></tr>
<tr><td>1</td><td>14</td><td><var>M</var> = <var>N</var> - 2, and there are precisely one or two preexisting trails leading from each billabong.<br> In other words, there are two sets of connected billabongs, and in each set the trails form an unbranching path.</td></tr>
<tr><td>2</td><td>10</td><td><var>M</var> = <var>N</var> - 2 and <var>N</var> ≤ 100</td></tr>
<tr><td>3</td><td>23</td><td><var>M</var> = <var>N</var> - 2</td></tr>
<tr><td>4</td><td>18</td><td>There is at most one pre-existing trail leading from each billabong.</td></tr>
<tr><td>5</td><td>12</td><td><var>N</var> ≤ 3,000</td></tr>
<tr><td>6</td><td>23</td><td><i>(None)</i></td></tr>
</tbody></table>
</div>

<div id="descSidebar"> <!-- TODO: Make this nicer/more semantic -->
  <p>
        
        <a href="https://wcipeg.com/submissions/,ioi1311">All Submissions</a>    <br>
    
        <a href="https://wcipeg.com/submissions/rank/ioi1311">Best Solutions</a>        <br>
  </p>

  <p>
    
      </p>

  <p>
            <br>
  </p>

  <p>
    <!-- TODO: Move this into the controller -->
    <b>Point Value:</b> 20 (partial)<br>
    <b>Time Limit:</b> 1.00s<br>
    <b>Memory Limit:</b> 64M<br>
    <b>Added:</b> Jul 15, 2013<br>
      </p>

  
  <p>
  <b>Languages Allowed:</b><br>
  <span title="C++03 (g++ 4.1.3)">C++03</span>, <span title="Pascal (fpc 2.6.0-9)">PAS</span>, <span title="C (gcc 4.7.2)">C</span>, <span title="Haskell (ghc-6.12.1)">HASK</span>, <span title="Intel x86 assembly (nasm 2.10.01)">ASM</span>, <span title="Ruby (ruby 2.1.2)">RUBY</span>, <span title="Python 2 (python 2.6.8)">PYTH2</span>, <span title="Java (OpenJDK javac 1.7.0_03)">JAVA</span>, <span title="PHP (PHP 5.4.4)">PHP</span>, <span title="Scheme (Racket v5.0.1) (NOT WORKING)">SCM</span>, <span title="OCaml (version 3.12.1)">CAML</span>, <span title="Perl, v5.10.1">PERL</span>, <span title="C# (Mono version 2.4.4.0) (NOT WORKING)">C#</span>, <span title="C++11 (g++ 4.9.1)">C++11</span>, <span title="Python 3 (python 3.2.3)">PYTH3</span>  </p>
</div> <!-- descSidebar -->

<div id="comments">
  <h2 class="icon" style="background: url(https://wcipeg.com/assets/icons/comment_bubble.png) no-repeat right top">Comments (<a href="https://wcipeg.com/comments/search/place=ioi1311">Search</a>)</h2><p style="text-align: center"></p><div class="comment_block" id="comment8845">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/kobortor">kobortor</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/8845">Apr 21, 2018 - 3:21:46 am UTC</a>      </span>
      <a class="comment_title" id="title8845" onclick="toggle(&quot;body8845&quot;)">Submissions take way too much time.</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating8845">
    (<span class="upvotes"><span id="upvotes8845">0</span></span>/<span class="downvotes"><span id="downvotes8845">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body8845" class="comment_body">
    <pre id="msg8845" style="display: none">If often takes many minutes to complete a submission on this question, clogging up the site's judges and preventing submissions to other problems. I think PEG should either cut down on the amount of data, add a short-circuiting grader or allow users to abort wrong submissions.</pre>
    <div style="opacity: 1">
      If often takes many minutes to complete a submission on this question, clogging up the site's judges and preventing submissions to other problems. I think PEG should either cut down on the amount of data, add a short-circuiting grader or allow users to abort wrong submissions.    </div>
    <br><div class="comment_block" id="comment8846">
  <div class="comment_header" style="opacity: 1">
    <span class="comment_info">
            <b><a href="https://wcipeg.com/user/jargon">jargon</a></b>
            <span class="comment_date">
        on <a href="https://wcipeg.com/comments/thread/8846">Apr 21, 2018 - 7:48:14 pm UTC</a>      </span>
      <a class="comment_title" id="title8846" onclick="toggle(&quot;body8846&quot;)">Re: Submissions take way too much time.</a>
          </span>
    <ul class="controls">
              <li class="comment_rating" id="rating8846">
    (<span class="upvotes"><span id="upvotes8846">0</span></span>/<span class="downvotes"><span id="downvotes8846">0</span></span>)
  </li>
  </ul>  </div>
  <div id="body8846" class="comment_body">
    <pre id="msg8846" style="display: none">The wall-clock time to judge one submission seems to be about 5 minutes. A single instance of this is acceptable; while it takes some time to judge, other submissions can actually still be judged in the meanwhile.

However, making three submissions to this problem in as many minutes will indeed put significant strain on the Judge. Perhaps the best way to go about this is to give users the option of immediately halting judging, earning 0 on the remaining cases. *shrug*</pre>
    <div style="opacity: 1">
      The wall-clock time to judge one submission seems to be about 5 minutes. A single instance of this is acceptable; while it takes some time to judge, other submissions can actually still be judged in the meanwhile. <br> <br>However, making three submissions to this problem in as many minutes will indeed put significant strain on the Judge. Perhaps the best way to go about this is to give users the option of immediately halting judging, earning 0 on the remaining cases. *shrug*    </div>
      </div>
</div>
  </div>
</div>
<br>
</div>

<div style="clear: both">&nbsp;</div>

</div> <!-- content -->
</div> <!-- container -->
</div> <!-- wrapper -->

<div id="footer">
  <div id="footer_time_info">
    Loaded in 0.0221s.<br>
    Server time on page load:
    May 8, 2018 15:40:36 UTC 
    <br>
  </div>
  <div style="clear: both; height: 1ex"></div>

  <div style="float: right">
    <a href="https://wcipeg.com%2Fproblem%2Fioi1311">Secure server</a>  </div>

<a href="http://www.debian.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/debian.png" alt="Powered by Debian GNU/Linux"></a>

<a href="http://www.apache.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/apache.gif" alt="Powered by Apache"></a>

<a href="http://www.mysql.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/mysql.png" alt="Powered by MySQL"></a>

<a href="http://www.php.net" target="_blank">
  <img src="https://wcipeg.com/assets/img/php.gif" alt="Powered by PHP"> 
</a>

<a href="http://www.openssl.org" target="_blank">
  <img src="https://wcipeg.com/assets/img/openssl.png" alt="Powered by OpenSSL"> 
</a>

<a href="http://www.codeigniter.com" target="_blank">
  <img src="https://wcipeg.com/assets/img/codeignited.gif" alt="Powered by CodeIgniter"> 
</a>

<a href="http://validator.w3.org/check?uri=referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/html5.png" alt="Valid HTML 5"></a>

<a href="http://jigsaw.w3.org/css-validator/check/referer" target="_blank">
  <img src="https://wcipeg.com/assets/img/css3.png" alt="Valid CSS 3"></a>

<span title="Thanks to Naomi Cui for helping to create this image">
  <a href="http://git-scm.com/" target="_blank">
    <img src="https://wcipeg.com/assets/img/git-80x15-final.png" alt="git managed">  </a>
</span>

<br>

<div style="font-size: 85%; line-height: 1.5">
  <a href="/wiki/Judge:Copyright" target="_blank">Notes on copyright</a> |
  <a href="/wiki/Judge:TOS" target="_blank">Terms of service</a>
  <br>
  <a href="/wiki/Judge:Free_software" target="_blank">The PEG Judge is powered
  solely by free software.</a>
</div>
 
</div> <!-- footer -->



</body></html>