<!DOCTYPE html><html lang="en" dir="ltr" class="client-js"><head>
<meta charset="UTF-8">
<title>Prefix sum array and difference array - PEGWiki</title>
<meta name="generator" content="MediaWiki 1.25.2">
<link rel="alternate" type="application/x-wiki" title="Edit" href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit">
<link rel="edit" title="Edit" href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/opensearch_desc.php" title="PEGWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wcipeg.com/wiki/api.php?action=rsd">
<link rel="alternate" hreflang="x-default" href="/wiki/Prefix_sum_array_and_difference_array">
<link rel="copyright" href="http://creativecommons.org/licenses/by/3.0/">
<link rel="alternate" type="application/atom+xml" title="PEGWiki Atom feed" href="/wiki/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="canonical" href="/wiki/Prefix_sum_array_and_difference_array">
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=ext.geshi.language.c%2Ccpp%2Chaskell%7Cext.math.styles%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*">
<style>
.mw-collapsible-toggle{float:right;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}  .mw-content-ltr .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr .mw-collapsible-toggle{float:right} .mw-content-rtl .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl .mw-collapsible-toggle{float:left}.mw-customtoggle,.mw-collapsible-toggle{cursor:pointer} caption .mw-collapsible-toggle,.mw-content-ltr caption .mw-collapsible-toggle,.mw-content-rtl caption .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr caption .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl caption .mw-collapsible-toggle{float:none} li .mw-collapsible-toggle,.mw-content-ltr li .mw-collapsible-toggle,.mw-content-rtl li .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr li .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl li .mw-collapsible-toggle{float:none} .mw-collapsible-toggle-li{list-style:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:e1ffd603cbaaa5f1a36e0d13fe843535 */
.suggestions{overflow:hidden;position:absolute;top:0;left:0;width:0;border:none;z-index:1099;padding:0;margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0}.suggestions-result{color:black;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left; overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}.suggestions-result-current{background-color:#4C59A6;color:white}.suggestions-special .special-label{color:gray;text-align:left}.suggestions-special .special-query{color:black;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:silver}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:white}.highlight{font-weight:bold}
/* cache key: wikidb:resourceloader:filter:minify-css:7:f8d0c6895ce3ae14434c16b8fca59432 */
.postedit-container{margin:0 auto;position:fixed;top:0;height:0;left:50%;z-index:1000;font-size:13px}.postedit-container:hover{cursor:pointer}.postedit{position:relative;top:0.6em;left:-50%;padding:.6em 3.6em .6em 1.1em;line-height:1.5625em;color:#626465;background-color:#f4f4f4;border:1px solid #dcd9d9;text-shadow:0 0.0625em 0 rgba(255,255,255,0.5);border-radius:5px;box-shadow:0 2px 5px 0 #ccc;-webkit-transition:all 0.25s ease-in-out;-moz-transition:all 0.25s ease-in-out;-ms-transition:all 0.25s ease-in-out;-o-transition:all 0.25s ease-in-out;transition:all 0.25s ease-in-out}.skin-monobook .postedit{top:6em !important}.postedit-faded{opacity:0}.postedit-icon{padding-left:41px;  line-height:25px;background-repeat:no-repeat;background-position:8px 50%}.postedit-icon-checkmark{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABblBMVEUAAAD///////9PfTf///80aRdTgjn///9Feij///////////9Rfzf///////////9PfjZRgDh1o1xOfTb///////+bwYqLtnj///////9PfTa82K////9WhT6YxIL///9QgDdTgzr////////j7uDl7eLq8efi693k7OH///////9UhjuBr2rp9uRUhjr///9YljVKgir///9WiTlYjT3////9/v57vFlbkT5PjC9dlD/5/fhuq09stUTs9uhxuElctCpfnT1huDFloEZloUZmpENmvDZpvDxpvTxqvjxrvT5rvT9rwTxsqktswD5uwkBvuUdxw0NztFBztU9ztVBzwkp0tlJ1xkd2t1R3uVR4w1F4xk54x014yE15uVZ5v1R5xVB6v1R7yFJ8wVh9xVl9yFR9yVd9ylN+xVh+yFd/x1l/yFeAylmEx1+Ny2uY0Hqe04Wj1Ymv3Ze33qLD47TJ5L3O6cPU7Mrq9eb2+/Q4j37OAAAAQHRSTlMAAQIEBAUFBQwPFB4fJCUoKiosQEhJS01RUlZZXmdydXaChYuSlJSWmJmoq6uur8LExcvM19fg5ejt8fX2+Pr7SljgewAAAKpJREFUGBkFwQNCAwAAAMDLtl3LtrG4rWXbtvX77gAgZ6grFwC0bhwNVgKgdPZx8b0dgLi+s7Wn0VoAqpfOI9+BNADZI7fLrz2pSEwGHZuH+78lSK8ZLkLezF3ooyUG3VPXq2USei9WngeyoG195yBYWDF3E/2pAhl1e9Gr8bGT+bfOFCC2fnvh4X7rcqIAQNNu+HT6sxkAjceTL/2ZAIhv+PorBwBJxfkA//dFHSCBy/UTAAAAAElFTkSuQmCC);background-image:url(https://wcipeg.com/wiki/resources/src/mediawiki.action/images/green-checkmark.png?2015-08-10T21:21:40Z)!ie;background-position:left}.postedit-close{position:absolute;padding:0 .8em;right:0;top:0;font-size:1.25em;font-weight:bold;line-height:2.3em;color:black;text-shadow:0 0.0625em 0 white;text-decoration:none;opacity:0.2;filter:alpha(opacity=20)}.postedit-close:hover{color:black;text-decoration:none;opacity:0.4;filter:alpha(opacity=40)}
/* cache key: wikidb:resourceloader:filter:minify-css:7:86d7c89b7cadf5004340279c398253d8 */</style><style>
.suggestions a.mw-searchSuggest-link,.suggestions a.mw-searchSuggest-link:hover,.suggestions a.mw-searchSuggest-link:active,.suggestions a.mw-searchSuggest-link:focus{color:black;text-decoration:none}.suggestions-result-current a.mw-searchSuggest-link,.suggestions-result-current a.mw-searchSuggest-link:hover,.suggestions-result-current a.mw-searchSuggest-link:active,.suggestions-result-current a.mw-searchSuggest-link:focus{color:white}.suggestions a.mw-searchSuggest-link .special-query{ overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}
/* cache key: wikidb:resourceloader:filter:minify-css:7:ae3fa4570b5ac0c6cf7b3776c8ae4d6f */</style><meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*">
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:b36fd1c042133c9c9b60260f7c29b237 */</style>
<script src="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script><script src="/wiki/load.php?debug=false&amp;lang=en&amp;modules=jquery%2Cmediawiki&amp;only=scripts&amp;skin=vector&amp;version=20161103T112730Z"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Prefix_sum_array_and_difference_array","wgTitle":"Prefix sum array and difference array","wgCurRevisionId":2168,"wgRevisionId":2168,"wgArticleId":417,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages needing diagrams"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Prefix_sum_array_and_difference_array","wgRelevantArticleId":417,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgRedirectedFrom":"Prefix_sum_array","wgInternalRedirectTargetUrl":"/wiki/Prefix_sum_array_and_difference_array"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wikidb:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.redirect","mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script><script src="/wiki/load.php?debug=false&amp;lang=en&amp;modules=jquery.accessKeyLabel%2Cclient%2CmwExtension%2CtabIndex%2Cthrottle-debounce%7Cmediawiki.action.view.redirect%7Cmediawiki.legacy.ajax%2Cwikibits%7Cmediawiki.notify%2Cutil%7Cmediawiki.page.startup%7Cskins.vector.js&amp;skin=vector&amp;version=20161103T112730Z&amp;*"></script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Prefix_sum_array_and_difference_array skin-vector action-view">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<div class="mw-indicators">
</div>
			<h1 id="firstHeading" class="firstHeading" lang="en">Prefix sum array and difference array</h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From PEGWiki</div>
								<div id="contentSub"><span class="mw-redirectedfrom">(Redirected from <a href="/wiki/index.php?title=Prefix_sum_array&amp;redirect=no" title="Prefix sum array">Prefix sum array</a>)</span></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>Given an <a href="/wiki/Array" title="Array">array</a> of numbers, we can construct a new array by replacing each element by the difference between itself and the previous element, except for the first element, which we simply ignore. This is called the <b>difference array</b>, because it contains the first differences of the original array. We will denote the difference array of array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> by <img class="mwe-math-fallback-image-inline tex" alt="D(A)" src="/wiki/images/math/1/7/0/17089e81664ce583e28e592e981c96ca.png">. For example, the difference array of <img class="mwe-math-fallback-image-inline tex" alt="A = [9, 2, 6, 3, 1, 5, 0, 7]" src="/wiki/images/math/7/f/9/7f9d88c652b184dc4db1a19714f6dd80.png"> is <img class="mwe-math-fallback-image-inline tex" alt="D(A) = [2-9, 6-2, 3-6, 1-3, 5-1, 0-5, 7-0]" src="/wiki/images/math/e/3/5/e35ce6a5ac5351ad3daf63f72445d05b.png">, or <img class="mwe-math-fallback-image-inline tex" alt="[-7, 4, -3, -2, 4, -5, 7]" src="/wiki/images/math/a/d/d/add580769fa99a870317b923383072b7.png">.
</p><p>We see that the difference array can be computed in <a href="/wiki/index.php?title=Linear_time&amp;action=edit&amp;redlink=1" class="new" title="Linear time (page does not exist)">linear time</a> from the original array, and is shorter than the original array by one element. Here are implementations in C and Haskell. (Note that the Haskell implementation actually takes a list, but returns an array.)
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="c source-c"><pre class="de1"><span class="co1">// D must have enough space for n-1 ints</span>
<span class="kw4">void</span> difference_array<span class="br0">(</span><span class="kw4">int</span><span class="sy0">*</span> A<span class="sy0">,</span> <span class="kw4">int</span> n<span class="sy0">,</span> <span class="kw4">int</span><span class="sy0">*</span> D<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> n<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">)</span>
        D<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">=</span> A<span class="br0">[</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">]</span> <span class="sy0">-</span> A<span class="br0">[</span>i<span class="br0">]</span><span class="sy0">;</span>
<span class="br0">}</span></pre></div></div><br>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="haskell source-haskell"><pre class="de1">d <span class="sy0">::</span> <span class="br0">[</span><span class="kw4">Int</span><span class="br0">]</span> <span class="sy0">-&gt;</span> Array <span class="kw4">Int</span> <span class="br0">[</span><span class="kw4">Int</span><span class="br0">]</span>
d a <span class="sy0">=</span> listArray <span class="br0">(</span><span class="nu0">0</span>, <span class="kw3">length</span> a <span class="sy0">-</span> <span class="nu0">2</span><span class="br0">)</span> <span class="br0">(</span><span class="kw3">zipWith</span> <span class="br0">(</span><span class="sy0">-</span><span class="br0">)</span> <span class="br0">(</span><span class="kw3">tail</span> a<span class="br0">)</span> a<span class="br0">)</span></pre></div></div><br>
<p>The <b>prefix sum array</b> is the opposite of the difference array. Given an array of numbers <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> and an arbitrary constant <img class="mwe-math-fallback-image-inline tex" alt="c" src="/wiki/images/math/4/a/8/4a8a08f09d37b73795649038408b5f33.png">, we first append <img class="mwe-math-fallback-image-inline tex" alt="c" src="/wiki/images/math/4/a/8/4a8a08f09d37b73795649038408b5f33.png"> onto the front of the array, and then replace each element with the sum of itself and all the elements preceding it. For example, if we start with <img class="mwe-math-fallback-image-inline tex" alt="A = [9, 2, 6, 3, 1, 5, 0, 7]" src="/wiki/images/math/7/f/9/7f9d88c652b184dc4db1a19714f6dd80.png">, and choose to append the arbitrary value <img class="mwe-math-fallback-image-inline tex" alt="-8" src="/wiki/images/math/a/8/d/a8d2ec85eaf98407310b72eb73dda247.png"> to the front, we obtain <img class="mwe-math-fallback-image-inline tex" alt="P(-8, A) = [-8, -8+9, -8+9+2, -8+9+2+6, ..., -8+9+2+6+3+1+5+0+7]" src="/wiki/images/math/3/0/a/30a6494f688a01d72adad9f368016095.png">, or <img class="mwe-math-fallback-image-inline tex" alt="[-8, 1, 3, 9, 12, 13, 18, 18, 25]" src="/wiki/images/math/5/c/c/5cc1dad3f6d3c0ccea7d7d3dd92c5bc8.png">. Computing the prefix sum array can be done in linear time as well, and the prefix sum array is longer than the original array by one element:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="c source-c"><pre class="de1"><span class="co1">// P must have enough space for n+1 ints</span>
<span class="kw4">void</span> prefix_sum_array<span class="br0">(</span><span class="kw4">int</span> c<span class="sy0">,</span> <span class="kw4">int</span><span class="sy0">*</span> A<span class="sy0">,</span> <span class="kw4">int</span> n<span class="sy0">,</span> <span class="kw4">int</span><span class="sy0">*</span> P<span class="br0">)</span>
<span class="br0">{</span>
    P<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="sy0">=</span> c<span class="sy0">;</span>
    <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> n<span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">)</span>
        P<span class="br0">[</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">]</span> <span class="sy0">=</span> P<span class="br0">[</span>i<span class="br0">]</span> <span class="sy0">+</span> A<span class="br0">[</span>i<span class="br0">]</span><span class="sy0">;</span>
<span class="br0">}</span></pre></div></div><br>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="haskell source-haskell"><pre class="de1">p <span class="sy0">::</span> <span class="kw4">Int</span> <span class="sy0">-&gt;</span> <span class="br0">[</span><span class="kw4">Int</span><span class="br0">]</span> <span class="sy0">-&gt;</span> Array <span class="kw4">Int</span> <span class="br0">[</span><span class="kw4">Int</span><span class="br0">]</span>
p c a <span class="sy0">=</span> listArray <span class="br0">(</span><span class="nu0">0</span>, <span class="kw3">length</span> a<span class="br0">)</span> <span class="br0">(</span><span class="kw3">scanl</span> <span class="br0">(</span><span class="sy0">+</span><span class="br0">)</span> c a<span class="br0">)</span></pre></div></div><br>
<p>Note that every array has an infinite number of possible prefix sum arrays, since we can choose whatever value we want for <img class="mwe-math-fallback-image-inline tex" alt="c" src="/wiki/images/math/4/a/8/4a8a08f09d37b73795649038408b5f33.png">. For convenience, we usually choose <img class="mwe-math-fallback-image-inline tex" alt="c = 0" src="/wiki/images/math/6/3/3/633bff1fa0b2fabb9e12f0f4285e42cb.png">. However, changing the value of <img class="mwe-math-fallback-image-inline tex" alt="c" src="/wiki/images/math/4/a/8/4a8a08f09d37b73795649038408b5f33.png"> has only the effect of shifting all the elements of <img class="mwe-math-fallback-image-inline tex" alt="P(c,A)" src="/wiki/images/math/0/a/2/0a2cfffa25c2566f84095e5979c46a1e.png"> by a constant. For example, <img class="mwe-math-fallback-image-inline tex" alt="P(15, A) = [15, 24, 26, 32, 35, 36, 41, 41, 48]" src="/wiki/images/math/2/f/5/2f55d6c3a47d61dae3b77320f34e8d9d.png">. However, each element of <img class="mwe-math-fallback-image-inline tex" alt="P(15, A)" src="/wiki/images/math/2/4/f/24f705fb40fcd43466204a1d1eca46e0.png"> is exactly 23 more than the corresponding element from <img class="mwe-math-fallback-image-inline tex" alt="P(-8, A)" src="/wiki/images/math/d/a/f/daf4883670c70c31cf4d98b9dccd0ffb.png">.
</p><p>The functions <img class="mwe-math-fallback-image-inline tex" alt="D" src="/wiki/images/math/f/6/2/f623e75af30e62bbd73d6df5b50bb7b5.png"> and <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png"> carry out <b>reverse processes</b>. Given an nonempty zero-indexed array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">:
</p>
<ol><li> <img class="mwe-math-fallback-image-inline tex" alt="D(P(c, A)) = A" src="/wiki/images/math/1/3/c/13c64c6f230af9e025a4258f0223250d.png"> for any <img class="mwe-math-fallback-image-inline tex" alt="c" src="/wiki/images/math/4/a/8/4a8a08f09d37b73795649038408b5f33.png">. For example, taking the difference array of <img class="mwe-math-fallback-image-inline tex" alt="P(-8, A) = [-8, 1, 3, 9, 12, 13, 18, 18, 25]" src="/wiki/images/math/0/2/b/02b6898dffbc07ad061a917cb0a015c4.png"> gives <img class="mwe-math-fallback-image-inline tex" alt="[9, 2, 6, 3, 1, 5, 0, 7]" src="/wiki/images/math/a/3/e/a3e4109270a19cac82c7e91bec7564e4.png">, that is, it restores the original array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">.</li>
<li> <img class="mwe-math-fallback-image-inline tex" alt="P(A_0, D(A)) = A" src="/wiki/images/math/3/d/6/3d62bf96f2577fa3a5cacc54efd5a04e.png">. Thus, taking <img class="mwe-math-fallback-image-inline tex" alt="D(A) = [-7, 4, -3, -2, 4, -5, 7]" src="/wiki/images/math/f/4/4/f4480db6ad3c47e96c7874fcfcea1336.png"> and <img class="mwe-math-fallback-image-inline tex" alt="A_0 = 9" src="/wiki/images/math/e/c/4/ec4b3bca7794a30d22f70c3cc70d35e9.png"> (initial element of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">), we have <img class="mwe-math-fallback-image-inline tex" alt="P(A_0, D(A)) = [9, 2, 6, 3, 1, 5, 0, 7]" src="/wiki/images/math/9/7/a/97a41ef3e4d9b2e3dde402ac06122ea8.png">, again restoring the original array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">.</li></ol>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2><span class="toctoggle">&nbsp;[<a href="#" id="togglelink">hide</a>]&nbsp;</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Analogy_with_calculus"><span class="tocnumber">1</span> <span class="toctext">Analogy with calculus</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Use_of_prefix_sum_array"><span class="tocnumber">2</span> <span class="toctext">Use of prefix sum array</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Example:_Counting_Subsequences_.28SPOJ.29"><span class="tocnumber">2.1</span> <span class="toctext">Example: Counting Subsequences (SPOJ)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Use_of_difference_array"><span class="tocnumber">3</span> <span class="toctext">Use of difference array</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Example:_Wireless_.28CCC.29"><span class="tocnumber">3.1</span> <span class="toctext">Example: Wireless (CCC)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Multiple_dimensions"><span class="tocnumber">4</span> <span class="toctext">Multiple dimensions</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Prefix_sum_array"><span class="tocnumber">4.1</span> <span class="toctext">Prefix sum array</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#Example:_Diamonds_.28BOI.29"><span class="tocnumber">4.1.1</span> <span class="toctext">Example: Diamonds (BOI)</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#Difference_array"><span class="tocnumber">4.2</span> <span class="toctext">Difference array</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Example:_The_Cake_is_a_Dessert"><span class="tocnumber">4.2.1</span> <span class="toctext">Example: The Cake is a Dessert</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#A_word_on_the_dynamic_case"><span class="tocnumber">5</span> <span class="toctext">A word on the dynamic case</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Analogy_with_calculus">Analogy with calculus</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=1" title="Edit section: Analogy with calculus">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>These two processes—computing the difference array, and computing a prefix sum array—are the discrete equivalents of differentiation and integration in calculus, which operate on continuous domains. An entry in an array is like the value of a function at a particular point.
</p>
<ul><li> <i>Reverse processes</i>:</li></ul>
<dl><dd><ul><li> <img class="mwe-math-fallback-image-inline tex" alt="D(P(c, A)) = A" src="/wiki/images/math/1/3/c/13c64c6f230af9e025a4258f0223250d.png"> for any <img class="mwe-math-fallback-image-inline tex" alt="c" src="/wiki/images/math/4/a/8/4a8a08f09d37b73795649038408b5f33.png">. Likewise <img class="mwe-math-fallback-image-inline tex" alt="\frac{d}{dx} \int_c^x f(t)\, dt = f(x)" src="/wiki/images/math/6/9/4/6949b0d795606cf6cdd766c4a4cd118e.png"> for any <img class="mwe-math-fallback-image-inline tex" alt="c" src="/wiki/images/math/4/a/8/4a8a08f09d37b73795649038408b5f33.png">.</li>
<li> <img class="mwe-math-fallback-image-inline tex" alt="P(A_0, D(A)) = A" src="/wiki/images/math/3/d/6/3d62bf96f2577fa3a5cacc54efd5a04e.png">. Likewise <img class="mwe-math-fallback-image-inline tex" alt="f(a) + \int_a^x \frac{df}{dt}\, dt = f(x)" src="/wiki/images/math/a/c/b/acb2b34f1e958869612de1d3305ff7ef.png">.</li></ul></dd></dl>
<ul><li> <i>Uniqueness</i>:</li></ul>
<dl><dd><ul><li> A differentiable function <img class="mwe-math-fallback-image-inline tex" alt="f(x)" src="/wiki/images/math/5/0/b/50bbd36e1fd2333108437a2ca378be62.png"> can only have one derivative, <img class="mwe-math-fallback-image-inline tex" alt="\frac{df}{dx}" src="/wiki/images/math/f/6/8/f688b400699fb4c3ad61a00cc0e62d9d.png">. An array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> can only have one difference array, <img class="mwe-math-fallback-image-inline tex" alt="D(A)" src="/wiki/images/math/1/7/0/17089e81664ce583e28e592e981c96ca.png">.</li>
<li> A continuous function <img class="mwe-math-fallback-image-inline tex" alt="f(x)" src="/wiki/images/math/5/0/b/50bbd36e1fd2333108437a2ca378be62.png"> has an infinite number of antiderivatives, <img class="mwe-math-fallback-image-inline tex" alt="F_c(x) = \int_c^x f(t)\, dt" src="/wiki/images/math/f/6/1/f61a3dc15050384eea237b05798c8cfa.png">, where <img class="mwe-math-fallback-image-inline tex" alt="c" src="/wiki/images/math/4/a/8/4a8a08f09d37b73795649038408b5f33.png"> can be any number in its domain, but they differ only by a constant (their graphs are vertical translations of each other). An array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> has an infinite number of prefix arrays <img class="mwe-math-fallback-image-inline tex" alt="P(c,A)" src="/wiki/images/math/0/a/2/0a2cfffa25c2566f84095e5979c46a1e.png">, but they differ only by a constant (at each entry).</li></ul></dd></dl>
<ul><li> Given some function <img class="mwe-math-fallback-image-inline tex" alt="f:[a,b]\to\mathbb{R}" src="/wiki/images/math/3/3/2/332d0f0f6103ad3c4ec22d3af5b36e7c.png">, and the fact that <img class="mwe-math-fallback-image-inline tex" alt="F" src="/wiki/images/math/8/0/0/800618943025315f869e4e1f09471012.png">, an antiderivative of <img class="mwe-math-fallback-image-inline tex" alt="f" src="/wiki/images/math/8/f/a/8fa14cdd754f91cc6554c9e71929cce7.png">, satisfies <img class="mwe-math-fallback-image-inline tex" alt="F(a) = y_0" src="/wiki/images/math/b/6/e/b6e29906c06606d849c21fa87610d003.png">, we can uniquely reconstruct <img class="mwe-math-fallback-image-inline tex" alt="F" src="/wiki/images/math/8/0/0/800618943025315f869e4e1f09471012.png">. That is, even though <img class="mwe-math-fallback-image-inline tex" alt="f" src="/wiki/images/math/8/f/a/8fa14cdd754f91cc6554c9e71929cce7.png"> has an infinite number of antiderivatives, we can pin it down to one once we are given the value the antiderivative is supposed to attain on the left edge of <img class="mwe-math-fallback-image-inline tex" alt="f" src="/wiki/images/math/8/f/a/8fa14cdd754f91cc6554c9e71929cce7.png">'s domain. Likewise, given some array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> and the fact that <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png">, a prefix sum array of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">, satisfies <img class="mwe-math-fallback-image-inline tex" alt="P_0 = c" src="/wiki/images/math/9/5/d/95df46b19c447e6a01069a7e053ed1e9.png">, we can uniquely reconstruct <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png">.</li>
<li> <i>Effect on length</i>:</li></ul>
<dl><dd><ul><li> <img class="mwe-math-fallback-image-inline tex" alt="D(A)" src="/wiki/images/math/1/7/0/17089e81664ce583e28e592e981c96ca.png"> is shorter than <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> by one element. Differentiating <img class="mwe-math-fallback-image-inline tex" alt="f:[a,b] \to \mathbb{R}" src="/wiki/images/math/3/3/2/332d0f0f6103ad3c4ec22d3af5b36e7c.png"> gives a function <img class="mwe-math-fallback-image-inline tex" alt="f':(a,b) \to \mathbb{R}" src="/wiki/images/math/e/8/2/e8225c2799818c45ad63767cc86fcef2.png"> (shortens the closed interval to an open interval).</li>
<li> <img class="mwe-math-fallback-image-inline tex" alt="P(c,A)" src="/wiki/images/math/0/a/2/0a2cfffa25c2566f84095e5979c46a1e.png"> is longer than <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> by one element. Integrating <img class="mwe-math-fallback-image-inline tex" alt="f:(a,b) \to \mathbb{R}" src="/wiki/images/math/0/2/5/025555a6e2a70c44f2978bbb91a65644.png"> gives a function <img class="mwe-math-fallback-image-inline tex" alt="F:[a,b] \to \mathbb{R}" src="/wiki/images/math/1/9/b/19b17cac5b2437be7e4aa88212b6ddc4.png"> (lengthens the open interval to a closed interval).</li></ul></dd></dl>
<p>Because of these similarities, we will speak simply of <i>differentiating</i> and <i>integrating</i> arrays. An array can be differentiated multiple times, but eventually it will shrink to length 0. An array can be integrated any number of times.
</p>
<h2><span class="mw-headline" id="Use_of_prefix_sum_array">Use of prefix sum array</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=2" title="Edit section: Use of prefix sum array">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The Fundamental Theorem of Calculus also has an analogue, which is why the prefix sum array is so useful. To compute an integral <img class="mwe-math-fallback-image-inline tex" alt="\int_a^b f(t)\, dt" src="/wiki/images/math/2/7/f/27f634cd4accd9eda4b96a1424af9fd9.png">, which is like a continuous kind of sum of an infinite number of function values <img class="mwe-math-fallback-image-inline tex" alt="f(a), f(a+\epsilon), f(a+2\epsilon), ..., f(b)" src="/wiki/images/math/b/e/4/be4f0dcbeb52537a72e19de928c79880.png">, we take any antiderivative <img class="mwe-math-fallback-image-inline tex" alt="F" src="/wiki/images/math/8/0/0/800618943025315f869e4e1f09471012.png">, and compute <img class="mwe-math-fallback-image-inline tex" alt="F(b) - F(a)" src="/wiki/images/math/0/5/d/05dce1fc5a99f01613a3515624d217df.png">. Likewise, to compute the sum of values <img class="mwe-math-fallback-image-inline tex" alt="A_i, A_{i+1}, A_{i+2}, ..., A_{j-1}" src="/wiki/images/math/4/2/3/423fce97c9b4861c497a80b5933a71d0.png">, we will take any prefix array <img class="mwe-math-fallback-image-inline tex" alt="P(c,A)" src="/wiki/images/math/0/a/2/0a2cfffa25c2566f84095e5979c46a1e.png"> and compute <img class="mwe-math-fallback-image-inline tex" alt="P_j - P_i" src="/wiki/images/math/e/b/5/eb52045822f4b7786e8b1e82c872333d.png">. Notice that just as we can use any antiderivative <img class="mwe-math-fallback-image-inline tex" alt="F" src="/wiki/images/math/8/0/0/800618943025315f869e4e1f09471012.png"> because the constant cancels out, we can use any prefix sum array because the initial value cancels out. (Note our use of the <a href="/wiki/Left_half-open_interval" title="Left half-open interval" class="mw-redirect">left half-open interval</a>.)
</p><p><i>Proof</i>: <img class="mwe-math-fallback-image-inline tex" alt="P_j = c + \sum_{k=0}^{j-1} A_k" src="/wiki/images/math/d/7/7/d77c5f71323aad26048fed31682510df.png"> and <img class="mwe-math-fallback-image-inline tex" alt="P_i = c + \sum_{k=0}^{i-1} A_k" src="/wiki/images/math/d/6/0/d60d1ce148ee104fbb25e7383664c416.png">. Subtracting gives <img class="mwe-math-fallback-image-inline tex" alt="P_j - P_i = \sum_{k=0}^{j-1} A_k - \sum_{k=0}^{i-1} A_k = \sum_{k=i}^{j-1} A_k" src="/wiki/images/math/f/d/2/fd2647da0613fd93498a20bd2b9f1305.png"> as desired. <img class="mwe-math-fallback-image-inline tex" alt="_{\blacksquare}" src="/wiki/images/math/7/1/b/71bd29496761f73ac935924fd05288c3.png">
</p><p>This is best illustrated <i>via</i> example. Let <img class="mwe-math-fallback-image-inline tex" alt="A = [9,2,6,3,1,5,0,7]" src="/wiki/images/math/7/f/9/7f9d88c652b184dc4db1a19714f6dd80.png"> as before. Take <img class="mwe-math-fallback-image-inline tex" alt="P(0,A) = [0, 9, 11, 17, 20, 21, 26, 26, 33]" src="/wiki/images/math/c/4/7/c473217b3594e5fed86c3fbef7cc3894.png">. Then, suppose we want <img class="mwe-math-fallback-image-inline tex" alt="A_2 + A_3 + A_4 + A_5 = 6 + 3 + 1 + 5 = 15" src="/wiki/images/math/9/9/f/99f20f7520c5c3b93a7499d75c773efb.png">. We can compute this by taking <img class="mwe-math-fallback-image-inline tex" alt="P_6 - P_2 = 26 - 11 = 15" src="/wiki/images/math/3/b/6/3b6741b7131c4be6522202cf085fbb94.png">. This is because <img class="mwe-math-fallback-image-inline tex" alt="P_6 - P_2 = (0 + A_0 + A_1 + A_2 + A_3 + A_4 + A_5) - (0 + A_0 + A_1) = A_2 + A_3 + A_4 + A_5" src="/wiki/images/math/0/0/f/00f06cb8d61e2ba98d12216a7306c755.png">.
</p><p>When we use the prefix sum array in this case, we generally use <img class="mwe-math-fallback-image-inline tex" alt="c=0" src="/wiki/images/math/6/3/3/633bff1fa0b2fabb9e12f0f4285e42cb.png"> for convenience (although we are theoretically free to use any value we wish), and speak of the prefix sum array obtained this way as simply <i>the</i> prefix sum array.
</p>
<h3><span class="mw-headline" id="Example:_Counting_Subsequences_.28SPOJ.29">Example: Counting Subsequences (SPOJ)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=3" title="Edit section: Example: Counting Subsequences (SPOJ)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Computing the prefix sum array is rarely the most difficult part of a problem. Instead, the prefix sum array is kept on hand because the algorithm to solve the problem makes frequent reference to range sums.
</p><p>We will consider the problem <a rel="nofollow" class="external text" href="http://www.spoj.pl/problems/SUBSEQ">Counting Subsequences</a> from IPSC 2006. Here we are given an array of integers <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> and asked to find the number of contiguous subsequences of the array that sum to 47.
</p><p>To solve this, we will first transform array <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> into its prefix sum array <img class="mwe-math-fallback-image-inline tex" alt="P(0,S)" src="/wiki/images/math/9/9/8/9984740c5634e4dea6e75f631201d550.png">. Notice that the sum of each contiguous subsequence <img class="mwe-math-fallback-image-inline tex" alt="S_i + S_{i+1} + S_{i+2} + ... + S_{j-1}" src="/wiki/images/math/0/c/4/0c4f9a2eff185196f3ef851b539a4343.png"> corresponds to the difference of two elements of <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png">, that is, <img class="mwe-math-fallback-image-inline tex" alt="P_j - P_i" src="/wiki/images/math/e/b/5/eb52045822f4b7786e8b1e82c872333d.png">. So what we want to find is the number of pairs <img class="mwe-math-fallback-image-inline tex" alt="(i,j)" src="/wiki/images/math/5/2/7/5270ae675fac24f97e172dcd9b18fa92.png"> with <img class="mwe-math-fallback-image-inline tex" alt="P_j - P_i = 47" src="/wiki/images/math/9/c/b/9cb0c08c93460bb317de11e3c35f3097.png"> and <img class="mwe-math-fallback-image-inline tex" alt="i &lt; j" src="/wiki/images/math/6/1/7/617a84df314579d8a8f63efb98141f5c.png">. (Note that if <img class="mwe-math-fallback-image-inline tex" alt="i &gt; j" src="/wiki/images/math/a/a/2/aa25859cb8605531ec149d9739933158.png">, we will instead get a subsequence with sum -47.)
</p><p>However, this is quite easy to do. We sweep through <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png"> from left to right, keeping a <a href="/wiki/Map" title="Map">map</a> of all elements of <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png"> we've seen so far, along with their frequencies; and for each element <img class="mwe-math-fallback-image-inline tex" alt="P_j" src="/wiki/images/math/b/d/7/bd758bd9fc9fb546dd9882f82337a8c8.png"> we count the number of times <img class="mwe-math-fallback-image-inline tex" alt="P_j - 47" src="/wiki/images/math/2/b/0/2b061434258aa468a33a4e04c70fd7bc.png"> has appeared so far, by looking up that value in our map; this tells us how many contiguous subsequences ending at <img class="mwe-math-fallback-image-inline tex" alt="S_{j-1}" src="/wiki/images/math/a/7/8/a78cbb8a20dffa8d41924392b92af65f.png"> have sum 47. And finally, adding the number of contiguous subsequences with sum 47 ending at each entry of <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> gives the total number of such subsequences in the array. Total time taken is <img class="mwe-math-fallback-image-inline tex" alt="O(N)" src="/wiki/images/math/3/3/6/33697ce7dfa48ba80980d298c8089378.png">, if we use a <a href="/wiki/index.php?title=Hash_table&amp;action=edit&amp;redlink=1" class="new" title="Hash table (page does not exist)">hash table</a> implementation of the map.
</p>
<h2><span class="mw-headline" id="Use_of_difference_array">Use of difference array</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=4" title="Edit section: Use of difference array">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The difference array is used to keep track of an array when ranges of said array can be updated all at once. If we have array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> and add an increment <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> to elements <img class="mwe-math-fallback-image-inline tex" alt="A_i, A_{i+1}, ..., A_{j-1}" src="/wiki/images/math/c/0/6/c060db46ee724d764debbf8b568df3aa.png">, then notice that <img class="mwe-math-fallback-image-inline tex" alt="D_0, D_1, ..., D_{i-2}" src="/wiki/images/math/3/1/3/3134421ccfaa68eea95b370d80418ece.png"> are not affected; that <img class="mwe-math-fallback-image-inline tex" alt="D_{i-1} = A_i - A_{i-1}" src="/wiki/images/math/8/9/d/89d6124716f34889c4034ac51be27c72.png"> is increased by <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png">; that <img class="mwe-math-fallback-image-inline tex" alt="D_i, D_{i+1}, ..., D_{j-2}" src="/wiki/images/math/1/3/4/134bd5dcc4acf6753627436ad77c265c.png"> are not affected; that <img class="mwe-math-fallback-image-inline tex" alt="D_{j-1} = A_j - A_{j-1}" src="/wiki/images/math/5/f/7/5f7d6c237f7017d585a2a2da00b7b062.png"> is decreased by <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png">; and that <img class="mwe-math-fallback-image-inline tex" alt="D_j, D_{j+1}, ..." src="/wiki/images/math/b/d/4/bd4ec02e4da000a35c731e16ae6f2289.png"> are unaffected. Thus, if we are required to update many ranges of an array in this manner, we should keep track of <img class="mwe-math-fallback-image-inline tex" alt="D" src="/wiki/images/math/f/6/2/f623e75af30e62bbd73d6df5b50bb7b5.png"> rather than <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> itself, and then integrate at the end to reconstruct <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">.
</p>
<h3><span class="mw-headline" id="Example:_Wireless_.28CCC.29">Example: Wireless (CCC)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=5" title="Edit section: Example: Wireless (CCC)">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>This is the basis of the model solution to <a rel="nofollow" class="external text" href="https://wcipeg.com/problem/ccc09s5">Wireless</a> from CCC 2009. We are given a grid of lattice points with up to 30000 rows and up to 1000 columns, and up to 1000 circles, each of which is centered at a lattice point. Each circle has a particular weight associated with it. We want to stand at a lattice point such that the sum of the weights of all the circles covering it is maximized, and to determine how many such lattice points there are.
</p><p>The most straightforward way to do this is by actually computing the sum of weights of all covering circles at each individual lattice point. However, doing this naively would take up to <img class="mwe-math-fallback-image-inline tex" alt="30000\cdot 1000\cdot 1000 = 3\cdot 10^{10}" src="/wiki/images/math/4/5/7/457af1203861ff1c40b3694220bd4c13.png"> operations, as we would have to consider each lattice point and each circle and decide whether that circle covers that lattice point.
</p><p>To solve this, we will treat each column of the lattice as an array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">, where entry <img class="mwe-math-fallback-image-inline tex" alt="A_i" src="/wiki/images/math/e/8/a/e8aaf87d9a5c35b14cfbc370d3fd7b21.png"> denotes the sum of weights of all the circles covering the point in row <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png"> of that column. Now, consider any of the given circles. Either this circle does not cover any points in this column at all, or the points it covers in this column will all be <i>consecutive</i>. (This is equivalent to saying that the intersection of a circle with a line is a line segment.) For example, a circle centered at <img class="mwe-math-fallback-image-inline tex" alt="(2,3)" src="/wiki/images/math/5/2/0/52053dc3ca4218b698d115408e557a44.png"> with radius <img class="mwe-math-fallback-image-inline tex" alt="5" src="/wiki/images/math/e/4/d/e4da3b7fbbce2345d7772b0674a318d5.png"> will cover no lattice points with x-coordinate <img class="mwe-math-fallback-image-inline tex" alt="-10" src="/wiki/images/math/1/b/0/1b0fd9efa5279c4203b7c70233f86dbf.png">, and as for lattice points with x-coordinate <img class="mwe-math-fallback-image-inline tex" alt="1" src="/wiki/images/math/c/4/c/c4ca4238a0b923820dcc509a6f75849b.png">, it will cover <img class="mwe-math-fallback-image-inline tex" alt="(1,-1), (1,0), (1,1), (1,2), (1,3), (1,4), (1,5), (1,6), (1,7)" src="/wiki/images/math/4/1/d/41db0187475be80dec2cd8f504364f86.png">. Thus, the circle covers some first point <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png"> and some last point <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png">, and adds some value <img class="mwe-math-fallback-image-inline tex" alt="B" src="/wiki/images/math/9/d/5/9d5ed678fe57bcca610140957afab571.png"> to each point that it covers; that is, it adds <img class="mwe-math-fallback-image-inline tex" alt="B" src="/wiki/images/math/9/d/5/9d5ed678fe57bcca610140957afab571.png"> to <img class="mwe-math-fallback-image-inline tex" alt="A_i, A_{i+1}, ..., A_j" src="/wiki/images/math/a/2/4/a24c2dfca3c1081ab27b32759f88e78f.png">. Thus, we will simply maintain the difference array <img class="mwe-math-fallback-image-inline tex" alt="D" src="/wiki/images/math/f/6/2/f623e75af30e62bbd73d6df5b50bb7b5.png">, noting that the circle adds <img class="mwe-math-fallback-image-inline tex" alt="B" src="/wiki/images/math/9/d/5/9d5ed678fe57bcca610140957afab571.png"> to <img class="mwe-math-fallback-image-inline tex" alt="D_{i-1}" src="/wiki/images/math/0/a/1/0a128087c3fabc3a4844055dd9283ff2.png"> and takes <img class="mwe-math-fallback-image-inline tex" alt="B" src="/wiki/images/math/9/d/5/9d5ed678fe57bcca610140957afab571.png"> away from <img class="mwe-math-fallback-image-inline tex" alt="D_j" src="/wiki/images/math/a/1/7/a172471dc0819462c82e5509847bb796.png">. We maintain such a difference array for each column; and we perform at most two updates for each circle-column pair; so the total number of updates is bounded by <img class="mwe-math-fallback-image-inline tex" alt="2\cdot 1000\cdot 1000 = 2\cdot 10^6" src="/wiki/images/math/d/8/6/d8630804937c5975d3c6421856f5d9ec.png">. (The detail of how to keep track of the initial element of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> is left as an exercise to the reader.) After this, we perform integration on each column and find the maximum values, which requires at most a constant times the total number of lattice points, which is up to <img class="mwe-math-fallback-image-inline tex" alt="3\cdot 10^7" src="/wiki/images/math/f/e/6/fe63c01cbe0787060f165c8b107e347f.png">.
</p>
<h2><span class="mw-headline" id="Multiple_dimensions">Multiple dimensions</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=6" title="Edit section: Multiple dimensions">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The prefix sum array and difference array can be extended to multiple dimensions.
</p>
<h3><span class="mw-headline" id="Prefix_sum_array">Prefix sum array</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=7" title="Edit section: Prefix sum array">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>We start by considering the two-dimensional case. Given an <img class="mwe-math-fallback-image-inline tex" alt="m\times n" src="/wiki/images/math/c/4/f/c4f729d02a67ac278165d81c624944ca.png"> array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">, we will define the prefix sum array <img class="mwe-math-fallback-image-inline tex" alt="P(A)" src="/wiki/images/math/c/2/f/c2f209ff6eaa8536318ead1dc01a86af.png"> as follows: <img class="mwe-math-fallback-image-inline tex" alt="P_{i,j} = \sum_{k=0}^{i-1} \sum_{m=0}^{j-1} A_{k,m}" src="/wiki/images/math/c/1/e/c1ed659bdd470877a54bb0036ad79504.png">. In other words, the first row of <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png"> is all zeroes, the first column of <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png"> is all zeroes, and all other elements of <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png"> are obtained by adding up some upper-left rectangle of values of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">. For example, <img class="mwe-math-fallback-image-inline tex" alt="P_{2,3} = A_{0,0} + A_{0,1} + A_{0,2} + A_{1,0} + A_{1,1} + A_{1,2}" src="/wiki/images/math/e/5/7/e57cb329ef46333a8a8a47aa34064a57.png">. Or, more easily expressed, <img class="mwe-math-fallback-image-inline tex" alt="P_{i,j}" src="/wiki/images/math/f/2/e/f2e0adeb4b00717957465afeb0bb89c3.png"> is the sum of all entries of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> with indices in <img class="mwe-math-fallback-image-inline tex" alt="[0,i) \times [0,j)" src="/wiki/images/math/e/4/0/e40b52f307d8ef5189ca0743cee6ffd5.png"> (Cartesian product).
</p><p>In general, if we are given an <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png">-dimensional array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> with dimensions <img class="mwe-math-fallback-image-inline tex" alt="m_1 \times m_2 \times ... \times m_n" src="/wiki/images/math/9/7/d/97d6762e52238cf0e6a31db2dfb8e244.png">, then the prefix sum array has dimensions <img class="mwe-math-fallback-image-inline tex" alt="(m_1+1) \times (m_2+1) \times ... \times (m_n+1)" src="/wiki/images/math/5/8/1/5817934730227df8cc2dec4b438dca7e.png">, and is defined by <img class="mwe-math-fallback-image-inline tex" alt="P_{i_1,i_2,...,i_n} = \sum_{k_1=0}^{i_1-1} \sum_{k_2=0}^{i_2-1} ... \sum_{k_n=0}^{i_n-1} A_{k_1,k_2,...,k_n}" src="/wiki/images/math/5/4/1/5418051a93934dab23c121cea546af0d.png">; or we can simply say that it is the sum of all entries of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> with indices in <img class="mwe-math-fallback-image-inline tex" alt="[0,i_1) \times [0,i_2) \times ... \times [0,i_n)" src="/wiki/images/math/c/3/7/c3783055075bfbdfc14d4e16414f0ac1.png">.
</p><p>To compute the prefix sum array in the two-dimensional case, we will scan first down and then right, as suggested by the following C++ implementation:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><pre class="de1">vector<span class="sy1">&lt;</span>vector<span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> <span class="sy1">&gt;</span> P<span class="br0">(</span>vector<span class="sy1">&lt;</span>vector<span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> <span class="sy1">&gt;</span> A<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw4">int</span> m <span class="sy1">=</span> A.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="kw4">int</span> n <span class="sy1">=</span> A<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="co1">// Make an m+1 by n+1 array and initialize it with zeroes.</span>
    vector<span class="sy1">&lt;</span>vector<span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> <span class="sy1">&gt;</span> p<span class="br0">(</span>m<span class="sy2">+</span><span class="nu0">1</span>, vector<span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span><span class="br0">(</span>n<span class="sy2">+</span><span class="nu0">1</span>, <span class="nu0">0</span><span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i <span class="sy1">=</span> <span class="nu0">1</span><span class="sy4">;</span> i <span class="sy1">&lt;=</span> m<span class="sy4">;</span> i<span class="sy2">++</span><span class="br0">)</span>
        <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> j <span class="sy1">=</span> <span class="nu0">1</span><span class="sy4">;</span> j <span class="sy1">&lt;=</span> n<span class="sy4">;</span> j<span class="sy2">++</span><span class="br0">)</span>
            p<span class="br0">[</span>i<span class="br0">]</span><span class="br0">[</span>j<span class="br0">]</span> <span class="sy1">=</span> p<span class="br0">[</span>i<span class="sy2">-</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">[</span>j<span class="br0">]</span> <span class="sy2">+</span> A<span class="br0">[</span>i<span class="sy2">-</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">[</span>j<span class="sy2">-</span><span class="nu0">1</span><span class="br0">]</span><span class="sy4">;</span>
    <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i <span class="sy1">=</span> <span class="nu0">1</span><span class="sy4">;</span> i <span class="sy1">&lt;=</span> m<span class="sy4">;</span> i<span class="sy2">++</span><span class="br0">)</span>
        <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> j <span class="sy1">=</span> <span class="nu0">1</span><span class="sy4">;</span> j <span class="sy1">&lt;=</span> n<span class="sy4">;</span> j<span class="sy2">++</span><span class="br0">)</span>
            p<span class="br0">[</span>i<span class="br0">]</span><span class="br0">[</span>j<span class="br0">]</span> <span class="sy2">+</span><span class="sy1">=</span> p<span class="br0">[</span>i<span class="br0">]</span><span class="br0">[</span>j<span class="sy2">-</span><span class="nu0">1</span><span class="br0">]</span><span class="sy4">;</span>
    <span class="kw1">return</span> p<span class="sy4">;</span>
<span class="br0">}</span></pre></div></div><br>
<p>Here, we first make each column of <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png"> the prefix sum array of a column of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">, then convert each row of <img class="mwe-math-fallback-image-inline tex" alt="P" src="/wiki/images/math/4/4/c/44c29edb103a2872f519ad0c9a0fdaaa.png"> into its prefix sum array to obtain the final values. That is, after the first pair of for loops, <img class="mwe-math-fallback-image-inline tex" alt="P_{i,j}" src="/wiki/images/math/f/2/e/f2e0adeb4b00717957465afeb0bb89c3.png"> will be equal to <img class="mwe-math-fallback-image-inline tex" alt="A_{0,j} + A_{1,j} + ... + A_{i-1,j}" src="/wiki/images/math/c/a/3/ca3a3163aa2e464646a24bdb5c44df64.png">, and after the second pair, we will then have <img class="mwe-math-fallback-image-inline tex" alt="P_{i,j} := P_{i,0} + P_{i,1} + ... + P_{i,j-1} = (A_{0,0} + ... + A_{i-1,0}) + (A_{0,1} + ... + A_{i-1,1}) + ... + (A_{0,j-1} + ... + A_{i-1,j-1})" src="/wiki/images/math/c/9/f/c9fb19db557338db3ea253cefb3e0cd8.png">, as desired. The extension of this to more than two dimensions is straightforward.
</p><p>(Haskell code is not shown, because using functional programming in this case does not make the code nicer.)
</p><p>After the prefix sum array has been computed, we can use it to add together any rectangle in <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">, that is, all the elements with their indices in <img class="mwe-math-fallback-image-inline tex" alt="[x_1,x_2), [y_1,y_2)" src="/wiki/images/math/b/f/3/bf340686d0ae7701d57b964b9c2b0656.png">. To do so, we first observe that <img class="mwe-math-fallback-image-inline tex" alt="P_{x_2,y_2} - P_{x_1,y_2}" src="/wiki/images/math/1/2/d/12df834c910c6e5a0884819def81078b.png"> gives the sum of all the elements with indices in the box <img class="mwe-math-fallback-image-inline tex" alt="[x_1, x_2) \times [0, y_2)" src="/wiki/images/math/0/9/a/09ab39bd8d0c0984b409243d99b44eed.png">. Then we similarly observe that <img class="mwe-math-fallback-image-inline tex" alt="P_{x_2,y_1} - P_{x_1,y_1}" src="/wiki/images/math/c/a/f/cafcde0005ef11df04b640941fc0b923.png"> corresponds to the box <img class="mwe-math-fallback-image-inline tex" alt="[x_1, x_2) \times [0, y_1)" src="/wiki/images/math/5/a/6/5a67f153af858bf7761d619a5645d1ff.png">. Subtracting gives the box <img class="mwe-math-fallback-image-inline tex" alt="[x_1, x_2) \times [y_1, y_2)" src="/wiki/images/math/2/b/c/2bcd1fa3c1da607c91fb4c060dacac0e.png">. This gives a final formula of <img class="mwe-math-fallback-image-inline tex" alt="P_{x_2,y_2} - P_{x_1,y_2} - P_{x_2,y_1} + P_{x_1,y_1}" src="/wiki/images/math/7/a/c/7acb47b2dcaf45a13e96106e46ee2185.png">.
</p><p>In the <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png">-dimensional case, to sum the elements of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> with indices in the box <img class="mwe-math-fallback-image-inline tex" alt="[x_{1,0}, x_{1,1}) \times [x_{2,0}, x_{2,1}) \times ... \times [x_{n,0}, x_{n,1})" src="/wiki/images/math/b/5/b/b5b4aa9c1e109757725b7a9c59e0eba7.png">, we will use the formula <img class="mwe-math-fallback-image-inline tex" alt="\sum_{k_1=0}^1 \sum_{k_2=0}^1 ... \sum_{k_n=0}^1 (-1)^{n - k_1 - k_2 - ... - k_n} P_{x_{1,k_1}, x_{2,k_2}, ..., x_{n,k_n}}" src="/wiki/images/math/b/5/f/b5f70e12413400bde2d3ec6f26e8c61f.png">. We will not state the proof, instead noting that it is a form of the inclusion–exclusion principle.
</p>
<h4><span class="mw-headline" id="Example:_Diamonds_.28BOI.29">Example: Diamonds (BOI)</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=8" title="Edit section: Example: Diamonds (BOI)">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p>The problem <a rel="nofollow" class="external text" href="https://wcipeg.com/problem/boi09p6">Diamonds</a> from BOI '09 is a straightforward application of the prefix sum array in three dimensions. We read in a three-dimensional array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">, and then compute its prefix sum array; after doing this, we will be able to determine the sum of any box of the array with indices in the box <img class="mwe-math-fallback-image-inline tex" alt="[x_1, x_2) \times [y_1, y_2) \times [z_1, z_2)" src="/wiki/images/math/5/e/6/5e632b83ccee2e9e9d2e3864c4cd5f5f.png"> as <img class="mwe-math-fallback-image-inline tex" alt="P_{x_2,y_2,z_2} - P_{x_1,y_2,z_2} - P_{x_2,y_1,z_2} - P_{x_2,y_2,z_1} + P_{x_1,y_1,z_2} + P_{x_1,y_2,z_1} + P_{x_2,y_1,z_1} - P_{x_1,y_1,z_1}" src="/wiki/images/math/f/3/6/f363b58a2674236c8411bd7d90826bbe.png">.
</p>
<h3><span class="mw-headline" id="Difference_array">Difference array</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=9" title="Edit section: Difference array">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>To use the difference array properly in two dimensions, it is easiest to use a source array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> with the property that the first row and first column consist entirely of zeroes. (In multiple dimensions, we will want <img class="mwe-math-fallback-image-inline tex" alt="A_{i_1, i_2, ..., i_n} = 0" src="/wiki/images/math/9/a/2/9a23948695f5725af4804b04512c27e5.png"> whenever any of the <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png">'s are zero.)
</p><p>We will simply define the difference array <img class="mwe-math-fallback-image-inline tex" alt="D" src="/wiki/images/math/f/6/2/f623e75af30e62bbd73d6df5b50bb7b5.png"> to be the array whose prefix sum array is <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">. This means in particular that <img class="mwe-math-fallback-image-inline tex" alt="D_{i,j}" src="/wiki/images/math/3/3/1/331b6b0ae20707a9008b1597df4e6519.png"> is the sum of elements of <img class="mwe-math-fallback-image-inline tex" alt="D" src="/wiki/images/math/f/6/2/f623e75af30e62bbd73d6df5b50bb7b5.png"> with indices in the box <img class="mwe-math-fallback-image-inline tex" alt="[i,i+1) \times [j,j+1)" src="/wiki/images/math/1/f/7/1f71443989f17adc7dc582d390aaa92f.png"> (this box contains only the single element <img class="mwe-math-fallback-image-inline tex" alt="D_{i,j}" src="/wiki/images/math/3/3/1/331b6b0ae20707a9008b1597df4e6519.png">). Using the prefix sum array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">, we obtain <img class="mwe-math-fallback-image-inline tex" alt="D_{i,j} = A_{i+1,j+1} - A_{i,j+1} - A_{i+1,j} + A_{i,j}" src="/wiki/images/math/0/5/b/05b6074a11fd9c1e92eec8f8468a2349.png">. In general:
</p>
<dl><dd><img class="mwe-math-fallback-image-inline tex" alt="D_{i_1, i_2, ..., i_n} = \sum_{k_1=0}^1 \sum_{k_2=0}^1 ... \sum_{k_n=0}^1 (-1)^{n - k_1 - k_2 - ... - k_n} A_{i_1+k_1,i_2+k_2,...,i_n+k_n}" src="/wiki/images/math/0/f/8/0f856c84338835d47e883c49b0e8b053.png">.</dd></dl>
<p>Should we actually need to <i>compute</i> the difference array, on the other hand, the easiest way to do so is by reversing the computation of the prefix sum array:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="cpp source-cpp"><pre class="de1">vector<span class="sy1">&lt;</span>vector<span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> <span class="sy1">&gt;</span> D<span class="br0">(</span>vector<span class="sy1">&lt;</span>vector<span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> <span class="sy1">&gt;</span> A<span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw4">int</span> m <span class="sy1">=</span> A.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="kw4">int</span> n <span class="sy1">=</span> A<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span>.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="co1">// Make an m+1 by n+1 array</span>
    vector<span class="sy1">&lt;</span>vector<span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span> <span class="sy1">&gt;</span> d<span class="br0">(</span>m<span class="sy2">-</span><span class="nu0">1</span>, vector<span class="sy1">&lt;</span><span class="kw4">int</span><span class="sy1">&gt;</span><span class="br0">(</span>n<span class="sy2">-</span><span class="nu0">1</span><span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> i <span class="sy1">&lt;</span> m<span class="sy2">-</span><span class="nu0">1</span><span class="sy4">;</span> i<span class="sy2">++</span><span class="br0">)</span>
        <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> j <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> j <span class="sy1">&lt;</span> n<span class="sy2">-</span><span class="nu0">1</span><span class="sy4">;</span> j<span class="sy2">++</span><span class="br0">)</span>
            d<span class="br0">[</span>i<span class="br0">]</span><span class="br0">[</span>j<span class="br0">]</span> <span class="sy1">=</span> A<span class="br0">[</span>i<span class="sy2">+</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">[</span>j<span class="sy2">+</span><span class="nu0">1</span><span class="br0">]</span> <span class="sy2">-</span> A<span class="br0">[</span>i<span class="sy2">+</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">[</span>j<span class="br0">]</span><span class="sy4">;</span>
    <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> i <span class="sy1">=</span> m<span class="sy2">-</span><span class="nu0">2</span><span class="sy4">;</span> i <span class="sy1">&gt;</span> <span class="nu0">0</span><span class="sy4">;</span> i<span class="sy2">--</span><span class="br0">)</span>
        <span class="kw1">for</span> <span class="br0">(</span><span class="kw4">int</span> j <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> j <span class="sy1">&lt;</span> n<span class="sy2">-</span><span class="nu0">1</span><span class="sy4">;</span> j<span class="sy2">++</span><span class="br0">)</span>
            d<span class="br0">[</span>i<span class="br0">]</span><span class="br0">[</span>j<span class="br0">]</span> <span class="sy2">-</span><span class="sy1">=</span> d<span class="br0">[</span>i<span class="sy2">-</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">[</span>j<span class="br0">]</span><span class="sy4">;</span>
    <span class="kw1">return</span> d<span class="sy4">;</span>
<span class="br0">}</span></pre></div></div><br>
<p>In this code, we first make each column of <img class="mwe-math-fallback-image-inline tex" alt="D" src="/wiki/images/math/f/6/2/f623e75af30e62bbd73d6df5b50bb7b5.png"> the difference array of the corresponding column of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png">, and then treat each row as now being the prefix sum array of the final result (the row of the difference array), so we scan backward through it to reconstruct the original array (<i>i.e.</i>, take the difference array of the row). (We have to do this backward so that we won't overwrite a value we still need later.) The extension to multiple dimensions is straightforward; we simply have to walk backward over every additional dimension as well.
</p><p>Now we consider what happens when all elements of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> with coordinates in the box given by <img class="mwe-math-fallback-image-inline tex" alt="[r_1, r_2) \times [c_1, c_2)" src="/wiki/images/math/d/c/e/dce8f6c053e9094c534ebe44c3c98a80.png"> are incremented by <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png">. If we take the difference array of each column of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> now, as in the function <code>D</code> defined above, we see that for each column, we will have to add <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> to entry <img class="mwe-math-fallback-image-inline tex" alt="r_1-1" src="/wiki/images/math/0/e/f/0ef26e498ddb1888c0596f6d634f3568.png"> and subtract it from <img class="mwe-math-fallback-image-inline tex" alt="r_2-1" src="/wiki/images/math/4/b/b/4bb294d342a195f673981deb3be1eadc.png"> (as in the one-dimensional case). Now if we take the difference array of each row of what we've just obtained, we notice that in row number <img class="mwe-math-fallback-image-inline tex" alt="r_1-1" src="/wiki/images/math/0/e/f/0ef26e498ddb1888c0596f6d634f3568.png">, we've added <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> to every element in columns in <img class="mwe-math-fallback-image-inline tex" alt="[c_1,c_2)" src="/wiki/images/math/1/1/0/11051f861f566dfafdb7260a4e856e91.png"> in the previous step, and in row number <img class="mwe-math-fallback-image-inline tex" alt="r_2-1" src="/wiki/images/math/4/b/b/4bb294d342a195f673981deb3be1eadc.png">, we've subtracted <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> to every element in the same column range, so in the end the effect is to add <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> to elements <img class="mwe-math-fallback-image-inline tex" alt="D_{r_1-1,c_1-1}" src="/wiki/images/math/3/8/b/38b60ad4f35e95b06a80637a59226c26.png"> and <img class="mwe-math-fallback-image-inline tex" alt="D_{r_2-1,c_2-1}" src="/wiki/images/math/4/5/5/455b4c61911e9ef6edbae74142a2817e.png">, and to subtract <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> from elements <img class="mwe-math-fallback-image-inline tex" alt="D_{r_2-1,c_1-1}" src="/wiki/images/math/e/f/c/efc67aace068deab66424862f27c44ab.png"> and <img class="mwe-math-fallback-image-inline tex" alt="D_{r_1-1,c_2-1}" src="/wiki/images/math/d/c/9/dc998d3d0777a165fda2390c1eac1d88.png">.
</p><p>In the general case, when adding <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> to all elements of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> with indices in the box <img class="mwe-math-fallback-image-inline tex" alt="[x_{1,0}, x_{1,1}) \times [x_{2,0}, x_{2,1}) \times ... \times [x_{n,0}, x_{n,1})" src="/wiki/images/math/b/5/b/b5b4aa9c1e109757725b7a9c59e0eba7.png">, a total of <img class="mwe-math-fallback-image-inline tex" alt="2^n" src="/wiki/images/math/9/a/a/9aa0ec0374c89d2f7f3d9cd2e05a4bc5.png"> elements of <img class="mwe-math-fallback-image-inline tex" alt="D" src="/wiki/images/math/f/6/2/f623e75af30e62bbd73d6df5b50bb7b5.png"> need to be updated. In particular, element <img class="mwe-math-fallback-image-inline tex" alt="D_{x_{1,j_1}-1, x_{2,j_2}-1, ..., x_{n,j_n}-1}" src="/wiki/images/math/b/9/a/b9ac41bfef34e00a07df8daa05d54bbc.png"> (where each of the <img class="mwe-math-fallback-image-inline tex" alt="j" src="/wiki/images/math/3/6/3/363b122c528f54df4a0446b6bab05515.png">'s can be either 0 or 1, giving <img class="mwe-math-fallback-image-inline tex" alt="2^n" src="/wiki/images/math/9/a/a/9aa0ec0374c89d2f7f3d9cd2e05a4bc5.png"> possibilities in total) is incremented by <img class="mwe-math-fallback-image-inline tex" alt="(-1)^{j_1+j_2+...+j_n}k" src="/wiki/images/math/2/7/6/276fa687ef28e2168de53dd85b012260.png">. That is, if we consider an <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png">-dimensional array to be an <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png">-dimensional hypercube of numbers, then the elements to be updated lie on the corners of an <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png">-dimensional hypercube; we 2-color the vertices black and white (meaning two adjacent vertices always have opposite colours), with the lowest corner (corresponding to indices <img class="mwe-math-fallback-image-inline tex" alt="[x_{1,0}-1, x_{2,0}-1, ..., x_{n,0}-1]" src="/wiki/images/math/e/e/9/ee969b6f137475e7cbacf3b7c020acbb.png">) white; and each white vertex receiving <img class="mwe-math-fallback-image-inline tex" alt="+k" src="/wiki/images/math/3/c/0/3c0717630acbac3a17cb44dcae9ea091.png"> and each black vertex <img class="mwe-math-fallback-image-inline tex" alt="-k" src="/wiki/images/math/f/f/2/ff2bddd61609f26dc3255408781890ad.png">. One can attempt to visualize the effect this has on the prefix sum array in three dimensions, and become convinced that it makes sense in <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png"> dimensions. Each element in the prefix sum array <img class="mwe-math-fallback-image-inline tex" alt="A_{i_1, i_2, ..., i_n}" src="/wiki/images/math/0/7/f/07f8b3dd2018fb7afc3c33f4fba60a7e.png"> is the sum of all the elements in some box of the difference array with its lowest corner at the origin, <img class="mwe-math-fallback-image-inline tex" alt="[0, i_1) \times [0, i_2) \times ... \times [0, i_n)" src="/wiki/images/math/c/3/7/c3783055075bfbdfc14d4e16414f0ac1.png">. If the highest corner actually lies within the hypercube, that is, <img class="mwe-math-fallback-image-inline tex" alt="x_{1,0} \leq i_1 &lt; x_{1,1}, x_{2,0} \leq i_2 &lt; x_{2,1}, ..., x_{n,0} \leq i_n &lt; x_{n,1}" src="/wiki/images/math/3/2/0/320e2345104829119575fb1f021b15e2.png">, then this box is only going to contain the low corner <img class="mwe-math-fallback-image-inline tex" alt="D_{x_{1,0}-1, x_{2,0}-1, ..., x_{n,0}-1}" src="/wiki/images/math/7/5/f/75f16e1a01632fc17fcf961d38b276c9.png">, which has increased by <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png">; thus, this entry in <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> has increased by <img class="mwe-math-fallback-image-inline tex" alt="k" src="/wiki/images/math/8/c/e/8ce4b16b22b58894aa86c421e8759df3.png"> as well, and this is true of all elements that lie within the hypercube, <img class="mwe-math-fallback-image-inline tex" alt="[x_{1,0},x_{1,1}) \times [x_{2,0},x_{2,1}) \times ... \times [x_{n,0},x_{n,1})" src="/wiki/images/math/b/5/b/b5b4aa9c1e109757725b7a9c59e0eba7.png">. If any of the <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png">'s are less than the lower bound of the corresponding <img class="mwe-math-fallback-image-inline tex" alt="x" src="/wiki/images/math/9/d/d/9dd4e461268c8034f5c8564e155c67a6.png">, then our box doesn't hit any of the vertices of the hypercube at all, so all these elements are unaffected; and if instead any one of them goes over the upper bound, then our box passes in through one hyperface and out through another, which means that corresponding vertices on the low and high face will either both be hit or both not be hit, and each pair cancels itself out, giving again no change outside the hypercube.
</p>
<h4><span class="mw-headline" id="Example:_The_Cake_is_a_Dessert">Example: The Cake is a Dessert</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=10" title="Edit section: Example: The Cake is a Dessert">edit</a><span class="mw-editsection-bracket">]</span></span></h4>
<p><a rel="nofollow" class="external text" href="https://wcipeg.com/problem/cake">The Cake is a Dessert</a> from the Waterloo–Woburn 2011 Mock CCC is a straightforward application of the difference array in two dimensions.
</p>
<h2><span class="mw-headline" id="A_word_on_the_dynamic_case">A word on the dynamic case</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit&amp;section=11" title="Edit section: A word on the dynamic case">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The dynamic version of the problem that the prefix sum array is intended to solve requires us to be able to carry out an intermixed sequence of operations, where each operation either changes an element of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> or asks us to determine the sum <img class="mwe-math-fallback-image-inline tex" alt="A_0 + A_1 + ... + A_{i-1}" src="/wiki/images/math/8/6/7/8673492b0a8bc0ff87363b3c27f9dcdf.png"> for some <img class="mwe-math-fallback-image-inline tex" alt="i" src="/wiki/images/math/8/6/5/865c0c0b4ab0e063e5caa3387c1a8741.png">. That is, we need to be able to compute entries of the prefix sum array of an array that is changing (dynamic). If we can do this, then we can do range sum queries easily on a dynamic array, simply by taking the difference of prefix sums as in the static case. This is a bit trickier to do, but is most easily and efficiently accomplished using the <a href="/wiki/index.php?title=Binary_indexed_tree&amp;action=edit&amp;redlink=1" class="new" title="Binary indexed tree (page does not exist)">binary indexed tree</a> data structure, which is specifically designed to solve this problem and can be updated in <img class="mwe-math-fallback-image-inline tex" alt="O(\log(m_1) \log(m_2) ... \log(m_n))" src="/wiki/images/math/8/4/a/84a20b36d4be06de06d58cb5cfe98f22.png"> time, where <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png"> is the number of dimensions and each <img class="mwe-math-fallback-image-inline tex" alt="m" src="/wiki/images/math/6/f/8/6f8f57715090da2632453988d9a1501b.png"> is a dimension. Each prefix sum query also takes that amount of time, but we need to perform <img class="mwe-math-fallback-image-inline tex" alt="2^n" src="/wiki/images/math/9/a/a/9aa0ec0374c89d2f7f3d9cd2e05a4bc5.png"> of these to find a box sum using the formula given previously, so the running time of the query is asymptotically <img class="mwe-math-fallback-image-inline tex" alt="2^n" src="/wiki/images/math/9/a/a/9aa0ec0374c89d2f7f3d9cd2e05a4bc5.png"> times greater than that of the update. In the most commonly encountered one-dimensional case, both query and update are simply <img class="mwe-math-fallback-image-inline tex" alt="O(\log m)" src="/wiki/images/math/9/b/6/9b6948075e3f7593be5aba1356146311.png">.
</p><p>The dynamic version of the problem that the difference array is intended to solve is analogous: we want to be able to increment entire ranges of an array, but at any point we also want to be able to determine any element of the array. Here, we simply use a binary indexed tree for the difference array, and compute prefix sums whenever we want to access an element. Here, it is the update that is slower by a factor of <img class="mwe-math-fallback-image-inline tex" alt="2^n" src="/wiki/images/math/9/a/a/9aa0ec0374c89d2f7f3d9cd2e05a4bc5.png"> than the query (because we have to update <img class="mwe-math-fallback-image-inline tex" alt="2^n" src="/wiki/images/math/9/a/a/9aa0ec0374c89d2f7f3d9cd2e05a4bc5.png"> entries at a time, but only query one.)
</p><p>On the other hand, if we combine the two, that is, we wish to be able to increment ranges of some array <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> as well as query prefix sums of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> in an intermixed sequence, matters become more complicated. Notice that in the static case we would just track the difference array of <img class="mwe-math-fallback-image-inline tex" alt="A" src="/wiki/images/math/7/f/c/7fc56270e7a70fa81a5935b72eacbe29.png"> and then integrate twice at the end. In the dynamic case, however, we need to use a <a href="/wiki/Segment_tree" title="Segment tree">segment tree</a> with lazy propagation. This will give us <img class="mwe-math-fallback-image-inline tex" alt="O(2^n \log(m_1) \log(m_2) ... \log(m_n))" src="/wiki/images/math/b/5/d/b5de506c7004751542fff04f588838c9.png"> time on both the query and the update, but is somewhat more complex and slower than the binary indexed tree on the <a href="/wiki/Invisible_constant_factor" title="Invisible constant factor" class="mw-redirect">invisible constant factor</a>.
</p>
<!-- 
NewPP limit report
CPU time usage: 0.293 seconds
Real time usage: 0.331 seconds
Preprocessor visited node count: 2313/1000000
Preprocessor generated node count: 5344/1000000
Post‐expand include size: 371/2097152 bytes
Template argument size: 82/2097152 bytes
Highest expansion depth: 4/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%  147.005      1 - -total
  5.80%    8.527      3 - Template:Problem
  3.36%    4.942      3 - Template:JudgeRoot
  1.65%    2.419      3 - Template:Root
  1.53%    2.253      1 - Template:SPOJ
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:417-0!*!0!!en!*!*!math=0 and timestamp 20180430203505 and revision id 2168
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wcipeg.com/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;oldid=2168">https://wcipeg.com/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;oldid=2168</a>"					</div>
													<div id="catlinks" class="catlinks"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/wiki/Category:Pages_needing_diagrams" title="Category:Pages needing diagrams">Pages needing diagrams</a></li></ul></div></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-createaccount"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Prefix+sum+array+and+difference+array&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Prefix+sum+array+and+difference+array" title="You are encouraged to log in; however, it is not mandatory [ctrl-alt-o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li id="ca-nstab-main" class="selected"><span><a href="/wiki/Prefix_sum_array_and_difference_array" title="View the content page [ctrl-alt-c]" accesskey="c">Page</a></span></li>
															<li id="ca-talk" class="new"><span><a href="/wiki/index.php?title=Talk:Prefix_sum_array_and_difference_array&amp;action=edit&amp;redlink=1" title="Discussion about the content page [ctrl-alt-t]" accesskey="t">Discussion</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label" tabindex="0"><span>Variants</span><a href="#" tabindex="-1"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="/wiki/Prefix_sum_array_and_difference_array">Read</a></span></li>
															<li id="ca-edit"><span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=edit" title="You can edit this page. Please use the preview button before saving [ctrl-alt-e]" accesskey="e">Edit</a></span></li>
															<span class="placeholder" style="display: none;"></span>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu" aria-labelledby="p-cactions-label" style="">
						<h3 id="p-cactions-label" tabindex="0" style="width: 61px;"><span>More</span><a href="#" tabindex="-1"></a></h3>

						<div class="menu">
							<ul><li id="ca-history" class="collapsible" style="display: list-item;"><span><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=history" title="Past revisions of this page [ctrl-alt-h]" accesskey="h">View history</a></span></li>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="/wiki/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search PEGWiki [ctrl-alt-f]" accesskey="f" id="searchInput" tabindex="1" autocomplete="off"><input type="hidden" value="Special:Search" name="title"><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton">								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="/wiki/Main_Page" title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>

			<div class="body">
									<ul>
													<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [ctrl-alt-z]" accesskey="z">Main page</a></li>
													<li id="n-Index"><a href="/wiki/Special:AllPages">Index</a></li>
													<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [ctrl-alt-r]" accesskey="r">Recent changes</a></li>
													<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random page [ctrl-alt-x]" accesskey="x">Random page</a></li>
													<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Prefix_sum_array_and_difference_array" title="A list of all wiki pages that link here [ctrl-alt-j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Prefix_sum_array_and_difference_array" title="Recent changes in pages linked from this page [ctrl-alt-k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [ctrl-alt-q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;printable=yes" rel="alternate" title="Printable version of this page [ctrl-alt-p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;oldid=2168" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="/wiki/index.php?title=Prefix_sum_array_and_difference_array&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 26 March 2018, at 22:16.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by/3.0/">Attribution 3.0 Unported</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="/wiki/PEGWiki:Privacy_policy" title="PEGWiki:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="/wiki/PEGWiki:About" title="PEGWiki:About">About PEGWiki</a></li>
											<li id="footer-places-disclaimer"><a href="/wiki/PEGWiki:General_disclaimer" title="PEGWiki:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by/3.0/"><img src="http://i.creativecommons.org/l/by/3.0/88x31.png" alt="Attribution 3.0 Unported" width="88" height="31"></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="//www.mediawiki.org/"><img src="/wiki/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wcipeg.com/wiki/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script><script src="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":70});
}</script>
	

<div class="suggestions" style="display: none; font-size: 13px;"><div class="suggestions-results"></div><div class="suggestions-special"></div></div></body></html>