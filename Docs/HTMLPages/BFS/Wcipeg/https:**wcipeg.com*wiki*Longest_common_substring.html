<!DOCTYPE html><html lang="en" dir="ltr" class="client-js"><head>
<meta charset="UTF-8">
<title>Longest common substring - PEGWiki</title>
<meta name="generator" content="MediaWiki 1.25.2">
<link rel="alternate" type="application/x-wiki" title="Edit" href="/wiki/index.php?title=Longest_common_substring&amp;action=edit">
<link rel="edit" title="Edit" href="/wiki/index.php?title=Longest_common_substring&amp;action=edit">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/opensearch_desc.php" title="PEGWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wcipeg.com/wiki/api.php?action=rsd">
<link rel="alternate" hreflang="x-default" href="/wiki/Longest_common_substring">
<link rel="copyright" href="http://creativecommons.org/licenses/by/3.0/">
<link rel="alternate" type="application/atom+xml" title="PEGWiki Atom feed" href="/wiki/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=ext.math.styles%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cmediawiki.ui.button%7Cskins.vector.styles&amp;only=styles&amp;skin=vector&amp;*">
<style>
.mw-collapsible-toggle{float:right;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}  .mw-content-ltr .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr .mw-collapsible-toggle{float:right} .mw-content-rtl .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl .mw-collapsible-toggle{float:left}.mw-customtoggle,.mw-collapsible-toggle{cursor:pointer} caption .mw-collapsible-toggle,.mw-content-ltr caption .mw-collapsible-toggle,.mw-content-rtl caption .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr caption .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl caption .mw-collapsible-toggle{float:none} li .mw-collapsible-toggle,.mw-content-ltr li .mw-collapsible-toggle,.mw-content-rtl li .mw-collapsible-toggle,.mw-content-rtl .mw-content-ltr li .mw-collapsible-toggle,.mw-content-ltr .mw-content-rtl li .mw-collapsible-toggle{float:none} .mw-collapsible-toggle-li{list-style:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:e1ffd603cbaaa5f1a36e0d13fe843535 */
.suggestions{overflow:hidden;position:absolute;top:0;left:0;width:0;border:none;z-index:1099;padding:0;margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0}.suggestions-result{color:black;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left; overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}.suggestions-result-current{background-color:#4C59A6;color:white}.suggestions-special .special-label{color:gray;text-align:left}.suggestions-special .special-query{color:black;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:silver}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:white}.highlight{font-weight:bold}
/* cache key: wikidb:resourceloader:filter:minify-css:7:f8d0c6895ce3ae14434c16b8fca59432 */
.postedit-container{margin:0 auto;position:fixed;top:0;height:0;left:50%;z-index:1000;font-size:13px}.postedit-container:hover{cursor:pointer}.postedit{position:relative;top:0.6em;left:-50%;padding:.6em 3.6em .6em 1.1em;line-height:1.5625em;color:#626465;background-color:#f4f4f4;border:1px solid #dcd9d9;text-shadow:0 0.0625em 0 rgba(255,255,255,0.5);border-radius:5px;box-shadow:0 2px 5px 0 #ccc;-webkit-transition:all 0.25s ease-in-out;-moz-transition:all 0.25s ease-in-out;-ms-transition:all 0.25s ease-in-out;-o-transition:all 0.25s ease-in-out;transition:all 0.25s ease-in-out}.skin-monobook .postedit{top:6em !important}.postedit-faded{opacity:0}.postedit-icon{padding-left:41px;  line-height:25px;background-repeat:no-repeat;background-position:8px 50%}.postedit-icon-checkmark{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABblBMVEUAAAD///////9PfTf///80aRdTgjn///9Feij///////////9Rfzf///////////9PfjZRgDh1o1xOfTb///////+bwYqLtnj///////9PfTa82K////9WhT6YxIL///9QgDdTgzr////////j7uDl7eLq8efi693k7OH///////9UhjuBr2rp9uRUhjr///9YljVKgir///9WiTlYjT3////9/v57vFlbkT5PjC9dlD/5/fhuq09stUTs9uhxuElctCpfnT1huDFloEZloUZmpENmvDZpvDxpvTxqvjxrvT5rvT9rwTxsqktswD5uwkBvuUdxw0NztFBztU9ztVBzwkp0tlJ1xkd2t1R3uVR4w1F4xk54x014yE15uVZ5v1R5xVB6v1R7yFJ8wVh9xVl9yFR9yVd9ylN+xVh+yFd/x1l/yFeAylmEx1+Ny2uY0Hqe04Wj1Ymv3Ze33qLD47TJ5L3O6cPU7Mrq9eb2+/Q4j37OAAAAQHRSTlMAAQIEBAUFBQwPFB4fJCUoKiosQEhJS01RUlZZXmdydXaChYuSlJSWmJmoq6uur8LExcvM19fg5ejt8fX2+Pr7SljgewAAAKpJREFUGBkFwQNCAwAAAMDLtl3LtrG4rWXbtvX77gAgZ6grFwC0bhwNVgKgdPZx8b0dgLi+s7Wn0VoAqpfOI9+BNADZI7fLrz2pSEwGHZuH+78lSK8ZLkLezF3ooyUG3VPXq2USei9WngeyoG195yBYWDF3E/2pAhl1e9Gr8bGT+bfOFCC2fnvh4X7rcqIAQNNu+HT6sxkAjceTL/2ZAIhv+PorBwBJxfkA//dFHSCBy/UTAAAAAElFTkSuQmCC);background-image:url(https://wcipeg.com/wiki/resources/src/mediawiki.action/images/green-checkmark.png?2015-08-10T21:21:40Z)!ie;background-position:left}.postedit-close{position:absolute;padding:0 .8em;right:0;top:0;font-size:1.25em;font-weight:bold;line-height:2.3em;color:black;text-shadow:0 0.0625em 0 white;text-decoration:none;opacity:0.2;filter:alpha(opacity=20)}.postedit-close:hover{color:black;text-decoration:none;opacity:0.4;filter:alpha(opacity=40)}
/* cache key: wikidb:resourceloader:filter:minify-css:7:86d7c89b7cadf5004340279c398253d8 */</style><style>
.suggestions a.mw-searchSuggest-link,.suggestions a.mw-searchSuggest-link:hover,.suggestions a.mw-searchSuggest-link:active,.suggestions a.mw-searchSuggest-link:focus{color:black;text-decoration:none}.suggestions-result-current a.mw-searchSuggest-link,.suggestions-result-current a.mw-searchSuggest-link:hover,.suggestions-result-current a.mw-searchSuggest-link:active,.suggestions-result-current a.mw-searchSuggest-link:focus{color:white}.suggestions a.mw-searchSuggest-link .special-query{ overflow:hidden;-o-text-overflow:ellipsis; text-overflow:ellipsis;white-space:nowrap}
/* cache key: wikidb:resourceloader:filter:minify-css:7:ae3fa4570b5ac0c6cf7b3776c8ae4d6f */</style><meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=vector&amp;*">
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wikidb:resourceloader:filter:minify-css:7:b36fd1c042133c9c9b60260f7c29b237 */</style>
<script src="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector&amp;*"></script><script src="/wiki/load.php?debug=false&amp;lang=en&amp;modules=jquery%2Cmediawiki&amp;only=scripts&amp;skin=vector&amp;version=20161103T112730Z"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Longest_common_substring","wgTitle":"Longest common substring","wgCurRevisionId":1332,"wgRevisionId":1332,"wgArticleId":210,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Longest_common_substring","wgRelevantArticleId":210,"wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[]});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});
/* cache key: wikidb:resourceloader:filter:minify-js:7:a5c52c063dc436c1ca7c9f456936a5e9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script><script src="/wiki/load.php?debug=false&amp;lang=en&amp;modules=jquery.accessKeyLabel%2Cclient%2CmwExtension%2CtabIndex%2Cthrottle-debounce%7Cmediawiki.legacy.ajax%2Cwikibits%7Cmediawiki.notify%2Cutil%7Cmediawiki.page.startup%7Cskins.vector.js&amp;skin=vector&amp;version=20161103T112730Z&amp;*"></script>
<!--[if lt IE 7]><style type="text/css">body{behavior:url("/wiki/skins/Vector/csshover.min.htc")}</style><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Longest_common_substring skin-vector action-view">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>

						<div class="mw-indicators">
</div>
			<h1 id="firstHeading" class="firstHeading" lang="en">Longest common substring</h1>
						<div id="bodyContent" class="mw-body-content">
									<div id="siteSub">From PEGWiki</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p><i>Not to be confused with <a href="/wiki/Longest_common_subsequence" title="Longest common subsequence">Longest common subsequence</a>.</i>
</p><p>The <b>longest common substring (LCS)</b> problem is the problem of finding a string of maximum length which is simultaneously a substring of two or more given strings (usually two). For example, the longest common substring of <b>atlas</b> and <b>elastic</b> is <b>las</b>. This problem is much less applicable (in real life) than the more error-tolerant <a href="/wiki/Longest_common_subsequence" title="Longest common subsequence">longest common subsequence</a> problem, but it is theoretically interesting.
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2><span class="toctoggle">&nbsp;[<a href="#" id="togglelink">hide</a>]&nbsp;</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Discussion"><span class="tocnumber">1</span> <span class="toctext">Discussion</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Dynamic_programming_solution"><span class="tocnumber">2</span> <span class="toctext">Dynamic programming solution</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#More_efficient_solution"><span class="tocnumber">3</span> <span class="toctext">More efficient solution</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Suffix_tree"><span class="tocnumber">3.1</span> <span class="toctext">Suffix tree</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Suffix_array"><span class="tocnumber">3.2</span> <span class="toctext">Suffix array</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Discussion">Discussion</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Longest_common_substring&amp;action=edit&amp;section=1" title="Edit section: Discussion">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>We can observe immediately that this problem is solvable in polynomial time, because a string of length <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png"> has <img class="mwe-math-fallback-image-inline tex" alt="O(n^2)" src="/wiki/images/math/1/8/9/189317b4b935a745fcfaf95940d2b4f0.png"> substrings, allowing us to simply list all substrings of each string and then find the longest entry(ies) common to both strings. This, however, gives <img class="mwe-math-fallback-image-inline tex" alt="O(n^3+m)" src="/wiki/images/math/3/3/7/337cd6b336562986ad970b18520ab7e9.png"> time (assuming we have two strings of lengths <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png"> and <img class="mwe-math-fallback-image-inline tex" alt="m" src="/wiki/images/math/6/f/8/6f8f57715090da2632453988d9a1501b.png"> and we use an efficient <a href="/wiki/String_search" title="String search" class="mw-redirect">string search</a> algorithm). In addressing the question of whether it is possible to do better, we at first consider three variations on the problem:
</p>
<ul><li> Return <i>all</i> LCSes. There may only be <img class="mwe-math-fallback-image-inline tex" alt="O(\min(n,m))" src="/wiki/images/math/4/d/b/4db697a36c09d4b42694c7a7a551d373.png"> of these, where <img class="mwe-math-fallback-image-inline tex" alt="m" src="/wiki/images/math/6/f/8/6f8f57715090da2632453988d9a1501b.png"> is the length of the first string and <img class="mwe-math-fallback-image-inline tex" alt="n" src="/wiki/images/math/7/b/8/7b8b965ad4bca0e41ab51de7b31363a1.png"> is the length of the second. This is because there are only <img class="mwe-math-fallback-image-inline tex" alt="m-x+1" src="/wiki/images/math/8/8/e/88e76b0b97207638a56dbf6e071d708e.png"> substrings of any given length <img class="mwe-math-fallback-image-inline tex" alt="x" src="/wiki/images/math/9/d/d/9dd4e461268c8034f5c8564e155c67a6.png"> in the first string, and <img class="mwe-math-fallback-image-inline tex" alt="n-x+1" src="/wiki/images/math/7/3/e/73ef9e8761499fdf477bcf78345d19d3.png"> in the second string.</li>
<li> Return <i>any</i> LCS.</li>
<li> Return only the <i>length</i> of an LCS.</li></ul>
<p>We shall see that all three variations can be solved in linear time, no matter how many strings are given in input.
</p>
<h2><span class="mw-headline" id="Dynamic_programming_solution">Dynamic programming solution</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Longest_common_substring&amp;action=edit&amp;section=2" title="Edit section: Dynamic programming solution">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p><a href="/wiki/Dynamic_programming" title="Dynamic programming">Dynamic programming</a> admits a solution with time and space polynomial in the lengths of the strings involved but exponential in the number of strings. Nevertheless, it is the recommended method for two strings of length at most a few thousand, because of its simplicity. The reasoning is along the same lines as that used to solve the <a href="/wiki/Longest_common_subsequence" title="Longest common subsequence">longest common subsequence</a> problem. Let the two strings be denoted <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png">, where <img class="mwe-math-fallback-image-inline tex" alt="S" src="/wiki/images/math/5/d/b/5dbc98dcc983a70728bd082d1a47546e.png"> has characters <img class="mwe-math-fallback-image-inline tex" alt="S_1, S_2, ..., S_m" src="/wiki/images/math/4/5/e/45e39ca81d34f3a67e23329fe78b0e40.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T" src="/wiki/images/math/b/9/e/b9ece18c950afbfa6b0fdbfa4ff731d3.png"> has characters <img class="mwe-math-fallback-image-inline tex" alt="T_1, T_2, ..., T_n" src="/wiki/images/math/5/9/d/59d2cb4eadb87aca2355dca2eaf4863c.png">. Define <img class="mwe-math-fallback-image-inline tex" alt="f(i,j)" src="/wiki/images/math/b/2/a/b2a4a0f9166881f2eb72bbbc8db92995.png"> for each <img class="mwe-math-fallback-image-inline tex" alt="1 \leq i \leq m, 1 \leq j \leq n" src="/wiki/images/math/7/2/3/72385cea2bf3de4644fc43271e934b78.png"> to be the length of the longest common substring ending at <img class="mwe-math-fallback-image-inline tex" alt="S_i" src="/wiki/images/math/5/7/3/57322f88a90b4fc9a5da1f5d01a8f6ea.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T_j" src="/wiki/images/math/6/3/6/6361fc85c03558be3587efd764461a01.png">. Then:
</p>
<ol><li> Define <img class="mwe-math-fallback-image-inline tex" alt="f(i,j) = 0" src="/wiki/images/math/9/3/7/9379aac2e1f1169f9065d1a23ba6bcd2.png"> if <img class="mwe-math-fallback-image-inline tex" alt="i = 0" src="/wiki/images/math/8/a/8/8a8f1e8e0a73d8e44a17653f830f7947.png"> or <img class="mwe-math-fallback-image-inline tex" alt="j = 0" src="/wiki/images/math/8/c/e/8ce91474779c9115367408f3651ba4e6.png">.</li>
<li> Observe that if <img class="mwe-math-fallback-image-inline tex" alt="S_i \neq T_j" src="/wiki/images/math/a/4/f/a4f850822e8aefb20de0e759f9720eff.png">, then <img class="mwe-math-fallback-image-inline tex" alt="f(i,j) = 0" src="/wiki/images/math/9/3/7/9379aac2e1f1169f9065d1a23ba6bcd2.png">.</li>
<li> If <img class="mwe-math-fallback-image-inline tex" alt="S_i = T_j" src="/wiki/images/math/e/0/d/e0da0cfd031e538fadc572fbdc6a4abc.png">, then <img class="mwe-math-fallback-image-inline tex" alt="f(i,j) \geq 1" src="/wiki/images/math/d/7/9/d796d7edbe08fe95bd1f9fc06716dfaf.png">. In particular, if <img class="mwe-math-fallback-image-inline tex" alt="x = f(i-1,j-1)" src="/wiki/images/math/3/c/b/3cb6a8a70cf7633ea14fb953cf9555b8.png">, that is, there is a common substring of length <img class="mwe-math-fallback-image-inline tex" alt="x" src="/wiki/images/math/9/d/d/9dd4e461268c8034f5c8564e155c67a6.png"> ending at <img class="mwe-math-fallback-image-inline tex" alt="S_{i-1}" src="/wiki/images/math/b/a/8/ba8eb32a5251faa4e4841c9fbd4be599.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T_{j-1}" src="/wiki/images/math/a/5/7/a577df93f37516dcf5a3ba477d5f23b2.png"> (but no longer), then appending <img class="mwe-math-fallback-image-inline tex" alt="S_i" src="/wiki/images/math/5/7/3/57322f88a90b4fc9a5da1f5d01a8f6ea.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T_j" src="/wiki/images/math/6/3/6/6361fc85c03558be3587efd764461a01.png"> gives a common substring of length <img class="mwe-math-fallback-image-inline tex" alt="x+1" src="/wiki/images/math/c/f/2/cf267a0bc414e4ea2681d6bd522a8992.png"> ending at <img class="mwe-math-fallback-image-inline tex" alt="S_i" src="/wiki/images/math/5/7/3/57322f88a90b4fc9a5da1f5d01a8f6ea.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T_j" src="/wiki/images/math/6/3/6/6361fc85c03558be3587efd764461a01.png">. Thus <img class="mwe-math-fallback-image-inline tex" alt="f(i,j) = x+1 = 1 + f(i-1,j-1)" src="/wiki/images/math/5/0/5/505183b7a2741715d1a0d00f1444e7a9.png">.</li>
<li> Clearly, the length of the LCS overall is <img class="mwe-math-fallback-image-inline tex" alt="\max_{i,j} f" src="/wiki/images/math/4/6/4/464690b9c75d7d387955ed4a55680bd6.png">. Each pair <img class="mwe-math-fallback-image-inline tex" alt="(i,j)" src="/wiki/images/math/5/2/7/5270ae675fac24f97e172dcd9b18fa92.png"> for which <img class="mwe-math-fallback-image-inline tex" alt="f(i,j) = \max_{i,j} f" src="/wiki/images/math/9/1/f/91fdb49ce19527616c63d6701a3ebb6c.png"> corresponds to a longest common substring ending at <img class="mwe-math-fallback-image-inline tex" alt="S_i" src="/wiki/images/math/5/7/3/57322f88a90b4fc9a5da1f5d01a8f6ea.png"> and <img class="mwe-math-fallback-image-inline tex" alt="T_j" src="/wiki/images/math/6/3/6/6361fc85c03558be3587efd764461a01.png">.</li></ol>
<p>Thus:
</p>
<pre>input S, T
m ← length S
n ← length T
result ← 0
for i ∈ [0..m]
  for j ∈ [0..n]
    if i=0 or j=0 or S[i] ≠ T[j]
      a[i][j] ← 0
    else
      a[i][j] ← 1 + a[i-1][j-1]
      result ← max(result,a[i][j])
print "Longest common substring has length " + result
</pre>
<p>For three or more strings, the code is very similar, but each extra string introduces a new level of loop nesting. The time and memory used are proportional to the product of the lengths of all input strings, giving <img class="mwe-math-fallback-image-inline tex" alt="O(mn)" src="/wiki/images/math/0/c/a/0ca5e4e27ca8dc4c891d2c8598529ed1.png"> for the two-string case.
</p>
<h2><span class="mw-headline" id="More_efficient_solution">More efficient solution</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Longest_common_substring&amp;action=edit&amp;section=3" title="Edit section: More efficient solution">edit</a><span class="mw-editsection-bracket">]</span></span></h2>
<p>The fastest solutions are obtained using suffix data structures.
</p>
<h3><span class="mw-headline" id="Suffix_tree">Suffix tree</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Longest_common_substring&amp;action=edit&amp;section=4" title="Edit section: Suffix tree">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>A <a href="/wiki/index.php?title=Generalized_suffix_tree&amp;action=edit&amp;redlink=1" class="new" title="Generalized suffix tree (page does not exist)">generalized suffix tree</a> of the strings involved can be constructed in linear time, assuming an <a href="/wiki/String#Definitions" title="String">integer alphabet</a>. The LCS is then the one corresponding to the deepest node that contains labels for all input strings. If there are multiple longest common substrings, each one will correspond to a maximally deep node.
</p><p><i>Proof</i>: Clearly any node that contains labels from all input strings corresponds to a common substring of all input strings, and the length of this substring is given by the depth of the node. It only remains to show that the LCS always occurs at a node (and not along any of the edges). Suppose the LCS does occur in the middle of an edge. Then follow the edge down to the nearest node. If this node contains labels from all input strings, then it corresponds to a longer common substring, a contradiction. If it does not, then the edge should have split further up, yet it has not, also a contradiction. <img class="mwe-math-fallback-image-inline tex" alt="_\blacksquare" src="/wiki/images/math/7/7/3/773d97c085dfd2ddd2d1d170ff65aa2e.png">
</p>
<h3><span class="mw-headline" id="Suffix_array">Suffix array</span><span class="mw-editsection"><span class="mw-editsection-bracket">[</span><a href="/wiki/index.php?title=Longest_common_substring&amp;action=edit&amp;section=5" title="Edit section: Suffix array">edit</a><span class="mw-editsection-bracket">]</span></span></h3>
<p>Solution using a <a href="/wiki/index.php?title=Generalized_suffix_array&amp;action=edit&amp;redlink=1" class="new" title="Generalized suffix array (page does not exist)">generalized suffix array</a> is more complicated, but uses less space and may also be faster. The suffix array itself may be constructed in linear time, again assuming an integer alphabet. The <a href="/wiki/index.php?title=Longest_common_prefix_array&amp;action=edit&amp;redlink=1" class="new" title="Longest common prefix array (page does not exist)">longest common prefix array</a> (LCP array) can also be constructed in linear time. Observe that if <img class="mwe-math-fallback-image-inline tex" alt="s_1, s_2, ..., s_k" src="/wiki/images/math/3/c/4/3c40783c3c1fd5ad505846d0188ee6a0.png"> are consecutive suffixes in the suffix array, then the lengths of the longest common prefixes of the pairs <img class="mwe-math-fallback-image-inline tex" alt="(s_1, s_2), (s_2, s_3), ..., (s_{k-1},s_k)" src="/wiki/images/math/1/a/d/1ad42b4b956086c32eb48930609ba08e.png"> are consecutive entries in the LCP array and the minimum value in this range is the length of the LCP of all <img class="mwe-math-fallback-image-inline tex" alt="s_1, ..., s_k" src="/wiki/images/math/f/6/b/f6b6a8c3ba641bc96bf6f9f97ce2db66.png"> taken together. Observe further that to each common substring there corresponds such a set of suffixes containing at least one suffix from each input string, and the common substring is a common prefix of all the selected suffixes. (In particular, as a substring is always a prefix of a suffix, there must be a suffix from each input string which has the common substring as a prefix. Choose one such suffix from each input string; then take for the <img class="mwe-math-fallback-image-inline tex" alt="s_i" src="/wiki/images/math/e/5/a/e5a7472d780a5a032c7775cc5e3ce901.png">'s these suffixes and all the ones between them.)
</p><p>Now, move a <a href="/wiki/Sliding_window" title="Sliding window">sliding window</a> from left to right through the suffix array; the left edge should merely iterate from left to right, and the right edge should always move just far right enough to ensure that the window contains at least one suffix from each input string. (Observe that the right edge does, indeed, always stay stationary or move to the right; it never moves to the left.) The sliding window in the suffix array corresponds to a sliding window in the LCP array. For each position of the window in the LCP array let us find the minimum value of the LCP; this is then the length of the longest common prefix of the strings currently in the window in the suffix array. The maximum of these minimum values gives the LCS, since each window is only as large as it has to be to include all strings (and expanding a window can never increase the LCP length). This <a href="/wiki/Sliding_range_minimum_query" title="Sliding range minimum query">sliding range minimum query</a> can be solved in linear time using a <a href="/wiki/Deque" title="Deque">deque</a>.
</p>
<!-- 
NewPP limit report
CPU time usage: 0.060 seconds
Real time usage: 0.069 seconds
Preprocessor visited node count: 457/1000000
Preprocessor generated node count: 1209/1000000
Post‐expand include size: 61/2097152 bytes
Template argument size: 26/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    6.200      1 - -total
100.00%    6.200      1 - Template:Distinguish
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:210-0!*!0!!en!*!*!math=0 and timestamp 20180501014134 and revision id 1332
 -->
</div>									<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wcipeg.com/wiki/index.php?title=Longest_common_substring&amp;oldid=1332">https://wcipeg.com/wiki/index.php?title=Longest_common_substring&amp;oldid=1332</a>"					</div>
													<div id="catlinks" class="catlinks catlinks-allhidden"></div>												<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>

			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-createaccount"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Longest+common+substring&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Longest+common+substring" title="You are encouraged to log in; however, it is not mandatory [ctrl-alt-o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
															<li id="ca-nstab-main" class="selected"><span><a href="/wiki/Longest_common_substring" title="View the content page [ctrl-alt-c]" accesskey="c">Page</a></span></li>
															<li id="ca-talk" class="new"><span><a href="/wiki/index.php?title=Talk:Longest_common_substring&amp;action=edit&amp;redlink=1" title="Discussion about the content page [ctrl-alt-t]" accesskey="t">Discussion</a></span></li>
													</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<h3 id="p-variants-label" tabindex="0"><span>Variants</span><a href="#" tabindex="-1"></a></h3>

						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
															<li id="ca-view" class="selected"><span><a href="/wiki/Longest_common_substring">Read</a></span></li>
															<li id="ca-edit"><span><a href="/wiki/index.php?title=Longest_common_substring&amp;action=edit" title="You can edit this page. Please use the preview button before saving [ctrl-alt-e]" accesskey="e">Edit</a></span></li>
															<span class="placeholder" style="display: none;"></span>
													</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu" aria-labelledby="p-cactions-label" style="">
						<h3 id="p-cactions-label" tabindex="0" style="width: 61px;"><span>More</span><a href="#" tabindex="-1"></a></h3>

						<div class="menu">
							<ul><li id="ca-history" class="collapsible" style="display: list-item;"><span><a href="/wiki/index.php?title=Longest_common_substring&amp;action=history" title="Past revisions of this page [ctrl-alt-h]" accesskey="h">View history</a></span></li>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>

						<form action="/wiki/index.php" id="searchform">
														<div id="simpleSearch">
															<input type="search" name="search" placeholder="Search" title="Search PEGWiki [ctrl-alt-f]" accesskey="f" id="searchInput" tabindex="1" autocomplete="off"><input type="hidden" value="Special:Search" name="title"><input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchButton" class="searchButton">								</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="/wiki/Main_Page" title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>

			<div class="body">
									<ul>
													<li id="n-mainpage-description"><a href="/wiki/Main_Page" title="Visit the main page [ctrl-alt-z]" accesskey="z">Main page</a></li>
													<li id="n-Index"><a href="/wiki/Special:AllPages">Index</a></li>
													<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="A list of recent changes in the wiki [ctrl-alt-r]" accesskey="r">Recent changes</a></li>
													<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random page [ctrl-alt-x]" accesskey="x">Random page</a></li>
													<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
											</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Tools</h3>

			<div class="body">
									<ul>
													<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/Longest_common_substring" title="A list of all wiki pages that link here [ctrl-alt-j]" accesskey="j">What links here</a></li>
													<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/Longest_common_substring" title="Recent changes in pages linked from this page [ctrl-alt-k]" accesskey="k">Related changes</a></li>
													<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [ctrl-alt-q]" accesskey="q">Special pages</a></li>
													<li id="t-print"><a href="/wiki/index.php?title=Longest_common_substring&amp;printable=yes" rel="alternate" title="Printable version of this page [ctrl-alt-p]" accesskey="p">Printable version</a></li>
													<li id="t-permalink"><a href="/wiki/index.php?title=Longest_common_substring&amp;oldid=1332" title="Permanent link to this revision of the page">Permanent link</a></li>
													<li id="t-info"><a href="/wiki/index.php?title=Longest_common_substring&amp;action=info" title="More information about this page">Page information</a></li>
											</ul>
							</div>
		</div>
				</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> This page was last modified on 29 May 2011, at 04:49.</li>
											<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://creativecommons.org/licenses/by/3.0/">Attribution 3.0 Unported</a> unless otherwise noted.</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="/wiki/PEGWiki:Privacy_policy" title="PEGWiki:Privacy policy">Privacy policy</a></li>
											<li id="footer-places-about"><a href="/wiki/PEGWiki:About" title="PEGWiki:About">About PEGWiki</a></li>
											<li id="footer-places-disclaimer"><a href="/wiki/PEGWiki:General_disclaimer" title="PEGWiki:General disclaimer">Disclaimers</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
											<li id="footer-copyrightico">
															<a href="http://creativecommons.org/licenses/by/3.0/"><img src="http://i.creativecommons.org/l/by/3.0/88x31.png" alt="Attribution 3.0 Unported" width="88" height="31"></a>
													</li>
											<li id="footer-poweredbyico">
															<a href="//www.mediawiki.org/"><img src="/wiki/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"></a>
													</li>
									</ul>
						<div style="clear:both"></div>
		</div>
		<script>if(window.jQuery)jQuery.ready();</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest"],null,true);
}</script>
<script>if(window.mw){
document.write("\u003Cscript src=\"https://wcipeg.com/wiki/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=site\u0026amp;only=scripts\u0026amp;skin=vector\u0026amp;*\"\u003E\u003C/script\u003E");
}</script><script src="https://wcipeg.com/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=vector&amp;*"></script>
<script>if(window.mw){
mw.config.set({"wgBackendResponseTime":66});
}</script>
	

<div class="suggestions" style="display: none; font-size: 13px;"><div class="suggestions-results"></div><div class="suggestions-special"></div></div></body></html>