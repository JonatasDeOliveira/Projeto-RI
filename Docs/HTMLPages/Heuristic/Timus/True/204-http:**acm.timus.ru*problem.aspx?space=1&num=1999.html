<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1999. The secret module @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1999"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1999&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1999&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1999&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1999&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1999. The secret module</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_epigraph">Palpatine: Rise, my friend.<br>
Darth Vader: The Death Star will be completed on schedule.<br>
Palpatine: You’ve done well, Lord Vader.</div></div><div class="problem_par"><div class="problem_par_normal">The Death Star space station was created to keep the whole Galaxy under control. 
This station was equipped with the most powerful weapons and could carry thousands destroyers.
The Death Star also had some precautions introduced in order to prevent the rebels from approaching.
Specifically, all destroyers that approached the station were subject to thorough examination.
There was a special module responsible for managing the entrance control. The module read and checked the arriving ship’s identification number.</div></div><div class="problem_par"><div class="problem_par_normal">The ship’s number is a non-negative integer, it is read from the left to the right.
The number can have any length. Leading zeroes should not affect the module verdict.
The checking module is a finite deterministic automaton with <i>n</i> states.
Initially, the automaton is at the first state. It checks a ship’s number as follows.
It reads a digit and changes its state according to some rule, determined by the current state and the analyzed digit.
If the automaton reads the ship’s number to the end and finishes in a terminal state, then the station lets the ship in.
Otherwise, the ship is destroyed. Any ship with an empty identification number also has to be destroyed, 
hence the initial state is non-terminal for sure.</div></div><div class="problem_par"><div class="problem_par_normal">This system worked perfectly well until the day the rebels destroyed the station. 
The designers of the new Death Star decided to use a similar technology for checking ships’ numbers.
But the rebels already know the numbers of many enemy ships.
So, in order to raise security levels, the identification numbers of all imperial destroyers were increased by some number <i>k</i>.</div></div><div class="problem_par"><div class="problem_par_normal">Your task is to make a special module for the new Death Star.
The module should let a ship in if and only if
its number is the new number of one of the imperial destroyers.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line of the input contains integer <i>k</i> (1 ≤ <i>k</i> ≤ 8).
Then the automaton’s description follows. 
The first line of the description contains the number of the states in the automaton <i>n</i> (1 ≤ <i>n</i> ≤ 100).
The second line of the description contains <i>n</i> numbers <i>t</i><sub><i>i</i></sub> (<i>t</i><sub><i>i</i></sub> ∈ {0, 1}). 
<i>t</i><sub><i>i</i></sub> = 1, if the <i>i</i>-th state is terminal and <i>t</i><sub><i>i</i></sub> = 0 otherwise.
The <i>i</i>-th of the next <i>n</i> lines contains 10 integers that correspond to the numbers of states the automaton will change to 
if it is in state <i>i</i> and reads digit 0, 1, …, 9 correspondingly.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">If there is no proper automaton for the Death Star, print "Impossible".
If there is one, print "Success", then print the automaton’s description in the same format as in the input.
Your automaton should have at most 25&nbsp;600 states.
It is guaranteed that if there is a proper automaton, then there also is one that fits into the given limit.</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>3
4
0 0 1 0
1 2 4 4 4 4 4 4 4 4
4 2 4 4 4 4 4 4 3 4
4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4
</pre></td><td><pre>Success
5
0 0 0 0 1
1 2 3 4 4 4 4 4 4 4
4 2 3 4 4 4 4 4 4 4
4 5 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4
4 4 4 4 4 4 4 4 4 4
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Denis Dublennykh (prepared by Eugene Kurpilyansky)<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1999" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1999" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 4740</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1999" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1999">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1999">Discussion (1)</a><br><a href="status.aspx?space=1&amp;num=1999">All submissions (363)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1999&amp;status=accepted">All accepted submissions (39)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1999">Solutions rating (24)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>