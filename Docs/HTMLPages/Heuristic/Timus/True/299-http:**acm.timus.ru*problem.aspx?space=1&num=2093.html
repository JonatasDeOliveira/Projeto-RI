<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>2093. All Roads Lead to Snowdrift @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=2093"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=2093&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=2093&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=2093&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=2093&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">2093. All Roads Lead to Snowdrift</h2><div class="problem_limits">Time limit: 2.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Winter in Yekaterinburg is the longest time of the year. And everyone 
spends long winter evenings in his own way. For Fedor this evening is 
very special, because for the first time in many years the legendary 
German rock band Decline gives a&nbsp;concert in Yekaterinburg. Fedor needs to 
go through the city to the concert hall. And, as ill luck would have it,  
this day the&nbsp;snow began to fall, thoroughly slowing down the traffic on 
all roads. A snow-clearing equipment slightly saves the&nbsp;situation, but 
during the cleaning of the road the driving through it is closed.</div></div><div class="problem_par"><div class="problem_par_normal">In normal weather Fedor can drive through the <i>i</i>-th road in time <i>t</i><sub><i>i</i></sub>. 
In the snowfall, travel time depends on the amount of snow on a road. 
If Fedor starts his travel through the <i>i</i>-th road after time <i>T</i> after 
its last cleaning (or after the beginning of&nbsp;a&nbsp;snowfall, if this road has 
not been cleaned yet), the travel time through it will be equal to min(⌈(1 + <i>T</i>/100) · <i>t</i><sub><i>i</i></sub>⌉, <nobr>100500 · <i>t</i><sub><i>i</i></sub></nobr>) (⌈<i>x</i>⌉ is <i>x</i> rounded upwards).</div></div><div class="problem_par"><div class="problem_par_normal">Fedor has found on the Internet a complete plan of roads cleaning. He 
wants to construct his route without driving through a&nbsp;road during 
its cleaning (and always leaving a road before its next cleaning). Fedor 
may be waiting on the crossroads for the&nbsp;moment when he can drive further. 
He needs to select a route which allows him to get to the concert hall as  
soon as possible.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains integers <i>n</i> and <i>m</i> that are the number of 
crossroads and roads between them respectively <nobr>(2 ≤ <i>n</i> ≤ 10<sup>5</sup>;</nobr> 1 ≤ <i>m</i> ≤ 10<sup>5</sup>). Fedor’s house is at the first crossroad, and a 
concert hall is at the <i>n</i>-th. The <i>i</i>-th of the following <i>m</i> lines 
describes the <i>i</i>-th road as integers <i>a</i><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub> and <i>t</i><sub><i>i</i></sub> meaning the 
numbers of crossroads connected by it, and travel time through it in 
normal weather conditions (1 ≤ <i>a</i><sub><i>i</i></sub>, <i>b</i><sub><i>i</i></sub> ≤ <i>n</i>; 1 
≤ <i>t</i><sub><i>i</i></sub> ≤ 10<sup>6</sup>). All roads in Yekaterinburg are bilateral,  
between any two crossroads there is no more than one road, no road 
connects a crossroad with itself. It is possible to drive from Fedor’s 
house to a concert hall by roads.</div></div><div class="problem_par"><div class="problem_par_normal">The next line contains an integer <i>k</i> (1 ≤ <i>k</i> ≤ 10<sup>5</sup>). 
The following <i>k</i> lines contain the plan of roads cleaning. The <i>i</i>-th 
one contains integers <i>p</i><sub><i>i</i></sub>, <i>s</i><sub><i>i</i></sub> and <i>f</i><sub><i>i</i></sub> that are the road number and  
moments when the cleaning will be started and finished <nobr>(1 ≤ <i>p</i><sub><i>i</i></sub> 
≤ <i>m</i>;</nobr> <nobr>0 ≤ <i>s</i><sub><i>i</i></sub> &lt; <i>f</i><sub><i>i</i></sub> ≤ 10<sup>9</sup>)</nobr>. During the evening 
the same road can be cleaned several times, but one of its cleaning always 
ends up strictly before the next one begins. </div></div><div class="problem_par"><div class="problem_par_normal">Fedor leaves his house at the beginning of a snowfall. All times are 
counted from that moment and measured in minutes.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output the minimum time in which Fedor will be able to get to the concert 
hall. </div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>4 3
1 2 10
2 3 10
3 4 10
1
2 10 15
</pre></td><td><pre>38
</pre></td></tr></tbody></table><h3 class="problem_subtitle">Notes</h3><div class="problem_par"><div class="problem_par_normal">In the example, Fedor passes the first road in 10 minutes, then waits 5 
minutes at the second crossroad for the end of the cleaning, then passes 
the second road in 10 minutes. 25 minutes after the start, he goes to the 
third road and passes it in 13 minutes (because of the snow that had 
fallen on it during 25 minutes of snowfall).</div></div><div class="problem_source"><b>Problem Author: </b>Denis Dublennykh<br><b>Problem Source: </b>Open Ural FU Personal Contest 2014<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=graphs">graph theory</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=2093" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=2093" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 1017</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=2093" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=2093">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=2093">Discussion (3)</a><br><a href="status.aspx?space=1&amp;num=2093">All submissions (887)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=2093&amp;status=accepted">All accepted submissions (104)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=2093">Solutions rating (74)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>