<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1967. Programmer Casino @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1967"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1967&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1967&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1967&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1967&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1967. Programmer Casino</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">The Macau city is referred to as the “Oriental Monte Carlo”. There are 
more than thirty casinos in Macau. Every year they lure millions of 
gamblers from China and from other countries. The gambling industry makes 
up for about 40% of the city's GDP. </div></div><div class="problem_par"><div class="problem_par_normal">Vova learned from his friends in Guangzhou that Macau has special casinos 
for programmers only. Vova found that quite interesting and he immediately 
decided to visit a programmer casino. One such casino was located by Vova's 
hotel, so in the evening he took some cash and went there.  </div></div><div class="problem_par"><div class="problem_par_normal">Indeed, there must have been programmers sitting at the casino tables, because the 
tables had no cards or pieces. Instead, each player had a notepad lying in 
front of him. A player wrote some numbers in his notepad. Vova was 
explained that the game goes like this. First each player writes a number 
one on a clear notepad page. Then the croupier starts reading out a 
sequence of zeroes and ones, one digit at a time. If the croupier reads 
out a number zero, all players add a zero to the end of the last number in their 
pages. And if the croupier reads out a number one, then the player can either add 
this number one to the end of the last number or write it on a new line, 
thus starting a new number. After the croupier stops reading out the 
digits, each player converts all his binary numbers into decimals, then 
glues them all into a single decimal number in the order, in which they 
were recorded. The player with the minimum resulting number wins. </div></div><div class="problem_par"><div class="problem_par_normal">For example, if the croupier reads out the sequence of 1011100101, the 
first player writes binary letters 1, 1011 and 100101 decimals 
1, 11 and 37), and the second player writes 110, 11100 and 101 
(decimal 6, 28 and 5), then the winner is the second player as 6285 is 
less than 11137. </div></div><div class="problem_par"><div class="problem_par_normal">Before joining in the game, Vova decided to learn to play optimally well 
for the simple case when the croupier's sequence is represented as a 
binary record of all integers one by one from 2 to <i>n</i> (in the above given 
example <i>n</i> was equal to five). But as Vova failed to quickly come up with the 
optimal strategy, he asked you to help him.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The single line contains an integer <i>n</i> (2 ≤ <i>n</i> ≤ 100&nbsp;000).</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">In the first line print, how many numbers Vova should write down if he 
plays optimally well. In the second line print the numbers' lengths in 
bits in the order they are written. If there are multiple solutions that 
result in the minimum decimal number, print any of them. </div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>5
</pre></td><td><pre>2
1 10
</pre></td></tr></tbody></table><h3 class="problem_subtitle">Notes</h3><div class="problem_par"><div class="problem_par_normal">In the sample you need to write down all the digits the croupier reads out 
into the second number. In this case after the numbers are converted to 
decimals and glued together, we get number 1741.</div></div><div class="problem_source"><b>Problem Author: </b>Ilya Zvigintsev<br><b>Problem Source: </b>Open Ural FU Personal Contest 2013<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1967" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1967" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 4283</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1967" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1967">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1967">Discussion (2)</a><br><a href="status.aspx?space=1&amp;num=1967">All submissions (422)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1967&amp;status=accepted">All accepted submissions (96)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1967">Solutions rating (30)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>