<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1906. The Lost Civilization @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1906"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1906&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1906&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1906&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1906&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1906. The Lost Civilization</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Recently, the ruins of the ancient city have been found on one of the planets in the system of Betelgeuse. Particular attention was drawn to the well-preserved temple with walls covered with numerous texts. Transcription revealed that they tell about the social structure and the culture of the lost civilization.</div></div><div class="problem_par"><div class="problem_par_normal">In particular, the lettering described how the production and distribution of food was organized in the heyday of this civilization. It was found that around the city there were fields with some edible plants characterized by extremely high yield. In the autumn any citizen could come to any such field and take its share of the fruits. This share was strictly fixed, and the shares of any two residents were equal. One could take no more and no less than his share was. If someone came to the field and saw that there were less fruits than he needed, he took nothing and went to another field.
The remaining fruits were let to seeds, so from each of them some new fruits would grow next year. This number was always the same and did not depend on the year or which fruit the seeds were collected from. </div></div><div class="problem_par"><div class="problem_par_normal">You found tablets with some numbers at the place where the field nearest to the city once was. Perhaps an annual account of the fruit remaining at the beginning of winter in this field was carried out on these tablets. You also suggested that by this time of the year the quantity of fruit in the field was always less than the size of one share. The appearance of several tablets changed over years, and it is possible that more recent ones had a completely different purpose. Find the size of the share per capita and growth rate (how many fruits grew from seeds from one piece of fruit) that is consistent with as much of the oldest tablets as possible.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains an integer <i>n</i> that is an amount of tablets (1 ≤ <i>n</i> ≤ 10<sup>5</sup>).
The second line contains integers <i>a</i><sub>0</sub>, <i>a</i><sub>1</sub>, …, <i>a</i><sub><i>n</i> − 1</sub>, written on the tablets (0 ≤ <i>a</i><sub><i>i</i></sub> ≤ 10<sup>9</sup>).
<i>a</i><sub>0</sub> is written on the oldest tablet, <i>a</i><sub><i>n</i> − 1</sub> is written on the newest one.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output integers <i>L</i>, <i>P</i> and <i>k</i>, meaning that integers on the first <i>L</i> tablets don’t contradict the size of the share <i>P</i> and growth rate <i>k</i>.
Integers <i>P</i> and <i>k</i> must meet the following restrictions:
1 ≤ <i>P</i> ≤ 2 · 10<sup>18</sup>; 0 ≤ <i>k</i> ≤ 2 · 10<sup>18</sup> (it is 
guaranteed that among the solutions of the problem there is at least one satisfying 
these constraints). 
If there are several solutions with maximum value <i>L</i>, output any of them.</div></div><h3 class="problem_subtitle">Samples</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>5
1 2 4 8 0
</pre></td><td><pre>5 16 2
</pre></td></tr><tr><td><pre>3
4 2 1
</pre></td><td><pre>3 5 3
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Denis Dublennykh<br><b>Problem Source: </b>Ural Championship 2012<br></div></div></div><div><b>Tags: </b><a href="problemset.aspx?space=1&amp;tag=hardest">hardest problem</a> &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1906" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1906" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 6859</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1906" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1906">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1906">Discussion (1)</a><br><a href="status.aspx?space=1&amp;num=1906">All submissions (438)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1906&amp;status=accepted">All accepted submissions (22)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1906">Solutions rating (18)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>