<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=768"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>1188. Library @ Timus Online Judge</title><link rel="alternate" hreflang="x-default" href="/problem.aspx?space=1&amp;num=1188"><link rel="alternate" hreflang="en-us" href="/problem.aspx?space=1&amp;num=1188&amp;locale=en"><link rel="alternate" hreflang="ru-ru" href="/problem.aspx?space=1&amp;num=1188&amp;locale=ru"><link rel="stylesheet" type="text/css" href="/style52.css"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"></head><body><table width="100%" cellspacing="0" cellpadding="0" class="body"><tbody><tr><td class="caption"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" class="locale"><a href="/problem.aspx?space=1&amp;num=1188&amp;locale=en">ENG</a>&nbsp;&nbsp;<a href="/problem.aspx?space=1&amp;num=1188&amp;locale=ru">RUS</a></td><td class="title"><a href="/">Timus Online Judge</a></td><td width="130"></td></tr></tbody></table></td></tr><tr><td class="panel"><table width="100%" cellspacing="0" cellpadding="0"><tbody><tr><td width="130" valign="TOP" align="CENTER" style="padding-bottom:5px;"><a href="/"><img border="0" src="/images/usu-summer.jpg" height="134" width="106" alt=""></a></td><td valign="TOP" align="LEFT"><table width="100%" cellspacing="0" cellpadding="0" class="panel"><tbody><tr><th width="25%"><div>Online Judge</div></th><th width="25%"><div>Problems</div></th><th width="25%"><div>Authors</div></th><th width="25%"><div>Online contests</div></th></tr><tr><td valign="TOP" align="LEFT"><a href="/">About Online Judge</a><br><a href="/help.aspx?topic=faq">Frequently asked questions</a><br><a href="/news.aspx">Site news</a><br><a href="/forum/">Webboard</a><br><a href="/help.aspx?topic=links">Links</a><br></td><td valign="TOP" align="LEFT"><a href="/problemset.aspx">Problem set</a><br><a href="/submit.aspx">Submit solution</a><br><a href="/status.aspx">Judge status</a><br><a href="/help.aspx?topic=judge">Guide</a><br></td><td valign="TOP"><a href="/register.aspx">Register</a><br><a href="/authedit.aspx">Update your info</a><br><a href="/ranklist.aspx">Authors ranklist</a><br><form action="/search.aspx" method="GET" style="margin-top:0.6em;"><input name="Str" size="12" value="" placeholder="Author’s name"> <input type="SUBMIT" value="Search"></form></td><td valign="TOP"><a href="/contest.aspx">Current contest</a><br><a href="/schedule.aspx">Scheduled contests</a><br><a href="/archive.aspx">Past contests</a><br><a href="/help.aspx?topic=contest">Rules</a><br></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="padding-top: 32px; padding-bottom: 20px;"><table align="CENTER" cellspacing="0" cellpadding="0"><tbody><tr><td width="800"><div class="problem_content"><h2 class="problem_title">1188. Library</h2><div class="problem_limits">Time limit: 1.0 second<br>Memory limit: 64 MB<br></div><div id="problem_text"><div class="problem_par"><div class="problem_par_normal">Castaway Robinson Crusoe is living alone on a remote island.
One day a ship carrying a royal library has wrecked nearby.
Usually Robinson brings any useful stuff from the shipwreck to his
island, and this time he has brought a big chest with books.</div></div><img src="/image/get.aspx/b554ef49-d479-41a4-abec-3df173ea7dba" border="0" alt="Problem illustration" align="RIGHT" class="problem_raimage"><div class="problem_par"><div class="problem_par_normal">Robinson has decided to build a bookcase for these books to create
his own library. He cut a rectangular niche in the rock for that purpose,
hammered in wooden pegs, and placed wooden planks on every pair of pegs 
that have the same height, so that all planks are situated horizontally
and suit to act as shelves.</div></div><div class="problem_par"><div class="problem_par_normal">Unfortunately, Robinson has discovered that one especially old and big
tome does not fit in his bookcase. He measured the height and width of this
tome and has decided to redesign his bookcase in such a way, as to completely
fit the tome on one of the shelves, taking into account locations of other
shelves and the dimensions of the niche. With each shelf in the bookcase,
one of the following operations should be made:

<ol>

<li>Leave the shelf on its original place.</li>

<li>Move the shelf to the left or to the right.</li>

<li>Shorten the shelf by cutting off a part of the plank and optionally
move it to the left or to the right.</li>

<li>Move one of the pegs to a different place at the same height and 
move the shelf to the left or to the right.</li>

<li>Shorten the shelf by cutting off a part of the plank, move one of the
pegs to a different place at the same height, and optionally move the
shortened shelf to the left or to the right.</li>

<li>Remove the shelf from the bookcase along with both supporting pegs.</li>
</ol>
</div></div><div class="problem_par"><div class="problem_par_normal">We say that the shelf is properly supported by its pegs, if exactly two
distinct pegs support the shelf and the center of the shelf is between its
pegs or coincides with one of the pegs. The original design of Robinson's
library has all the shelves properly supported by their pegs and lengths of
all shelves are integer number of inches. The Robinson may only cut an integer
number of inches from the planks, because he has no tools for more precise
measurements. All remaining shelves after the redesign must be properly
supported by their pegs.</div></div><div class="problem_par"><div class="problem_par_normal">You are to find the way to redesign Robinson's library to fit the special
old tome without changing original design too much. You have to minimize the
number of pegs that are to be removed from their original places during
the redesign (operations 4 and 5 remove one peg, and operation 6 removes
two pegs). If there are different ways to solve the problem, then you are
to find the one that minimizes the total length of planks that are to be
cut off (operations 3 and 5 involve cutting something from the planks,
and operation 6 counts as if cutting off the whole plank). Width of
planks and diameter of pegs shall be considered zero.</div></div><div class="problem_par"><div class="problem_par_normal">The tome may not be rotated. The tome should completely (to all its width)
stand on one of the shelves and may only touch other shelves, their pegs or
niche's edge.</div></div><h3 class="problem_subtitle">Input</h3><div class="problem_par"><div class="problem_par_normal">The first line contains four integers <i>X<sub>N</sub></i>, <i>Y<sub>N</sub></i>, <i>X<sub>T</sub></i>, and <i>Y<sub>T</sub></i>, separated by spaces. They are, correspondingly, width and height of the niche, and width and height of the old tome in inches (1 ≤ <i>X<sub>N</sub></i>, <i>Y<sub>N</sub></i>, <i>X<sub>T</sub></i>, <i>Y<sub>T</sub></i> ≤ 1000).</div></div><div class="problem_par"><div class="problem_par_normal">The second line contains a single integer <i>N</i> (1 ≤ <i>N</i> ≤ 100) that represents the number of the shelves. Then <i>N</i> lines follow. Each line represents a single shelf along with its two supporting pegs, and contains five integer numbers <i>y<sub>i</sub></i>, <i>x<sub>i</sub></i>, <i>l<sub>i</sub></i>, <i>x</i><sub>1<sub><i>i</i></sub></sub>, <i>x</i><sub>2<sub><i>i</i></sub></sub>, separated by spaces, where:

<ul>
<li><i>y<sub>i</sub></i> (0 &lt; <i>y<sub>i</sub></i> &lt; <i>Y<sub>N</sub></i>)&nbsp;— the height of the <i>i</i><sup>th</sup> shelf above the bottom of the niche in inches.</li>
<li><i>x<sub>i</sub></i> (0 ≤ <i>x<sub>i</sub></i> &lt; <i>X<sub>N</sub></i>)&nbsp;— the distance between 
the left end of the <i>i</i><sup>th</sup> shelf and the left edge of the niche in inches.</li>
<li><i>l<sub>i</sub></i> (0 &lt; <i>l<sub>i</sub></i> ≤ <i>X<sub>N</sub></i>&nbsp;−&nbsp;<i>x<sub>i</sub></i>)&nbsp;— the length of the <i>i</i><sup>th</sup> shelf in inches.</li>
<li><i>x</i><sub>1<sub><i>i</i></sub></sub> (0 ≤ <i>x</i><sub>1<sub><i>i</i></sub></sub> ≤ <i>l<sub>i</sub></i>/2)&nbsp;— the distance between the left end of the <i>i</i><sup>th</sup> shelf and its leftmost supporting peg in inches.</li>
<li><i>x</i><sub>2<sub><i>i</i></sub></sub> (<i>l<sub>i</sub></i>/2 ≤ <i>x</i><sub>2<sub><i>i</i></sub></sub> ≤ <i>l<sub>i</sub></i>;
    <i>x</i><sub>1<sub><i>i</i></sub></sub> &lt; <i>x</i><sub>2<sub><i>i</i></sub></sub>)&nbsp;— the distance between the left end of the <i>i</i><sup>th</sup> shelf and its rightmost supporting peg in inches.</li>
</ul>
</div></div><div class="problem_par"><div class="problem_par_normal">All shelves are situated on different heights and are properly supported by their pegs. The problem is guaranteed to have a solution for the input data.</div></div><h3 class="problem_subtitle">Output</h3><div class="problem_par"><div class="problem_par_normal">Output two integers separated by a space. The first one is the minimal number of pegs that are to be removed by Robinson from their original locations to place the tome. The second one is the minimal total length of planks in inches that are to be cut off during the redesign that removes the least number of pegs.</div></div><h3 class="problem_subtitle">Sample</h3><table class="sample"><tbody><tr><th width="350">input</th><th width="350">output</th></tr><tr><td><pre>11 8 4 6
4
1 1 7 1 4
4 3 7 1 6
7 2 6 3 4
2 0 3 0 3
</pre></td><td><pre>1 3
</pre></td></tr></tbody></table><div class="problem_source"><b>Problem Author: </b>Elena Kryuchkova, Roman Elizarov
<br><b>Problem Source: </b>2001-2002 ACM Northeastern European Regional Programming Contest<br></div></div></div><div><b>Tags: </b>none &nbsp;<span class="problem_tags_toggle">(<form method="POST" action="problem.aspx?space=1&amp;num=1188" style="display:inline;" id="ToggleTagsForm"><a href="problem.aspx?space=1&amp;num=1188" onclick="document.getElementById('ToggleTagsForm').submit();return false;"><input type="hidden" name="Action" value="HideTags">hide tags for unsolved problems</a></form>)</span></div><div class="problem_links"><span>Difficulty: 2087</span> &nbsp;&nbsp;&nbsp;<a href="print.aspx?space=1&amp;num=1188" target="_blank">Printable version</a> &nbsp;&nbsp;&nbsp;<a href="submit.aspx?space=1&amp;num=1188">Submit solution</a> &nbsp;&nbsp;&nbsp;<a href="forum/?space=1&amp;num=1188">Discussion (6)</a><br><a href="status.aspx?space=1&amp;num=1188">All submissions (1157)</a> &nbsp;&nbsp;&nbsp;<a href="status.aspx?space=1&amp;num=1188&amp;status=accepted">All accepted submissions (243)</a> &nbsp;&nbsp;&nbsp;<a href="rating.aspx?space=1&amp;num=1188">Solutions rating (192)</a></div></td></tr></tbody></table></td></tr><tr><td class="footer"><script type="text/javascript" async="" src="https://mc.yandex.ru/metrika/watch.js"></script><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript>&lt;div&gt;&lt;img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""&gt;&lt;/div&gt;</noscript>© 2000–2017 <a href="/team.aspx">Timus Online Judge Team</a>. All rights reserved.</td></tr></tbody></table><img src="https://mc.yandex.ru/metrika/advert.gif" style="position: absolute; visibility: hidden; width: 0px; height: 0px;"></body></html>